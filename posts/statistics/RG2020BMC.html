<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zad Rafi">
<meta name="dcterms.date" content="2020-12-11">
<meta name="keywords" content="p-value, p-value function, confidence curve, confidence distribution">
<meta name="description" content="This post goes through the R code and logic that was used to construct the figures and concepts in Rafi &amp; Greenland (2020) BMC MRM.">

<title>Tables, Graphs, and Computations from Rafi &amp; Greenland (2020) – Less Likely</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 2em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-befe23ebd2f54d8af2c8a89d1a1611f1.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-6f31dc0de0b27d6330ba5816b520976b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-851073aeef2233dc7fca7df9ea7de5a3.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-6f31dc0de0b27d6330ba5816b520976b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": true,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Less Likely</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html#category=statistics"> 
<span class="menu-text">Statistics</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/zadrafi"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/zadrafi"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#valid-p-values-are-uniform-under-the-null-model" id="toc-valid-p-values-are-uniform-under-the-null-model" class="nav-link active" data-scroll-target="#valid-p-values-are-uniform-under-the-null-model"><span class="header-section-number">0.1</span> Valid <span class="math inline">\(P\)</span>-values Are Uniform Under the Null Model</a></li>
  <li><a href="#posterior-predictive-p-values" id="toc-posterior-predictive-p-values" class="nav-link" data-scroll-target="#posterior-predictive-p-values"><span class="header-section-number">0.2</span> Posterior Predictive <span class="math inline">\(P\)</span>-values</a></li>
  <li><a href="#table-1-some-p-values-s-values-maximum-likelihood-ratios-and-likelihood-ratio-statistics" id="toc-table-1-some-p-values-s-values-maximum-likelihood-ratios-and-likelihood-ratio-statistics" class="nav-link" data-scroll-target="#table-1-some-p-values-s-values-maximum-likelihood-ratios-and-likelihood-ratio-statistics"><span class="header-section-number">0.3</span> Table 1: Some <span class="math inline">\(P\)</span>-values, <span class="math inline">\(S\)</span>-values, Maximum Likelihood Ratios, and Likelihood Ratio Statistics</a></li>
  <li><a href="#frequentist-interval-estimate-percentiles" id="toc-frequentist-interval-estimate-percentiles" class="nav-link" data-scroll-target="#frequentist-interval-estimate-percentiles"><span class="header-section-number">0.4</span> Frequentist Interval Estimate Percentiles</a></li>
  <li><a href="#refer-to-long-run-coverage" id="toc-refer-to-long-run-coverage" class="nav-link" data-scroll-target="#refer-to-long-run-coverage"><span class="header-section-number">0.5</span> Refer to Long-Run Coverage</a></li>
  <li><a href="#brown-et-al.-2017-reanalysis" id="toc-brown-et-al.-2017-reanalysis" class="nav-link" data-scroll-target="#brown-et-al.-2017-reanalysis"><span class="header-section-number">1</span> Brown et al.&nbsp;(2017) Reanalysis</a>
  <ul class="collapse">
  <li><a href="#table-2-p-values-s-values-and-likelihoods-for-targeted-hypotheses-about-hazard-ratios-for-brown-et-al." id="toc-table-2-p-values-s-values-and-likelihoods-for-targeted-hypotheses-about-hazard-ratios-for-brown-et-al." class="nav-link" data-scroll-target="#table-2-p-values-s-values-and-likelihoods-for-targeted-hypotheses-about-hazard-ratios-for-brown-et-al."><span class="header-section-number">1.1</span> Table 2: <span class="math inline">\(P\)</span>-values, <span class="math inline">\(S\)</span>-values, and Likelihoods for Targeted Hypotheses About Hazard Ratios for Brown et al.</a></li>
  <li><a href="#plot-the-point-estimate-and-95-compatibility-interval" id="toc-plot-the-point-estimate-and-95-compatibility-interval" class="nav-link" data-scroll-target="#plot-the-point-estimate-and-95-compatibility-interval"><span class="header-section-number">1.2</span> Plot the point estimate and 95% compatibility interval</a></li>
  <li><a href="#p-value-and-s-value-functions" id="toc-p-value-and-s-value-functions" class="nav-link" data-scroll-target="#p-value-and-s-value-functions"><span class="header-section-number">1.3</span> <span class="math inline">\(P\)</span>-value and <span class="math inline">\(S\)</span>-value Functions</a></li>
  <li><a href="#figure-3-p-value-compatibility-function" id="toc-figure-3-p-value-compatibility-function" class="nav-link" data-scroll-target="#figure-3-p-value-compatibility-function"><span class="header-section-number">1.4</span> Figure 3: <span class="math inline">\(P\)</span>-value (Compatibility) Function</a></li>
  <li><a href="#cumulative-confidence-compatibility-distribution" id="toc-cumulative-confidence-compatibility-distribution" class="nav-link" data-scroll-target="#cumulative-confidence-compatibility-distribution"><span class="header-section-number">1.5</span> Cumulative Confidence (Compatibility Distribution)</a></li>
  <li><a href="#figure-4-s-value-suprisal-function" id="toc-figure-4-s-value-suprisal-function" class="nav-link" data-scroll-target="#figure-4-s-value-suprisal-function"><span class="header-section-number">1.6</span> Figure 4: <span class="math inline">\(S\)</span>-value (Suprisal) Function</a></li>
  <li><a href="#likelihood-support-functions" id="toc-likelihood-support-functions" class="nav-link" data-scroll-target="#likelihood-support-functions"><span class="header-section-number">1.7</span> Likelihood (Support) Functions</a></li>
  <li><a href="#figure-s1-relative-likelihood-function" id="toc-figure-s1-relative-likelihood-function" class="nav-link" data-scroll-target="#figure-s1-relative-likelihood-function"><span class="header-section-number">1.8</span> Figure S1: Relative Likelihood Function</a></li>
  <li><a href="#figure-s2-deviance-function-2lnmlr" id="toc-figure-s2-deviance-function-2lnmlr" class="nav-link" data-scroll-target="#figure-s2-deviance-function-2lnmlr"><span class="header-section-number">1.9</span> Figure S2: Deviance Function <span class="math inline">\(2ln(MLR)\)</span></a></li>
  </ul></li>
  <li><a href="#statistical-package-citations" id="toc-statistical-package-citations" class="nav-link" data-scroll-target="#statistical-package-citations"><span class="header-section-number">2</span> Statistical Package Citations</a></li>
  <li><a href="#environment" id="toc-environment" class="nav-link" data-scroll-target="#environment"><span class="header-section-number">3</span> Environment</a></li>
  <li><a href="#stata" id="toc-stata" class="nav-link" data-scroll-target="#stata"><span class="header-section-number">4</span> Stata</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="header-section-number">4.1</span> ————————————————————————</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">5</span> References</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/zadrafi/lesslikely/edit/main/posts/statistics/RG2020BMC.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/zadrafi/lesslikely/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Tables, Graphs, and Computations from Rafi &amp; Greenland (2020)</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>

<div>
  <div class="description">
    This post goes through the R code and logic that was used to construct the figures and concepts in Rafi &amp; Greenland (2020) BMC MRM.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Zad Rafi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 11, 2020</p>
    </div>
  </div>
  
    
  </div>
  

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>p-value, p-value function, confidence curve, confidence distribution</p>
  </div>
</div>

</header>


<script src="RG2020BMC_files/libs/kePrint-0.0.1/kePrint.js"></script>
<p><link href="RG2020BMC_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet"></p>
<center>
<img src="https://res.cloudinary.com/less-likely/image/upload/v1602038429/Site/confidencecurve.svg" width="100" style="cursor: zoom-in" align="right">
</center>
<hr>
<p>The following post provides <em>some</em> of the code that was used to construct the figures and tables from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland, 2020</a><span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup><a href="#ref-rafiSemanticCognitiveTools2020" role="doc-biblioref">1</a></sup></span>. An enhanced PDF version of the paper can be <a href="https://rdcu.be/b789P">found here</a>. For further discussion of the computations, see the appendix of the <a href="https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM1_ESM.pdf">main paper</a>, along with our <a href="https://arxiv.org/pdf/2008.12991.pdf">technical supplement</a>.<span class="citation" data-cites="greenlandTechnicalIssuesInterpretation2020"><sup><a href="#ref-greenlandTechnicalIssuesInterpretation2020" role="doc-biblioref">2</a></sup></span></p>
<hr>
<blockquote class="blockquote">
<p><strong>Disclaimer:</strong> I am responsible for all the code and mistakes below, and none of them can be attributed to my coauthors or my fellow package developers.</p>
</blockquote>
<hr>
<p>In order to recreate the functions, I would recommend installing the latest version of <a href="https://data.lesslikely.com/concurve/"><code>concurve</code></a> from <a href="https://cran.r-project.org/package=concurve">CRAN</a>, as it has patched some issues with graphing when the outcome is binary. Use the script below to get the latest version and load the <code>R</code> package. A number of other <code>R</code> packages are also used in this post, which are <a href="#statistical-package-citations">listed below.</a></p>
<hr>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"concurve"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"concurve"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<section id="valid-p-values-are-uniform-under-the-null-model" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="valid-p-values-are-uniform-under-the-null-model"><span class="header-section-number">0.1</span> Valid <span class="math inline">\(P\)</span>-values Are Uniform Under the Null Model</h2>
<hr>
<p>Here we show that valid <span class="math inline">\(P\)</span>-values have specific properties, when the null model is true. We first generate two variables (<span class="math inline">\(Y\)</span>, <span class="math inline">\(X\)</span>) that come from the same normal distribution with a <span class="math inline">\(\mu\)</span> of 0 and <span class="math inline">\(\sigma\)</span> of 1, each with a total of <code>1000</code> observations. We assume that there is no relationship between these two variables. We run a simple t-test between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> and iterate this <code>100000</code> times and compute <code>100000</code> <span class="math inline">\(P\)</span>-values to see the overall distribution of the <span class="math inline">\(P\)</span>-values, which we then plot using a histogram./</p>
<hr>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>set.seed <span class="ot">&lt;-</span> <span class="dv">1031</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>t.sim <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n.sim)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>n.samp <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X, Y)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(X, Y, <span class="at">data =</span> df)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    t.sim[i] <span class="ot">&lt;-</span> t[[<span class="dv">3</span>]]</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> t.sim)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"#99c7c7"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of P-values Under the Null"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"P-value"</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-4-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>This can also be shown using the <a href="https://cran.r-project.org/package=TeachingDemos"><code>TeachingDemos</code></a> <code>R</code> package, which has a function dedicated to showing this phenomenon.</p>
<hr>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"TeachingDemos"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: 'TeachingDemos'</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from 'package:plotly':</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     subplot</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from 'package:Hmisc':</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     cnvrt.coords, subplot</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>set.seed <span class="ot">&lt;-</span> <span class="dv">1031</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>obs_p <span class="ot">&lt;-</span> <span class="fu">Pvalue.norm.sim</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">mu0 =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma0 =</span> <span class="dv">1</span>, <span class="at">test =</span> <span class="st">"t"</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">B =</span> <span class="fl">1e+05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-5-1.svg" data-fig-align="center" width="768"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> obs_p)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"#99c7c7"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of P-values Under the Null"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"P-value"</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-5-2.svg" data-fig-align="center" width="768"></p>
<hr>
<p>As you can see, when the null model is true, the distribution of <span class="math inline">\(P\)</span>-values is uniform. Valid <span class="math inline">\(P\)</span>-values are uniform under the null hypothesis and their corresponding <span class="math inline">\(S\)</span>-values are exponentially distributed. We run the same simulation as before, but then convert the obtained <span class="math inline">\(P\)</span>-values into <span class="math inline">\(S\)</span>-values, to see how they are distributed.</p>
<hr>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>set.seed <span class="ot">&lt;-</span> <span class="dv">1031</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>t.sim <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n.sim)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>n.samp <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X, Y)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(X, Y, <span class="at">data =</span> df)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    t.sim[i] <span class="ot">&lt;-</span> t[[<span class="dv">3</span>]]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fu">log2</span>(t.sim))) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"#d46c5b"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of S-values Under the Null"</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"S-value (Bits of Information)"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-6-1.svg" data-fig-align="center" width="768"></p>
<hr>
</section>
<section id="posterior-predictive-p-values" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="posterior-predictive-p-values"><span class="header-section-number">0.2</span> Posterior Predictive <span class="math inline">\(P\)</span>-values</h2>
<hr>
<p>Despite the name, posterior predictive <span class="math inline">\(P\)</span>-values are not considered valid frequentist <span class="math inline">\(P\)</span>-values because they do not meet the uniformity criterion, instead they are pulled towards the parameter value <code>0.5</code>. For further discussion, see our <a href="https://arxiv.org/pdf/2008.12991.pdf">technical supplement</a> along with <a href="https://doi.org/10.1080/00031305.2018.1529625">Greenland (2019)</a> for comprehensive theoretical discussions.[<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup><a href="#ref-greenlandValidPvaluesBehave2019" role="doc-biblioref">3</a></sup></span>;<span class="citation" data-cites="greenlandTechnicalIssuesInterpretation2020"><sup><a href="#ref-greenlandTechnicalIssuesInterpretation2020" role="doc-biblioref">2</a></sup></span>]</p>
<p>A quick excerpt from our main paper and the technical supplement explains why this is not the case,</p>
<hr>
<blockquote class="blockquote">
<p>As discussed in the Supplement, in Bayesian settings one may see certain <span class="math inline">\(P\)</span>-values that are not valid frequentist <span class="math inline">\(P\)</span>-values, the primary example being the posterior predictive <span class="math inline">\(P\)</span>-value<span class="citation" data-cites="bayarriValuesCompositeNull2000"><sup><a href="#ref-bayarriValuesCompositeNull2000" role="doc-biblioref">4</a></sup></span>;<span class="citation" data-cites="robinsAsymptoticDistributionValues2000"><sup><a href="#ref-robinsAsymptoticDistributionValues2000" role="doc-biblioref">5</a></sup></span>; unfortunately, the negative logs of such invalid <span class="math inline">\(P\)</span>-values do not measure surprisal at the statistic given the model, and so are not valid <span class="math inline">\(S\)</span>-values.</p>
<p>The decision rule “reject <strong>H</strong> if <span class="math inline">\(p\leq\)</span> <span class="math inline">\(\alpha\)</span>” will reject <strong>H</strong> 100<span class="math inline">\(\alpha\)</span>% of the time under sampling from a model <strong>M</strong> obeying <strong>H</strong> (i.e., the Type-1 error rate of the test will be <span class="math inline">\(\alpha\)</span>) provided the random variable <span class="math inline">\(P\)</span> corresponding to <span class="math inline">\(p\)</span> is valid (uniform under the model <strong>M</strong> used to compute it), but not necessarily otherwise[<span class="citation" data-cites="kuffnerWhyArePvalues2019"><sup><a href="#ref-kuffnerWhyArePvalues2019" role="doc-biblioref">6</a></sup></span>]. This is one reason why frequentist writers reject invalid <span class="math inline">\(P\)</span>-values (such as posterior predictive <span class="math inline">\(P\)</span>-values, which highly concentrate around 0.50) and devote considerable technical coverage to uniform <span class="math inline">\(P\)</span>-values<span class="citation" data-cites="kuffnerWhyArePvalues2019"><sup><a href="#ref-kuffnerWhyArePvalues2019" role="doc-biblioref">6</a></sup></span>;<span class="citation" data-cites="robinsAsymptoticDistributionValues2000"><sup><a href="#ref-robinsAsymptoticDistributionValues2000" role="doc-biblioref">5</a></sup></span>;<span class="citation" data-cites="bayarriValuesCompositeNull2000"><sup><a href="#ref-bayarriValuesCompositeNull2000" role="doc-biblioref">4</a></sup></span>. A valid <span class="math inline">\(P\)</span>-value (“U-value”) translates into an exponentially distributed <span class="math inline">\(S\)</span>-value with a mean of 1 nat or <span class="math inline">\(\log_{2}(e)=1.443\)</span> bits where <span class="math inline">\(e\)</span> is the base of the natural logs.</p>
<p>Uniformity is also central to the “refutational information” interpretation of the <span class="math inline">\(S\)</span>-value used here, for it is necessary to ensure that the <span class="math inline">\(P\)</span>-value <span class="math inline">\(p\)</span> from which <span class="math inline">\(s\)</span> is derived is in fact the percentile of the observed value of the test statistic in the distribution of the statistic under <strong>M</strong>, thus making small <span class="math inline">\(p\)</span> surprising under <strong>M</strong> and making <span class="math inline">\(s\)</span> the corresponding degree of surprise. Because posterior predictive <span class="math inline">\(P\)</span>-values do not translate into sampling percentiles of the statistic under the hypothesis (in fact, they are pulled toward 0.5 from the correct percentiles)<span class="citation" data-cites="robinsAsymptoticDistributionValues2000"><sup><a href="#ref-robinsAsymptoticDistributionValues2000" role="doc-biblioref">5</a></sup></span>;<span class="citation" data-cites="bayarriValuesCompositeNull2000"><sup><a href="#ref-bayarriValuesCompositeNull2000" role="doc-biblioref">4</a></sup></span>, the resulting negative log does not measure surprisal at the statistic given <strong>M</strong>, and so is not a valid <span class="math inline">\(S\)</span>-value in our terms.</p>
</blockquote>
<hr>
<p>And indeed, we can show this phenomenon below with simulations. Here we fit a simple Bayesian regression model with a weakly informative prior <code>normal(0, 10)</code> using <a href="https://mc-stan.org/rstanarm"><code>rstanarm</code></a>, where both the predictor and response variable come from the same distribution and have the same location and scale parameters (<span class="math inline">\(\mu = 0\)</span>, <span class="math inline">\(\sigma = 1\)</span>. We then calculate the observed test statistics, along with their distributions, and convert them into posterior predictive <span class="math inline">\(P\)</span>-values and plot them using <a href="https://mc-stan.org/bayesplot"><code>Bayesplot</code></a> functions. Then, we iterate this <code>1000</code> times to examine the distribution of posterior predictive <span class="math inline">\(P\)</span>-values and compare them to standard <span class="math inline">\(P\)</span>-values that are known to be uniform.</p>
<p>But first, we’ll generate the distribution of the test statistic from one model.</p>
<hr>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"bayesplot"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rstan"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rstanarm"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> <span class="dv">4</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>teal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#99c7c7"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="st">"teal"</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>n.samp <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X, Y)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> df, <span class="at">chains =</span> <span class="dv">1</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in if (!prior_dist_name %in% unlist(ok_dists)) {: argument is of length zero</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>yrep <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(mod1)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: object 'mod1' not found</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">ppc_stat</span>(Y, yrep, <span class="at">stat =</span> <span class="st">"median"</span>, <span class="at">freq =</span> <span class="cn">TRUE</span>, <span class="at">binwidth =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Posterior Test Statistic"</span>) <span class="sc">+</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">yaxis_text</span>(<span class="at">on =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: object 'yrep' not found</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>values_all <span class="ot">&lt;-</span> h[[<span class="st">"plot_env"</span>]][[<span class="st">"T_yrep"</span>]]</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: object 'h' not found</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>prob_to_find <span class="ot">&lt;-</span> h[[<span class="st">"plot_env"</span>]][[<span class="st">"T_y"</span>]]</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: object 'h' not found</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>quantInv <span class="ot">&lt;-</span> <span class="cf">function</span>(distr, value) <span class="fu">ecdf</span>(distr)(value)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>posterior_p_value <span class="ot">&lt;-</span> <span class="fu">quantInv</span>(values_all, prob_to_find)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: object 'values_all' not found</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">ppc_stat_2d</span>(Y, yrep) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Posterior Test Statistic"</span>)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: object 'yrep' not found</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h)</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'h' not found</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(l)</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'l' not found</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prob_to_find)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'print': object 'prob_to_find' not found</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<p>The above is the posterior predictive test statistic for one model, along with it’s distribution. Now let’s iterate this process, convert them into posterior predictive <span class="math inline">\(P\)</span>-values, and generate their distribution.</p>
<hr>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> <span class="dv">4</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>set.seed <span class="ot">&lt;-</span> <span class="dv">1031</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>ppp <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n.sim)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>n.samp <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>quantInv <span class="ot">&lt;-</span> <span class="cf">function</span>(distr, value) <span class="fu">ecdf</span>(distr)(value)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ppp)) {</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X, Y)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    mod1 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> df, <span class="at">chains =</span> <span class="dv">1</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">iter =</span> <span class="dv">1000</span>, <span class="at">refresh =</span> <span class="dv">0</span>, <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    yrep <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(mod1)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    h <span class="ot">&lt;-</span> <span class="fu">ppc_stat</span>(Y, yrep, <span class="at">stat =</span> <span class="st">"median"</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    values_all <span class="ot">&lt;-</span> h[[<span class="st">"plot_env"</span>]][[<span class="st">"T_yrep"</span>]]</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    prob_to_find <span class="ot">&lt;-</span> h[[<span class="st">"plot_env"</span>]][[<span class="st">"T_y"</span>]]</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    posterior_p_value <span class="ot">&lt;-</span> <span class="fu">quantInv</span>(values_all, prob_to_find)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    ppp[i] <span class="ot">&lt;-</span> posterior_p_value</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in if (!prior_dist_name %in% unlist(ok_dists)) {: argument is of length zero</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> ppp)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"#99c7c7"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Posterior Predictive P-values"</span>,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"From Simulation of 1000 Simple Linear Regressions"</span>,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Posterior Predictive P-value"</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-8-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>We can also show this in <code>Stata 16.1</code>, using their new <code>bayesstats ppvalues</code> command which generates posterior predictive <span class="math inline">\(P\)</span>-values.</p>
<hr>
<div class="sourceCode" id="cb9"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span> 16.1</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="kw">obs</span> 100</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">Generate variables from a normal distribution like before</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">generate</span> x = rnormal(0, 1)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">generate</span> <span class="fu">y</span> = rnormal(0, 1)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">We set up our model here </span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>parallel initialize 8, f</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>bayesmh <span class="fu">y</span> x, likelihood(<span class="fu">normal</span>({<span class="kw">var</span>})) prior({<span class="kw">var</span>}, <span class="fu">normal</span>(0, 10)) <span class="co">///</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>prior({<span class="fu">y</span>:}, <span class="fu">normal</span>(0, 10)) rseed(1031) <span class="kw">saving</span>(coutput_pred, <span class="kw">replace</span>) mcmcsize(1000)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">We use the bayespredict command to make predictions from the model</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>bayespredict (<span class="kw">mean</span>:@mean({_resid})) (<span class="kw">var</span>:@variance({_resid})), <span class="co">///</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>rseed(1031) <span class="kw">saving</span>(coutput_pred, <span class="kw">replace</span>) </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">Then we calculate the posterior predictive P-values</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>bayesstats ppvalues {<span class="kw">mean</span>} <span class="kw">using</span> coutput_pred</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>#&gt; . <span class="kw">version</span> 16.1</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>#&gt; . <span class="kw">set</span> <span class="kw">obs</span> 100</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>#&gt; Number <span class="kw">of</span> observations (_N) was 0, now 100.</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>#&gt; . <span class="co">/**</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &gt; Generate variables from a normal distribution like before</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &gt; */</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>#&gt; . <span class="kw">generate</span> x = rnormal(0, 1)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>#&gt; . <span class="kw">generate</span> <span class="fu">y</span> = rnormal(0, 1)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>#&gt; . <span class="co">/**</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &gt; We set up our model here </span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &gt; </span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &gt; */</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>#&gt; . parallel initialize 8, f</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>#&gt; <span class="kw">N</span> Child processes: 8</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>#&gt; Stata <span class="ot">dir</span>:  /Applications/Stata/StataBE.app/Contents/MacOS/stata-<span class="kw">be</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>#&gt; . bayesmh <span class="fu">y</span> x, likelihood(<span class="fu">normal</span>({<span class="kw">var</span>})) prior({<span class="kw">var</span>}, <span class="fu">normal</span>(0, 10)) <span class="co">///</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>#&gt; &gt; prior({<span class="fu">y</span>:}, <span class="fu">normal</span>(0, 10)) rseed(1031) <span class="kw">saving</span>(coutput_pred, <span class="kw">replace</span>) mcmcsize(1000)</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>#&gt;   </span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>#&gt; Burn-<span class="kw">in</span> ...</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>#&gt; Simulation ...</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>#&gt; Model summary</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>#&gt; ------------------------------------------------------------------------------</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>#&gt; Likelihood: </span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>#&gt;   <span class="fu">y</span> ~ <span class="fu">normal</span>(xb_y,{<span class="kw">var</span>})</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>#&gt; Priors: </span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>#&gt;   {<span class="fu">y</span>:x <span class="dt">_cons</span>} ~ <span class="fu">normal</span>(0,10)                                               (1)</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>#&gt;         {<span class="kw">var</span>} ~ <span class="fu">normal</span>(0,10)</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>#&gt; ------------------------------------------------------------------------------</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>#&gt; (1) Parameters are elements <span class="kw">of</span> the linear form xb_y.</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>#&gt; Bayesian <span class="fu">normal</span> regression                       MCMC iterations  =      3,500</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>#&gt; Random-walk Metropolis–Hastings sampling         Burn-<span class="kw">in</span>          =      2,500</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>#&gt;                                                  MCMC <span class="kw">sample</span> <span class="kw">size</span> =      1,000</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>#&gt;                                                  Number <span class="kw">of</span> <span class="kw">obs</span>    =        100</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>#&gt;                                                  Acceptance rate  =      .2068</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>#&gt;                                                  Efficiency:  <span class="fu">min</span> =     .03878</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>#&gt;                                                               avg =     .07757</span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>#&gt; Log marginal-likelihood = -149.68351                          <span class="fu">max</span> =      .1317</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>#&gt;  </span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>#&gt; ------------------------------------------------------------------------------</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>#&gt;              |                                                Equal-tailed</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>#&gt;              |      Mean   Std. <span class="kw">dev</span>.     MCSE     Median  [95% cred. interval]</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>#&gt; -------------+----------------------------------------------------------------</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>#&gt; <span class="fu">y</span>            |</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>#&gt;            x | -.0758396    .097915   .008532  -.0704775  -.2600037   .1054718</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>#&gt;        <span class="dt">_cons</span> |  .0238076   .1107038   .014035   .0326669  -.1793756   .2293247</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>#&gt; -------------+----------------------------------------------------------------</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>#&gt;          <span class="kw">var</span> |  .9773565   .1313659   .021096   .9384637   .7882847   1.323255</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>#&gt; ------------------------------------------------------------------------------</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>#&gt; file coutput_pred.dta saved.</span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>#&gt; . <span class="co">/**</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &gt; We use the bayespredict command to make predictions from the model</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &gt; */</span></span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>#&gt; . bayespredict (<span class="kw">mean</span>:@mean({_resid})) (<span class="kw">var</span>:@variance({_resid})), <span class="co">///</span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>#&gt; &gt; rseed(1031) <span class="kw">saving</span>(coutput_pred, <span class="kw">replace</span>) </span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>#&gt; Computing predictions ...</span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>#&gt; file coutput_pred.dta saved.</span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>#&gt; file coutput_pred.ster saved.</span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>#&gt; . <span class="co">/**</span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &gt; Then we calculate the posterior predictive P-values</span></span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &gt; */</span></span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>#&gt; . bayesstats ppvalues {<span class="kw">mean</span>} <span class="kw">using</span> coutput_pred</span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>#&gt; Posterior predictive summary   MCMC <span class="kw">sample</span> <span class="kw">size</span> =     1,000</span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>#&gt; -----------------------------------------------------------</span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>#&gt;            T |      Mean   Std. <span class="kw">dev</span>.  E(T_obs)  P(T&gt;=T_obs)</span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>#&gt; -------------+---------------------------------------------</span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>#&gt;         <span class="kw">mean</span> |  .0004223   .0957513    .008651         .495</span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>#&gt; -----------------------------------------------------------</span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>#&gt; Note: P(T&gt;=T_obs) <span class="kw">close</span> to 0 <span class="kw">or</span> 1 indicates lack <span class="kw">of</span> <span class="kw">fit</span>.</span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>#&gt; .</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<p>As we can see from the <code>R</code> plot above, the test statistics are are generally concentrated around <code>0.5</code> and the distribution (as shown above via the <code>R</code> code) hardly resembles the uniform distribution of <span class="math inline">\(P\)</span>-value under the null model. Further, the base-2 log transformation of posterior predictive <span class="math inline">\(P\)</span>-values is not exponentially distributed, making them invalid <span class="math inline">\(S\)</span>-values in our terms.</p>
<hr>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> (<span class="sc">-</span><span class="fu">log2</span>(ppp)))) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"#d46c5b"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of -log2(Posterior Predictive P-values)"</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"S-values Produced From Posterior Predictive P-values"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"-log2(Posterior Predictive P-value)"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 100 rows containing non-finite outside the scale range (`stat_bin()`).</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in max(f): no non-missing arguments to max; returning -Inf</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in `geom_histogram()`:</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ! Problem while computing stat.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Error occurred in the 1st layer.</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Caused by error in `seq_len()`:</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ! argument must be coercible to non-negative integer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="table-1-some-p-values-s-values-maximum-likelihood-ratios-and-likelihood-ratio-statistics" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="table-1-some-p-values-s-values-maximum-likelihood-ratios-and-likelihood-ratio-statistics"><span class="header-section-number">0.3</span> Table 1: Some <span class="math inline">\(P\)</span>-values, <span class="math inline">\(S\)</span>-values, Maximum Likelihood Ratios, and Likelihood Ratio Statistics</h2>
<hr>
<p>Here, we look at some common <span class="math inline">\(P\)</span>-values, and how they correspond to other information statistics and likelihood measures.</p>
<hr>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.99</span>, <span class="fl">0.9</span>, <span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.025</span>, <span class="fl">0.01</span>, <span class="fl">0.005</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1e-04</span>, <span class="fu">paste</span>(<span class="st">"5 sigma (~ 2.9 in 10 million)"</span>), <span class="fu">paste</span>(<span class="st">"1 in 100 million (GWAS)"</span>),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">"6 sigma (~ 1 in a billion)"</span>))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>svalue <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fu">log2</span>(<span class="fu">c</span>(<span class="fl">0.99</span>, <span class="fl">0.9</span>, <span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.025</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.01</span>, <span class="fl">0.005</span>, <span class="fl">1e-04</span>)), <span class="fl">21.7</span>, <span class="fl">26.6</span>, <span class="fl">29.9</span>), <span class="dv">2</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>pvalue[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="fu">formatC</span>(pvalue[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">format =</span> <span class="st">"e"</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>mlr <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.01</span>, <span class="fl">1.26</span>, <span class="fl">1.94</span>, <span class="fl">3.87</span>, <span class="fl">6.83</span>, <span class="fl">12.3</span>, <span class="fl">27.6</span>, <span class="fl">51.4</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1935</span>, (<span class="fl">5.2</span> <span class="sc">*</span> (<span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)), (<span class="fl">1.4</span> <span class="sc">*</span> (<span class="dv">10</span><span class="sc">^</span><span class="dv">7</span>)), (<span class="fl">1.3</span> <span class="sc">*</span> (<span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>))), <span class="dv">2</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio statistic</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>lr <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fl">0.00016</span>, <span class="fl">0.016</span>, <span class="fl">0.45</span>, <span class="fl">1.32</span>, <span class="fl">2.71</span>, <span class="fl">3.84</span>, <span class="fl">5.02</span>, <span class="fl">6.63</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="fl">7.88</span>, <span class="fl">15.1</span>, <span class="fl">26.3</span>, <span class="fl">32.8</span>, <span class="fl">37.4</span>), <span class="dv">2</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pvalue, svalue, mlr, lr)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"P-value (compatibility)"</span>, <span class="st">"S-value (bits)"</span>,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Maximum Likelihood Ratio"</span>, <span class="st">"Deviance Statistic 2ln(MLR)"</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(table1, <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">padding =</span> <span class="dv">45</span>, <span class="at">longtable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#777"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="at">row =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#777"</span>, <span class="at">bold =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="at">column =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">color =</span> <span class="st">"#777"</span>, <span class="at">bold =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>, <span class="at">lightable_options =</span> <span class="st">"basic"</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">font_size =</span> <span class="dv">17</span>, <span class="at">fixed_thead =</span> <span class="fu">list</span>(<span class="at">enabled =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">footnote</span>(<span class="at">general_title =</span> <span class="st">"Abbreviations: "</span>, <span class="at">title_format =</span> <span class="st">"underline"</span>,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">general =</span> <span class="fu">c</span>(<span class="st">"Table 1 $P$-values                  and binary $S$-values, with corresponding maximum-likelihood ratios (MLR) and deviance (likelihood-ratio) statistics for a simple test hypothesis H under background assumptions A"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">P-value (compatibility)</th>
<th style="text-align: right;">S-value (bits)</th>
<th style="text-align: right;">Maximum Likelihood Ratio</th>
<th style="text-align: right;">Deviance Statistic 2ln(MLR)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.99</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1.00e+00</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.9</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">1.01e+00</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.5</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.26e+00</td>
<td style="text-align: right;">0.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.25</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">1.94e+00</td>
<td style="text-align: right;">1.32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.1</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">3.87e+00</td>
<td style="text-align: right;">2.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.05</td>
<td style="text-align: right;">4.32</td>
<td style="text-align: right;">6.83e+00</td>
<td style="text-align: right;">3.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.025</td>
<td style="text-align: right;">5.32</td>
<td style="text-align: right;">1.23e+01</td>
<td style="text-align: right;">5.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.01</td>
<td style="text-align: right;">6.64</td>
<td style="text-align: right;">2.76e+01</td>
<td style="text-align: right;">6.63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.005</td>
<td style="text-align: right;">7.64</td>
<td style="text-align: right;">5.14e+01</td>
<td style="text-align: right;">7.88</td>
</tr>
<tr class="even">
<td style="text-align: left;">1e-04</td>
<td style="text-align: right;">13.29</td>
<td style="text-align: right;">1.94e+03</td>
<td style="text-align: right;">15.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5 sigma (~ 2.9 in 10 million)</td>
<td style="text-align: right;">21.70</td>
<td style="text-align: right;">5.20e+05</td>
<td style="text-align: right;">26.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">1 in 100 million (GWAS)</td>
<td style="text-align: right;">26.60</td>
<td style="text-align: right;">1.40e+07</td>
<td style="text-align: right;">32.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6 sigma (~ 1 in a billion)</td>
<td style="text-align: right;">29.90</td>
<td style="text-align: right;">1.30e+08</td>
<td style="text-align: right;">37.40</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style="text-decoration: underline;">Abbreviations: </span></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Table 1 $P$-values and binary $S$-values, with corresponding maximum-likelihood ratios (MLR) and deviance (likelihood-ratio) statistics for a simple test hypothesis H under background assumptions A</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<hr>
<p>For further discussion of 5 and 6 sigma cutoffs, see<span class="citation" data-cites="cousinsJeffreysLindleyParadox2017"><sup><a href="#ref-cousinsJeffreysLindleyParadox2017" role="doc-biblioref">7</a></sup></span>.</p>
<hr>
</section>
<section id="frequentist-interval-estimate-percentiles" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="frequentist-interval-estimate-percentiles"><span class="header-section-number">0.4</span> Frequentist Interval Estimate Percentiles</h2>
</section>
<section id="refer-to-long-run-coverage" class="level2" data-number="0.5">
<h2 data-number="0.5" class="anchored" data-anchor-id="refer-to-long-run-coverage"><span class="header-section-number">0.5</span> Refer to Long-Run Coverage</h2>
<hr>
<p>Here we simulate a study where one group with 100 participants has an <span class="math inline">\(\mu\)</span> of <code>100</code> with a <span class="math inline">\(\sigma\)</span> of <code>20</code> and the second group has the same number of participants but an average of <code>80</code> and a standard deviation of <code>20.</code> We compare them using a Welch’s <span class="math inline">\(t\)</span>-test and generate 95% compatibility intervals several times, specifically <code>100</code> times, and then plot them. Since we know the mean difference is <code>20</code>, we wish to see how often the interval estimates cover this true parameter value.</p>
<hr>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-12-1.svg" data-fig-align="center" width="1056"></p>
<hr>
<p>This shows that the intervals tend to vary simply as a result of randomness, and that the proper interpretation of the attached percentile is about long run coverage of the true parameter. However, this does not preclude interpretation of a single interval estimate from a study.[<span class="citation" data-cites="coxChapterIntervalEstimation1974"><sup><a href="#ref-coxChapterIntervalEstimation1974" role="doc-biblioref">8</a></sup></span>] As we write in the <em>Replace unrealistic “confidence” claims with compatibility measures</em> section of our paper.[<span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup><a href="#ref-rafiSemanticCognitiveTools2020" role="doc-biblioref">1</a></sup></span>]</p>
<hr>
<blockquote class="blockquote">
<p>The fact that “confidence” refers to the procedure behavior, not the reported interval, seems to be lost on most researchers. Remarking on this subtlety, when Jerzy Neyman discussed his confidence concept in 1934 at a meeting of the Royal Statistical Society, Arthur Bowley replied, “I am not at all sure that the ‘confidence’ is not a confidence trick.”<span class="citation" data-cites="bowleyDiscussionDrNeyman1934"><sup><a href="#ref-bowleyDiscussionDrNeyman1934" role="doc-biblioref">9</a></sup></span>. And indeed, 40 years later, Cox and Hinkley warned, “interval estimates cannot be taken as probability statements about parameters, and foremost is the interpretation ‘such and such parameter values are consistent with the data.’”<span class="citation" data-cites="coxChapterIntervalEstimation1974"><sup><a href="#ref-coxChapterIntervalEstimation1974" role="doc-biblioref">8</a></sup></span>. Unfortunately, the word “consistency” is used for several other concepts in statistics, while in logic it refers to an absolute condition (of noncontradiction); thus, its use in place of “confidence” would risk further confusion.</p>
<p>To address the problems above, we exploit the fact that a 95% CI summarizes the results of varying the test hypothesis H over a range of parameter values, displaying all values for which <span class="math inline">\(p\)</span> &gt; 0.05<span class="citation" data-cites="coxPrinciplesStatisticalInference2006"><sup><a href="#ref-coxPrinciplesStatisticalInference2006" role="doc-biblioref">10</a></sup></span> and hence <span class="math inline">\(s\)</span> &lt; 4.32 bits<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup><a href="#ref-greenlandValidPvaluesBehave2019" role="doc-biblioref">3</a></sup></span>;<span class="citation" data-cites="amrheinInferentialStatisticsDescriptive2019"><sup><a href="#ref-amrheinInferentialStatisticsDescriptive2019" role="doc-biblioref">11</a></sup></span>. Thus the CI contains a range of parameter values that are more compatible with the data than are values outside the interval, under the background assumptions<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup><a href="#ref-greenlandValidPvaluesBehave2019" role="doc-biblioref">3</a></sup></span>;<span class="citation" data-cites="greenlandStatisticalTestsValues2016"><sup><a href="#ref-greenlandStatisticalTestsValues2016" role="doc-biblioref">12</a></sup></span>. Unconditionally (and thus even if the background assumptions are uncertain), the interval shows the values of the parameter which, when combined with the background assumptions, produce a test model that is “highly compatible” with the data in the sense of having less than 4.32 bits of information against it. We thus refer to CI as compatibility intervals rather than confidence intervals<span class="citation" data-cites="greenlandAreConfidenceIntervals2019"><sup><a href="#ref-greenlandAreConfidenceIntervals2019" role="doc-biblioref">13</a></sup></span>;<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup><a href="#ref-greenlandValidPvaluesBehave2019" role="doc-biblioref">3</a></sup></span>;<span class="citation" data-cites="amrheinInferentialStatisticsDescriptive2019"><sup><a href="#ref-amrheinInferentialStatisticsDescriptive2019" role="doc-biblioref">11</a></sup></span>; their abbreviation remains “CI.” We reject calling these intervals “uncertainty intervals,” because they do not capture uncertainty about background assumptions<span class="citation" data-cites="greenlandAreConfidenceIntervals2019"><sup><a href="#ref-greenlandAreConfidenceIntervals2019" role="doc-biblioref">13</a></sup></span>.</p>
</blockquote>
<hr>
<p>Indeed, this also has to do with our paper on deemphasizing the model assumptions that are often behind common statistical outputs, and why it is necessary to treat them as uncertain, rather than given.[<span class="citation" data-cites="greenlandAidScientificInference2020"><sup><a href="#ref-greenlandAidScientificInference2020" role="doc-biblioref">14</a></sup></span>] For example, a 95% interval estimate is assumed to be free of bias in its construction, however, it’s coverage claims are no longer so, once there are systematic errors in play. Many of these common, classical statistical procedures are designed to deal with random variation, and less so with bias (a relatively new field, with shiny new methods).</p>
<hr>
</section>
<section id="brown-et-al.-2017-reanalysis" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Brown et al.&nbsp;(2017) Reanalysis</h1>
<hr>
<p>Taken from the <a href="https://doi.org/10.1001/jama.2017.3415">Brown et al. data.</a>[<span class="citation" data-cites="brownAssociationSerotonergicAntidepressant2017"><sup><a href="#ref-brownAssociationSerotonergicAntidepressant2017" role="doc-biblioref">15</a></sup></span>;<span class="citation" data-cites="brownAssociationAntenatalExposure2017"><sup><a href="#ref-brownAssociationAntenatalExposure2017" role="doc-biblioref">16</a></sup></span>]</p>
<p>Here we take the reported statistics from the Brown et al.&nbsp;studies in order to run statistical tests of different alternative test hypotheses and use those results to construct various functions.</p>
<p>We calculate the standard errors from the point estimate and the confidence (compatibility) limits.</p>
<hr>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fl">2.59</span><span class="sc">/</span><span class="fl">0.997</span>)<span class="sc">/</span><span class="fl">3.92</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>logUL <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fl">2.59</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>logLL <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fl">0.997</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>logpoint <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fl">1.61</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>logpoint <span class="sc">+</span> (<span class="fl">1.96</span> <span class="sc">*</span> se)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.954</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>logpoint <span class="sc">-</span> (<span class="fl">1.96</span> <span class="sc">*</span> se)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.0011</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<section id="table-2-p-values-s-values-and-likelihoods-for-targeted-hypotheses-about-hazard-ratios-for-brown-et-al." class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="table-2-p-values-s-values-and-likelihoods-for-targeted-hypotheses-about-hazard-ratios-for-brown-et-al."><span class="header-section-number">1.1</span> Table 2: <span class="math inline">\(P\)</span>-values, <span class="math inline">\(S\)</span>-values, and Likelihoods for Targeted Hypotheses About Hazard Ratios for <a href="https://doi.org/10.1001/jama.2017.3415">Brown et al.</a></h2>
<hr>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>testhypothesis <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Halving of hazard"</span>, <span class="st">"No effect (null)"</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Point estimate"</span>, <span class="st">"Doubling of hazard"</span>, <span class="st">"Tripling of hazard"</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Quintupling of hazard"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>hazardratios <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">1.61</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.6e-06</span>, <span class="fl">0.05</span>, <span class="dv">1</span>, <span class="fl">0.37</span>, <span class="fl">0.01</span>, <span class="fl">3.2e-06</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>svals <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="sc">-</span><span class="fu">log2</span>(pvals), <span class="dv">2</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>mlr2 <span class="ot">&lt;-</span> <span class="fu">c</span>((<span class="dv">1</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>), <span class="fl">6.77</span>, <span class="dv">1</span>, <span class="fl">1.49</span>, <span class="fl">26.2</span>, (<span class="dv">5</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>lr <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">exp</span>((((<span class="fu">log</span>(<span class="fl">0.5</span><span class="sc">/</span><span class="fl">1.61</span>))<span class="sc">/</span>se)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span>)), <span class="fu">exp</span>((((<span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">1.61</span>))<span class="sc">/</span>se)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span>)),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>((((<span class="fu">log</span>(<span class="fl">1.61</span><span class="sc">/</span><span class="fl">1.61</span>))<span class="sc">/</span>se)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span>)), <span class="fu">exp</span>((((<span class="fu">log</span>(<span class="dv">2</span><span class="sc">/</span><span class="fl">1.61</span>))<span class="sc">/</span>se)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span>)),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>((((<span class="fu">log</span>(<span class="dv">3</span><span class="sc">/</span><span class="fl">1.61</span>))<span class="sc">/</span>se)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span>)), <span class="fu">exp</span>((((<span class="fu">log</span>(<span class="dv">5</span><span class="sc">/</span><span class="fl">1.61</span>))<span class="sc">/</span>se)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span>))),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>LR <span class="ot">&lt;-</span> <span class="fu">formatC</span>(lr, <span class="at">format =</span> <span class="st">"e"</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(testhypothesis, hazardratios, pvals, svals,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    mlr2, LR)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Test Hypothesis"</span>, <span class="st">"HR"</span>, <span class="st">"P-values"</span>, <span class="st">"S-values"</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MLR"</span>, <span class="st">"LR"</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(table2, <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">padding =</span> <span class="dv">45</span>, <span class="at">longtable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#777"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="at">row =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#777"</span>, <span class="at">bold =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="at">column =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">color =</span> <span class="st">"#777"</span>, <span class="at">bold =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>, <span class="at">lightable_options =</span> <span class="st">"basic"</span>,</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">font_size =</span> <span class="dv">15</span>, <span class="at">fixed_thead =</span> <span class="fu">list</span>(<span class="at">enabled =</span> F))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Test Hypothesis</th>
<th style="text-align: right;">HR</th>
<th style="text-align: right;">P-values</th>
<th style="text-align: right;">S-values</th>
<th style="text-align: right;">MLR</th>
<th style="text-align: left;">LR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Halving of hazard</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">19.25</td>
<td style="text-align: right;">1.00e+05</td>
<td style="text-align: left;">1.02e+05</td>
</tr>
<tr class="even">
<td style="text-align: left;">No effect (null)</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">4.32</td>
<td style="text-align: right;">6.77e+00</td>
<td style="text-align: left;">6.77e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Point estimate</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00e+00</td>
<td style="text-align: left;">1.00e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Doubling of hazard</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">1.43</td>
<td style="text-align: right;">1.49e+00</td>
<td style="text-align: left;">1.49e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tripling of hazard</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">6.64</td>
<td style="text-align: right;">2.62e+01</td>
<td style="text-align: left;">2.62e+01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Quintupling of hazard</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">18.25</td>
<td style="text-align: right;">5.00e+04</td>
<td style="text-align: left;">5.03e+04</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="plot-the-point-estimate-and-95-compatibility-interval" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="plot-the-point-estimate-and-95-compatibility-interval"><span class="header-section-number">1.2</span> Plot the point estimate and 95% compatibility interval</h2>
<hr>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>label <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Brown et al. (2017)</span><span class="sc">\n</span><span class="st"> JAMA"</span>, <span class="st">"Brown et al. (2017)</span><span class="sc">\n</span><span class="st"> J Clin Psychiatry"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>point <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.61</span>, <span class="fl">1.7</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.997</span>, <span class="fl">1.1</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.59</span>, <span class="fl">2.6</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(label, point, lower, upper)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<p>Here we plot the 95% compatibility interval estimate reported from the high-dimensional propensity score analysis.</p>
<hr>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> label, <span class="at">y =</span> point, <span class="at">ymin =</span> lower,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> upper, <span class="at">group =</span> label)) <span class="sc">+</span> <span class="fu">geom_pointrange</span>(<span class="at">color =</span> <span class="st">"#007C7C"</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#d46c5b"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">10</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Association Between Serotonergic Antidepressant Exposure </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="st">               </span><span class="sc">\n</span><span class="st">During Pregnancy and Child Autism Spectrum Disorder"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Reported 95% Compatibility Intervals From Primary Results"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Study"</span>, <span class="at">y =</span> <span class="st">"Hazard Ratio (JAMA) + </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="st">            Adjusted Pooled Odds Ratio (J Clin Psychiatry)"</span>) <span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">label =</span> <span class="st">"Null parameter value of 1"</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"#d46c5b"</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">2.2</span>, <span class="at">y =</span> <span class="fl">1.8</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">label =</span> <span class="st">"Point Estimate = 1.61, </span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="st">           Lower Limit = 0.997, Upper Limit = 2.59"</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#000000"</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> <span class="fl">1.8</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">label =</span> <span class="st">"Point Estimate = 1.7, </span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="st">           Lower Limit = 1.1, Upper Limit = 2.6"</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#000000"</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">13</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>)) <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-16-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>Once again, the authors reported that[<span class="citation" data-cites="brownAssociationSerotonergicAntidepressant2017"><sup><a href="#ref-brownAssociationSerotonergicAntidepressant2017" role="doc-biblioref">15</a></sup></span>]</p>
<blockquote class="blockquote">
<p>In the 2837 pregnancies (7.9%) exposed to antidepressants, 2.0% (95% CI, 1.6%-2.6%) of children were diagnosed with autism spectrum disorder. Risk of autism spectrum disorder was significantly higher with serotonergic antidepressant exposure (4.51 exposed vs 2.03 unexposed per 1000 person-years; between-group difference, 2.48 95% CI, 2.33-2.62 per 1000 person-years) in crude (HR, 2.16 95% CI, 1.64-2.86) and multivariable-adjusted analyses (HR, 1.59 95% CI, 1.17-2.17) (Table 2). After inverse probability of treatment weighting based on the HDPS, the association was not significant (HR, 1.61 95% CI, 0.997-2.59) (Table 2).</p>
</blockquote>
<p>and concluded with</p>
<blockquote class="blockquote">
<p>In children born to mothers receiving public drug coverage in Ontario, Canada, in utero serotonergic antidepressant exposure compared with no exposure was not associated with autism spectrum disorder in the child. Although a causal relationship cannot be ruled out, the previously observed association may be explained by other factors.</p>
</blockquote>
<p>We will show using the graphical and tabular summaries below, why a more nuanced summary such as,</p>
<blockquote class="blockquote">
<p>“After HDPS adjustment for confounding, a 61% hazard elevation remained; however, under the same model, every hypothesis from no elevation up to a 160% hazard increase had <span class="math inline">\(p\)</span> &gt; 0.05; Thus, while quite imprecise, these results are consistent with previous observations of a positive association between serotonergic antidepressant prescriptions and subsequent ASD. Because the association may be partially or wholly due to uncontrolled biases, further evidence will be needed for evaluating what, if any, proportion of it can be attributed to causal effects of prenatal serotonergic antidepressant use on ASD incidence.”</p>
</blockquote>
<p>would have been far more appropriate, as we discuss in our paper.[<span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup><a href="#ref-rafiSemanticCognitiveTools2020" role="doc-biblioref">1</a></sup></span>]</p>
<hr>
</section>
<section id="p-value-and-s-value-functions" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="p-value-and-s-value-functions"><span class="header-section-number">1.3</span> <span class="math inline">\(P\)</span>-value and <span class="math inline">\(S\)</span>-value Functions</h2>
<hr>
<p>In order to use this information to construct a <span class="math inline">\(P\)</span>-value function, we can use the <a href="https://data.lesslikely.com/concurve/"><code>concurve</code></a> functions.</p>
<hr>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"concurve"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<p>We enter the reported point estimates and compatibility limits and produce all possible intervals + <span class="math inline">\(P\)</span>-values + <span class="math inline">\(S\)</span>-values. This is calculated assuming normal approximations with the <a href="https://data.lesslikely.com/concurve/reference/curve_rev.html"><code>curve_rev()</code></a> function.</p>
<hr>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>curve1 <span class="ot">&lt;-</span> <span class="fu">curve_rev</span>(<span class="at">point =</span> <span class="fl">1.61</span>, <span class="at">LL =</span> <span class="fl">0.997</span>, <span class="at">UL =</span> <span class="fl">2.59</span>, <span class="at">measure =</span> <span class="st">"ratio"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<p>It is stored in the object <code>curve1</code>.</p>
<p>We can generate a table of the relevant statistics from this reanalysis, similar to the table from above, but this time using the <a href="https://data.lesslikely.com/concurve/index.html"><code>concurve</code></a> function, <a href="https://data.lesslikely.com/concurve/reference/curve_table.html"><code>curve_table()</code></a>, but this time it will give us interval estimates of various percentiles (<span class="math inline">\(25\)</span>%, <span class="math inline">\(50\)</span>%, <span class="math inline">\(75\)</span>%, <span class="math inline">\(95\)</span>%, etc.). These are in turn used to construct the entire confidence (compatibility) distribution or <span class="math inline">\(P\)</span>-value function.</p>
<hr>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(<span class="fu">curve_table</span>(curve1[[<span class="dv">1</span>]]), <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">padding =</span> <span class="dv">45</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">longtable =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#777"</span>, <span class="at">row.names =</span> F, <span class="at">col.names =</span> <span class="fu">colnames</span>(<span class="fu">curve_table</span>(curve1[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="at">row =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#777"</span>, <span class="at">bold =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="at">column =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">color =</span> <span class="st">"#777"</span>, <span class="at">bold =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>, <span class="at">lightable_options =</span> <span class="st">"basic"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">font_size =</span> <span class="dv">17</span>, <span class="at">fixed_thead =</span> <span class="fu">list</span>(<span class="at">enabled =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">footnote</span>(<span class="at">general_title =</span> <span class="fu">c</span>(<span class="st">"Table of Statistics for Various Interval Estimate Percentiles"</span>),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">general =</span> <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Lower Limit</th>
<th style="text-align: right;">Upper Limit</th>
<th style="text-align: right;">Interval Width</th>
<th style="text-align: right;">Interval Level (%)</th>
<th style="text-align: right;">CDF</th>
<th style="text-align: right;">P-value</th>
<th style="text-align: right;">S-value (bits)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.490</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">25.0</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">0.750</td>
<td style="text-align: right;">0.415</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.366</td>
<td style="text-align: right;">1.90</td>
<td style="text-align: right;">0.531</td>
<td style="text-align: right;">50.0</td>
<td style="text-align: right;">0.750</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.217</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">0.914</td>
<td style="text-align: right;">75.0</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">2.000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.178</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">1.021</td>
<td style="text-align: right;">80.0</td>
<td style="text-align: right;">0.900</td>
<td style="text-align: right;">0.200</td>
<td style="text-align: right;">2.322</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.134</td>
<td style="text-align: right;">2.29</td>
<td style="text-align: right;">1.152</td>
<td style="text-align: right;">85.0</td>
<td style="text-align: right;">0.925</td>
<td style="text-align: right;">0.150</td>
<td style="text-align: right;">2.737</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.079</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">1.325</td>
<td style="text-align: right;">90.0</td>
<td style="text-align: right;">0.950</td>
<td style="text-align: right;">0.100</td>
<td style="text-align: right;">3.322</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.999</td>
<td style="text-align: right;">2.60</td>
<td style="text-align: right;">1.596</td>
<td style="text-align: right;">95.0</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">4.322</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.933</td>
<td style="text-align: right;">2.78</td>
<td style="text-align: right;">1.846</td>
<td style="text-align: right;">97.5</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">5.322</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.860</td>
<td style="text-align: right;">3.02</td>
<td style="text-align: right;">2.155</td>
<td style="text-align: right;">99.0</td>
<td style="text-align: right;">0.995</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">6.644</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span style="font-style: italic;">Table of Statistics for Various Interval Estimate Percentiles</span></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="figure-3-p-value-compatibility-function" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="figure-3-p-value-compatibility-function"><span class="header-section-number">1.4</span> Figure 3: <span class="math inline">\(P\)</span>-value (Compatibility) Function</h2>
<hr>
<p>Plot the <span class="math inline">\(P\)</span>-value (Compatibility) function of the <a href="https://doi.org/10.1001/jama.2017.3415">Brown et al.</a> data</p>
<p>Now we plot the <span class="math inline">\(P\)</span>-value function from the data stored in <code>curve1</code> using the <a href="https://data.lesslikely.com/concurve/reference/ggcurve.html"><code>ggcurve()</code></a> function from <a href="https://data.lesslikely.com/concurve/"><code>concurve</code></a>.</p>
<hr>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcurve</span>(curve1[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">"c"</span>, <span class="at">measure =</span> <span class="st">"ratio"</span>, <span class="at">nullvalue =</span> <span class="fu">c</span>(<span class="dv">1</span>),</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(P),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"-value (Compatibility) Function"</span>)), <span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(P),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"-values for a range of hazard ratios (HR)"</span>)), <span class="at">x =</span> <span class="st">"Hazard Ratio (HR)"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(P), <span class="st">"-value"</span>))) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">1.61</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">2.59</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-20-1.svg" data-fig-align="center" width="672"></p>
<hr>
<p>It is practically the same as the published version from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland, 2020</a><span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup><a href="#ref-rafiSemanticCognitiveTools2020" role="doc-biblioref">1</a></sup></span>.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1602038429/Site/confidencecurve.svg" width="750"></p>
<hr>
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>curve1 <span class="ot">&lt;-</span> <span class="fu">curve_rev</span>(<span class="at">point =</span> <span class="fl">1.61</span>, <span class="at">LL =</span> <span class="fl">0.997</span>, <span class="at">UL =</span> <span class="fl">2.59</span>, <span class="at">measure =</span> <span class="st">"ratio"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>curve2 <span class="ot">&lt;-</span> <span class="fu">curve_rev</span>(<span class="at">point =</span> <span class="fl">1.7</span>, <span class="at">LL =</span> <span class="fl">1.1</span>, <span class="at">UL =</span> <span class="fl">2.6</span>, <span class="at">measure =</span> <span class="st">"ratio"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="cumulative-confidence-compatibility-distribution" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="cumulative-confidence-compatibility-distribution"><span class="header-section-number">1.5</span> Cumulative Confidence (Compatibility Distribution)</h2>
<hr>
<p>Although we do not cover this figure in our paper, it is easy to construct using <a href="https://data.lesslikely.com/concurve/index.html"><code>concurve's</code></a> <a href="https://data.lesslikely.com/concurve/reference/ggcurve.html"><code>ggcurve()</code></a> function by specifying <code>type</code> as “<code>cdf</code>” to see the median estimate within the confidence distribution. The horizontal line that meets at the curve, is approximately the same as the maximum at the <span class="math inline">\(P\)</span>-value function/confidence (compatibility) curve.</p>
<hr>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcurve</span>(curve1[[<span class="dv">2</span>]], <span class="at">type =</span> <span class="st">"cdf"</span>, <span class="at">measure =</span> <span class="st">"ratio"</span>, <span class="at">nullvalue =</span> <span class="fu">c</span>(<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"P-values for a range of hazard ratios (HR)"</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"Association Between Serotonergic Antidepressant Exposure </span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="st">       </span><span class="sc">\n</span><span class="st">During Pregnancy and Child Autism Spectrum Disorder"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Hazard Ratio (HR)"</span>, <span class="at">y =</span> <span class="st">"Cumulative Compatibility"</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-22-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>We will also calculate the likelihoods so that we can generate the corresponding likelihood functions.</p>
<hr>
<div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>lik2 <span class="ot">&lt;-</span> <span class="fu">curve_rev</span>(<span class="at">point =</span> <span class="fl">1.7</span>, <span class="at">LL =</span> <span class="fl">1.1</span>, <span class="at">UL =</span> <span class="fl">2.6</span>, <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">measure =</span> <span class="st">"ratio"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>lik1 <span class="ot">&lt;-</span> <span class="fu">curve_rev</span>(<span class="at">point =</span> <span class="fl">1.61</span>, <span class="at">LL =</span> <span class="fl">0.997</span>, <span class="at">UL =</span> <span class="fl">2.59</span>, <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">measure =</span> <span class="st">"ratio"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<p>We can also see how consistent these results are with previous studies conducted by the same research group, given the overlap of the functions, which can be compared using the <a href="https://data.lesslikely.com/concurve/reference/plot_compare.html"><code>plot_compare()</code></a> function. Let’s compare the relative likelihood functions from both studies from this research group to see how consistent the results are.</p>
<hr>
<div class="sourceCode" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_compare</span>(<span class="at">data1 =</span> lik1[[<span class="dv">1</span>]], <span class="at">data2 =</span> lik2[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">"l1"</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">measure =</span> <span class="st">"ratio"</span>, <span class="at">nullvalue =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Brown et al. 2017. J Clin Psychiatry. vs. </span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="st">              </span><span class="sc">\n</span><span class="st">Brown et al. 2017. JAMA."</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"J Clin Psychiatry: OR = 1.7, 1/6.83 LI: LL = 1.1, UL = 2.6 </span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="st">                         </span><span class="sc">\n</span><span class="st">JAMA: HR = 1.61, 1/6.83 LI: LL = 0.997, UL = 2.59"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="st">"Hazard Ratio / Odds Ratio"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-24-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>and the <span class="math inline">\(P\)</span>-value functions.</p>
<hr>
<div class="sourceCode" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_compare</span>(<span class="at">data1 =</span> curve1[[<span class="dv">1</span>]], <span class="at">data2 =</span> curve2[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">"c"</span>,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">measure =</span> <span class="st">"ratio"</span>, <span class="at">nullvalue =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Brown et al. 2017. J Clin Psychiatry. vs. </span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="st">              </span><span class="sc">\n</span><span class="st">Brown et al. 2017. JAMA."</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"J Clin Psychiatry: OR = 1.7, 1/6.83 LI: LL = 1.1, UL = 2.6 </span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="st">              </span><span class="sc">\n</span><span class="st">JAMA: HR = 1.61, 1/6.83 LI: LL = 0.997, UL = 2.59"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="st">"Hazard Ratio / Odds Ratio"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-25-1.svg" data-fig-align="center" width="768"></p>
<hr>
</section>
<section id="figure-4-s-value-suprisal-function" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="figure-4-s-value-suprisal-function"><span class="header-section-number">1.6</span> Figure 4: <span class="math inline">\(S\)</span>-value (Suprisal) Function</h2>
<hr>
<p>Plot the <span class="math inline">\(S\)</span>-value (Surprisal) function of the <a href="https://doi.org/10.1001/jama.2017.3415">Brown et al.</a> data with <a href="https://data.lesslikely.com/concurve/reference/ggcurve.html"><code>ggcurve()</code></a></p>
<hr>
<div class="sourceCode" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcurve</span>(<span class="at">data =</span> curve1[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">"s"</span>, <span class="at">measure =</span> <span class="st">"ratio"</span>, <span class="at">nullvalue =</span> <span class="fu">c</span>(<span class="dv">1</span>),</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"S-value (Surprisal) Function"</span>, <span class="at">subtitle =</span> <span class="st">"S-Values (surprisals) for a range of hazard ratios (HR)"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="st">"Hazard Ratio"</span>, <span class="at">yaxis1 =</span> <span class="st">"S-value (bits of information)"</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-26-1.svg" data-fig-align="center" width="576"></p>
<hr>
<p>which is quite close to the figure from our paper.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1602200052/Site/surprisalcurve.png" width="750"></p>
<hr>
</section>
<section id="likelihood-support-functions" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="likelihood-support-functions"><span class="header-section-number">1.7</span> Likelihood (Support) Functions</h2>
<hr>
<p>Here we provide the code to show how we constructed the likelihood functions from our paper, which are the supplementary figures found <a href="https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM3_ESM.pdf">here (S1)</a> and <a href="https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM4_ESM.pdf">here (S2)</a>.</p>
<hr>
<p>Calculate and Plot Likelihood (Support) Intervals.</p>
<p>Here we use the reported estimates to construct the <span class="math inline">\(Z\)</span>-scores and standard errors, which are in turn used to compute the likelihoods.</p>
<hr>
<div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>hrvalues <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.65</span>, <span class="at">to =</span> <span class="fl">3.98</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fl">2.59</span><span class="sc">/</span><span class="fl">0.997</span>)<span class="sc">/</span><span class="fl">3.92</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>zscore <span class="ot">&lt;-</span> <span class="fu">sapply</span>(hrvalues, <span class="cf">function</span>(i) (<span class="fu">log</span>(i<span class="sc">/</span><span class="fl">1.61</span>)<span class="sc">/</span>se))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="figure-s1-relative-likelihood-function" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="figure-s1-relative-likelihood-function"><span class="header-section-number">1.8</span> Figure S1: Relative Likelihood Function</h2>
<hr>
<p>We then standardize all the likelihoods by their maximum at the likelihood function,<span class="citation" data-cites="jewellStatisticsEpidemiology2003"><sup><a href="#ref-jewellStatisticsEpidemiology2003" role="doc-biblioref">17</a></sup></span> to produce relative likelihoods, likelihood intervals, and their corresponding relative likelihood function.[<span class="citation" data-cites="royallStatisticalEvidenceLikelihood1997"><sup><a href="#ref-royallStatisticalEvidenceLikelihood1997" role="doc-biblioref">18</a></sup></span>]</p>
<hr>
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>support <span class="ot">&lt;-</span> <span class="fu">exp</span>((<span class="sc">-</span>zscore<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>likfunction <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(hrvalues, zscore, support)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> likfunction, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hrvalues, <span class="at">y =</span> support)) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#d46c5b"</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> (<span class="dv">1</span><span class="sc">/</span><span class="fl">6.83</span>), <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#333333"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> hrvalues,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="fu">min</span>(support), <span class="at">ymax =</span> support), <span class="at">fill =</span> <span class="st">"#d46c5b"</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relative Likelihood Function"</span>, <span class="at">subtitle =</span> <span class="st">"Relative likelihoods for a range of hazard ratios"</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Hazard Ratio (HR)"</span>, <span class="at">y =</span> <span class="st">"Relative Likelihood </span><span class="sc">\n</span><span class="st">1/MLR"</span>) <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.65</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="st">"1/6.83 LI = 0.997, 2.59"</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"#000000"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">10</span>)) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0125</span>)), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-28-1.svg" data-fig-align="center" width="672"></p>
<hr>
<p>The <span class="math inline">\(\frac{1}{6.83}\)</span> likelihood interval corresponds to the 95% compatibility interval, as shown by the figure from our paper.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1602200052/Site/relativelikelihood.png" width="750"></p>
<hr>
<p>Below we use the calculated <span class="math inline">\(Z\)</span>-scores to construct the log-likelihood function which is the upward-concave parabola <span class="math inline">\(\frac{Z^{2}}{2}\)</span> = <span class="math inline">\(-ln(MLR)\)</span></p>
<hr>
<div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>support <span class="ot">&lt;-</span> (zscore<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>likfunction <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(hrvalues, zscore, support)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> likfunction, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hrvalues, <span class="at">y =</span> support)) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#d46c5b"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> hrvalues, <span class="at">ymin =</span> support,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="fu">max</span>(support)), <span class="at">fill =</span> <span class="st">"#d46c5b"</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-Likelihood Function"</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Log-likelihoods for a range of hazard ratios"</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hazard Ratio (HR)"</span>, <span class="at">y =</span> <span class="st">"ln(MLR)"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>)) <span class="sc">+</span> <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.0125</span>)),</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">7</span>, <span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-29-1.svg" data-fig-align="center" width="672"></p>
<hr>
</section>
<section id="figure-s2-deviance-function-2lnmlr" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="figure-s2-deviance-function-2lnmlr"><span class="header-section-number">1.9</span> Figure S2: Deviance Function <span class="math inline">\(2ln(MLR)\)</span></h2>
<hr>
<p>Known as the deviance function, it is twice the log-likelihood, which maps to the <span class="math inline">\(S\)</span>-value function.</p>
<hr>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>support <span class="ot">&lt;-</span> (zscore<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>likfunction <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(hrvalues, zscore, support)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> likfunction, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hrvalues, <span class="at">y =</span> support)) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#d46c5b"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">3.84</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"#333333"</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> hrvalues, <span class="at">ymin =</span> support,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="fu">max</span>(support)), <span class="at">fill =</span> <span class="st">"#d46c5b"</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">1.65</span>, <span class="at">y =</span> <span class="fl">4.4</span>, <span class="at">label =</span> <span class="st">"1/6.83 LI = 0.997, 2.59"</span>, <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#000000"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">10</span>)) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0125</span>)), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">14</span>, <span class="dv">2</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Deviance Function"</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Deviance statistics for a range of hazard ratios"</span>,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hazard Ratio (HR)"</span>, <span class="at">y =</span> <span class="st">" Deviance Statistic </span><span class="sc">\n</span><span class="st">2ln(MLR)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-30-1.svg" data-fig-align="center" width="672"></p>
<hr>
<p>And the version from our paper can be found <a href="https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM4_ESM.pdf">here</a>.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1602200052/Site/deviancefunction.png" width="750"></p>
<hr>
<p>It is important to note that although we have calculated these likelihood functions manually here, they can also be generated easily using the <a href="https://data.lesslikely.com/concurve/reference/curve_lik.html"><code>curve_lik()</code></a> function which takes inputs from the <a href="https://cran.r-project.org/package=ProfileLikelihood"><code>ProfileLikelihood</code></a> <code>R</code> package. To see a further discussion, please see the <a href="https://data.lesslikely.com/concurve/articles/likelihood.html">following article</a>, which gives several examples for a wide variety of models.</p>
<p>Further, we urge some caution. Although we endorse the construction and presentation of likelihood functions along with <span class="math inline">\(P\)</span>-value and <span class="math inline">\(S\)</span>-value functions, along with the tabulations, the use of pure likelihood methods has been highly controversial among some statisticians, with some going as far as to say that <em>likelihood is blind</em> although not all statisticians believe this, and have responded to such criticisms in kind, see discussants.<span class="citation" data-cites="daviesApproximatingDataDiscussion2008"><sup><a href="#ref-daviesApproximatingDataDiscussion2008" role="doc-biblioref">19</a></sup></span> Thus, we support providing both <span class="math inline">\(P\)</span>-value/<span class="math inline">\(S\)</span>-value and likelihood-based functions for a complete picture.</p>
<p>Indeed, we can see how they all easily map to one another when plotted side by side, with the following script.</p>
<hr>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"cowplot"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(confcurve, surprisalcurve, relsupportfunction, deviancefunction,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<p>A clearer plot comparing the four functions is seen below (click on the image to view in full).</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1581988661/Site/Comparisons.png" width="1000" style="cursor: zoom-in"></p>
<hr>
<p>Additional adjustments that were made to the figures from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland, 2020</a><span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup><a href="#ref-rafiSemanticCognitiveTools2020" role="doc-biblioref">1</a></sup></span> were done using Adobe Illustrator and Photoshop.</p>
<p>All errors are ours, and we welcome critical feedback and reporting of errors. To report possible errors in our analyses, please post it as a comment below or as a bug <a href="https://github.com/zadrafi/concurve/issues">here</a>. We will compile them onto a public errata, if any errors or flaws are reported to us.</p>
<hr>
</section>
</section>
<section id="statistical-package-citations" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Statistical Package Citations</h1>
<hr>
<p>Please remember to cite the <code>R</code> packages if you use any of the <code>R</code> scripts from above. The citation for our [<span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup><a href="#ref-rafiSemanticCognitiveTools2020" role="doc-biblioref">1</a></sup></span>] can be found below in the <a href="#references">References</a> section or it can be <a href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/s12874-020-01105-9.ris">downloaded here</a> for a reference manager.</p>
<hr>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"concurve"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"TeachingDemos"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"ProfileLikelihood"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"rstan"</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"rstanarm"</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"bayesplot"</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"knitr"</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"kableExtra"</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"cowplot"</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"Statamarkdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="environment" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Environment</h1>
<hr>
<p>The analyses were run on:</p>
<hr>
<div class="sourceCode" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>si <span class="ot">&lt;-</span> <span class="fu">sessionInfo</span>()</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(si, <span class="at">RNG =</span> <span class="cn">TRUE</span>, <span class="at">locale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R version 4.5.0 (2025-04-11)</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Matrix products: default</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random number generation:</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  RNG:     L'Ecuyer-CMRG </span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Normal:  Inversion </span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Sample:  Rejection </span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; locale:</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time zone: America/New_York</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tzcode source: internal</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attached base packages:</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] splines   grid      stats4    parallel  stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; other attached packages:</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [1] TeachingDemos_2.13    plotly_4.10.4         TSstudio_0.1.7        tfautograph_0.3.2     tfdatasets_2.17.0    </span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [6] keras_2.15.0          tensorflow_2.16.0     timetk_2.9.0          modeltime_1.3.1       workflowsets_1.1.1   </span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [11] workflows_1.2.0       tune_1.3.0            rsample_1.3.0         recipes_1.3.1         parsnip_1.3.2        </span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [16] modeldata_1.4.0       infer_1.0.8           dials_1.4.0           scales_1.4.0          tidymodels_1.3.0     </span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [21] xgboost_1.7.11.1      prophet_1.0           rlang_1.1.6           astsa_2.2             bayesforecast_1.0.5  </span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [26] smooth_4.2.0          greybox_2.0.4         glmnet_4.1-9          forecast_8.24.0       fable_0.4.1          </span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [31] fabletools_0.5.0      tsibbledata_0.4.1     tsibble_1.1.6         rstanarm_2.32.1       texPreview_2.1.0     </span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [36] tinytex_0.57          rmarkdown_2.29        brms_2.22.0           bootImpute_1.2.2      knitr_1.50           </span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [41] boot_1.3-31           JuliaCall_0.17.6      reshape2_1.4.4        ProfileLikelihood_1.3 ImputeRobust_1.3-1   </span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [46] gamlss_5.4-22         gamlss.dist_6.1-1     gamlss.data_6.0-6     mvtnorm_1.3-3         performance_0.14.0   </span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [51] summarytools_1.1.4    tidybayes_3.0.7       htmltools_0.5.8.1     Statamarkdown_0.9.2   car_3.1-3            </span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [56] carData_3.0-5         qqplotr_0.0.6         ggcorrplot_0.1.4.1    mitml_0.4-5           pbmcapply_1.5.1      </span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [61] Amelia_1.8.3          Rcpp_1.0.14           blogdown_1.21         doParallel_1.0.17     iterators_1.0.14     </span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [66] foreach_1.5.2         lattice_0.22-7        bayesplot_1.12.0      wesanderson_0.3.7     VIM_6.2.2            </span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [71] colorspace_2.1-1      here_1.0.1            progress_1.2.3        loo_2.8.0             mi_1.1               </span></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [76] Matrix_1.7-3          broom_1.0.8           yardstick_1.3.2       svglite_2.2.1         Cairo_1.6-2          </span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [81] cowplot_1.1.3         mgcv_1.9-3            nlme_3.1-168          xfun_0.52             broom.mixed_0.2.9.6  </span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [86] reticulate_1.42.0     kableExtra_1.4.0      posterior_1.6.1       checkmate_2.3.2       parallelly_1.45.0    </span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [91] miceFast_0.8.5        randomForest_4.7-1.2  missForest_1.5        miceadds_3.17-44      quantreg_6.1         </span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [96] SparseM_1.84-2        MCMCpack_1.7-1        MASS_7.3-65           coda_0.19-4.1         latex2exp_0.9.6      </span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 23 entries ]</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [1] igraph_2.1.4         Formula_1.2-5        rematch2_2.1.2       GPfit_1.0-9          tidyselect_1.2.1    </span></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [6] bridgesampling_1.1-2 rngtools_1.5.2       dichromat_2.0-0.1    png_0.1-8            cli_3.6.5           </span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [11] arrayhelpers_1.1-0   askpass_1.2.1        openssl_2.3.3        textshaping_1.0.1    officer_0.6.10      </span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [16] lhs_1.2.0            curl_6.2.3           mime_0.13            evaluate_1.0.3       V8_6.0.4            </span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [21] stringi_1.8.7        backports_1.5.0      desc_1.4.3           qqconf_1.3.2         httpuv_1.6.16       </span></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [26] rappdirs_0.3.3       details_0.4.0        prodlim_2025.04.28   KMsurv_0.1-6         doRNG_1.8.6.2       </span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [31] survminer_0.5.0      DT_0.33              DBI_1.2.3            withr_3.0.2          tfruns_1.5.3        </span></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [36] reformulas_0.4.1     tseries_0.10-58      class_7.3-23         systemfonts_1.2.3    rprojroot_2.0.4     </span></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [41] lmtest_0.9-40        formatR_1.14         colourpicker_1.3.0   htmlwidgets_1.6.4    fs_1.6.6            </span></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [46] labeling_0.4.3       ranger_0.17.0        DEoptimR_1.1-3-1     zoo_1.8-14           itertools_0.1-3     </span></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [51] svUnit_1.0.6         timechange_0.3.0     caTools_1.18.3       extremevalues_2.4.1  data.table_1.17.4   </span></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [56] timeDate_4041.110    pan_1.9              clipr_0.8.0          ellipsis_0.3.2       lazyeval_0.2.2      </span></span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [61] yaml_2.3.10          survival_3.8-3       crayon_1.5.3         tensorA_0.36.2.1     RColorBrewer_1.1-3  </span></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [66] later_1.4.2          codetools_0.2-20     base64enc_0.1-3      shape_1.4.6.1        estimability_1.5.1  </span></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [71] gdtools_0.4.2        DiceDesign_1.10      foreign_0.8-90       pkgconfig_2.0.3      xml2_1.3.8          </span></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [76] mathjaxr_1.8-0       ggpubr_0.6.0         viridisLite_0.4.2    xtable_1.8-4         plyr_1.8.9          </span></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [81] httr_1.4.7           rbibutils_2.3        tools_4.5.0          globals_0.18.0       hardhat_1.4.1       </span></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [86] pkgbuild_1.4.8       htmlTable_2.4.3      survMisc_0.5.6       shinyjs_2.1.0        crosstalk_1.2.1     </span></span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [91] twosamples_2.0.1     MatrixModels_0.5-4   lme4_1.1-37          digest_0.6.37        numDeriv_2016.8-1.1 </span></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [96] furrr_0.3.1          farver_2.1.2         tzdb_0.5.0           rapportools_1.2      rpart_4.1.24        </span></span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 90 entries ]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="stata" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Stata</h1>
<hr>
<div class="sourceCode" id="cb33"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>about</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="kw">version</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>#&gt; Stata/BE 17.0 <span class="kw">for</span> Mac (Apple Silicon)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>#&gt; Revision 21 May 2024</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>#&gt; Copyright 1985-2021 StataCorp LLC</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>#&gt; Total physical <span class="dv">memory</span>: 24.00 GB</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>#&gt; Stata license: Single-user  perpetual</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>#&gt; Serial number: 301706317553</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>#&gt;   Licensed to: Zad Rafi</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>#&gt;                AMG</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>#&gt; </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>#&gt; <span class="kw">version</span> 17.0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="section" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="section"><span class="header-section-number">4.1</span> ————————————————————————</h2>
</section>
</section>
<section id="references" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> References</h1>
<hr>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="2" data-line-spacing="2" role="list">
<div id="ref-rafiSemanticCognitiveTools2020" class="csl-entry" role="listitem">
1. Rafi Z, Greenland S. (2020). <span>“Semantic and cognitive tools to aid statistical science: Replace confidence and significance by compatibility and surprise.”</span> <em>BMC Medical Research Methodology</em>. <strong>20</strong>:244. doi: <a href="https://doi.org/10.1186/s12874-020-01105-9">10.1186/s12874-020-01105-9</a>.
</div>
<div id="ref-greenlandTechnicalIssuesInterpretation2020" class="csl-entry" role="listitem">
2. Greenland S, Rafi Z. (2020). <span>“Technical <span>Issues</span> in the <span>Interpretation</span> of <span>S</span>-values and <span>Their Relation</span> to <span>Other Information Measures</span>.”</span> <em>arXiv:200812991 [statME]</em>. <a href="https://arxiv.org/abs/2008.12991">https://arxiv.org/abs/2008.12991</a>.
</div>
<div id="ref-greenlandValidPvaluesBehave2019" class="csl-entry" role="listitem">
3. Greenland S. (2019). <span>“Valid <span>P</span>-values behave exactly as they should: <span>Some</span> misleading criticisms of <span>P</span>-values and their resolution with <span>S</span>-values.”</span> <em>The American Statistician</em>. <strong>73</strong>:106–114. doi: <a href="https://doi.org/10.1080/00031305.2018.1529625">10.1080/00031305.2018.1529625</a>.
</div>
<div id="ref-bayarriValuesCompositeNull2000" class="csl-entry" role="listitem">
4. Bayarri MJ, Berger JO. (2000). <span>“P <span>Values</span> for <span>Composite Null Models</span>.”</span> <em>Journal of the American Statistical Association</em>. <strong>95</strong>:1127–1142. doi: <a href="https://doi.org/10/dpvq8c">10/dpvq8c</a>.
</div>
<div id="ref-robinsAsymptoticDistributionValues2000" class="csl-entry" role="listitem">
5. Robins JM, van der Vaart A, Ventura V. (2000). <span>“Asymptotic <span>Distribution</span> of <span>P Values</span> in <span>Composite Null Models</span>.”</span> <em>Journal of the American Statistical Association</em>. <strong>95</strong>:1143–1156. doi: <a href="https://doi.org/10/gg7krv">10/gg7krv</a>.
</div>
<div id="ref-kuffnerWhyArePvalues2019" class="csl-entry" role="listitem">
6. Kuffner TA, Walker SG. (2019). <span>“Why are <span>P</span>-values controversial?”</span> <em>The American Statistician</em>. <strong>73</strong>:1–3. doi: <a href="https://doi.org/10.1080/00031305.2016.1277161">10.1080/00031305.2016.1277161</a>.
</div>
<div id="ref-cousinsJeffreysLindleyParadox2017" class="csl-entry" role="listitem">
7. Cousins RD. (2017). <span>“The <span>Jeffreys</span> paradox and discovery criteria in high energy physics.”</span> <em>Synthese</em>. <strong>194</strong>:395–432. doi: <a href="https://doi.org/10.1007/s11229-014-0525-z">10.1007/s11229-014-0525-z</a>.
</div>
<div id="ref-coxChapterIntervalEstimation1974" class="csl-entry" role="listitem">
8. Cox DR, Hinkley DV. (1974). <span>“Chapter 7, <span>Interval</span> estimation.”</span> In: Theoretical <span>Statistics</span>. <span>Chapman and Hall/CRC</span>. p. 207–249. doi: <a href="https://doi.org/10.1201/b14832">10.1201/b14832</a>.
</div>
<div id="ref-bowleyDiscussionDrNeyman1934" class="csl-entry" role="listitem">
9. Bowley AL. (1934). <span>“Discussion on <span>Dr</span>. <span>Neyman</span>’s <span>Paper</span>. <span>P</span>. 607 in: <span>Neyman J</span>. <span>On</span> the two different aspects of the representative method: <span>The</span> method of stratified sampling and the method of purposive selection (with discussion).”</span> <em>Journal of the Royal Statistical Society</em>. <strong>4</strong>:558–625. doi: <a href="https://doi.org/10.2307/2342192">10.2307/2342192</a>.
</div>
<div id="ref-coxPrinciplesStatisticalInference2006" class="csl-entry" role="listitem">
10. Cox DR. (2006). <span>“Principles of <span>Statistical Inference</span>.”</span> <span>Cambridge University Press</span>.
</div>
<div id="ref-amrheinInferentialStatisticsDescriptive2019" class="csl-entry" role="listitem">
11. Amrhein V, Trafimow D, Greenland S. (2019). <span>“Inferential statistics as descriptive statistics: <span>There</span> is no replication crisis if we don’t expect replication.”</span> <em>The American Statistician</em>. <strong>73</strong>:262–270. doi: <a href="https://doi.org/10.1080/00031305.2018.1543137">10.1080/00031305.2018.1543137</a>.
</div>
<div id="ref-greenlandStatisticalTestsValues2016" class="csl-entry" role="listitem">
12. Greenland S, Senn SJ, Rothman KJ, Carlin JB, Poole C, Goodman SN, et al. (2016). <span>“Statistical tests, <span>P</span> values, confidence intervals, and power: <span>A</span> guide to misinterpretations.”</span> <em>European Journal of Epidemiology</em>. <strong>31</strong>:337–350. doi: <a href="https://doi.org/10.1007/s10654-016-0149-3">10.1007/s10654-016-0149-3</a>.
</div>
<div id="ref-greenlandAreConfidenceIntervals2019" class="csl-entry" role="listitem">
13. Greenland S. (2019). <span>“Are confidence intervals better termed <span>‘uncertainty intervals’</span>? <span>No</span>: <span>Call</span> them compatibility intervals.”</span> <em>BMJ</em>. <strong>366</strong>. doi: <a href="https://doi.org/10.1136/bmj.l5381">10.1136/bmj.l5381</a>.
</div>
<div id="ref-greenlandAidScientificInference2020" class="csl-entry" role="listitem">
14. Greenland S, Rafi Z. (2020). <span>“To <span>Aid Scientific Inference</span>, <span>Emphasize Unconditional Descriptions</span> of <span>Statistics</span>.”</span> <em>arXiv:190908583 [statME]</em>. <a href="https://arxiv.org/abs/1909.08583">https://arxiv.org/abs/1909.08583</a>.
</div>
<div id="ref-brownAssociationSerotonergicAntidepressant2017" class="csl-entry" role="listitem">
15. Brown HK, Ray JG, Wilton AS, Lunsky Y, Gomes T, Vigod SN. (2017). <span>“Association between serotonergic antidepressant use during pregnancy and autism spectrum disorder in children.”</span> <em>Journal of the American Medical Association</em>. <strong>317</strong>:1544–1552. doi: <a href="https://doi.org/10.1001/jama.2017.3415">10.1001/jama.2017.3415</a>.
</div>
<div id="ref-brownAssociationAntenatalExposure2017" class="csl-entry" role="listitem">
16. Brown HK, Hussain-Shamsy N, Lunsky Y, Dennis C-LE, Vigod SN. (2017). <span>“The association between antenatal exposure to selective serotonin reuptake inhibitors and autism: <span>A</span> systematic review and meta-analysis.”</span> <em>The Journal of Clinical Psychiatry</em>. <strong>78</strong>:e48–e58. doi: <a href="https://doi.org/10.4088/JCP.15r10194">10.4088/JCP.15r10194</a>.
</div>
<div id="ref-jewellStatisticsEpidemiology2003" class="csl-entry" role="listitem">
17. Jewell NP. (2003). <span>“Statistics for <span>Epidemiology</span>.”</span> <span>CRC Press</span>.
</div>
<div id="ref-royallStatisticalEvidenceLikelihood1997" class="csl-entry" role="listitem">
18. Royall R. (1997). <span>“Statistical <span>Evidence</span>: <span>A Likelihood Paradigm</span>.”</span> <span>CRC Press</span>.
</div>
<div id="ref-daviesApproximatingDataDiscussion2008" class="csl-entry" role="listitem">
19. Davies PL. (2008). <span>“Approximating data [with discussion and a rejoinder].”</span> <em>Journal of the Korean Statistical Society</em>. <strong>37</strong>:191–211. doi: <a href="https://doi.org/10/bn8cgk">10/bn8cgk</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/lesslikely\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb34" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Tables, Graphs, and Computations from Rafi &amp; Greenland (2020)</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Zad Rafi</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2020-12-12T00:00:00.000Z</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="an">lastmod:</span><span class="co"> '`r Sys.Date()`'</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="an">url:</span><span class="co"> statistics/RG2020BMC</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> &gt;-</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">  https://res.cloudinary.com/less-likely/image/upload/v1602038429/Site/confidencecurve.svg</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="an">og_image:</span><span class="co"> &gt;-</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">  https://res.cloudinary.com/less-likely/image/upload/v1602038429/Site/confidencecurve.svg</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> &gt;-</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co">  This post goes through the R code and logic that was used to construct the</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">  figures and concepts in Rafi &amp; Greenland (2020) BMC MRM.</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="an">layout:</span><span class="co"> post</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="an">archives:</span><span class="co"> statistics</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co"> </span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="an">slug:</span><span class="co"> RG2020BMC</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="an">tags:</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="co">  - accuracy</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="co">  - statistics</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co">  - statistical reporting</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="an">keywords:</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="co">  - p-value</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="co">  - p-value function</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="co">  - confidence curve</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="co">  - confidence distribution</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="co">  blogdown::html_page:</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="co">    df_print: kable</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: false</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC_files/libs/kePrint-0.0.1/kePrint.js"</span><span class="dt">&gt;&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">link</span><span class="ot"> href</span><span class="op">=</span><span class="st">"RG2020BMC_files/libs/lightable-0.0.1/lightable.css"</span><span class="ot"> rel</span><span class="op">=</span><span class="st">"stylesheet"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">center</span><span class="dt">&gt;</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"https://res.cloudinary.com/less-likely/image/upload/v1602038429/Site/confidencecurve.svg"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"100"</span><span class="ot"> style</span><span class="op">=</span><span class="st">"cursor: zoom-in"</span><span class="ot"> align</span><span class="op">=</span><span class="st">"right"</span><span class="dt">/&gt;</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">center</span><span class="dt">&gt;</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>The following post provides *some* of the code that was used to</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>construct the figures and tables from [Rafi &amp; Greenland,</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>2020](https://doi.org/10.1186/s12874-020-01105-9)</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>@rafiSemanticCognitiveTools2020. An enhanced PDF version of the paper</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>can be <span class="co">[</span><span class="ot">found here</span><span class="co">](https://rdcu.be/b789P)</span>. For further discussion of</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>the computations, see the appendix of the [main</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>paper](https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM1_ESM.pdf),</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>along with our [technical</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>supplement](https://arxiv.org/pdf/2008.12991.pdf).</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>@greenlandTechnicalIssuesInterpretation2020</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **Disclaimer:** I am responsible for all the code and mistakes below,</span></span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; and none of them can be attributed to my coauthors or my fellow</span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; package developers.</span></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>In order to recreate the functions, I would recommend installing the</span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a>latest version of <span class="co">[</span><span class="ot">`concurve`</span><span class="co">](https://data.lesslikely.com/concurve/)</span></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>from <span class="co">[</span><span class="ot">CRAN</span><span class="co">](https://cran.r-project.org/package=concurve)</span>, as it has</span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a>patched some issues with graphing when the outcome is binary. Use the</span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a>script below to get the latest version and load the <span class="in">`R`</span> package. A</span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>number of other <span class="in">`R`</span> packages are also used in this post, which are</span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">listed below.</span><span class="co">](#statistical-package-citations)</span></span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"concurve"</span>)</span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"concurve"</span>)</span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a><span class="fu">## Valid $P$-values Are Uniform Under the Null Model</span></span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-83"><a href="#cb34-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-84"><a href="#cb34-84" aria-hidden="true" tabindex="-1"></a>Here we show that valid $P$-values have specific properties, when the</span>
<span id="cb34-85"><a href="#cb34-85" aria-hidden="true" tabindex="-1"></a>null model is true. We first generate two variables ($Y$, $X$) that come</span>
<span id="cb34-86"><a href="#cb34-86" aria-hidden="true" tabindex="-1"></a>from the same normal distribution with a $\mu$ of 0 and $\sigma$ of 1,</span>
<span id="cb34-87"><a href="#cb34-87" aria-hidden="true" tabindex="-1"></a>each with a total of <span class="in">`1000`</span> observations. We assume that there is no</span>
<span id="cb34-88"><a href="#cb34-88" aria-hidden="true" tabindex="-1"></a>relationship between these two variables. We run a simple t-test between</span>
<span id="cb34-89"><a href="#cb34-89" aria-hidden="true" tabindex="-1"></a>$Y$ and $X$ and iterate this <span class="in">`100000`</span> times and compute <span class="in">`100000`</span></span>
<span id="cb34-90"><a href="#cb34-90" aria-hidden="true" tabindex="-1"></a>$P$-values to see the overall distribution of the $P$-values, which we</span>
<span id="cb34-91"><a href="#cb34-91" aria-hidden="true" tabindex="-1"></a>then plot using a histogram./</span>
<span id="cb34-92"><a href="#cb34-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-93"><a href="#cb34-93" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-94"><a href="#cb34-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-95"><a href="#cb34-95" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-96"><a href="#cb34-96" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb34-97"><a href="#cb34-97" aria-hidden="true" tabindex="-1"></a>set.seed <span class="ot">&lt;-</span> <span class="dv">1031</span></span>
<span id="cb34-98"><a href="#cb34-98" aria-hidden="true" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb34-99"><a href="#cb34-99" aria-hidden="true" tabindex="-1"></a>t.sim <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n.sim)</span>
<span id="cb34-100"><a href="#cb34-100" aria-hidden="true" tabindex="-1"></a>n.samp <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb34-101"><a href="#cb34-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-102"><a href="#cb34-102" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb34-103"><a href="#cb34-103" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb34-104"><a href="#cb34-104" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb34-105"><a href="#cb34-105" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X, Y)</span>
<span id="cb34-106"><a href="#cb34-106" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(X, Y, <span class="at">data =</span> df)</span>
<span id="cb34-107"><a href="#cb34-107" aria-hidden="true" tabindex="-1"></a>    t.sim[i] <span class="ot">&lt;-</span> t[[<span class="dv">3</span>]]</span>
<span id="cb34-108"><a href="#cb34-108" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-109"><a href="#cb34-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-110"><a href="#cb34-110" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> t.sim)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb34-111"><a href="#cb34-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"#99c7c7"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of P-values Under the Null"</span>,</span>
<span id="cb34-112"><a href="#cb34-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"P-value"</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb34-113"><a href="#cb34-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb34-114"><a href="#cb34-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-115"><a href="#cb34-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-116"><a href="#cb34-116" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-4-1.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"768"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-117"><a href="#cb34-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-118"><a href="#cb34-118" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-119"><a href="#cb34-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-120"><a href="#cb34-120" aria-hidden="true" tabindex="-1"></a>This can also be shown using the</span>
<span id="cb34-121"><a href="#cb34-121" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`TeachingDemos`</span><span class="co">](https://cran.r-project.org/package=TeachingDemos)</span> <span class="in">`R`</span></span>
<span id="cb34-122"><a href="#cb34-122" aria-hidden="true" tabindex="-1"></a>package, which has a function dedicated to showing this phenomenon.</span>
<span id="cb34-123"><a href="#cb34-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-124"><a href="#cb34-124" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-125"><a href="#cb34-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-126"><a href="#cb34-126" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-127"><a href="#cb34-127" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"TeachingDemos"</span>)</span>
<span id="cb34-128"><a href="#cb34-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-129"><a href="#cb34-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: 'TeachingDemos'</span></span>
<span id="cb34-130"><a href="#cb34-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from 'package:plotly':</span></span>
<span id="cb34-131"><a href="#cb34-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-132"><a href="#cb34-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     subplot</span></span>
<span id="cb34-133"><a href="#cb34-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from 'package:Hmisc':</span></span>
<span id="cb34-134"><a href="#cb34-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-135"><a href="#cb34-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     cnvrt.coords, subplot</span></span>
<span id="cb34-136"><a href="#cb34-136" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb34-137"><a href="#cb34-137" aria-hidden="true" tabindex="-1"></a>set.seed <span class="ot">&lt;-</span> <span class="dv">1031</span></span>
<span id="cb34-138"><a href="#cb34-138" aria-hidden="true" tabindex="-1"></a>obs_p <span class="ot">&lt;-</span> <span class="fu">Pvalue.norm.sim</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">mu0 =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>,</span>
<span id="cb34-139"><a href="#cb34-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma0 =</span> <span class="dv">1</span>, <span class="at">test =</span> <span class="st">"t"</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb34-140"><a href="#cb34-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">B =</span> <span class="fl">1e+05</span>)</span>
<span id="cb34-141"><a href="#cb34-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-142"><a href="#cb34-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-143"><a href="#cb34-143" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-5-1.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"768"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-144"><a href="#cb34-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-145"><a href="#cb34-145" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-146"><a href="#cb34-146" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> obs_p)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb34-147"><a href="#cb34-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"#99c7c7"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of P-values Under the Null"</span>,</span>
<span id="cb34-148"><a href="#cb34-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"P-value"</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb34-149"><a href="#cb34-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb34-150"><a href="#cb34-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-151"><a href="#cb34-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-152"><a href="#cb34-152" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-5-2.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"768"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-153"><a href="#cb34-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-154"><a href="#cb34-154" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-155"><a href="#cb34-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-156"><a href="#cb34-156" aria-hidden="true" tabindex="-1"></a>As you can see, when the null model is true, the distribution of</span>
<span id="cb34-157"><a href="#cb34-157" aria-hidden="true" tabindex="-1"></a>$P$-values is uniform. Valid $P$-values are uniform under the null</span>
<span id="cb34-158"><a href="#cb34-158" aria-hidden="true" tabindex="-1"></a>hypothesis and their corresponding $S$-values are exponentially</span>
<span id="cb34-159"><a href="#cb34-159" aria-hidden="true" tabindex="-1"></a>distributed. We run the same simulation as before, but then convert the</span>
<span id="cb34-160"><a href="#cb34-160" aria-hidden="true" tabindex="-1"></a>obtained $P$-values into $S$-values, to see how they are distributed.</span>
<span id="cb34-161"><a href="#cb34-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-162"><a href="#cb34-162" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-163"><a href="#cb34-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-164"><a href="#cb34-164" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-165"><a href="#cb34-165" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb34-166"><a href="#cb34-166" aria-hidden="true" tabindex="-1"></a>set.seed <span class="ot">&lt;-</span> <span class="dv">1031</span></span>
<span id="cb34-167"><a href="#cb34-167" aria-hidden="true" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb34-168"><a href="#cb34-168" aria-hidden="true" tabindex="-1"></a>t.sim <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n.sim)</span>
<span id="cb34-169"><a href="#cb34-169" aria-hidden="true" tabindex="-1"></a>n.samp <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb34-170"><a href="#cb34-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-171"><a href="#cb34-171" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb34-172"><a href="#cb34-172" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb34-173"><a href="#cb34-173" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb34-174"><a href="#cb34-174" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X, Y)</span>
<span id="cb34-175"><a href="#cb34-175" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(X, Y, <span class="at">data =</span> df)</span>
<span id="cb34-176"><a href="#cb34-176" aria-hidden="true" tabindex="-1"></a>    t.sim[i] <span class="ot">&lt;-</span> t[[<span class="dv">3</span>]]</span>
<span id="cb34-177"><a href="#cb34-177" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-178"><a href="#cb34-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-179"><a href="#cb34-179" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fu">log2</span>(t.sim))) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>,</span>
<span id="cb34-180"><a href="#cb34-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"#d46c5b"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of S-values Under the Null"</span>,</span>
<span id="cb34-181"><a href="#cb34-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"S-value (Bits of Information)"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb34-182"><a href="#cb34-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-183"><a href="#cb34-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-184"><a href="#cb34-184" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-6-1.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"768"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-185"><a href="#cb34-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-186"><a href="#cb34-186" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-187"><a href="#cb34-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-188"><a href="#cb34-188" aria-hidden="true" tabindex="-1"></a><span class="fu">## Posterior Predictive $P$-values</span></span>
<span id="cb34-189"><a href="#cb34-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-190"><a href="#cb34-190" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-191"><a href="#cb34-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-192"><a href="#cb34-192" aria-hidden="true" tabindex="-1"></a>Despite the name, posterior predictive $P$-values are not considered</span>
<span id="cb34-193"><a href="#cb34-193" aria-hidden="true" tabindex="-1"></a>valid frequentist $P$-values because they do not meet the uniformity</span>
<span id="cb34-194"><a href="#cb34-194" aria-hidden="true" tabindex="-1"></a>criterion, instead they are pulled towards the parameter value <span class="in">`0.5`</span>.</span>
<span id="cb34-195"><a href="#cb34-195" aria-hidden="true" tabindex="-1"></a>For further discussion, see our [technical</span>
<span id="cb34-196"><a href="#cb34-196" aria-hidden="true" tabindex="-1"></a>supplement](https://arxiv.org/pdf/2008.12991.pdf) along with [Greenland</span>
<span id="cb34-197"><a href="#cb34-197" aria-hidden="true" tabindex="-1"></a>(2019)](https://doi.org/10.1080/00031305.2018.1529625) for comprehensive</span>
<span id="cb34-198"><a href="#cb34-198" aria-hidden="true" tabindex="-1"></a>theoretical discussions.<span class="sc">\[</span>@greenlandValidPvaluesBehave2019;</span>
<span id="cb34-199"><a href="#cb34-199" aria-hidden="true" tabindex="-1"></a>@greenlandTechnicalIssuesInterpretation2020<span class="sc">\]</span></span>
<span id="cb34-200"><a href="#cb34-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-201"><a href="#cb34-201" aria-hidden="true" tabindex="-1"></a>A quick excerpt from our main paper and the technical supplement</span>
<span id="cb34-202"><a href="#cb34-202" aria-hidden="true" tabindex="-1"></a>explains why this is not the case,</span>
<span id="cb34-203"><a href="#cb34-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-204"><a href="#cb34-204" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-205"><a href="#cb34-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-206"><a href="#cb34-206" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; As discussed in the Supplement, in Bayesian settings one may see</span></span>
<span id="cb34-207"><a href="#cb34-207" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; certain $P$-values that are not valid frequentist $P$-values, the</span></span>
<span id="cb34-208"><a href="#cb34-208" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; primary example being the posterior predictive $P$-value</span></span>
<span id="cb34-209"><a href="#cb34-209" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; @bayarriValuesCompositeNull2000;@robinsAsymptoticDistributionValues2000;</span></span>
<span id="cb34-210"><a href="#cb34-210" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; unfortunately, the negative logs of such invalid $P$-values do not</span></span>
<span id="cb34-211"><a href="#cb34-211" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; measure surprisal at the statistic given the model, and so are not</span></span>
<span id="cb34-212"><a href="#cb34-212" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; valid $S$-values.</span></span>
<span id="cb34-213"><a href="#cb34-213" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb34-214"><a href="#cb34-214" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The decision rule "reject **H** if $p\leq$ $\alpha$" will reject **H**</span></span>
<span id="cb34-215"><a href="#cb34-215" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 100$\alpha$% of the time under sampling from a model **M** obeying</span></span>
<span id="cb34-216"><a href="#cb34-216" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **H** (i.e., the Type-1 error rate of the test will be $\alpha$)</span></span>
<span id="cb34-217"><a href="#cb34-217" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; provided the random variable $P$ corresponding to $p$ is valid</span></span>
<span id="cb34-218"><a href="#cb34-218" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (uniform under the model **M** used to compute it), but not</span></span>
<span id="cb34-219"><a href="#cb34-219" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; necessarily otherwise</span><span class="sc">\[</span><span class="at">@kuffnerWhyArePvalues2019</span><span class="sc">\]</span><span class="at">. This is one reason</span></span>
<span id="cb34-220"><a href="#cb34-220" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; why frequentist writers reject invalid $P$-values (such as posterior</span></span>
<span id="cb34-221"><a href="#cb34-221" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; predictive $P$-values, which highly concentrate around 0.50) and</span></span>
<span id="cb34-222"><a href="#cb34-222" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; devote considerable technical coverage to uniform $P$-values</span></span>
<span id="cb34-223"><a href="#cb34-223" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; @kuffnerWhyArePvalues2019; @robinsAsymptoticDistributionValues2000;</span></span>
<span id="cb34-224"><a href="#cb34-224" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; @bayarriValuesCompositeNull2000. A valid $P$-value ("U-value")</span></span>
<span id="cb34-225"><a href="#cb34-225" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; translates into an exponentially distributed $S$-value with a mean of</span></span>
<span id="cb34-226"><a href="#cb34-226" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 1 nat or $\log_{2}(e)=1.443$ bits where $e$ is the base of the natural</span></span>
<span id="cb34-227"><a href="#cb34-227" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; logs.</span></span>
<span id="cb34-228"><a href="#cb34-228" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb34-229"><a href="#cb34-229" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Uniformity is also central to the "refutational information"</span></span>
<span id="cb34-230"><a href="#cb34-230" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; interpretation of the $S$-value used here, for it is necessary to</span></span>
<span id="cb34-231"><a href="#cb34-231" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; ensure that the $P$-value $p$ from which $s$ is derived is in fact the</span></span>
<span id="cb34-232"><a href="#cb34-232" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; percentile of the observed value of the test statistic in the</span></span>
<span id="cb34-233"><a href="#cb34-233" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; distribution of the statistic under **M**, thus making small $p$</span></span>
<span id="cb34-234"><a href="#cb34-234" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; surprising under **M** and making $s$ the corresponding degree of</span></span>
<span id="cb34-235"><a href="#cb34-235" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; surprise. Because posterior predictive $P$-values do not translate</span></span>
<span id="cb34-236"><a href="#cb34-236" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; into sampling percentiles of the statistic under the hypothesis (in</span></span>
<span id="cb34-237"><a href="#cb34-237" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; fact, they are pulled toward 0.5 from the correct percentiles)</span></span>
<span id="cb34-238"><a href="#cb34-238" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; @robinsAsymptoticDistributionValues2000;</span></span>
<span id="cb34-239"><a href="#cb34-239" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; @bayarriValuesCompositeNull2000, the resulting negative log does not</span></span>
<span id="cb34-240"><a href="#cb34-240" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; measure surprisal at the statistic given **M**, and so is not a valid</span></span>
<span id="cb34-241"><a href="#cb34-241" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $S$-value in our terms.</span></span>
<span id="cb34-242"><a href="#cb34-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-243"><a href="#cb34-243" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-244"><a href="#cb34-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-245"><a href="#cb34-245" aria-hidden="true" tabindex="-1"></a>And indeed, we can show this phenomenon below with simulations. Here we</span>
<span id="cb34-246"><a href="#cb34-246" aria-hidden="true" tabindex="-1"></a>fit a simple Bayesian regression model with a weakly informative prior</span>
<span id="cb34-247"><a href="#cb34-247" aria-hidden="true" tabindex="-1"></a><span class="in">`normal(0, 10)`</span> using <span class="co">[</span><span class="ot">`rstanarm`</span><span class="co">](https://mc-stan.org/rstanarm)</span>, where</span>
<span id="cb34-248"><a href="#cb34-248" aria-hidden="true" tabindex="-1"></a>both the predictor and response variable come from the same distribution</span>
<span id="cb34-249"><a href="#cb34-249" aria-hidden="true" tabindex="-1"></a>and have the same location and scale parameters ($\mu = 0$,</span>
<span id="cb34-250"><a href="#cb34-250" aria-hidden="true" tabindex="-1"></a>$\sigma = 1$. We then calculate the observed test statistics, along with</span>
<span id="cb34-251"><a href="#cb34-251" aria-hidden="true" tabindex="-1"></a>their distributions, and convert them into posterior predictive</span>
<span id="cb34-252"><a href="#cb34-252" aria-hidden="true" tabindex="-1"></a>$P$-values and plot them using</span>
<span id="cb34-253"><a href="#cb34-253" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`Bayesplot`</span><span class="co">](https://mc-stan.org/bayesplot)</span> functions. Then, we iterate</span>
<span id="cb34-254"><a href="#cb34-254" aria-hidden="true" tabindex="-1"></a>this <span class="in">`1000`</span> times to examine the distribution of posterior predictive</span>
<span id="cb34-255"><a href="#cb34-255" aria-hidden="true" tabindex="-1"></a>$P$-values and compare them to standard $P$-values that are known to be</span>
<span id="cb34-256"><a href="#cb34-256" aria-hidden="true" tabindex="-1"></a>uniform.</span>
<span id="cb34-257"><a href="#cb34-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-258"><a href="#cb34-258" aria-hidden="true" tabindex="-1"></a>But first, we'll generate the distribution of the test statistic from</span>
<span id="cb34-259"><a href="#cb34-259" aria-hidden="true" tabindex="-1"></a>one model.</span>
<span id="cb34-260"><a href="#cb34-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-261"><a href="#cb34-261" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-262"><a href="#cb34-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-263"><a href="#cb34-263" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-264"><a href="#cb34-264" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"bayesplot"</span>)</span>
<span id="cb34-265"><a href="#cb34-265" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rstan"</span>)</span>
<span id="cb34-266"><a href="#cb34-266" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rstanarm"</span>)</span>
<span id="cb34-267"><a href="#cb34-267" aria-hidden="true" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-268"><a href="#cb34-268" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> <span class="dv">4</span>)</span>
<span id="cb34-269"><a href="#cb34-269" aria-hidden="true" tabindex="-1"></a>teal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#99c7c7"</span>)</span>
<span id="cb34-270"><a href="#cb34-270" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="st">"teal"</span>)</span>
<span id="cb34-271"><a href="#cb34-271" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb34-272"><a href="#cb34-272" aria-hidden="true" tabindex="-1"></a>n.samp <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb34-273"><a href="#cb34-273" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb34-274"><a href="#cb34-274" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb34-275"><a href="#cb34-275" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X, Y)</span>
<span id="cb34-276"><a href="#cb34-276" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> df, <span class="at">chains =</span> <span class="dv">1</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb34-277"><a href="#cb34-277" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb34-278"><a href="#cb34-278" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in if (!prior_dist_name %in% unlist(ok_dists)) {: argument is of length zero</span></span>
<span id="cb34-279"><a href="#cb34-279" aria-hidden="true" tabindex="-1"></a>yrep <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(mod1)</span>
<span id="cb34-280"><a href="#cb34-280" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: object 'mod1' not found</span></span>
<span id="cb34-281"><a href="#cb34-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-282"><a href="#cb34-282" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">ppc_stat</span>(Y, yrep, <span class="at">stat =</span> <span class="st">"median"</span>, <span class="at">freq =</span> <span class="cn">TRUE</span>, <span class="at">binwidth =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb34-283"><a href="#cb34-283" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Posterior Test Statistic"</span>) <span class="sc">+</span></span>
<span id="cb34-284"><a href="#cb34-284" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">yaxis_text</span>(<span class="at">on =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-285"><a href="#cb34-285" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: object 'yrep' not found</span></span>
<span id="cb34-286"><a href="#cb34-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-287"><a href="#cb34-287" aria-hidden="true" tabindex="-1"></a>values_all <span class="ot">&lt;-</span> h[[<span class="st">"plot_env"</span>]][[<span class="st">"T_yrep"</span>]]</span>
<span id="cb34-288"><a href="#cb34-288" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: object 'h' not found</span></span>
<span id="cb34-289"><a href="#cb34-289" aria-hidden="true" tabindex="-1"></a>prob_to_find <span class="ot">&lt;-</span> h[[<span class="st">"plot_env"</span>]][[<span class="st">"T_y"</span>]]</span>
<span id="cb34-290"><a href="#cb34-290" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: object 'h' not found</span></span>
<span id="cb34-291"><a href="#cb34-291" aria-hidden="true" tabindex="-1"></a>quantInv <span class="ot">&lt;-</span> <span class="cf">function</span>(distr, value) <span class="fu">ecdf</span>(distr)(value)</span>
<span id="cb34-292"><a href="#cb34-292" aria-hidden="true" tabindex="-1"></a>posterior_p_value <span class="ot">&lt;-</span> <span class="fu">quantInv</span>(values_all, prob_to_find)</span>
<span id="cb34-293"><a href="#cb34-293" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: object 'values_all' not found</span></span>
<span id="cb34-294"><a href="#cb34-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-295"><a href="#cb34-295" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">ppc_stat_2d</span>(Y, yrep) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Posterior Test Statistic"</span>)</span>
<span id="cb34-296"><a href="#cb34-296" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: object 'yrep' not found</span></span>
<span id="cb34-297"><a href="#cb34-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-298"><a href="#cb34-298" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h)</span>
<span id="cb34-299"><a href="#cb34-299" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'h' not found</span></span>
<span id="cb34-300"><a href="#cb34-300" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(l)</span>
<span id="cb34-301"><a href="#cb34-301" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'l' not found</span></span>
<span id="cb34-302"><a href="#cb34-302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-303"><a href="#cb34-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-304"><a href="#cb34-304" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-305"><a href="#cb34-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-306"><a href="#cb34-306" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-307"><a href="#cb34-307" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prob_to_find)</span>
<span id="cb34-308"><a href="#cb34-308" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'print': object 'prob_to_find' not found</span></span>
<span id="cb34-309"><a href="#cb34-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-310"><a href="#cb34-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-311"><a href="#cb34-311" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-312"><a href="#cb34-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-313"><a href="#cb34-313" aria-hidden="true" tabindex="-1"></a>The above is the posterior predictive test statistic for one model,</span>
<span id="cb34-314"><a href="#cb34-314" aria-hidden="true" tabindex="-1"></a>along with it's distribution. Now let's iterate this process, convert</span>
<span id="cb34-315"><a href="#cb34-315" aria-hidden="true" tabindex="-1"></a>them into posterior predictive $P$-values, and generate their</span>
<span id="cb34-316"><a href="#cb34-316" aria-hidden="true" tabindex="-1"></a>distribution.</span>
<span id="cb34-317"><a href="#cb34-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-318"><a href="#cb34-318" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-319"><a href="#cb34-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-320"><a href="#cb34-320" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-321"><a href="#cb34-321" aria-hidden="true" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-322"><a href="#cb34-322" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> <span class="dv">4</span>)</span>
<span id="cb34-323"><a href="#cb34-323" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb34-324"><a href="#cb34-324" aria-hidden="true" tabindex="-1"></a>set.seed <span class="ot">&lt;-</span> <span class="dv">1031</span></span>
<span id="cb34-325"><a href="#cb34-325" aria-hidden="true" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb34-326"><a href="#cb34-326" aria-hidden="true" tabindex="-1"></a>ppp <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n.sim)</span>
<span id="cb34-327"><a href="#cb34-327" aria-hidden="true" tabindex="-1"></a>n.samp <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb34-328"><a href="#cb34-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-329"><a href="#cb34-329" aria-hidden="true" tabindex="-1"></a>quantInv <span class="ot">&lt;-</span> <span class="cf">function</span>(distr, value) <span class="fu">ecdf</span>(distr)(value)</span>
<span id="cb34-330"><a href="#cb34-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-331"><a href="#cb34-331" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ppp)) {</span>
<span id="cb34-332"><a href="#cb34-332" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb34-333"><a href="#cb34-333" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samp, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb34-334"><a href="#cb34-334" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X, Y)</span>
<span id="cb34-335"><a href="#cb34-335" aria-hidden="true" tabindex="-1"></a>    mod1 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> df, <span class="at">chains =</span> <span class="dv">1</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb34-336"><a href="#cb34-336" aria-hidden="true" tabindex="-1"></a>        <span class="at">iter =</span> <span class="dv">1000</span>, <span class="at">refresh =</span> <span class="dv">0</span>, <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb34-337"><a href="#cb34-337" aria-hidden="true" tabindex="-1"></a>    yrep <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(mod1)</span>
<span id="cb34-338"><a href="#cb34-338" aria-hidden="true" tabindex="-1"></a>    h <span class="ot">&lt;-</span> <span class="fu">ppc_stat</span>(Y, yrep, <span class="at">stat =</span> <span class="st">"median"</span>)</span>
<span id="cb34-339"><a href="#cb34-339" aria-hidden="true" tabindex="-1"></a>    values_all <span class="ot">&lt;-</span> h[[<span class="st">"plot_env"</span>]][[<span class="st">"T_yrep"</span>]]</span>
<span id="cb34-340"><a href="#cb34-340" aria-hidden="true" tabindex="-1"></a>    prob_to_find <span class="ot">&lt;-</span> h[[<span class="st">"plot_env"</span>]][[<span class="st">"T_y"</span>]]</span>
<span id="cb34-341"><a href="#cb34-341" aria-hidden="true" tabindex="-1"></a>    posterior_p_value <span class="ot">&lt;-</span> <span class="fu">quantInv</span>(values_all, prob_to_find)</span>
<span id="cb34-342"><a href="#cb34-342" aria-hidden="true" tabindex="-1"></a>    ppp[i] <span class="ot">&lt;-</span> posterior_p_value</span>
<span id="cb34-343"><a href="#cb34-343" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-344"><a href="#cb34-344" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in if (!prior_dist_name %in% unlist(ok_dists)) {: argument is of length zero</span></span>
<span id="cb34-345"><a href="#cb34-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-346"><a href="#cb34-346" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> ppp)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb34-347"><a href="#cb34-347" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"#99c7c7"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Posterior Predictive P-values"</span>,</span>
<span id="cb34-348"><a href="#cb34-348" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"From Simulation of 1000 Simple Linear Regressions"</span>,</span>
<span id="cb34-349"><a href="#cb34-349" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Posterior Predictive P-value"</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,</span>
<span id="cb34-350"><a href="#cb34-350" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb34-351"><a href="#cb34-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-352"><a href="#cb34-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-353"><a href="#cb34-353" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-8-1.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"768"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-354"><a href="#cb34-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-355"><a href="#cb34-355" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-356"><a href="#cb34-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-357"><a href="#cb34-357" aria-hidden="true" tabindex="-1"></a>We can also show this in <span class="in">`Stata 16.1`</span>, using their new</span>
<span id="cb34-358"><a href="#cb34-358" aria-hidden="true" tabindex="-1"></a><span class="in">`bayesstats ppvalues`</span> command which generates posterior predictive</span>
<span id="cb34-359"><a href="#cb34-359" aria-hidden="true" tabindex="-1"></a>$P$-values.</span>
<span id="cb34-360"><a href="#cb34-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-361"><a href="#cb34-361" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-362"><a href="#cb34-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-363"><a href="#cb34-363" aria-hidden="true" tabindex="-1"></a><span class="in">``` stata</span></span>
<span id="cb34-364"><a href="#cb34-364" aria-hidden="true" tabindex="-1"></a><span class="in">version 16.1</span></span>
<span id="cb34-365"><a href="#cb34-365" aria-hidden="true" tabindex="-1"></a><span class="in">set obs 100</span></span>
<span id="cb34-366"><a href="#cb34-366" aria-hidden="true" tabindex="-1"></a><span class="in">/**</span></span>
<span id="cb34-367"><a href="#cb34-367" aria-hidden="true" tabindex="-1"></a><span class="in">Generate variables from a normal distribution like before</span></span>
<span id="cb34-368"><a href="#cb34-368" aria-hidden="true" tabindex="-1"></a><span class="in">*/</span></span>
<span id="cb34-369"><a href="#cb34-369" aria-hidden="true" tabindex="-1"></a><span class="in">generate x = rnormal(0, 1)</span></span>
<span id="cb34-370"><a href="#cb34-370" aria-hidden="true" tabindex="-1"></a><span class="in">generate y = rnormal(0, 1)</span></span>
<span id="cb34-371"><a href="#cb34-371" aria-hidden="true" tabindex="-1"></a><span class="in">/**</span></span>
<span id="cb34-372"><a href="#cb34-372" aria-hidden="true" tabindex="-1"></a><span class="in">We set up our model here </span></span>
<span id="cb34-373"><a href="#cb34-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-374"><a href="#cb34-374" aria-hidden="true" tabindex="-1"></a><span class="in">*/</span></span>
<span id="cb34-375"><a href="#cb34-375" aria-hidden="true" tabindex="-1"></a><span class="in">parallel initialize 8, f</span></span>
<span id="cb34-376"><a href="#cb34-376" aria-hidden="true" tabindex="-1"></a><span class="in">bayesmh y x, likelihood(normal({var})) prior({var}, normal(0, 10)) ///</span></span>
<span id="cb34-377"><a href="#cb34-377" aria-hidden="true" tabindex="-1"></a><span class="in">prior({y:}, normal(0, 10)) rseed(1031) saving(coutput_pred, replace) mcmcsize(1000)</span></span>
<span id="cb34-378"><a href="#cb34-378" aria-hidden="true" tabindex="-1"></a><span class="in">/**</span></span>
<span id="cb34-379"><a href="#cb34-379" aria-hidden="true" tabindex="-1"></a><span class="in">We use the bayespredict command to make predictions from the model</span></span>
<span id="cb34-380"><a href="#cb34-380" aria-hidden="true" tabindex="-1"></a><span class="in">*/</span></span>
<span id="cb34-381"><a href="#cb34-381" aria-hidden="true" tabindex="-1"></a><span class="in">bayespredict (mean:@mean({_resid})) (var:@variance({_resid})), ///</span></span>
<span id="cb34-382"><a href="#cb34-382" aria-hidden="true" tabindex="-1"></a><span class="in">rseed(1031) saving(coutput_pred, replace) </span></span>
<span id="cb34-383"><a href="#cb34-383" aria-hidden="true" tabindex="-1"></a><span class="in">/**</span></span>
<span id="cb34-384"><a href="#cb34-384" aria-hidden="true" tabindex="-1"></a><span class="in">Then we calculate the posterior predictive P-values</span></span>
<span id="cb34-385"><a href="#cb34-385" aria-hidden="true" tabindex="-1"></a><span class="in">*/</span></span>
<span id="cb34-386"><a href="#cb34-386" aria-hidden="true" tabindex="-1"></a><span class="in">bayesstats ppvalues {mean} using coutput_pred</span></span>
<span id="cb34-387"><a href="#cb34-387" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; . version 16.1</span></span>
<span id="cb34-388"><a href="#cb34-388" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-389"><a href="#cb34-389" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; . set obs 100</span></span>
<span id="cb34-390"><a href="#cb34-390" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Number of observations (_N) was 0, now 100.</span></span>
<span id="cb34-391"><a href="#cb34-391" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-392"><a href="#cb34-392" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; . /**</span></span>
<span id="cb34-393"><a href="#cb34-393" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; &gt; Generate variables from a normal distribution like before</span></span>
<span id="cb34-394"><a href="#cb34-394" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; &gt; */</span></span>
<span id="cb34-395"><a href="#cb34-395" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; . generate x = rnormal(0, 1)</span></span>
<span id="cb34-396"><a href="#cb34-396" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-397"><a href="#cb34-397" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; . generate y = rnormal(0, 1)</span></span>
<span id="cb34-398"><a href="#cb34-398" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-399"><a href="#cb34-399" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; . /**</span></span>
<span id="cb34-400"><a href="#cb34-400" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; &gt; We set up our model here </span></span>
<span id="cb34-401"><a href="#cb34-401" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; &gt; </span></span>
<span id="cb34-402"><a href="#cb34-402" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; &gt; */</span></span>
<span id="cb34-403"><a href="#cb34-403" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; . parallel initialize 8, f</span></span>
<span id="cb34-404"><a href="#cb34-404" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; N Child processes: 8</span></span>
<span id="cb34-405"><a href="#cb34-405" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Stata dir:  /Applications/Stata/StataBE.app/Contents/MacOS/stata-be</span></span>
<span id="cb34-406"><a href="#cb34-406" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-407"><a href="#cb34-407" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; . bayesmh y x, likelihood(normal({var})) prior({var}, normal(0, 10)) ///</span></span>
<span id="cb34-408"><a href="#cb34-408" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; &gt; prior({y:}, normal(0, 10)) rseed(1031) saving(coutput_pred, replace) mcmcsize(1000)</span></span>
<span id="cb34-409"><a href="#cb34-409" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;   </span></span>
<span id="cb34-410"><a href="#cb34-410" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Burn-in ...</span></span>
<span id="cb34-411"><a href="#cb34-411" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Simulation ...</span></span>
<span id="cb34-412"><a href="#cb34-412" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-413"><a href="#cb34-413" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Model summary</span></span>
<span id="cb34-414"><a href="#cb34-414" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; ------------------------------------------------------------------------------</span></span>
<span id="cb34-415"><a href="#cb34-415" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Likelihood: </span></span>
<span id="cb34-416"><a href="#cb34-416" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;   y ~ normal(xb_y,{var})</span></span>
<span id="cb34-417"><a href="#cb34-417" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-418"><a href="#cb34-418" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Priors: </span></span>
<span id="cb34-419"><a href="#cb34-419" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;   {y:x _cons} ~ normal(0,10)                                               (1)</span></span>
<span id="cb34-420"><a href="#cb34-420" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;         {var} ~ normal(0,10)</span></span>
<span id="cb34-421"><a href="#cb34-421" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; ------------------------------------------------------------------------------</span></span>
<span id="cb34-422"><a href="#cb34-422" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; (1) Parameters are elements of the linear form xb_y.</span></span>
<span id="cb34-423"><a href="#cb34-423" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-424"><a href="#cb34-424" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Bayesian normal regression                       MCMC iterations  =      3,500</span></span>
<span id="cb34-425"><a href="#cb34-425" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Random-walk Metropolis–Hastings sampling         Burn-in          =      2,500</span></span>
<span id="cb34-426"><a href="#cb34-426" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;                                                  MCMC sample size =      1,000</span></span>
<span id="cb34-427"><a href="#cb34-427" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;                                                  Number of obs    =        100</span></span>
<span id="cb34-428"><a href="#cb34-428" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;                                                  Acceptance rate  =      .2068</span></span>
<span id="cb34-429"><a href="#cb34-429" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;                                                  Efficiency:  min =     .03878</span></span>
<span id="cb34-430"><a href="#cb34-430" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;                                                               avg =     .07757</span></span>
<span id="cb34-431"><a href="#cb34-431" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Log marginal-likelihood = -149.68351                          max =      .1317</span></span>
<span id="cb34-432"><a href="#cb34-432" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;  </span></span>
<span id="cb34-433"><a href="#cb34-433" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; ------------------------------------------------------------------------------</span></span>
<span id="cb34-434"><a href="#cb34-434" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;              |                                                Equal-tailed</span></span>
<span id="cb34-435"><a href="#cb34-435" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;              |      Mean   Std. dev.     MCSE     Median  [95% cred. interval]</span></span>
<span id="cb34-436"><a href="#cb34-436" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; -------------+----------------------------------------------------------------</span></span>
<span id="cb34-437"><a href="#cb34-437" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; y            |</span></span>
<span id="cb34-438"><a href="#cb34-438" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;            x | -.0758396    .097915   .008532  -.0704775  -.2600037   .1054718</span></span>
<span id="cb34-439"><a href="#cb34-439" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;        _cons |  .0238076   .1107038   .014035   .0326669  -.1793756   .2293247</span></span>
<span id="cb34-440"><a href="#cb34-440" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; -------------+----------------------------------------------------------------</span></span>
<span id="cb34-441"><a href="#cb34-441" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;          var |  .9773565   .1313659   .021096   .9384637   .7882847   1.323255</span></span>
<span id="cb34-442"><a href="#cb34-442" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; ------------------------------------------------------------------------------</span></span>
<span id="cb34-443"><a href="#cb34-443" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-444"><a href="#cb34-444" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; file coutput_pred.dta saved.</span></span>
<span id="cb34-445"><a href="#cb34-445" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-446"><a href="#cb34-446" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; . /**</span></span>
<span id="cb34-447"><a href="#cb34-447" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; &gt; We use the bayespredict command to make predictions from the model</span></span>
<span id="cb34-448"><a href="#cb34-448" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; &gt; */</span></span>
<span id="cb34-449"><a href="#cb34-449" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; . bayespredict (mean:@mean({_resid})) (var:@variance({_resid})), ///</span></span>
<span id="cb34-450"><a href="#cb34-450" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; &gt; rseed(1031) saving(coutput_pred, replace) </span></span>
<span id="cb34-451"><a href="#cb34-451" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-452"><a href="#cb34-452" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Computing predictions ...</span></span>
<span id="cb34-453"><a href="#cb34-453" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-454"><a href="#cb34-454" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; file coutput_pred.dta saved.</span></span>
<span id="cb34-455"><a href="#cb34-455" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; file coutput_pred.ster saved.</span></span>
<span id="cb34-456"><a href="#cb34-456" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-457"><a href="#cb34-457" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; . /**</span></span>
<span id="cb34-458"><a href="#cb34-458" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; &gt; Then we calculate the posterior predictive P-values</span></span>
<span id="cb34-459"><a href="#cb34-459" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; &gt; */</span></span>
<span id="cb34-460"><a href="#cb34-460" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; . bayesstats ppvalues {mean} using coutput_pred</span></span>
<span id="cb34-461"><a href="#cb34-461" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-462"><a href="#cb34-462" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Posterior predictive summary   MCMC sample size =     1,000</span></span>
<span id="cb34-463"><a href="#cb34-463" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-464"><a href="#cb34-464" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; -----------------------------------------------------------</span></span>
<span id="cb34-465"><a href="#cb34-465" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;            T |      Mean   Std. dev.  E(T_obs)  P(T&gt;=T_obs)</span></span>
<span id="cb34-466"><a href="#cb34-466" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; -------------+---------------------------------------------</span></span>
<span id="cb34-467"><a href="#cb34-467" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;         mean |  .0004223   .0957513    .008651         .495</span></span>
<span id="cb34-468"><a href="#cb34-468" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; -----------------------------------------------------------</span></span>
<span id="cb34-469"><a href="#cb34-469" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Note: P(T&gt;=T_obs) close to 0 or 1 indicates lack of fit.</span></span>
<span id="cb34-470"><a href="#cb34-470" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-471"><a href="#cb34-471" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; .</span></span>
<span id="cb34-472"><a href="#cb34-472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-473"><a href="#cb34-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-474"><a href="#cb34-474" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-475"><a href="#cb34-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-476"><a href="#cb34-476" aria-hidden="true" tabindex="-1"></a>As we can see from the <span class="in">`R`</span> plot above, the test statistics are are</span>
<span id="cb34-477"><a href="#cb34-477" aria-hidden="true" tabindex="-1"></a>generally concentrated around <span class="in">`0.5`</span> and the distribution (as shown above</span>
<span id="cb34-478"><a href="#cb34-478" aria-hidden="true" tabindex="-1"></a>via the <span class="in">`R`</span> code) hardly resembles the uniform distribution of $P$-value</span>
<span id="cb34-479"><a href="#cb34-479" aria-hidden="true" tabindex="-1"></a>under the null model. Further, the base-2 log transformation of</span>
<span id="cb34-480"><a href="#cb34-480" aria-hidden="true" tabindex="-1"></a>posterior predictive $P$-values is not exponentially distributed, making</span>
<span id="cb34-481"><a href="#cb34-481" aria-hidden="true" tabindex="-1"></a>them invalid $S$-values in our terms.</span>
<span id="cb34-482"><a href="#cb34-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-483"><a href="#cb34-483" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-484"><a href="#cb34-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-485"><a href="#cb34-485" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-486"><a href="#cb34-486" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> (<span class="sc">-</span><span class="fu">log2</span>(ppp)))) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>,</span>
<span id="cb34-487"><a href="#cb34-487" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"#d46c5b"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of -log2(Posterior Predictive P-values)"</span>,</span>
<span id="cb34-488"><a href="#cb34-488" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"S-values Produced From Posterior Predictive P-values"</span>,</span>
<span id="cb34-489"><a href="#cb34-489" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"-log2(Posterior Predictive P-value)"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb34-490"><a href="#cb34-490" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 100 rows containing non-finite outside the scale range (`stat_bin()`).</span></span>
<span id="cb34-491"><a href="#cb34-491" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in max(f): no non-missing arguments to max; returning -Inf</span></span>
<span id="cb34-492"><a href="#cb34-492" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in `geom_histogram()`:</span></span>
<span id="cb34-493"><a href="#cb34-493" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ! Problem while computing stat.</span></span>
<span id="cb34-494"><a href="#cb34-494" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Error occurred in the 1st layer.</span></span>
<span id="cb34-495"><a href="#cb34-495" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Caused by error in `seq_len()`:</span></span>
<span id="cb34-496"><a href="#cb34-496" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ! argument must be coercible to non-negative integer</span></span>
<span id="cb34-497"><a href="#cb34-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-498"><a href="#cb34-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-499"><a href="#cb34-499" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-500"><a href="#cb34-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-501"><a href="#cb34-501" aria-hidden="true" tabindex="-1"></a><span class="fu">## Table 1: Some $P$-values, $S$-values, Maximum Likelihood Ratios, and Likelihood Ratio Statistics</span></span>
<span id="cb34-502"><a href="#cb34-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-503"><a href="#cb34-503" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-504"><a href="#cb34-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-505"><a href="#cb34-505" aria-hidden="true" tabindex="-1"></a>Here, we look at some common $P$-values, and how they correspond to</span>
<span id="cb34-506"><a href="#cb34-506" aria-hidden="true" tabindex="-1"></a>other information statistics and likelihood measures.</span>
<span id="cb34-507"><a href="#cb34-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-508"><a href="#cb34-508" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-509"><a href="#cb34-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-510"><a href="#cb34-510" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-511"><a href="#cb34-511" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.99</span>, <span class="fl">0.9</span>, <span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.025</span>, <span class="fl">0.01</span>, <span class="fl">0.005</span>,</span>
<span id="cb34-512"><a href="#cb34-512" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1e-04</span>, <span class="fu">paste</span>(<span class="st">"5 sigma (~ 2.9 in 10 million)"</span>), <span class="fu">paste</span>(<span class="st">"1 in 100 million (GWAS)"</span>),</span>
<span id="cb34-513"><a href="#cb34-513" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">"6 sigma (~ 1 in a billion)"</span>))</span>
<span id="cb34-514"><a href="#cb34-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-515"><a href="#cb34-515" aria-hidden="true" tabindex="-1"></a>svalue <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fu">log2</span>(<span class="fu">c</span>(<span class="fl">0.99</span>, <span class="fl">0.9</span>, <span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.025</span>,</span>
<span id="cb34-516"><a href="#cb34-516" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.01</span>, <span class="fl">0.005</span>, <span class="fl">1e-04</span>)), <span class="fl">21.7</span>, <span class="fl">26.6</span>, <span class="fl">29.9</span>), <span class="dv">2</span>)</span>
<span id="cb34-517"><a href="#cb34-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-518"><a href="#cb34-518" aria-hidden="true" tabindex="-1"></a>pvalue[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="fu">formatC</span>(pvalue[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">format =</span> <span class="st">"e"</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb34-519"><a href="#cb34-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-520"><a href="#cb34-520" aria-hidden="true" tabindex="-1"></a>mlr <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.01</span>, <span class="fl">1.26</span>, <span class="fl">1.94</span>, <span class="fl">3.87</span>, <span class="fl">6.83</span>, <span class="fl">12.3</span>, <span class="fl">27.6</span>, <span class="fl">51.4</span>,</span>
<span id="cb34-521"><a href="#cb34-521" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1935</span>, (<span class="fl">5.2</span> <span class="sc">*</span> (<span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)), (<span class="fl">1.4</span> <span class="sc">*</span> (<span class="dv">10</span><span class="sc">^</span><span class="dv">7</span>)), (<span class="fl">1.3</span> <span class="sc">*</span> (<span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>))), <span class="dv">2</span>)</span>
<span id="cb34-522"><a href="#cb34-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-523"><a href="#cb34-523" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio statistic</span></span>
<span id="cb34-524"><a href="#cb34-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-525"><a href="#cb34-525" aria-hidden="true" tabindex="-1"></a>lr <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fl">0.00016</span>, <span class="fl">0.016</span>, <span class="fl">0.45</span>, <span class="fl">1.32</span>, <span class="fl">2.71</span>, <span class="fl">3.84</span>, <span class="fl">5.02</span>, <span class="fl">6.63</span>,</span>
<span id="cb34-526"><a href="#cb34-526" aria-hidden="true" tabindex="-1"></a>    <span class="fl">7.88</span>, <span class="fl">15.1</span>, <span class="fl">26.3</span>, <span class="fl">32.8</span>, <span class="fl">37.4</span>), <span class="dv">2</span>)</span>
<span id="cb34-527"><a href="#cb34-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-528"><a href="#cb34-528" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pvalue, svalue, mlr, lr)</span>
<span id="cb34-529"><a href="#cb34-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-530"><a href="#cb34-530" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"P-value (compatibility)"</span>, <span class="st">"S-value (bits)"</span>,</span>
<span id="cb34-531"><a href="#cb34-531" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Maximum Likelihood Ratio"</span>, <span class="st">"Deviance Statistic 2ln(MLR)"</span>)</span>
<span id="cb34-532"><a href="#cb34-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-533"><a href="#cb34-533" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(table1, <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">padding =</span> <span class="dv">45</span>, <span class="at">longtable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-534"><a href="#cb34-534" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#777"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-535"><a href="#cb34-535" aria-hidden="true" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="at">row =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#777"</span>, <span class="at">bold =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb34-536"><a href="#cb34-536" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="at">column =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">color =</span> <span class="st">"#777"</span>, <span class="at">bold =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb34-537"><a href="#cb34-537" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>, <span class="at">lightable_options =</span> <span class="st">"basic"</span>,</span>
<span id="cb34-538"><a href="#cb34-538" aria-hidden="true" tabindex="-1"></a>        <span class="at">font_size =</span> <span class="dv">17</span>, <span class="at">fixed_thead =</span> <span class="fu">list</span>(<span class="at">enabled =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb34-539"><a href="#cb34-539" aria-hidden="true" tabindex="-1"></a>    <span class="fu">footnote</span>(<span class="at">general_title =</span> <span class="st">"Abbreviations: "</span>, <span class="at">title_format =</span> <span class="st">"underline"</span>,</span>
<span id="cb34-540"><a href="#cb34-540" aria-hidden="true" tabindex="-1"></a>        <span class="at">general =</span> <span class="fu">c</span>(<span class="st">"Table 1 $P$-values                  and binary $S$-values, with corresponding maximum-likelihood ratios (MLR) and deviance (likelihood-ratio) statistics for a simple test hypothesis H under background assumptions A"</span>))</span>
<span id="cb34-541"><a href="#cb34-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-542"><a href="#cb34-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-543"><a href="#cb34-543" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> P-value (compatibility) <span class="pp">|</span> S-value (bits) <span class="pp">|</span> Maximum Likelihood Ratio <span class="pp">|</span> Deviance Statistic 2ln(MLR) <span class="pp">|</span></span>
<span id="cb34-544"><a href="#cb34-544" aria-hidden="true" tabindex="-1"></a><span class="pp">|:---|---:|---:|---:|</span></span>
<span id="cb34-545"><a href="#cb34-545" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0.99 <span class="pp">|</span> 0.01 <span class="pp">|</span> 1.00e+00 <span class="pp">|</span> 0.00 <span class="pp">|</span></span>
<span id="cb34-546"><a href="#cb34-546" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0.9 <span class="pp">|</span> 0.15 <span class="pp">|</span> 1.01e+00 <span class="pp">|</span> 0.02 <span class="pp">|</span></span>
<span id="cb34-547"><a href="#cb34-547" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0.5 <span class="pp">|</span> 1.00 <span class="pp">|</span> 1.26e+00 <span class="pp">|</span> 0.45 <span class="pp">|</span></span>
<span id="cb34-548"><a href="#cb34-548" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0.25 <span class="pp">|</span> 2.00 <span class="pp">|</span> 1.94e+00 <span class="pp">|</span> 1.32 <span class="pp">|</span></span>
<span id="cb34-549"><a href="#cb34-549" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0.1 <span class="pp">|</span> 3.32 <span class="pp">|</span> 3.87e+00 <span class="pp">|</span> 2.71 <span class="pp">|</span></span>
<span id="cb34-550"><a href="#cb34-550" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0.05 <span class="pp">|</span> 4.32 <span class="pp">|</span> 6.83e+00 <span class="pp">|</span> 3.84 <span class="pp">|</span></span>
<span id="cb34-551"><a href="#cb34-551" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0.025 <span class="pp">|</span> 5.32 <span class="pp">|</span> 1.23e+01 <span class="pp">|</span> 5.02 <span class="pp">|</span></span>
<span id="cb34-552"><a href="#cb34-552" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0.01 <span class="pp">|</span> 6.64 <span class="pp">|</span> 2.76e+01 <span class="pp">|</span> 6.63 <span class="pp">|</span></span>
<span id="cb34-553"><a href="#cb34-553" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0.005 <span class="pp">|</span> 7.64 <span class="pp">|</span> 5.14e+01 <span class="pp">|</span> 7.88 <span class="pp">|</span></span>
<span id="cb34-554"><a href="#cb34-554" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1e-04 <span class="pp">|</span> 13.29 <span class="pp">|</span> 1.94e+03 <span class="pp">|</span> 15.10 <span class="pp">|</span></span>
<span id="cb34-555"><a href="#cb34-555" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 5 sigma (~ 2.9 in 10 million) <span class="pp">|</span> 21.70 <span class="pp">|</span> 5.20e+05 <span class="pp">|</span> 26.30 <span class="pp">|</span></span>
<span id="cb34-556"><a href="#cb34-556" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1 in 100 million (GWAS) <span class="pp">|</span> 26.60 <span class="pp">|</span> 1.40e+07 <span class="pp">|</span> 32.80 <span class="pp">|</span></span>
<span id="cb34-557"><a href="#cb34-557" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 6 sigma (~ 1 in a billion) <span class="pp">|</span> 29.90 <span class="pp">|</span> 1.30e+08 <span class="pp">|</span> 37.40 <span class="pp">|</span></span>
<span id="cb34-558"><a href="#cb34-558" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="dt">&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"text-decoration: underline;"</span><span class="dt">&gt;</span>Abbreviations: <span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span> <span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span></span>
<span id="cb34-559"><a href="#cb34-559" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>  Table 1 \$P\$-values and binary \$S\$-values, with corresponding maximum-likelihood ratios (MLR) and deviance (likelihood-ratio) statistics for a simple test hypothesis H under background assumptions A <span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span></span>
<span id="cb34-560"><a href="#cb34-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-561"><a href="#cb34-561" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-562"><a href="#cb34-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-563"><a href="#cb34-563" aria-hidden="true" tabindex="-1"></a>For further discussion of 5 and 6 sigma cutoffs, see</span>
<span id="cb34-564"><a href="#cb34-564" aria-hidden="true" tabindex="-1"></a>@cousinsJeffreysLindleyParadox2017.</span>
<span id="cb34-565"><a href="#cb34-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-566"><a href="#cb34-566" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-567"><a href="#cb34-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-568"><a href="#cb34-568" aria-hidden="true" tabindex="-1"></a><span class="fu">## Frequentist Interval Estimate Percentiles</span></span>
<span id="cb34-569"><a href="#cb34-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-570"><a href="#cb34-570" aria-hidden="true" tabindex="-1"></a><span class="fu">## Refer to Long-Run Coverage</span></span>
<span id="cb34-571"><a href="#cb34-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-572"><a href="#cb34-572" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-573"><a href="#cb34-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-574"><a href="#cb34-574" aria-hidden="true" tabindex="-1"></a>Here we simulate a study where one group with 100 participants has an</span>
<span id="cb34-575"><a href="#cb34-575" aria-hidden="true" tabindex="-1"></a>$\mu$ of <span class="in">`100`</span> with a $\sigma$ of <span class="in">`20`</span> and the second group has the same</span>
<span id="cb34-576"><a href="#cb34-576" aria-hidden="true" tabindex="-1"></a>number of participants but an average of <span class="in">`80`</span> and a standard deviation</span>
<span id="cb34-577"><a href="#cb34-577" aria-hidden="true" tabindex="-1"></a>of <span class="in">`20.`</span> We compare them using a Welch's $t$-test and generate 95%</span>
<span id="cb34-578"><a href="#cb34-578" aria-hidden="true" tabindex="-1"></a>compatibility intervals several times, specifically <span class="in">`100`</span> times, and</span>
<span id="cb34-579"><a href="#cb34-579" aria-hidden="true" tabindex="-1"></a>then plot them. Since we know the mean difference is <span class="in">`20`</span>, we wish to</span>
<span id="cb34-580"><a href="#cb34-580" aria-hidden="true" tabindex="-1"></a>see how often the interval estimates cover this true parameter value.</span>
<span id="cb34-581"><a href="#cb34-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-582"><a href="#cb34-582" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-583"><a href="#cb34-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-584"><a href="#cb34-584" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-12-1.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"1056"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-585"><a href="#cb34-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-586"><a href="#cb34-586" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-587"><a href="#cb34-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-588"><a href="#cb34-588" aria-hidden="true" tabindex="-1"></a>This shows that the intervals tend to vary simply as a result of</span>
<span id="cb34-589"><a href="#cb34-589" aria-hidden="true" tabindex="-1"></a>randomness, and that the proper interpretation of the attached</span>
<span id="cb34-590"><a href="#cb34-590" aria-hidden="true" tabindex="-1"></a>percentile is about long run coverage of the true parameter. However,</span>
<span id="cb34-591"><a href="#cb34-591" aria-hidden="true" tabindex="-1"></a>this does not preclude interpretation of a single interval estimate from</span>
<span id="cb34-592"><a href="#cb34-592" aria-hidden="true" tabindex="-1"></a>a study.<span class="sc">\[</span>@coxChapterIntervalEstimation1974<span class="sc">\]</span> As we write in the *Replace</span>
<span id="cb34-593"><a href="#cb34-593" aria-hidden="true" tabindex="-1"></a>unrealistic "confidence" claims with compatibility measures* section of</span>
<span id="cb34-594"><a href="#cb34-594" aria-hidden="true" tabindex="-1"></a>our paper.<span class="sc">\[</span>@rafiSemanticCognitiveTools2020<span class="sc">\]</span></span>
<span id="cb34-595"><a href="#cb34-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-596"><a href="#cb34-596" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-597"><a href="#cb34-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-598"><a href="#cb34-598" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The fact that "confidence" refers to the procedure behavior, not the</span></span>
<span id="cb34-599"><a href="#cb34-599" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; reported interval, seems to be lost on most researchers. Remarking on</span></span>
<span id="cb34-600"><a href="#cb34-600" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; this subtlety, when Jerzy Neyman discussed his confidence concept in</span></span>
<span id="cb34-601"><a href="#cb34-601" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 1934 at a meeting of the Royal Statistical Society, Arthur Bowley</span></span>
<span id="cb34-602"><a href="#cb34-602" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; replied, "I am not at all sure that the 'confidence' is not a</span></span>
<span id="cb34-603"><a href="#cb34-603" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; confidence trick." @bowleyDiscussionDrNeyman1934. And indeed, 40 years</span></span>
<span id="cb34-604"><a href="#cb34-604" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; later, Cox and Hinkley warned, "interval estimates cannot be taken as</span></span>
<span id="cb34-605"><a href="#cb34-605" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; probability statements about parameters, and foremost is the</span></span>
<span id="cb34-606"><a href="#cb34-606" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; interpretation 'such and such parameter values are consistent with the</span></span>
<span id="cb34-607"><a href="#cb34-607" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; data.'" @coxChapterIntervalEstimation1974. Unfortunately, the word</span></span>
<span id="cb34-608"><a href="#cb34-608" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "consistency" is used for several other concepts in statistics, while</span></span>
<span id="cb34-609"><a href="#cb34-609" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; in logic it refers to an absolute condition (of noncontradiction);</span></span>
<span id="cb34-610"><a href="#cb34-610" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; thus, its use in place of "confidence" would risk further confusion.</span></span>
<span id="cb34-611"><a href="#cb34-611" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb34-612"><a href="#cb34-612" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; To address the problems above, we exploit the fact that a 95% CI</span></span>
<span id="cb34-613"><a href="#cb34-613" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; summarizes the results of varying the test hypothesis H over a range</span></span>
<span id="cb34-614"><a href="#cb34-614" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; of parameter values, displaying all values for which $p$ </span><span class="sc">\&gt;</span><span class="at"> 0.05</span></span>
<span id="cb34-615"><a href="#cb34-615" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; @coxPrinciplesStatisticalInference2006 and hence $s$ </span><span class="sc">\&lt;</span><span class="at"> 4.32 bits</span></span>
<span id="cb34-616"><a href="#cb34-616" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; @greenlandValidPvaluesBehave2019;</span></span>
<span id="cb34-617"><a href="#cb34-617" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; @amrheinInferentialStatisticsDescriptive2019. Thus the CI contains a</span></span>
<span id="cb34-618"><a href="#cb34-618" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; range of parameter values that are more compatible with the data than</span></span>
<span id="cb34-619"><a href="#cb34-619" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; are values outside the interval, under the background assumptions</span></span>
<span id="cb34-620"><a href="#cb34-620" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; @greenlandValidPvaluesBehave2019;</span></span>
<span id="cb34-621"><a href="#cb34-621" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; @greenlandStatisticalTestsValues2016. Unconditionally (and thus even</span></span>
<span id="cb34-622"><a href="#cb34-622" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; if the background assumptions are uncertain), the interval shows the</span></span>
<span id="cb34-623"><a href="#cb34-623" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; values of the parameter which, when combined with the background</span></span>
<span id="cb34-624"><a href="#cb34-624" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; assumptions, produce a test model that is "highly compatible" with the</span></span>
<span id="cb34-625"><a href="#cb34-625" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; data in the sense of having less than 4.32 bits of information against</span></span>
<span id="cb34-626"><a href="#cb34-626" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; it. We thus refer to CI as compatibility intervals rather than</span></span>
<span id="cb34-627"><a href="#cb34-627" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; confidence intervals @greenlandAreConfidenceIntervals2019;</span></span>
<span id="cb34-628"><a href="#cb34-628" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; @greenlandValidPvaluesBehave2019;</span></span>
<span id="cb34-629"><a href="#cb34-629" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; @amrheinInferentialStatisticsDescriptive2019; their abbreviation</span></span>
<span id="cb34-630"><a href="#cb34-630" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; remains "CI." We reject calling these intervals "uncertainty</span></span>
<span id="cb34-631"><a href="#cb34-631" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; intervals," because they do not capture uncertainty about background</span></span>
<span id="cb34-632"><a href="#cb34-632" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; assumptions @greenlandAreConfidenceIntervals2019.</span></span>
<span id="cb34-633"><a href="#cb34-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-634"><a href="#cb34-634" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-635"><a href="#cb34-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-636"><a href="#cb34-636" aria-hidden="true" tabindex="-1"></a>Indeed, this also has to do with our paper on deemphasizing the model</span>
<span id="cb34-637"><a href="#cb34-637" aria-hidden="true" tabindex="-1"></a>assumptions that are often behind common statistical outputs, and why it</span>
<span id="cb34-638"><a href="#cb34-638" aria-hidden="true" tabindex="-1"></a>is necessary to treat them as uncertain, rather than</span>
<span id="cb34-639"><a href="#cb34-639" aria-hidden="true" tabindex="-1"></a>given.<span class="sc">\[</span>@greenlandAidScientificInference2020<span class="sc">\]</span> For example, a 95% interval</span>
<span id="cb34-640"><a href="#cb34-640" aria-hidden="true" tabindex="-1"></a>estimate is assumed to be free of bias in its construction, however,</span>
<span id="cb34-641"><a href="#cb34-641" aria-hidden="true" tabindex="-1"></a>it's coverage claims are no longer so, once there are systematic errors</span>
<span id="cb34-642"><a href="#cb34-642" aria-hidden="true" tabindex="-1"></a>in play. Many of these common, classical statistical procedures are</span>
<span id="cb34-643"><a href="#cb34-643" aria-hidden="true" tabindex="-1"></a>designed to deal with random variation, and less so with bias (a</span>
<span id="cb34-644"><a href="#cb34-644" aria-hidden="true" tabindex="-1"></a>relatively new field, with shiny new methods).</span>
<span id="cb34-645"><a href="#cb34-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-646"><a href="#cb34-646" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-647"><a href="#cb34-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-648"><a href="#cb34-648" aria-hidden="true" tabindex="-1"></a><span class="fu"># Brown et al.&nbsp;(2017) Reanalysis</span></span>
<span id="cb34-649"><a href="#cb34-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-650"><a href="#cb34-650" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-651"><a href="#cb34-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-652"><a href="#cb34-652" aria-hidden="true" tabindex="-1"></a>Taken from the [Brown et al.</span>
<span id="cb34-653"><a href="#cb34-653" aria-hidden="true" tabindex="-1"></a>data.](https://doi.org/10.1001/jama.2017.3415)<span class="sc">\[</span>@brownAssociationSerotonergicAntidepressant2017;</span>
<span id="cb34-654"><a href="#cb34-654" aria-hidden="true" tabindex="-1"></a>@brownAssociationAntenatalExposure2017<span class="sc">\]</span></span>
<span id="cb34-655"><a href="#cb34-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-656"><a href="#cb34-656" aria-hidden="true" tabindex="-1"></a>Here we take the reported statistics from the Brown et al.&nbsp;studies in</span>
<span id="cb34-657"><a href="#cb34-657" aria-hidden="true" tabindex="-1"></a>order to run statistical tests of different alternative test hypotheses</span>
<span id="cb34-658"><a href="#cb34-658" aria-hidden="true" tabindex="-1"></a>and use those results to construct various functions.</span>
<span id="cb34-659"><a href="#cb34-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-660"><a href="#cb34-660" aria-hidden="true" tabindex="-1"></a>We calculate the standard errors from the point estimate and the</span>
<span id="cb34-661"><a href="#cb34-661" aria-hidden="true" tabindex="-1"></a>confidence (compatibility) limits.</span>
<span id="cb34-662"><a href="#cb34-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-663"><a href="#cb34-663" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-664"><a href="#cb34-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-665"><a href="#cb34-665" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-666"><a href="#cb34-666" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fl">2.59</span><span class="sc">/</span><span class="fl">0.997</span>)<span class="sc">/</span><span class="fl">3.92</span></span>
<span id="cb34-667"><a href="#cb34-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-668"><a href="#cb34-668" aria-hidden="true" tabindex="-1"></a>logUL <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fl">2.59</span>)</span>
<span id="cb34-669"><a href="#cb34-669" aria-hidden="true" tabindex="-1"></a>logLL <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fl">0.997</span>)</span>
<span id="cb34-670"><a href="#cb34-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-671"><a href="#cb34-671" aria-hidden="true" tabindex="-1"></a>logpoint <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fl">1.61</span>)</span>
<span id="cb34-672"><a href="#cb34-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-673"><a href="#cb34-673" aria-hidden="true" tabindex="-1"></a>logpoint <span class="sc">+</span> (<span class="fl">1.96</span> <span class="sc">*</span> se)</span>
<span id="cb34-674"><a href="#cb34-674" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.954</span></span>
<span id="cb34-675"><a href="#cb34-675" aria-hidden="true" tabindex="-1"></a>logpoint <span class="sc">-</span> (<span class="fl">1.96</span> <span class="sc">*</span> se)</span>
<span id="cb34-676"><a href="#cb34-676" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.0011</span></span>
<span id="cb34-677"><a href="#cb34-677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-678"><a href="#cb34-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-679"><a href="#cb34-679" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-680"><a href="#cb34-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-681"><a href="#cb34-681" aria-hidden="true" tabindex="-1"></a><span class="fu">## Table 2: $P$-values, $S$-values, and Likelihoods for Targeted Hypotheses About Hazard Ratios for [Brown et al.](https://doi.org/10.1001/jama.2017.3415)</span></span>
<span id="cb34-682"><a href="#cb34-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-683"><a href="#cb34-683" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-684"><a href="#cb34-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-685"><a href="#cb34-685" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-686"><a href="#cb34-686" aria-hidden="true" tabindex="-1"></a>testhypothesis <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Halving of hazard"</span>, <span class="st">"No effect (null)"</span>,</span>
<span id="cb34-687"><a href="#cb34-687" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Point estimate"</span>, <span class="st">"Doubling of hazard"</span>, <span class="st">"Tripling of hazard"</span>,</span>
<span id="cb34-688"><a href="#cb34-688" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Quintupling of hazard"</span>)</span>
<span id="cb34-689"><a href="#cb34-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-690"><a href="#cb34-690" aria-hidden="true" tabindex="-1"></a>hazardratios <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">1.61</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb34-691"><a href="#cb34-691" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.6e-06</span>, <span class="fl">0.05</span>, <span class="dv">1</span>, <span class="fl">0.37</span>, <span class="fl">0.01</span>, <span class="fl">3.2e-06</span>)</span>
<span id="cb34-692"><a href="#cb34-692" aria-hidden="true" tabindex="-1"></a>svals <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="sc">-</span><span class="fu">log2</span>(pvals), <span class="dv">2</span>)</span>
<span id="cb34-693"><a href="#cb34-693" aria-hidden="true" tabindex="-1"></a>mlr2 <span class="ot">&lt;-</span> <span class="fu">c</span>((<span class="dv">1</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>), <span class="fl">6.77</span>, <span class="dv">1</span>, <span class="fl">1.49</span>, <span class="fl">26.2</span>, (<span class="dv">5</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb34-694"><a href="#cb34-694" aria-hidden="true" tabindex="-1"></a>lr <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">exp</span>((((<span class="fu">log</span>(<span class="fl">0.5</span><span class="sc">/</span><span class="fl">1.61</span>))<span class="sc">/</span>se)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span>)), <span class="fu">exp</span>((((<span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">1.61</span>))<span class="sc">/</span>se)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span>)),</span>
<span id="cb34-695"><a href="#cb34-695" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>((((<span class="fu">log</span>(<span class="fl">1.61</span><span class="sc">/</span><span class="fl">1.61</span>))<span class="sc">/</span>se)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span>)), <span class="fu">exp</span>((((<span class="fu">log</span>(<span class="dv">2</span><span class="sc">/</span><span class="fl">1.61</span>))<span class="sc">/</span>se)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span>)),</span>
<span id="cb34-696"><a href="#cb34-696" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>((((<span class="fu">log</span>(<span class="dv">3</span><span class="sc">/</span><span class="fl">1.61</span>))<span class="sc">/</span>se)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span>)), <span class="fu">exp</span>((((<span class="fu">log</span>(<span class="dv">5</span><span class="sc">/</span><span class="fl">1.61</span>))<span class="sc">/</span>se)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span>))),</span>
<span id="cb34-697"><a href="#cb34-697" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>)</span>
<span id="cb34-698"><a href="#cb34-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-699"><a href="#cb34-699" aria-hidden="true" tabindex="-1"></a>LR <span class="ot">&lt;-</span> <span class="fu">formatC</span>(lr, <span class="at">format =</span> <span class="st">"e"</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb34-700"><a href="#cb34-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-701"><a href="#cb34-701" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(testhypothesis, hazardratios, pvals, svals,</span>
<span id="cb34-702"><a href="#cb34-702" aria-hidden="true" tabindex="-1"></a>    mlr2, LR)</span>
<span id="cb34-703"><a href="#cb34-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-704"><a href="#cb34-704" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Test Hypothesis"</span>, <span class="st">"HR"</span>, <span class="st">"P-values"</span>, <span class="st">"S-values"</span>,</span>
<span id="cb34-705"><a href="#cb34-705" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MLR"</span>, <span class="st">"LR"</span>)</span>
<span id="cb34-706"><a href="#cb34-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-707"><a href="#cb34-707" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(table2, <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">padding =</span> <span class="dv">45</span>, <span class="at">longtable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-708"><a href="#cb34-708" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#777"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-709"><a href="#cb34-709" aria-hidden="true" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="at">row =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#777"</span>, <span class="at">bold =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb34-710"><a href="#cb34-710" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="at">column =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">color =</span> <span class="st">"#777"</span>, <span class="at">bold =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb34-711"><a href="#cb34-711" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>, <span class="at">lightable_options =</span> <span class="st">"basic"</span>,</span>
<span id="cb34-712"><a href="#cb34-712" aria-hidden="true" tabindex="-1"></a>        <span class="at">font_size =</span> <span class="dv">15</span>, <span class="at">fixed_thead =</span> <span class="fu">list</span>(<span class="at">enabled =</span> F))</span>
<span id="cb34-713"><a href="#cb34-713" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-714"><a href="#cb34-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-715"><a href="#cb34-715" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Test Hypothesis       <span class="pp">|</span>   HR <span class="pp">|</span> P-values <span class="pp">|</span> S-values <span class="pp">|</span>      MLR <span class="pp">|</span> LR       <span class="pp">|</span></span>
<span id="cb34-716"><a href="#cb34-716" aria-hidden="true" tabindex="-1"></a><span class="pp">|:----------------------|-----:|---------:|---------:|---------:|:---------|</span></span>
<span id="cb34-717"><a href="#cb34-717" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Halving of hazard     <span class="pp">|</span> 0.50 <span class="pp">|</span>     0.00 <span class="pp">|</span>    19.25 <span class="pp">|</span> 1.00e+05 <span class="pp">|</span> 1.02e+05 <span class="pp">|</span></span>
<span id="cb34-718"><a href="#cb34-718" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> No effect (null)      <span class="pp">|</span> 1.00 <span class="pp">|</span>     0.05 <span class="pp">|</span>     4.32 <span class="pp">|</span> 6.77e+00 <span class="pp">|</span> 6.77e+00 <span class="pp">|</span></span>
<span id="cb34-719"><a href="#cb34-719" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Point estimate        <span class="pp">|</span> 1.61 <span class="pp">|</span>     1.00 <span class="pp">|</span>     0.00 <span class="pp">|</span> 1.00e+00 <span class="pp">|</span> 1.00e+00 <span class="pp">|</span></span>
<span id="cb34-720"><a href="#cb34-720" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Doubling of hazard    <span class="pp">|</span> 2.00 <span class="pp">|</span>     0.37 <span class="pp">|</span>     1.43 <span class="pp">|</span> 1.49e+00 <span class="pp">|</span> 1.49e+00 <span class="pp">|</span></span>
<span id="cb34-721"><a href="#cb34-721" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Tripling of hazard    <span class="pp">|</span> 3.00 <span class="pp">|</span>     0.01 <span class="pp">|</span>     6.64 <span class="pp">|</span> 2.62e+01 <span class="pp">|</span> 2.62e+01 <span class="pp">|</span></span>
<span id="cb34-722"><a href="#cb34-722" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Quintupling of hazard <span class="pp">|</span> 5.00 <span class="pp">|</span>     0.00 <span class="pp">|</span>    18.25 <span class="pp">|</span> 5.00e+04 <span class="pp">|</span> 5.03e+04 <span class="pp">|</span></span>
<span id="cb34-723"><a href="#cb34-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-724"><a href="#cb34-724" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-725"><a href="#cb34-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-726"><a href="#cb34-726" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot the point estimate and 95% compatibility interval</span></span>
<span id="cb34-727"><a href="#cb34-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-728"><a href="#cb34-728" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-729"><a href="#cb34-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-730"><a href="#cb34-730" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-731"><a href="#cb34-731" aria-hidden="true" tabindex="-1"></a>label <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Brown et al. (2017)</span><span class="sc">\n</span><span class="st"> JAMA"</span>, <span class="st">"Brown et al. (2017)</span><span class="sc">\n</span><span class="st"> J Clin Psychiatry"</span>)</span>
<span id="cb34-732"><a href="#cb34-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-733"><a href="#cb34-733" aria-hidden="true" tabindex="-1"></a>point <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.61</span>, <span class="fl">1.7</span>)</span>
<span id="cb34-734"><a href="#cb34-734" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.997</span>, <span class="fl">1.1</span>)</span>
<span id="cb34-735"><a href="#cb34-735" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.59</span>, <span class="fl">2.6</span>)</span>
<span id="cb34-736"><a href="#cb34-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-737"><a href="#cb34-737" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(label, point, lower, upper)</span>
<span id="cb34-738"><a href="#cb34-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-739"><a href="#cb34-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-740"><a href="#cb34-740" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-741"><a href="#cb34-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-742"><a href="#cb34-742" aria-hidden="true" tabindex="-1"></a>Here we plot the 95% compatibility interval estimate reported from the</span>
<span id="cb34-743"><a href="#cb34-743" aria-hidden="true" tabindex="-1"></a>high-dimensional propensity score analysis.</span>
<span id="cb34-744"><a href="#cb34-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-745"><a href="#cb34-745" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-746"><a href="#cb34-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-747"><a href="#cb34-747" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-748"><a href="#cb34-748" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> label, <span class="at">y =</span> point, <span class="at">ymin =</span> lower,</span>
<span id="cb34-749"><a href="#cb34-749" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> upper, <span class="at">group =</span> label)) <span class="sc">+</span> <span class="fu">geom_pointrange</span>(<span class="at">color =</span> <span class="st">"#007C7C"</span>,</span>
<span id="cb34-750"><a href="#cb34-750" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>,</span>
<span id="cb34-751"><a href="#cb34-751" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#d46c5b"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">10</span>),</span>
<span id="cb34-752"><a href="#cb34-752" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Association Between Serotonergic Antidepressant Exposure </span></span>
<span id="cb34-753"><a href="#cb34-753" aria-hidden="true" tabindex="-1"></a><span class="st">               </span><span class="sc">\n</span><span class="st">During Pregnancy and Child Autism Spectrum Disorder"</span>,</span>
<span id="cb34-754"><a href="#cb34-754" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Reported 95% Compatibility Intervals From Primary Results"</span>,</span>
<span id="cb34-755"><a href="#cb34-755" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Study"</span>, <span class="at">y =</span> <span class="st">"Hazard Ratio (JAMA) + </span></span>
<span id="cb34-756"><a href="#cb34-756" aria-hidden="true" tabindex="-1"></a><span class="st">            Adjusted Pooled Odds Ratio (J Clin Psychiatry)"</span>) <span class="sc">+</span></span>
<span id="cb34-757"><a href="#cb34-757" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">label =</span> <span class="st">"Null parameter value of 1"</span>,</span>
<span id="cb34-758"><a href="#cb34-758" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"#d46c5b"</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb34-759"><a href="#cb34-759" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">2.2</span>, <span class="at">y =</span> <span class="fl">1.8</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">label =</span> <span class="st">"Point Estimate = 1.61, </span></span>
<span id="cb34-760"><a href="#cb34-760" aria-hidden="true" tabindex="-1"></a><span class="st">           Lower Limit = 0.997, Upper Limit = 2.59"</span>,</span>
<span id="cb34-761"><a href="#cb34-761" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#000000"</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb34-762"><a href="#cb34-762" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> <span class="fl">1.8</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">label =</span> <span class="st">"Point Estimate = 1.7, </span></span>
<span id="cb34-763"><a href="#cb34-763" aria-hidden="true" tabindex="-1"></a><span class="st">           Lower Limit = 1.1, Upper Limit = 2.6"</span>,</span>
<span id="cb34-764"><a href="#cb34-764" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#000000"</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb34-765"><a href="#cb34-765" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">13</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>)) <span class="sc">+</span></span>
<span id="cb34-766"><a href="#cb34-766" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>))</span>
<span id="cb34-767"><a href="#cb34-767" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-768"><a href="#cb34-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-769"><a href="#cb34-769" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-16-1.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"768"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-770"><a href="#cb34-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-771"><a href="#cb34-771" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-772"><a href="#cb34-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-773"><a href="#cb34-773" aria-hidden="true" tabindex="-1"></a>Once again, the authors reported</span>
<span id="cb34-774"><a href="#cb34-774" aria-hidden="true" tabindex="-1"></a>that<span class="sc">\[</span>@brownAssociationSerotonergicAntidepressant2017<span class="sc">\]</span></span>
<span id="cb34-775"><a href="#cb34-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-776"><a href="#cb34-776" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In the 2837 pregnancies (7.9%) exposed to antidepressants, 2.0% (95%</span></span>
<span id="cb34-777"><a href="#cb34-777" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; CI, 1.6%-2.6%) of children were diagnosed with autism spectrum</span></span>
<span id="cb34-778"><a href="#cb34-778" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; disorder. Risk of autism spectrum disorder was significantly higher</span></span>
<span id="cb34-779"><a href="#cb34-779" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; with serotonergic antidepressant exposure (4.51 exposed vs 2.03</span></span>
<span id="cb34-780"><a href="#cb34-780" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; unexposed per 1000 person-years; between-group difference, 2.48 95%</span></span>
<span id="cb34-781"><a href="#cb34-781" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; CI, 2.33-2.62 per 1000 person-years) in crude (HR, 2.16 95% CI,</span></span>
<span id="cb34-782"><a href="#cb34-782" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 1.64-2.86) and multivariable-adjusted analyses (HR, 1.59 95% CI,</span></span>
<span id="cb34-783"><a href="#cb34-783" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 1.17-2.17) (Table 2). After inverse probability of treatment weighting</span></span>
<span id="cb34-784"><a href="#cb34-784" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; based on the HDPS, the association was not significant (HR, 1.61 95%</span></span>
<span id="cb34-785"><a href="#cb34-785" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; CI, 0.997-2.59) (Table 2).</span></span>
<span id="cb34-786"><a href="#cb34-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-787"><a href="#cb34-787" aria-hidden="true" tabindex="-1"></a>and concluded with</span>
<span id="cb34-788"><a href="#cb34-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-789"><a href="#cb34-789" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In children born to mothers receiving public drug coverage in Ontario,</span></span>
<span id="cb34-790"><a href="#cb34-790" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Canada, in utero serotonergic antidepressant exposure compared with no</span></span>
<span id="cb34-791"><a href="#cb34-791" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; exposure was not associated with autism spectrum disorder in the</span></span>
<span id="cb34-792"><a href="#cb34-792" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; child. Although a causal relationship cannot be ruled out, the</span></span>
<span id="cb34-793"><a href="#cb34-793" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; previously observed association may be explained by other factors.</span></span>
<span id="cb34-794"><a href="#cb34-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-795"><a href="#cb34-795" aria-hidden="true" tabindex="-1"></a>We will show using the graphical and tabular summaries below, why a more</span>
<span id="cb34-796"><a href="#cb34-796" aria-hidden="true" tabindex="-1"></a>nuanced summary such as,</span>
<span id="cb34-797"><a href="#cb34-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-798"><a href="#cb34-798" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "After HDPS adjustment for confounding, a 61% hazard elevation</span></span>
<span id="cb34-799"><a href="#cb34-799" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; remained; however, under the same model, every hypothesis from no</span></span>
<span id="cb34-800"><a href="#cb34-800" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; elevation up to a 160% hazard increase had $p$ </span><span class="sc">\&gt;</span><span class="at"> 0.05; Thus, while</span></span>
<span id="cb34-801"><a href="#cb34-801" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; quite imprecise, these results are consistent with previous</span></span>
<span id="cb34-802"><a href="#cb34-802" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; observations of a positive association between serotonergic</span></span>
<span id="cb34-803"><a href="#cb34-803" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; antidepressant prescriptions and subsequent ASD. Because the</span></span>
<span id="cb34-804"><a href="#cb34-804" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; association may be partially or wholly due to uncontrolled biases,</span></span>
<span id="cb34-805"><a href="#cb34-805" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; further evidence will be needed for evaluating what, if any,</span></span>
<span id="cb34-806"><a href="#cb34-806" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; proportion of it can be attributed to causal effects of prenatal</span></span>
<span id="cb34-807"><a href="#cb34-807" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; serotonergic antidepressant use on ASD incidence."</span></span>
<span id="cb34-808"><a href="#cb34-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-809"><a href="#cb34-809" aria-hidden="true" tabindex="-1"></a>would have been far more appropriate, as we discuss in our</span>
<span id="cb34-810"><a href="#cb34-810" aria-hidden="true" tabindex="-1"></a>paper.<span class="sc">\[</span>@rafiSemanticCognitiveTools2020<span class="sc">\]</span></span>
<span id="cb34-811"><a href="#cb34-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-812"><a href="#cb34-812" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-813"><a href="#cb34-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-814"><a href="#cb34-814" aria-hidden="true" tabindex="-1"></a><span class="fu">## $P$-value and $S$-value Functions</span></span>
<span id="cb34-815"><a href="#cb34-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-816"><a href="#cb34-816" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-817"><a href="#cb34-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-818"><a href="#cb34-818" aria-hidden="true" tabindex="-1"></a>In order to use this information to construct a $P$-value function, we</span>
<span id="cb34-819"><a href="#cb34-819" aria-hidden="true" tabindex="-1"></a>can use the <span class="co">[</span><span class="ot">`concurve`</span><span class="co">](https://data.lesslikely.com/concurve/)</span></span>
<span id="cb34-820"><a href="#cb34-820" aria-hidden="true" tabindex="-1"></a>functions.</span>
<span id="cb34-821"><a href="#cb34-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-822"><a href="#cb34-822" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-823"><a href="#cb34-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-824"><a href="#cb34-824" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-825"><a href="#cb34-825" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"concurve"</span>)</span>
<span id="cb34-826"><a href="#cb34-826" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-827"><a href="#cb34-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-828"><a href="#cb34-828" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-829"><a href="#cb34-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-830"><a href="#cb34-830" aria-hidden="true" tabindex="-1"></a>We enter the reported point estimates and compatibility limits and</span>
<span id="cb34-831"><a href="#cb34-831" aria-hidden="true" tabindex="-1"></a>produce all possible intervals + $P$-values + $S$-values. This is</span>
<span id="cb34-832"><a href="#cb34-832" aria-hidden="true" tabindex="-1"></a>calculated assuming normal approximations with the</span>
<span id="cb34-833"><a href="#cb34-833" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`curve_rev()`</span><span class="co">](https://data.lesslikely.com/concurve/reference/curve_rev.html)</span></span>
<span id="cb34-834"><a href="#cb34-834" aria-hidden="true" tabindex="-1"></a>function.</span>
<span id="cb34-835"><a href="#cb34-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-836"><a href="#cb34-836" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-837"><a href="#cb34-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-838"><a href="#cb34-838" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-839"><a href="#cb34-839" aria-hidden="true" tabindex="-1"></a>curve1 <span class="ot">&lt;-</span> <span class="fu">curve_rev</span>(<span class="at">point =</span> <span class="fl">1.61</span>, <span class="at">LL =</span> <span class="fl">0.997</span>, <span class="at">UL =</span> <span class="fl">2.59</span>, <span class="at">measure =</span> <span class="st">"ratio"</span>)</span>
<span id="cb34-840"><a href="#cb34-840" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-841"><a href="#cb34-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-842"><a href="#cb34-842" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-843"><a href="#cb34-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-844"><a href="#cb34-844" aria-hidden="true" tabindex="-1"></a>It is stored in the object <span class="in">`curve1`</span>.</span>
<span id="cb34-845"><a href="#cb34-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-846"><a href="#cb34-846" aria-hidden="true" tabindex="-1"></a>We can generate a table of the relevant statistics from this reanalysis,</span>
<span id="cb34-847"><a href="#cb34-847" aria-hidden="true" tabindex="-1"></a>similar to the table from above, but this time using the</span>
<span id="cb34-848"><a href="#cb34-848" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`concurve`</span><span class="co">](https://data.lesslikely.com/concurve/index.html)</span> function,</span>
<span id="cb34-849"><a href="#cb34-849" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`curve_table()`</span><span class="co">](https://data.lesslikely.com/concurve/reference/curve_table.html)</span>,</span>
<span id="cb34-850"><a href="#cb34-850" aria-hidden="true" tabindex="-1"></a>but this time it will give us interval estimates of various percentiles</span>
<span id="cb34-851"><a href="#cb34-851" aria-hidden="true" tabindex="-1"></a>($25$%, $50$%, $75$%, $95$%, etc.). These are in turn used to construct</span>
<span id="cb34-852"><a href="#cb34-852" aria-hidden="true" tabindex="-1"></a>the entire confidence (compatibility) distribution or $P$-value</span>
<span id="cb34-853"><a href="#cb34-853" aria-hidden="true" tabindex="-1"></a>function.</span>
<span id="cb34-854"><a href="#cb34-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-855"><a href="#cb34-855" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-856"><a href="#cb34-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-857"><a href="#cb34-857" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-858"><a href="#cb34-858" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(<span class="fu">curve_table</span>(curve1[[<span class="dv">1</span>]]), <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">padding =</span> <span class="dv">45</span>,</span>
<span id="cb34-859"><a href="#cb34-859" aria-hidden="true" tabindex="-1"></a>    <span class="at">longtable =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#777"</span>, <span class="at">row.names =</span> F, <span class="at">col.names =</span> <span class="fu">colnames</span>(<span class="fu">curve_table</span>(curve1[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span></span>
<span id="cb34-860"><a href="#cb34-860" aria-hidden="true" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="at">row =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#777"</span>, <span class="at">bold =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb34-861"><a href="#cb34-861" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="at">column =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">color =</span> <span class="st">"#777"</span>, <span class="at">bold =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb34-862"><a href="#cb34-862" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>, <span class="at">lightable_options =</span> <span class="st">"basic"</span>,</span>
<span id="cb34-863"><a href="#cb34-863" aria-hidden="true" tabindex="-1"></a>        <span class="at">font_size =</span> <span class="dv">17</span>, <span class="at">fixed_thead =</span> <span class="fu">list</span>(<span class="at">enabled =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb34-864"><a href="#cb34-864" aria-hidden="true" tabindex="-1"></a>    <span class="fu">footnote</span>(<span class="at">general_title =</span> <span class="fu">c</span>(<span class="st">"Table of Statistics for Various Interval Estimate Percentiles"</span>),</span>
<span id="cb34-865"><a href="#cb34-865" aria-hidden="true" tabindex="-1"></a>        <span class="at">general =</span> <span class="st">" "</span>)</span>
<span id="cb34-866"><a href="#cb34-866" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-867"><a href="#cb34-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-868"><a href="#cb34-868" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Lower Limit <span class="pp">|</span> Upper Limit <span class="pp">|</span> Interval Width <span class="pp">|</span> Interval Level (%) <span class="pp">|</span> CDF <span class="pp">|</span> P-value <span class="pp">|</span> S-value (bits) <span class="pp">|</span></span>
<span id="cb34-869"><a href="#cb34-869" aria-hidden="true" tabindex="-1"></a><span class="pp">|---:|---:|---:|---:|---:|---:|---:|</span></span>
<span id="cb34-870"><a href="#cb34-870" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1.490 <span class="pp">|</span> 1.74 <span class="pp">|</span> 0.250 <span class="pp">|</span> 25.0 <span class="pp">|</span> 0.625 <span class="pp">|</span> 0.750 <span class="pp">|</span> 0.415 <span class="pp">|</span></span>
<span id="cb34-871"><a href="#cb34-871" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1.366 <span class="pp">|</span> 1.90 <span class="pp">|</span> 0.531 <span class="pp">|</span> 50.0 <span class="pp">|</span> 0.750 <span class="pp">|</span> 0.500 <span class="pp">|</span> 1.000 <span class="pp">|</span></span>
<span id="cb34-872"><a href="#cb34-872" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1.217 <span class="pp">|</span> 2.13 <span class="pp">|</span> 0.914 <span class="pp">|</span> 75.0 <span class="pp">|</span> 0.875 <span class="pp">|</span> 0.250 <span class="pp">|</span> 2.000 <span class="pp">|</span></span>
<span id="cb34-873"><a href="#cb34-873" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1.178 <span class="pp">|</span> 2.20 <span class="pp">|</span> 1.021 <span class="pp">|</span> 80.0 <span class="pp">|</span> 0.900 <span class="pp">|</span> 0.200 <span class="pp">|</span> 2.322 <span class="pp">|</span></span>
<span id="cb34-874"><a href="#cb34-874" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1.134 <span class="pp">|</span> 2.29 <span class="pp">|</span> 1.152 <span class="pp">|</span> 85.0 <span class="pp">|</span> 0.925 <span class="pp">|</span> 0.150 <span class="pp">|</span> 2.737 <span class="pp">|</span></span>
<span id="cb34-875"><a href="#cb34-875" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1.079 <span class="pp">|</span> 2.40 <span class="pp">|</span> 1.325 <span class="pp">|</span> 90.0 <span class="pp">|</span> 0.950 <span class="pp">|</span> 0.100 <span class="pp">|</span> 3.322 <span class="pp">|</span></span>
<span id="cb34-876"><a href="#cb34-876" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0.999 <span class="pp">|</span> 2.60 <span class="pp">|</span> 1.596 <span class="pp">|</span> 95.0 <span class="pp">|</span> 0.975 <span class="pp">|</span> 0.050 <span class="pp">|</span> 4.322 <span class="pp">|</span></span>
<span id="cb34-877"><a href="#cb34-877" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0.933 <span class="pp">|</span> 2.78 <span class="pp">|</span> 1.846 <span class="pp">|</span> 97.5 <span class="pp">|</span> 0.988 <span class="pp">|</span> 0.025 <span class="pp">|</span> 5.322 <span class="pp">|</span></span>
<span id="cb34-878"><a href="#cb34-878" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0.860 <span class="pp">|</span> 3.02 <span class="pp">|</span> 2.155 <span class="pp">|</span> 99.0 <span class="pp">|</span> 0.995 <span class="pp">|</span> 0.010 <span class="pp">|</span> 6.644 <span class="pp">|</span></span>
<span id="cb34-879"><a href="#cb34-879" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="dt">&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"font-style: italic;"</span><span class="dt">&gt;</span>Table of Statistics for Various Interval Estimate Percentiles<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span> <span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span></span>
<span id="cb34-880"><a href="#cb34-880" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span></span>
<span id="cb34-881"><a href="#cb34-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-882"><a href="#cb34-882" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-883"><a href="#cb34-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-884"><a href="#cb34-884" aria-hidden="true" tabindex="-1"></a><span class="fu">## Figure 3: $P$-value (Compatibility) Function</span></span>
<span id="cb34-885"><a href="#cb34-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-886"><a href="#cb34-886" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-887"><a href="#cb34-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-888"><a href="#cb34-888" aria-hidden="true" tabindex="-1"></a>Plot the $P$-value (Compatibility) function of the [Brown et</span>
<span id="cb34-889"><a href="#cb34-889" aria-hidden="true" tabindex="-1"></a>al.](https://doi.org/10.1001/jama.2017.3415) data</span>
<span id="cb34-890"><a href="#cb34-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-891"><a href="#cb34-891" aria-hidden="true" tabindex="-1"></a>Now we plot the $P$-value function from the data stored in <span class="in">`curve1`</span></span>
<span id="cb34-892"><a href="#cb34-892" aria-hidden="true" tabindex="-1"></a>using the</span>
<span id="cb34-893"><a href="#cb34-893" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`ggcurve()`</span><span class="co">](https://data.lesslikely.com/concurve/reference/ggcurve.html)</span></span>
<span id="cb34-894"><a href="#cb34-894" aria-hidden="true" tabindex="-1"></a>function from <span class="co">[</span><span class="ot">`concurve`</span><span class="co">](https://data.lesslikely.com/concurve/)</span>.</span>
<span id="cb34-895"><a href="#cb34-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-896"><a href="#cb34-896" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-897"><a href="#cb34-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-898"><a href="#cb34-898" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-899"><a href="#cb34-899" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcurve</span>(curve1[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">"c"</span>, <span class="at">measure =</span> <span class="st">"ratio"</span>, <span class="at">nullvalue =</span> <span class="fu">c</span>(<span class="dv">1</span>),</span>
<span id="cb34-900"><a href="#cb34-900" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(P),</span>
<span id="cb34-901"><a href="#cb34-901" aria-hidden="true" tabindex="-1"></a>    <span class="st">"-value (Compatibility) Function"</span>)), <span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(P),</span>
<span id="cb34-902"><a href="#cb34-902" aria-hidden="true" tabindex="-1"></a>    <span class="st">"-values for a range of hazard ratios (HR)"</span>)), <span class="at">x =</span> <span class="st">"Hazard Ratio (HR)"</span>,</span>
<span id="cb34-903"><a href="#cb34-903" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(P), <span class="st">"-value"</span>))) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">1.61</span>,</span>
<span id="cb34-904"><a href="#cb34-904" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">2.59</span>,</span>
<span id="cb34-905"><a href="#cb34-905" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-906"><a href="#cb34-906" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-907"><a href="#cb34-907" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span>
<span id="cb34-908"><a href="#cb34-908" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-909"><a href="#cb34-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-910"><a href="#cb34-910" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-20-1.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"672"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-911"><a href="#cb34-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-912"><a href="#cb34-912" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-913"><a href="#cb34-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-914"><a href="#cb34-914" aria-hidden="true" tabindex="-1"></a>It is practically the same as the published version from [Rafi &amp;</span>
<span id="cb34-915"><a href="#cb34-915" aria-hidden="true" tabindex="-1"></a>Greenland, 2020](https://doi.org/10.1186/s12874-020-01105-9)</span>
<span id="cb34-916"><a href="#cb34-916" aria-hidden="true" tabindex="-1"></a>@rafiSemanticCognitiveTools2020.</span>
<span id="cb34-917"><a href="#cb34-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-918"><a href="#cb34-918" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-919"><a href="#cb34-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-920"><a href="#cb34-920" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"https://res.cloudinary.com/less-likely/image/upload/v1602038429/Site/confidencecurve.svg"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"750"</span><span class="dt">/&gt;</span></span>
<span id="cb34-921"><a href="#cb34-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-922"><a href="#cb34-922" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-923"><a href="#cb34-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-924"><a href="#cb34-924" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-925"><a href="#cb34-925" aria-hidden="true" tabindex="-1"></a>curve1 <span class="ot">&lt;-</span> <span class="fu">curve_rev</span>(<span class="at">point =</span> <span class="fl">1.61</span>, <span class="at">LL =</span> <span class="fl">0.997</span>, <span class="at">UL =</span> <span class="fl">2.59</span>, <span class="at">measure =</span> <span class="st">"ratio"</span>)</span>
<span id="cb34-926"><a href="#cb34-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-927"><a href="#cb34-927" aria-hidden="true" tabindex="-1"></a>curve2 <span class="ot">&lt;-</span> <span class="fu">curve_rev</span>(<span class="at">point =</span> <span class="fl">1.7</span>, <span class="at">LL =</span> <span class="fl">1.1</span>, <span class="at">UL =</span> <span class="fl">2.6</span>, <span class="at">measure =</span> <span class="st">"ratio"</span>)</span>
<span id="cb34-928"><a href="#cb34-928" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-929"><a href="#cb34-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-930"><a href="#cb34-930" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-931"><a href="#cb34-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-932"><a href="#cb34-932" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cumulative Confidence (Compatibility Distribution)</span></span>
<span id="cb34-933"><a href="#cb34-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-934"><a href="#cb34-934" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-935"><a href="#cb34-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-936"><a href="#cb34-936" aria-hidden="true" tabindex="-1"></a>Although we do not cover this figure in our paper, it is easy to</span>
<span id="cb34-937"><a href="#cb34-937" aria-hidden="true" tabindex="-1"></a>construct using</span>
<span id="cb34-938"><a href="#cb34-938" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`concurve's`</span><span class="co">](https://data.lesslikely.com/concurve/index.html)</span></span>
<span id="cb34-939"><a href="#cb34-939" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`ggcurve()`</span><span class="co">](https://data.lesslikely.com/concurve/reference/ggcurve.html)</span></span>
<span id="cb34-940"><a href="#cb34-940" aria-hidden="true" tabindex="-1"></a>function by specifying <span class="in">`type`</span> as "<span class="in">`cdf`</span>" to see the median estimate</span>
<span id="cb34-941"><a href="#cb34-941" aria-hidden="true" tabindex="-1"></a>within the confidence distribution. The horizontal line that meets at</span>
<span id="cb34-942"><a href="#cb34-942" aria-hidden="true" tabindex="-1"></a>the curve, is approximately the same as the maximum at the $P$-value</span>
<span id="cb34-943"><a href="#cb34-943" aria-hidden="true" tabindex="-1"></a>function/confidence (compatibility) curve.</span>
<span id="cb34-944"><a href="#cb34-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-945"><a href="#cb34-945" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-946"><a href="#cb34-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-947"><a href="#cb34-947" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-948"><a href="#cb34-948" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcurve</span>(curve1[[<span class="dv">2</span>]], <span class="at">type =</span> <span class="st">"cdf"</span>, <span class="at">measure =</span> <span class="st">"ratio"</span>, <span class="at">nullvalue =</span> <span class="fu">c</span>(<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb34-949"><a href="#cb34-949" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"P-values for a range of hazard ratios (HR)"</span>,</span>
<span id="cb34-950"><a href="#cb34-950" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"Association Between Serotonergic Antidepressant Exposure </span></span>
<span id="cb34-951"><a href="#cb34-951" aria-hidden="true" tabindex="-1"></a><span class="st">       </span><span class="sc">\n</span><span class="st">During Pregnancy and Child Autism Spectrum Disorder"</span>,</span>
<span id="cb34-952"><a href="#cb34-952" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Hazard Ratio (HR)"</span>, <span class="at">y =</span> <span class="st">"Cumulative Compatibility"</span>) <span class="sc">+</span></span>
<span id="cb34-953"><a href="#cb34-953" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb34-954"><a href="#cb34-954" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-955"><a href="#cb34-955" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span>
<span id="cb34-956"><a href="#cb34-956" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-957"><a href="#cb34-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-958"><a href="#cb34-958" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-22-1.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"768"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-959"><a href="#cb34-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-960"><a href="#cb34-960" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-961"><a href="#cb34-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-962"><a href="#cb34-962" aria-hidden="true" tabindex="-1"></a>We will also calculate the likelihoods so that we can generate the</span>
<span id="cb34-963"><a href="#cb34-963" aria-hidden="true" tabindex="-1"></a>corresponding likelihood functions.</span>
<span id="cb34-964"><a href="#cb34-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-965"><a href="#cb34-965" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-966"><a href="#cb34-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-967"><a href="#cb34-967" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-968"><a href="#cb34-968" aria-hidden="true" tabindex="-1"></a>lik2 <span class="ot">&lt;-</span> <span class="fu">curve_rev</span>(<span class="at">point =</span> <span class="fl">1.7</span>, <span class="at">LL =</span> <span class="fl">1.1</span>, <span class="at">UL =</span> <span class="fl">2.6</span>, <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb34-969"><a href="#cb34-969" aria-hidden="true" tabindex="-1"></a>    <span class="at">measure =</span> <span class="st">"ratio"</span>)</span>
<span id="cb34-970"><a href="#cb34-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-971"><a href="#cb34-971" aria-hidden="true" tabindex="-1"></a>lik1 <span class="ot">&lt;-</span> <span class="fu">curve_rev</span>(<span class="at">point =</span> <span class="fl">1.61</span>, <span class="at">LL =</span> <span class="fl">0.997</span>, <span class="at">UL =</span> <span class="fl">2.59</span>, <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb34-972"><a href="#cb34-972" aria-hidden="true" tabindex="-1"></a>    <span class="at">measure =</span> <span class="st">"ratio"</span>)</span>
<span id="cb34-973"><a href="#cb34-973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-974"><a href="#cb34-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-975"><a href="#cb34-975" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-976"><a href="#cb34-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-977"><a href="#cb34-977" aria-hidden="true" tabindex="-1"></a>We can also see how consistent these results are with previous studies</span>
<span id="cb34-978"><a href="#cb34-978" aria-hidden="true" tabindex="-1"></a>conducted by the same research group, given the overlap of the</span>
<span id="cb34-979"><a href="#cb34-979" aria-hidden="true" tabindex="-1"></a>functions, which can be compared using the</span>
<span id="cb34-980"><a href="#cb34-980" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`plot_compare()`</span><span class="co">](https://data.lesslikely.com/concurve/reference/plot_compare.html)</span></span>
<span id="cb34-981"><a href="#cb34-981" aria-hidden="true" tabindex="-1"></a>function. Let's compare the relative likelihood functions from both</span>
<span id="cb34-982"><a href="#cb34-982" aria-hidden="true" tabindex="-1"></a>studies from this research group to see how consistent the results are.</span>
<span id="cb34-983"><a href="#cb34-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-984"><a href="#cb34-984" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-985"><a href="#cb34-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-986"><a href="#cb34-986" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-987"><a href="#cb34-987" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_compare</span>(<span class="at">data1 =</span> lik1[[<span class="dv">1</span>]], <span class="at">data2 =</span> lik2[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">"l1"</span>,</span>
<span id="cb34-988"><a href="#cb34-988" aria-hidden="true" tabindex="-1"></a>    <span class="at">measure =</span> <span class="st">"ratio"</span>, <span class="at">nullvalue =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Brown et al. 2017. J Clin Psychiatry. vs. </span></span>
<span id="cb34-989"><a href="#cb34-989" aria-hidden="true" tabindex="-1"></a><span class="st">              </span><span class="sc">\n</span><span class="st">Brown et al. 2017. JAMA."</span>,</span>
<span id="cb34-990"><a href="#cb34-990" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"J Clin Psychiatry: OR = 1.7, 1/6.83 LI: LL = 1.1, UL = 2.6 </span></span>
<span id="cb34-991"><a href="#cb34-991" aria-hidden="true" tabindex="-1"></a><span class="st">                         </span><span class="sc">\n</span><span class="st">JAMA: HR = 1.61, 1/6.83 LI: LL = 0.997, UL = 2.59"</span>,</span>
<span id="cb34-992"><a href="#cb34-992" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="st">"Hazard Ratio / Odds Ratio"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-993"><a href="#cb34-993" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-994"><a href="#cb34-994" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span>
<span id="cb34-995"><a href="#cb34-995" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-996"><a href="#cb34-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-997"><a href="#cb34-997" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-24-1.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"768"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-998"><a href="#cb34-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-999"><a href="#cb34-999" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1000"><a href="#cb34-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1001"><a href="#cb34-1001" aria-hidden="true" tabindex="-1"></a>and the $P$-value functions.</span>
<span id="cb34-1002"><a href="#cb34-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1003"><a href="#cb34-1003" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1004"><a href="#cb34-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1005"><a href="#cb34-1005" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-1006"><a href="#cb34-1006" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_compare</span>(<span class="at">data1 =</span> curve1[[<span class="dv">1</span>]], <span class="at">data2 =</span> curve2[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">"c"</span>,</span>
<span id="cb34-1007"><a href="#cb34-1007" aria-hidden="true" tabindex="-1"></a>    <span class="at">measure =</span> <span class="st">"ratio"</span>, <span class="at">nullvalue =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Brown et al. 2017. J Clin Psychiatry. vs. </span></span>
<span id="cb34-1008"><a href="#cb34-1008" aria-hidden="true" tabindex="-1"></a><span class="st">              </span><span class="sc">\n</span><span class="st">Brown et al. 2017. JAMA."</span>,</span>
<span id="cb34-1009"><a href="#cb34-1009" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"J Clin Psychiatry: OR = 1.7, 1/6.83 LI: LL = 1.1, UL = 2.6 </span></span>
<span id="cb34-1010"><a href="#cb34-1010" aria-hidden="true" tabindex="-1"></a><span class="st">              </span><span class="sc">\n</span><span class="st">JAMA: HR = 1.61, 1/6.83 LI: LL = 0.997, UL = 2.59"</span>,</span>
<span id="cb34-1011"><a href="#cb34-1011" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="st">"Hazard Ratio / Odds Ratio"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-1012"><a href="#cb34-1012" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-1013"><a href="#cb34-1013" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span>
<span id="cb34-1014"><a href="#cb34-1014" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-1015"><a href="#cb34-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1016"><a href="#cb34-1016" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-25-1.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"768"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-1017"><a href="#cb34-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1018"><a href="#cb34-1018" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1019"><a href="#cb34-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1020"><a href="#cb34-1020" aria-hidden="true" tabindex="-1"></a><span class="fu">## Figure 4: $S$-value (Suprisal) Function</span></span>
<span id="cb34-1021"><a href="#cb34-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1022"><a href="#cb34-1022" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1023"><a href="#cb34-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1024"><a href="#cb34-1024" aria-hidden="true" tabindex="-1"></a>Plot the $S$-value (Surprisal) function of the [Brown et</span>
<span id="cb34-1025"><a href="#cb34-1025" aria-hidden="true" tabindex="-1"></a>al.](https://doi.org/10.1001/jama.2017.3415) data with</span>
<span id="cb34-1026"><a href="#cb34-1026" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`ggcurve()`</span><span class="co">](https://data.lesslikely.com/concurve/reference/ggcurve.html)</span></span>
<span id="cb34-1027"><a href="#cb34-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1028"><a href="#cb34-1028" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1029"><a href="#cb34-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1030"><a href="#cb34-1030" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-1031"><a href="#cb34-1031" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcurve</span>(<span class="at">data =</span> curve1[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">"s"</span>, <span class="at">measure =</span> <span class="st">"ratio"</span>, <span class="at">nullvalue =</span> <span class="fu">c</span>(<span class="dv">1</span>),</span>
<span id="cb34-1032"><a href="#cb34-1032" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"S-value (Surprisal) Function"</span>, <span class="at">subtitle =</span> <span class="st">"S-Values (surprisals) for a range of hazard ratios (HR)"</span>,</span>
<span id="cb34-1033"><a href="#cb34-1033" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="st">"Hazard Ratio"</span>, <span class="at">yaxis1 =</span> <span class="st">"S-value (bits of information)"</span>) <span class="sc">+</span></span>
<span id="cb34-1034"><a href="#cb34-1034" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb34-1035"><a href="#cb34-1035" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-1036"><a href="#cb34-1036" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span>
<span id="cb34-1037"><a href="#cb34-1037" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-1038"><a href="#cb34-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1039"><a href="#cb34-1039" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-26-1.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"576"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-1040"><a href="#cb34-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1041"><a href="#cb34-1041" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1042"><a href="#cb34-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1043"><a href="#cb34-1043" aria-hidden="true" tabindex="-1"></a>which is quite close to the figure from our paper.</span>
<span id="cb34-1044"><a href="#cb34-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1045"><a href="#cb34-1045" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1046"><a href="#cb34-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1047"><a href="#cb34-1047" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"https://res.cloudinary.com/less-likely/image/upload/v1602200052/Site/surprisalcurve.png"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"750"</span><span class="dt">/&gt;</span></span>
<span id="cb34-1048"><a href="#cb34-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1049"><a href="#cb34-1049" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1050"><a href="#cb34-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1051"><a href="#cb34-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">## Likelihood (Support) Functions</span></span>
<span id="cb34-1052"><a href="#cb34-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1053"><a href="#cb34-1053" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1054"><a href="#cb34-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1055"><a href="#cb34-1055" aria-hidden="true" tabindex="-1"></a>Here we provide the code to show how we constructed the likelihood</span>
<span id="cb34-1056"><a href="#cb34-1056" aria-hidden="true" tabindex="-1"></a>functions from our paper, which are the supplementary figures found</span>
<span id="cb34-1057"><a href="#cb34-1057" aria-hidden="true" tabindex="-1"></a>[here</span>
<span id="cb34-1058"><a href="#cb34-1058" aria-hidden="true" tabindex="-1"></a>(S1)](https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM3_ESM.pdf)</span>
<span id="cb34-1059"><a href="#cb34-1059" aria-hidden="true" tabindex="-1"></a>and [here</span>
<span id="cb34-1060"><a href="#cb34-1060" aria-hidden="true" tabindex="-1"></a>(S2)](https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM4_ESM.pdf).</span>
<span id="cb34-1061"><a href="#cb34-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1062"><a href="#cb34-1062" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1063"><a href="#cb34-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1064"><a href="#cb34-1064" aria-hidden="true" tabindex="-1"></a>Calculate and Plot Likelihood (Support) Intervals.</span>
<span id="cb34-1065"><a href="#cb34-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1066"><a href="#cb34-1066" aria-hidden="true" tabindex="-1"></a>Here we use the reported estimates to construct the $Z$-scores and</span>
<span id="cb34-1067"><a href="#cb34-1067" aria-hidden="true" tabindex="-1"></a>standard errors, which are in turn used to compute the likelihoods.</span>
<span id="cb34-1068"><a href="#cb34-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1069"><a href="#cb34-1069" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1070"><a href="#cb34-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1071"><a href="#cb34-1071" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-1072"><a href="#cb34-1072" aria-hidden="true" tabindex="-1"></a>hrvalues <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.65</span>, <span class="at">to =</span> <span class="fl">3.98</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb34-1073"><a href="#cb34-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1074"><a href="#cb34-1074" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fl">2.59</span><span class="sc">/</span><span class="fl">0.997</span>)<span class="sc">/</span><span class="fl">3.92</span></span>
<span id="cb34-1075"><a href="#cb34-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1076"><a href="#cb34-1076" aria-hidden="true" tabindex="-1"></a>zscore <span class="ot">&lt;-</span> <span class="fu">sapply</span>(hrvalues, <span class="cf">function</span>(i) (<span class="fu">log</span>(i<span class="sc">/</span><span class="fl">1.61</span>)<span class="sc">/</span>se))</span>
<span id="cb34-1077"><a href="#cb34-1077" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-1078"><a href="#cb34-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1079"><a href="#cb34-1079" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1080"><a href="#cb34-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1081"><a href="#cb34-1081" aria-hidden="true" tabindex="-1"></a><span class="fu">## Figure S1: Relative Likelihood Function</span></span>
<span id="cb34-1082"><a href="#cb34-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1083"><a href="#cb34-1083" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1084"><a href="#cb34-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1085"><a href="#cb34-1085" aria-hidden="true" tabindex="-1"></a>We then standardize all the likelihoods by their maximum at the</span>
<span id="cb34-1086"><a href="#cb34-1086" aria-hidden="true" tabindex="-1"></a>likelihood function,@jewellStatisticsEpidemiology2003 to produce</span>
<span id="cb34-1087"><a href="#cb34-1087" aria-hidden="true" tabindex="-1"></a>relative likelihoods, likelihood intervals, and their corresponding</span>
<span id="cb34-1088"><a href="#cb34-1088" aria-hidden="true" tabindex="-1"></a>relative likelihood function.<span class="sc">\[</span>@royallStatisticalEvidenceLikelihood1997<span class="sc">\]</span></span>
<span id="cb34-1089"><a href="#cb34-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1090"><a href="#cb34-1090" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1091"><a href="#cb34-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1092"><a href="#cb34-1092" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-1093"><a href="#cb34-1093" aria-hidden="true" tabindex="-1"></a>support <span class="ot">&lt;-</span> <span class="fu">exp</span>((<span class="sc">-</span>zscore<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb34-1094"><a href="#cb34-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1095"><a href="#cb34-1095" aria-hidden="true" tabindex="-1"></a>likfunction <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(hrvalues, zscore, support)</span>
<span id="cb34-1096"><a href="#cb34-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1097"><a href="#cb34-1097" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> likfunction, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hrvalues, <span class="at">y =</span> support)) <span class="sc">+</span></span>
<span id="cb34-1098"><a href="#cb34-1098" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#d46c5b"</span>,</span>
<span id="cb34-1099"><a href="#cb34-1099" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> (<span class="dv">1</span><span class="sc">/</span><span class="fl">6.83</span>), <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb34-1100"><a href="#cb34-1100" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#333333"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> hrvalues,</span>
<span id="cb34-1101"><a href="#cb34-1101" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="fu">min</span>(support), <span class="at">ymax =</span> support), <span class="at">fill =</span> <span class="st">"#d46c5b"</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb34-1102"><a href="#cb34-1102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relative Likelihood Function"</span>, <span class="at">subtitle =</span> <span class="st">"Relative likelihoods for a range of hazard ratios"</span>,</span>
<span id="cb34-1103"><a href="#cb34-1103" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Hazard Ratio (HR)"</span>, <span class="at">y =</span> <span class="st">"Relative Likelihood </span><span class="sc">\n</span><span class="st">1/MLR"</span>) <span class="sc">+</span></span>
<span id="cb34-1104"><a href="#cb34-1104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.65</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="st">"1/6.83 LI = 0.997, 2.59"</span>,</span>
<span id="cb34-1105"><a href="#cb34-1105" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"#000000"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-1106"><a href="#cb34-1106" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-1107"><a href="#cb34-1107" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb34-1108"><a href="#cb34-1108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">10</span>)) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,</span>
<span id="cb34-1109"><a href="#cb34-1109" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0125</span>)), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>))</span>
<span id="cb34-1110"><a href="#cb34-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-1111"><a href="#cb34-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1112"><a href="#cb34-1112" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-28-1.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"672"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-1113"><a href="#cb34-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1114"><a href="#cb34-1114" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1115"><a href="#cb34-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1116"><a href="#cb34-1116" aria-hidden="true" tabindex="-1"></a>The $\frac{1}{6.83}$ likelihood interval corresponds to the 95%</span>
<span id="cb34-1117"><a href="#cb34-1117" aria-hidden="true" tabindex="-1"></a>compatibility interval, as shown by the figure from our paper.</span>
<span id="cb34-1118"><a href="#cb34-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1119"><a href="#cb34-1119" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1120"><a href="#cb34-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1121"><a href="#cb34-1121" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"https://res.cloudinary.com/less-likely/image/upload/v1602200052/Site/relativelikelihood.png"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"750"</span><span class="dt">/&gt;</span></span>
<span id="cb34-1122"><a href="#cb34-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1123"><a href="#cb34-1123" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1124"><a href="#cb34-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1125"><a href="#cb34-1125" aria-hidden="true" tabindex="-1"></a>Below we use the calculated $Z$-scores to construct the log-likelihood</span>
<span id="cb34-1126"><a href="#cb34-1126" aria-hidden="true" tabindex="-1"></a>function which is the upward-concave parabola $\frac{Z^{2}}{2}$ =</span>
<span id="cb34-1127"><a href="#cb34-1127" aria-hidden="true" tabindex="-1"></a>$-ln(MLR)$</span>
<span id="cb34-1128"><a href="#cb34-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1129"><a href="#cb34-1129" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1130"><a href="#cb34-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1131"><a href="#cb34-1131" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-1132"><a href="#cb34-1132" aria-hidden="true" tabindex="-1"></a>support <span class="ot">&lt;-</span> (zscore<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb34-1133"><a href="#cb34-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1134"><a href="#cb34-1134" aria-hidden="true" tabindex="-1"></a>likfunction <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(hrvalues, zscore, support)</span>
<span id="cb34-1135"><a href="#cb34-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1136"><a href="#cb34-1136" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> likfunction, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hrvalues, <span class="at">y =</span> support)) <span class="sc">+</span></span>
<span id="cb34-1137"><a href="#cb34-1137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#d46c5b"</span>,</span>
<span id="cb34-1138"><a href="#cb34-1138" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> hrvalues, <span class="at">ymin =</span> support,</span>
<span id="cb34-1139"><a href="#cb34-1139" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="fu">max</span>(support)), <span class="at">fill =</span> <span class="st">"#d46c5b"</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-Likelihood Function"</span>,</span>
<span id="cb34-1140"><a href="#cb34-1140" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Log-likelihoods for a range of hazard ratios"</span>,</span>
<span id="cb34-1141"><a href="#cb34-1141" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hazard Ratio (HR)"</span>, <span class="at">y =</span> <span class="st">"ln(MLR)"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb34-1142"><a href="#cb34-1142" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>)) <span class="sc">+</span> <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb34-1143"><a href="#cb34-1143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.0125</span>)),</span>
<span id="cb34-1144"><a href="#cb34-1144" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">7</span>, <span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb34-1145"><a href="#cb34-1145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb34-1146"><a href="#cb34-1146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-1147"><a href="#cb34-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1148"><a href="#cb34-1148" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-29-1.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"672"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-1149"><a href="#cb34-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1150"><a href="#cb34-1150" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1151"><a href="#cb34-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1152"><a href="#cb34-1152" aria-hidden="true" tabindex="-1"></a><span class="fu">## Figure S2: Deviance Function $2ln(MLR)$</span></span>
<span id="cb34-1153"><a href="#cb34-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1154"><a href="#cb34-1154" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1155"><a href="#cb34-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1156"><a href="#cb34-1156" aria-hidden="true" tabindex="-1"></a>Known as the deviance function, it is twice the log-likelihood, which</span>
<span id="cb34-1157"><a href="#cb34-1157" aria-hidden="true" tabindex="-1"></a>maps to the $S$-value function.</span>
<span id="cb34-1158"><a href="#cb34-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1159"><a href="#cb34-1159" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1160"><a href="#cb34-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1161"><a href="#cb34-1161" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-1162"><a href="#cb34-1162" aria-hidden="true" tabindex="-1"></a>support <span class="ot">&lt;-</span> (zscore<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb34-1163"><a href="#cb34-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1164"><a href="#cb34-1164" aria-hidden="true" tabindex="-1"></a>likfunction <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(hrvalues, zscore, support)</span>
<span id="cb34-1165"><a href="#cb34-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1166"><a href="#cb34-1166" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> likfunction, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hrvalues, <span class="at">y =</span> support)) <span class="sc">+</span></span>
<span id="cb34-1167"><a href="#cb34-1167" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#d46c5b"</span>,</span>
<span id="cb34-1168"><a href="#cb34-1168" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">3.84</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"#333333"</span>,</span>
<span id="cb34-1169"><a href="#cb34-1169" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> hrvalues, <span class="at">ymin =</span> support,</span>
<span id="cb34-1170"><a href="#cb34-1170" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="fu">max</span>(support)), <span class="at">fill =</span> <span class="st">"#d46c5b"</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb34-1171"><a href="#cb34-1171" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">1.65</span>, <span class="at">y =</span> <span class="fl">4.4</span>, <span class="at">label =</span> <span class="st">"1/6.83 LI = 0.997, 2.59"</span>, <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb34-1172"><a href="#cb34-1172" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#000000"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-1173"><a href="#cb34-1173" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-1174"><a href="#cb34-1174" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb34-1175"><a href="#cb34-1175" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">10</span>)) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,</span>
<span id="cb34-1176"><a href="#cb34-1176" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0125</span>)), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">14</span>, <span class="dv">2</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Deviance Function"</span>,</span>
<span id="cb34-1177"><a href="#cb34-1177" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Deviance statistics for a range of hazard ratios"</span>,</span>
<span id="cb34-1178"><a href="#cb34-1178" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hazard Ratio (HR)"</span>, <span class="at">y =</span> <span class="st">" Deviance Statistic </span><span class="sc">\n</span><span class="st">2ln(MLR)"</span>)</span>
<span id="cb34-1179"><a href="#cb34-1179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-1180"><a href="#cb34-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1181"><a href="#cb34-1181" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-30-1.svg"</span><span class="ot"> data-fig-align</span><span class="op">=</span><span class="st">"center"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"672"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb34-1182"><a href="#cb34-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1183"><a href="#cb34-1183" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1184"><a href="#cb34-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1185"><a href="#cb34-1185" aria-hidden="true" tabindex="-1"></a>And the version from our paper can be found</span>
<span id="cb34-1186"><a href="#cb34-1186" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">here</span><span class="co">](https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM4_ESM.pdf)</span>.</span>
<span id="cb34-1187"><a href="#cb34-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1188"><a href="#cb34-1188" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1189"><a href="#cb34-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1190"><a href="#cb34-1190" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"https://res.cloudinary.com/less-likely/image/upload/v1602200052/Site/deviancefunction.png"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"750"</span><span class="dt">/&gt;</span></span>
<span id="cb34-1191"><a href="#cb34-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1192"><a href="#cb34-1192" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1193"><a href="#cb34-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1194"><a href="#cb34-1194" aria-hidden="true" tabindex="-1"></a>It is important to note that although we have calculated these</span>
<span id="cb34-1195"><a href="#cb34-1195" aria-hidden="true" tabindex="-1"></a>likelihood functions manually here, they can also be generated easily</span>
<span id="cb34-1196"><a href="#cb34-1196" aria-hidden="true" tabindex="-1"></a>using the</span>
<span id="cb34-1197"><a href="#cb34-1197" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`curve_lik()`</span><span class="co">](https://data.lesslikely.com/concurve/reference/curve_lik.html)</span></span>
<span id="cb34-1198"><a href="#cb34-1198" aria-hidden="true" tabindex="-1"></a>function which takes inputs from the</span>
<span id="cb34-1199"><a href="#cb34-1199" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`ProfileLikelihood`</span><span class="co">](https://cran.r-project.org/package=ProfileLikelihood)</span></span>
<span id="cb34-1200"><a href="#cb34-1200" aria-hidden="true" tabindex="-1"></a><span class="in">`R`</span> package. To see a further discussion, please see the [following</span>
<span id="cb34-1201"><a href="#cb34-1201" aria-hidden="true" tabindex="-1"></a>article](https://data.lesslikely.com/concurve/articles/likelihood.html),</span>
<span id="cb34-1202"><a href="#cb34-1202" aria-hidden="true" tabindex="-1"></a>which gives several examples for a wide variety of models.</span>
<span id="cb34-1203"><a href="#cb34-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1204"><a href="#cb34-1204" aria-hidden="true" tabindex="-1"></a>Further, we urge some caution. Although we endorse the construction and</span>
<span id="cb34-1205"><a href="#cb34-1205" aria-hidden="true" tabindex="-1"></a>presentation of likelihood functions along with $P$-value and $S$-value</span>
<span id="cb34-1206"><a href="#cb34-1206" aria-hidden="true" tabindex="-1"></a>functions, along with the tabulations, the use of pure likelihood</span>
<span id="cb34-1207"><a href="#cb34-1207" aria-hidden="true" tabindex="-1"></a>methods has been highly controversial among some statisticians, with</span>
<span id="cb34-1208"><a href="#cb34-1208" aria-hidden="true" tabindex="-1"></a>some going as far as to say that *likelihood is blind* although not all</span>
<span id="cb34-1209"><a href="#cb34-1209" aria-hidden="true" tabindex="-1"></a>statisticians believe this, and have responded to such criticisms in</span>
<span id="cb34-1210"><a href="#cb34-1210" aria-hidden="true" tabindex="-1"></a>kind, see discussants. @daviesApproximatingDataDiscussion2008 Thus, we</span>
<span id="cb34-1211"><a href="#cb34-1211" aria-hidden="true" tabindex="-1"></a>support providing both $P$-value/$S$-value and likelihood-based</span>
<span id="cb34-1212"><a href="#cb34-1212" aria-hidden="true" tabindex="-1"></a>functions for a complete picture.</span>
<span id="cb34-1213"><a href="#cb34-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1214"><a href="#cb34-1214" aria-hidden="true" tabindex="-1"></a>Indeed, we can see how they all easily map to one another when plotted</span>
<span id="cb34-1215"><a href="#cb34-1215" aria-hidden="true" tabindex="-1"></a>side by side, with the following script.</span>
<span id="cb34-1216"><a href="#cb34-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1217"><a href="#cb34-1217" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1218"><a href="#cb34-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1219"><a href="#cb34-1219" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-1220"><a href="#cb34-1220" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"cowplot"</span>)</span>
<span id="cb34-1221"><a href="#cb34-1221" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(confcurve, surprisalcurve, relsupportfunction, deviancefunction,</span>
<span id="cb34-1222"><a href="#cb34-1222" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb34-1223"><a href="#cb34-1223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-1224"><a href="#cb34-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1225"><a href="#cb34-1225" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1226"><a href="#cb34-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1227"><a href="#cb34-1227" aria-hidden="true" tabindex="-1"></a>A clearer plot comparing the four functions is seen below (click on the</span>
<span id="cb34-1228"><a href="#cb34-1228" aria-hidden="true" tabindex="-1"></a>image to view in full).</span>
<span id="cb34-1229"><a href="#cb34-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1230"><a href="#cb34-1230" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1231"><a href="#cb34-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1232"><a href="#cb34-1232" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"https://res.cloudinary.com/less-likely/image/upload/v1581988661/Site/Comparisons.png"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"1000"</span><span class="ot"> style</span><span class="op">=</span><span class="st">"cursor: zoom-in"</span><span class="dt">/&gt;</span></span>
<span id="cb34-1233"><a href="#cb34-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1234"><a href="#cb34-1234" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1235"><a href="#cb34-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1236"><a href="#cb34-1236" aria-hidden="true" tabindex="-1"></a>Additional adjustments that were made to the figures from [Rafi &amp;</span>
<span id="cb34-1237"><a href="#cb34-1237" aria-hidden="true" tabindex="-1"></a>Greenland, 2020](https://doi.org/10.1186/s12874-020-01105-9)</span>
<span id="cb34-1238"><a href="#cb34-1238" aria-hidden="true" tabindex="-1"></a>@rafiSemanticCognitiveTools2020 were done using Adobe Illustrator and</span>
<span id="cb34-1239"><a href="#cb34-1239" aria-hidden="true" tabindex="-1"></a>Photoshop.</span>
<span id="cb34-1240"><a href="#cb34-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1241"><a href="#cb34-1241" aria-hidden="true" tabindex="-1"></a>All errors are ours, and we welcome critical feedback and reporting of</span>
<span id="cb34-1242"><a href="#cb34-1242" aria-hidden="true" tabindex="-1"></a>errors. To report possible errors in our analyses, please post it as a</span>
<span id="cb34-1243"><a href="#cb34-1243" aria-hidden="true" tabindex="-1"></a>comment below or as a bug</span>
<span id="cb34-1244"><a href="#cb34-1244" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">here</span><span class="co">](https://github.com/zadrafi/concurve/issues)</span>. We will compile them</span>
<span id="cb34-1245"><a href="#cb34-1245" aria-hidden="true" tabindex="-1"></a>onto a public errata, if any errors or flaws are reported to us.</span>
<span id="cb34-1246"><a href="#cb34-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1247"><a href="#cb34-1247" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1248"><a href="#cb34-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1249"><a href="#cb34-1249" aria-hidden="true" tabindex="-1"></a><span class="fu"># Statistical Package Citations</span></span>
<span id="cb34-1250"><a href="#cb34-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1251"><a href="#cb34-1251" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1252"><a href="#cb34-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1253"><a href="#cb34-1253" aria-hidden="true" tabindex="-1"></a>Please remember to cite the <span class="in">`R`</span> packages if you use any of the <span class="in">`R`</span></span>
<span id="cb34-1254"><a href="#cb34-1254" aria-hidden="true" tabindex="-1"></a>scripts from above. The citation for our</span>
<span id="cb34-1255"><a href="#cb34-1255" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>@rafiSemanticCognitiveTools2020<span class="sc">\]</span> can be found below in the</span>
<span id="cb34-1256"><a href="#cb34-1256" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">References</span><span class="co">](#references)</span> section or it can be [downloaded</span>
<span id="cb34-1257"><a href="#cb34-1257" aria-hidden="true" tabindex="-1"></a>here](https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/s12874-020-01105-9.ris)</span>
<span id="cb34-1258"><a href="#cb34-1258" aria-hidden="true" tabindex="-1"></a>for a reference manager.</span>
<span id="cb34-1259"><a href="#cb34-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1260"><a href="#cb34-1260" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1261"><a href="#cb34-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1262"><a href="#cb34-1262" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-1263"><a href="#cb34-1263" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"concurve"</span>)</span>
<span id="cb34-1264"><a href="#cb34-1264" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"TeachingDemos"</span>)</span>
<span id="cb34-1265"><a href="#cb34-1265" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"ProfileLikelihood"</span>)</span>
<span id="cb34-1266"><a href="#cb34-1266" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"rstan"</span>)</span>
<span id="cb34-1267"><a href="#cb34-1267" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"rstanarm"</span>)</span>
<span id="cb34-1268"><a href="#cb34-1268" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"bayesplot"</span>)</span>
<span id="cb34-1269"><a href="#cb34-1269" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"knitr"</span>)</span>
<span id="cb34-1270"><a href="#cb34-1270" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"kableExtra"</span>)</span>
<span id="cb34-1271"><a href="#cb34-1271" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb34-1272"><a href="#cb34-1272" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"cowplot"</span>)</span>
<span id="cb34-1273"><a href="#cb34-1273" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"Statamarkdown"</span>)</span>
<span id="cb34-1274"><a href="#cb34-1274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-1275"><a href="#cb34-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1276"><a href="#cb34-1276" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1277"><a href="#cb34-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1278"><a href="#cb34-1278" aria-hidden="true" tabindex="-1"></a><span class="fu"># Environment</span></span>
<span id="cb34-1279"><a href="#cb34-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1280"><a href="#cb34-1280" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1281"><a href="#cb34-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1282"><a href="#cb34-1282" aria-hidden="true" tabindex="-1"></a>The analyses were run on:</span>
<span id="cb34-1283"><a href="#cb34-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1284"><a href="#cb34-1284" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1285"><a href="#cb34-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1286"><a href="#cb34-1286" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb34-1287"><a href="#cb34-1287" aria-hidden="true" tabindex="-1"></a>si <span class="ot">&lt;-</span> <span class="fu">sessionInfo</span>()</span>
<span id="cb34-1288"><a href="#cb34-1288" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(si, <span class="at">RNG =</span> <span class="cn">TRUE</span>, <span class="at">locale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-1289"><a href="#cb34-1289" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R version 4.5.0 (2025-04-11)</span></span>
<span id="cb34-1290"><a href="#cb34-1290" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span id="cb34-1291"><a href="#cb34-1291" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span id="cb34-1292"><a href="#cb34-1292" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-1293"><a href="#cb34-1293" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Matrix products: default</span></span>
<span id="cb34-1294"><a href="#cb34-1294" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span id="cb34-1295"><a href="#cb34-1295" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span id="cb34-1296"><a href="#cb34-1296" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-1297"><a href="#cb34-1297" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random number generation:</span></span>
<span id="cb34-1298"><a href="#cb34-1298" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  RNG:     L'Ecuyer-CMRG </span></span>
<span id="cb34-1299"><a href="#cb34-1299" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Normal:  Inversion </span></span>
<span id="cb34-1300"><a href="#cb34-1300" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Sample:  Rejection </span></span>
<span id="cb34-1301"><a href="#cb34-1301" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb34-1302"><a href="#cb34-1302" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; locale:</span></span>
<span id="cb34-1303"><a href="#cb34-1303" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span id="cb34-1304"><a href="#cb34-1304" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-1305"><a href="#cb34-1305" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time zone: America/New_York</span></span>
<span id="cb34-1306"><a href="#cb34-1306" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tzcode source: internal</span></span>
<span id="cb34-1307"><a href="#cb34-1307" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-1308"><a href="#cb34-1308" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attached base packages:</span></span>
<span id="cb34-1309"><a href="#cb34-1309" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] splines   grid      stats4    parallel  stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span id="cb34-1310"><a href="#cb34-1310" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-1311"><a href="#cb34-1311" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; other attached packages:</span></span>
<span id="cb34-1312"><a href="#cb34-1312" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [1] TeachingDemos_2.13    plotly_4.10.4         TSstudio_0.1.7        tfautograph_0.3.2     tfdatasets_2.17.0    </span></span>
<span id="cb34-1313"><a href="#cb34-1313" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [6] keras_2.15.0          tensorflow_2.16.0     timetk_2.9.0          modeltime_1.3.1       workflowsets_1.1.1   </span></span>
<span id="cb34-1314"><a href="#cb34-1314" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [11] workflows_1.2.0       tune_1.3.0            rsample_1.3.0         recipes_1.3.1         parsnip_1.3.2        </span></span>
<span id="cb34-1315"><a href="#cb34-1315" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [16] modeldata_1.4.0       infer_1.0.8           dials_1.4.0           scales_1.4.0          tidymodels_1.3.0     </span></span>
<span id="cb34-1316"><a href="#cb34-1316" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [21] xgboost_1.7.11.1      prophet_1.0           rlang_1.1.6           astsa_2.2             bayesforecast_1.0.5  </span></span>
<span id="cb34-1317"><a href="#cb34-1317" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [26] smooth_4.2.0          greybox_2.0.4         glmnet_4.1-9          forecast_8.24.0       fable_0.4.1          </span></span>
<span id="cb34-1318"><a href="#cb34-1318" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [31] fabletools_0.5.0      tsibbledata_0.4.1     tsibble_1.1.6         rstanarm_2.32.1       texPreview_2.1.0     </span></span>
<span id="cb34-1319"><a href="#cb34-1319" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [36] tinytex_0.57          rmarkdown_2.29        brms_2.22.0           bootImpute_1.2.2      knitr_1.50           </span></span>
<span id="cb34-1320"><a href="#cb34-1320" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [41] boot_1.3-31           JuliaCall_0.17.6      reshape2_1.4.4        ProfileLikelihood_1.3 ImputeRobust_1.3-1   </span></span>
<span id="cb34-1321"><a href="#cb34-1321" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [46] gamlss_5.4-22         gamlss.dist_6.1-1     gamlss.data_6.0-6     mvtnorm_1.3-3         performance_0.14.0   </span></span>
<span id="cb34-1322"><a href="#cb34-1322" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [51] summarytools_1.1.4    tidybayes_3.0.7       htmltools_0.5.8.1     Statamarkdown_0.9.2   car_3.1-3            </span></span>
<span id="cb34-1323"><a href="#cb34-1323" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [56] carData_3.0-5         qqplotr_0.0.6         ggcorrplot_0.1.4.1    mitml_0.4-5           pbmcapply_1.5.1      </span></span>
<span id="cb34-1324"><a href="#cb34-1324" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [61] Amelia_1.8.3          Rcpp_1.0.14           blogdown_1.21         doParallel_1.0.17     iterators_1.0.14     </span></span>
<span id="cb34-1325"><a href="#cb34-1325" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [66] foreach_1.5.2         lattice_0.22-7        bayesplot_1.12.0      wesanderson_0.3.7     VIM_6.2.2            </span></span>
<span id="cb34-1326"><a href="#cb34-1326" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [71] colorspace_2.1-1      here_1.0.1            progress_1.2.3        loo_2.8.0             mi_1.1               </span></span>
<span id="cb34-1327"><a href="#cb34-1327" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [76] Matrix_1.7-3          broom_1.0.8           yardstick_1.3.2       svglite_2.2.1         Cairo_1.6-2          </span></span>
<span id="cb34-1328"><a href="#cb34-1328" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [81] cowplot_1.1.3         mgcv_1.9-3            nlme_3.1-168          xfun_0.52             broom.mixed_0.2.9.6  </span></span>
<span id="cb34-1329"><a href="#cb34-1329" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [86] reticulate_1.42.0     kableExtra_1.4.0      posterior_1.6.1       checkmate_2.3.2       parallelly_1.45.0    </span></span>
<span id="cb34-1330"><a href="#cb34-1330" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [91] miceFast_0.8.5        randomForest_4.7-1.2  missForest_1.5        miceadds_3.17-44      quantreg_6.1         </span></span>
<span id="cb34-1331"><a href="#cb34-1331" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [96] SparseM_1.84-2        MCMCpack_1.7-1        MASS_7.3-65           coda_0.19-4.1         latex2exp_0.9.6      </span></span>
<span id="cb34-1332"><a href="#cb34-1332" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 23 entries ]</span></span>
<span id="cb34-1333"><a href="#cb34-1333" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-1334"><a href="#cb34-1334" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span id="cb34-1335"><a href="#cb34-1335" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [1] igraph_2.1.4         Formula_1.2-5        rematch2_2.1.2       GPfit_1.0-9          tidyselect_1.2.1    </span></span>
<span id="cb34-1336"><a href="#cb34-1336" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [6] bridgesampling_1.1-2 rngtools_1.5.2       dichromat_2.0-0.1    png_0.1-8            cli_3.6.5           </span></span>
<span id="cb34-1337"><a href="#cb34-1337" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [11] arrayhelpers_1.1-0   askpass_1.2.1        openssl_2.3.3        textshaping_1.0.1    officer_0.6.10      </span></span>
<span id="cb34-1338"><a href="#cb34-1338" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [16] lhs_1.2.0            curl_6.2.3           mime_0.13            evaluate_1.0.3       V8_6.0.4            </span></span>
<span id="cb34-1339"><a href="#cb34-1339" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [21] stringi_1.8.7        backports_1.5.0      desc_1.4.3           qqconf_1.3.2         httpuv_1.6.16       </span></span>
<span id="cb34-1340"><a href="#cb34-1340" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [26] rappdirs_0.3.3       details_0.4.0        prodlim_2025.04.28   KMsurv_0.1-6         doRNG_1.8.6.2       </span></span>
<span id="cb34-1341"><a href="#cb34-1341" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [31] survminer_0.5.0      DT_0.33              DBI_1.2.3            withr_3.0.2          tfruns_1.5.3        </span></span>
<span id="cb34-1342"><a href="#cb34-1342" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [36] reformulas_0.4.1     tseries_0.10-58      class_7.3-23         systemfonts_1.2.3    rprojroot_2.0.4     </span></span>
<span id="cb34-1343"><a href="#cb34-1343" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [41] lmtest_0.9-40        formatR_1.14         colourpicker_1.3.0   htmlwidgets_1.6.4    fs_1.6.6            </span></span>
<span id="cb34-1344"><a href="#cb34-1344" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [46] labeling_0.4.3       ranger_0.17.0        DEoptimR_1.1-3-1     zoo_1.8-14           itertools_0.1-3     </span></span>
<span id="cb34-1345"><a href="#cb34-1345" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [51] svUnit_1.0.6         timechange_0.3.0     caTools_1.18.3       extremevalues_2.4.1  data.table_1.17.4   </span></span>
<span id="cb34-1346"><a href="#cb34-1346" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [56] timeDate_4041.110    pan_1.9              clipr_0.8.0          ellipsis_0.3.2       lazyeval_0.2.2      </span></span>
<span id="cb34-1347"><a href="#cb34-1347" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [61] yaml_2.3.10          survival_3.8-3       crayon_1.5.3         tensorA_0.36.2.1     RColorBrewer_1.1-3  </span></span>
<span id="cb34-1348"><a href="#cb34-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [66] later_1.4.2          codetools_0.2-20     base64enc_0.1-3      shape_1.4.6.1        estimability_1.5.1  </span></span>
<span id="cb34-1349"><a href="#cb34-1349" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [71] gdtools_0.4.2        DiceDesign_1.10      foreign_0.8-90       pkgconfig_2.0.3      xml2_1.3.8          </span></span>
<span id="cb34-1350"><a href="#cb34-1350" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [76] mathjaxr_1.8-0       ggpubr_0.6.0         viridisLite_0.4.2    xtable_1.8-4         plyr_1.8.9          </span></span>
<span id="cb34-1351"><a href="#cb34-1351" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [81] httr_1.4.7           rbibutils_2.3        tools_4.5.0          globals_0.18.0       hardhat_1.4.1       </span></span>
<span id="cb34-1352"><a href="#cb34-1352" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [86] pkgbuild_1.4.8       htmlTable_2.4.3      survMisc_0.5.6       shinyjs_2.1.0        crosstalk_1.2.1     </span></span>
<span id="cb34-1353"><a href="#cb34-1353" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [91] twosamples_2.0.1     MatrixModels_0.5-4   lme4_1.1-37          digest_0.6.37        numDeriv_2016.8-1.1 </span></span>
<span id="cb34-1354"><a href="#cb34-1354" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [96] furrr_0.3.1          farver_2.1.2         tzdb_0.5.0           rapportools_1.2      rpart_4.1.24        </span></span>
<span id="cb34-1355"><a href="#cb34-1355" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 90 entries ]</span></span>
<span id="cb34-1356"><a href="#cb34-1356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-1357"><a href="#cb34-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1358"><a href="#cb34-1358" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1359"><a href="#cb34-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1360"><a href="#cb34-1360" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stata</span></span>
<span id="cb34-1361"><a href="#cb34-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1362"><a href="#cb34-1362" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb34-1363"><a href="#cb34-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1364"><a href="#cb34-1364" aria-hidden="true" tabindex="-1"></a><span class="in">``` stata</span></span>
<span id="cb34-1365"><a href="#cb34-1365" aria-hidden="true" tabindex="-1"></a><span class="in">about</span></span>
<span id="cb34-1366"><a href="#cb34-1366" aria-hidden="true" tabindex="-1"></a><span class="in">version</span></span>
<span id="cb34-1367"><a href="#cb34-1367" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Stata/BE 17.0 for Mac (Apple Silicon)</span></span>
<span id="cb34-1368"><a href="#cb34-1368" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Revision 21 May 2024</span></span>
<span id="cb34-1369"><a href="#cb34-1369" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Copyright 1985-2021 StataCorp LLC</span></span>
<span id="cb34-1370"><a href="#cb34-1370" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-1371"><a href="#cb34-1371" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Total physical memory: 24.00 GB</span></span>
<span id="cb34-1372"><a href="#cb34-1372" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-1373"><a href="#cb34-1373" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Stata license: Single-user  perpetual</span></span>
<span id="cb34-1374"><a href="#cb34-1374" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; Serial number: 301706317553</span></span>
<span id="cb34-1375"><a href="#cb34-1375" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;   Licensed to: Zad Rafi</span></span>
<span id="cb34-1376"><a href="#cb34-1376" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt;                AMG</span></span>
<span id="cb34-1377"><a href="#cb34-1377" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; </span></span>
<span id="cb34-1378"><a href="#cb34-1378" aria-hidden="true" tabindex="-1"></a><span class="in">#&gt; version 17.0</span></span>
<span id="cb34-1379"><a href="#cb34-1379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-1380"><a href="#cb34-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1381"><a href="#cb34-1381" aria-hidden="true" tabindex="-1"></a><span class="fu">## ------------------------------------------------------------------------</span></span>
<span id="cb34-1382"><a href="#cb34-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1383"><a href="#cb34-1383" aria-hidden="true" tabindex="-1"></a><span class="fu"># References</span></span>
<span id="cb34-1384"><a href="#cb34-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1385"><a href="#cb34-1385" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2025, Less Likely</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/zadrafi/lesslikely/edit/main/posts/statistics/RG2020BMC.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/zadrafi/lesslikely/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/Lester_Domes">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/yourusername">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>