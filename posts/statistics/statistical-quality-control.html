<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zad Rafi">
<meta name="dcterms.date" content="2020-06-13">
<meta name="keywords" content="statistical reporting, statistics, accuracy, data science">
<meta name="description" content="Experienced statisticians and data analysts are familiar with stories where a coding error has led to an entire conclusion changing, even leading to a retraction. It’s the sort of stuff that keeps people up at night.">

<title>Quality Control in Statistical Analyses – Less Likely</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-befe23ebd2f54d8af2c8a89d1a1611f1.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-6f31dc0de0b27d6330ba5816b520976b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-851073aeef2233dc7fca7df9ea7de5a3.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-6f31dc0de0b27d6330ba5816b520976b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": true,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Less Likely</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html#category=statistics"> 
<span class="menu-text">Statistics</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/zadrafi"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/zadrafi"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-entry-management" id="toc-data-entry-management" class="nav-link active" data-scroll-target="#data-entry-management"><span class="header-section-number">1</span> Data Entry &amp; Management</a>
  <ul class="collapse">
  <li><a href="#general-principle-be-consistent-with-everything" id="toc-general-principle-be-consistent-with-everything" class="nav-link" data-scroll-target="#general-principle-be-consistent-with-everything"><span class="header-section-number">1.1</span> General Principle: Be Consistent With Everything</a></li>
  </ul></li>
  <li><a href="#setting-up-a-principled-statistical-workflow" id="toc-setting-up-a-principled-statistical-workflow" class="nav-link" data-scroll-target="#setting-up-a-principled-statistical-workflow"><span class="header-section-number">2</span> Setting Up a Principled Statistical Workflow</a>
  <ul class="collapse">
  <li><a href="#setting-up-the-project-folder" id="toc-setting-up-the-project-folder" class="nav-link" data-scroll-target="#setting-up-the-project-folder"><span class="header-section-number">2.1</span> Setting up the Project Folder</a></li>
  <li><a href="#setting-up-the-functions-script" id="toc-setting-up-the-functions-script" class="nav-link" data-scroll-target="#setting-up-the-functions-script"><span class="header-section-number">2.2</span> Setting up the Functions Script</a></li>
  <li><a href="#setting-up-the-error-catching-script" id="toc-setting-up-the-error-catching-script" class="nav-link" data-scroll-target="#setting-up-the-error-catching-script"><span class="header-section-number">2.3</span> Setting up the Error Catching Script</a></li>
  <li><a href="#example-of-data-loading-inspection" id="toc-example-of-data-loading-inspection" class="nav-link" data-scroll-target="#example-of-data-loading-inspection"><span class="header-section-number">2.4</span> Example of Data Loading &amp; Inspection</a></li>
  <li><a href="#example-of-the-main-source-script" id="toc-example-of-the-main-source-script" class="nav-link" data-scroll-target="#example-of-the-main-source-script"><span class="header-section-number">2.5</span> Example of the Main Source Script</a></li>
  <li><a href="#setting-the-seed" id="toc-setting-the-seed" class="nav-link" data-scroll-target="#setting-the-seed"><span class="header-section-number">2.6</span> Setting the Seed</a></li>
  <li><a href="#example-of-a-multiple-imputation-script" id="toc-example-of-a-multiple-imputation-script" class="nav-link" data-scroll-target="#example-of-a-multiple-imputation-script"><span class="header-section-number">2.7</span> Example of a Multiple Imputation Script</a></li>
  <li><a href="#saving-and-reading-data-carefully" id="toc-saving-and-reading-data-carefully" class="nav-link" data-scroll-target="#saving-and-reading-data-carefully"><span class="header-section-number">2.8</span> Saving and Reading Data Carefully</a></li>
  <li><a href="#example-modeling-script" id="toc-example-modeling-script" class="nav-link" data-scroll-target="#example-modeling-script"><span class="header-section-number">2.9</span> Example Modeling Script</a></li>
  <li><a href="#example-table-script" id="toc-example-table-script" class="nav-link" data-scroll-target="#example-table-script"><span class="header-section-number">2.10</span> Example Table Script</a></li>
  </ul></li>
  <li><a href="#possible-drawbacks-of-this-approach" id="toc-possible-drawbacks-of-this-approach" class="nav-link" data-scroll-target="#possible-drawbacks-of-this-approach"><span class="header-section-number">3</span> Possible Drawbacks of this Approach</a></li>
  <li><a href="#helpful-resources" id="toc-helpful-resources" class="nav-link" data-scroll-target="#helpful-resources"><span class="header-section-number">4</span> Helpful Resources</a></li>
  <li><a href="#environment" id="toc-environment" class="nav-link" data-scroll-target="#environment"><span class="header-section-number">5</span> Environment</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">6</span> References</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/zadrafi/lesslikely/edit/main/posts/statistics/statistical-quality-control.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/zadrafi/lesslikely/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Quality Control in Statistical Analyses</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">statistics</div>
  </div>
  </div>

<div>
  <div class="description">
    Experienced statisticians and data analysts are familiar with stories where a coding error has led to an entire conclusion changing, even leading to a retraction. It’s the sort of stuff that keeps people up at night.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Zad Rafi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 13, 2020</p>
    </div>
  </div>
  
    
  </div>
  

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>statistical reporting, statistics, accuracy, data science</p>
  </div>
</div>

</header>


<hr>
<p>Experienced statisticians and data analysts are familiar with stories where a coding error has led to an entire conclusion changing, <a href="https://jamanetwork.com/journals/jama/fullarticle/2752474">or even a retraction</a>.[@aboumatarNoticeRetractionAboumatar2019] It’s the sort of stuff that keeps people up at night. Unfortunately, not many of us think about these sorts of scenarios until we realize it’s very possible that it could happen to any of us.</p>
<p>To me, it seems that many of these issues could be avoided by having a principled data management and statistical workflow, and making it as transparent, open, and reproducible as possible. I’d like to quickly go over a few things that I’ve found helpful over the years, and I’ll first start with data management and data entry and then move onto analysis workflows. I largely consider this to be a living document, and I’m sure many people who will read this will have far better suggestions, so please leave them down below in the comments!</p>
<p>Before I go on, I want to emphasize that backing up your data, scripts, and <a href="https://happygitwithr.com/">using version control</a> is extremely important. There is no debate about this. It’s necessary so that other collaborators/colleagues can inspect your work and catch potential mistakes or see overall progress, but more importantly, it will prevent you from losing your data in a disaster, and it’ll help you catch your own mistakes, since you’ll be the most familiar with the data and scripts.</p>
<hr>
<section id="data-entry-management" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Data Entry &amp; Management</h1>
<hr>
<p>A nice paper that I’d like to review is the one by <a href="https://doi.org/10.1080/00031305.2017.1375989">Broman &amp; Woo, 2018</a> on how to manage your data when working with spreadsheets.[@bromanDataOrganizationSpreadsheets2018] The sad reality is that even though spreadsheets like Microsoft Excel or Google Sheets are available everywhere, and easy to use, there are many risks when working with spreadsheets, just ask any <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-1044-7?fbclid=IwAR06eQ5LTg2LX5byJBWfC6rJdAbAGXKvy3PUOhzPsVjUGqb7KqB1V_x36M0">statistician who works in genetics</a> or any bioinformatician.[@ziemannGeneNameErrors2016]</p>
<p>One of the most fatal errors <a href="https://theconversation.com/why-you-should-never-use-microsoft-excel-to-count-coronavirus-cases-147681">occurred recently</a> when a group of researchers lost thousands of documented COVID cases because they entered data for each case as a column instead of a row, and Excel has a limit on how many columns and rows it can handle (<strong>1,048,576 rows</strong> and <strong>16,384 columns</strong>, <a href="https://support.microsoft.com/en-us/office/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3">according to Microsoft</a>), as a result, most of these cases were lost, resulting in an enormous waste of resources due to a careless and ignorant mistake, highlighting the dangers of recklessly inputting data and conducting statistical analyses. There is no doubt that reviewing principles of good data management and workflow are essential to any data analyst. I’d like to touch on some of the most important points of <a href="https://doi.org/10.1080/00031305.2017.1375989">Broman &amp; Woo, 2018</a> paper before moving onto some other “principles” I’d like to share:</p>
<hr>
<section id="general-principle-be-consistent-with-everything" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="general-principle-be-consistent-with-everything"><span class="header-section-number">1.1</span> General Principle: Be Consistent With Everything</h2>
<hr>

<ul>
<li>When labeling missing values (<code>NA</code>, <code>N/A</code>, etc.):
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Choose one method (<code>NA</code>, <code>N/A</code>, etc.) and stick with it.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: Leaving cells empty to indicate missingness.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When labeling response variables:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: If you label a response variable consistently, for example, <code>fat-free-mass</code> in every instance to refer to the same variable.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: If you label a response variable <code>fat-free-mass</code> in one script/sheet, and <code>ffm</code>/<code>fat_free_mass</code> in another.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When formatting variable predictor names:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: <code>predictor_1_week12</code>, <code>predictor_2_week12</code>, <code>response_variable_week12</code>. This is consistent, with the order of the names, and dates/weeks, so it is easier to organize, inspect, and clean. Same thing applies to labeling response variables and pretty much all variables.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: When you label one variable <code>week12_predictor_1</code>, the next <code>predictor_2_week12</code>, and the last, <code>12_week_response</code>. Just <em>no</em>.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When formatting dates:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Use one format, <code>YYYY-MM-DD</code>, consistently.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: Everything else.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When filling out cells:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: One cell = one thing. No more, no less.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: One cell = multiple entries or no entries at all.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When keeping track of the data:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Create a comprehensive data dictionary so anyone can look at it and understand the spreadsheets/dataframes/variables.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: Expecting yourself and others to figure it out based on the variable names that you thought were brilliant.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When using Excel or Google Sheet’s shiny features:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Avoid using any of them, any formulas, highlighting, <em>italicizing</em>, <span style="font-weight:700;">bolding</span>, etc.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: If you’re the type of person to create charts in Excel.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>Planning for disasters:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Always, always, backup your files, save them in .txt files. Keep backups of those. And most importantly, <a href="https://happygitwithr.com/"><strong>use version control!</strong></a>
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: You don’t really plan for disasters and go with the flow.
</p></li>
</ul></li>
</ul>

<hr>
<ul>
<li>Last but not least, when entering cases:
<ul>
<li><p>
</p><p><span style="color:#7aa864; font-weight: 700;">Good</span>: Rows are for cases and observations, and columns are for variables and characteristics. Please do not switch these up!</p></li>
<li><p>
</p><p><span style="color:#CD5C5C; font-weight: 700;">Bad</span>: Using them interchangeably.</p></li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="setting-up-a-principled-statistical-workflow" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Setting Up a Principled Statistical Workflow</h1>
<hr>
<p>Here’s what I’ve been doing for many years and what seems to work for me (none of these ideas are originally mine, and I actually picked them up over the years from others’ advice, which will be linked below).</p>
<hr>
<section id="setting-up-the-project-folder" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="setting-up-the-project-folder"><span class="header-section-number">2.1</span> Setting up the Project Folder</h2>
<hr>
<p>When setting up a folder specific for a project (if you’re not doing this, you absolutely need to), first, I will create a folder with the title of my project, and usually have an <a href="https://rstudio.com/"><code>RStudio</code></a> project set up in there.</p>
<hr>
<blockquote class="blockquote">
<p>Disclaimer: while much of this advice will be familiar and easy to understand for those who use <code>R</code>, I think the general principles are widely applicable, especially for those who use scripts in their statistical software).</p>
</blockquote>
<hr>
<p>This folder will contain many other folders (more on that below), so the structure will end up being a bit complex.</p>
<hr>
<p><img data-enlargeable="" style="cursor: zoom-in" src="https://res.cloudinary.com/less-likely/image/upload/v1613136545/Site/diagram.png" alt="workflow"></p>
<hr>
<blockquote class="blockquote">
<p>It may be a bit difficult to read the words within the circles, but clicking on the diagram should enlargen it and allow you to zoom in, giving you a sense of how I organize all these scripts and files.</p>
</blockquote>
<hr>
<p>If this ends up confusing you, you can just scroll all the way down to see an image of what the folder structure looks like.</p>
<p>Instead of constantly changing the working directory to each subfolder when I need to do something inside that subfolder for a particular project or analysis, I set the project folder as the working directory only once, and then run the following:</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Very seriously consider installing the `here` package</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/package=here</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"here"</span>) </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># This and the scripts below take</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the directory used and set it as the top</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set_here</span>() </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">here</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<p>This not only sets the working directory, but gives you far more control over how you can save your files from any place within the hierarchical folder structure. It will create a file called <code>.here</code> inside the <code>Main Project</code> folder, which will indicate that this is the top level of the hierarchy.</p>
<p>Then, I will usually have created a <code>README.Rmd</code> file in the <code>Main Project</code> folder with updates on what I’ve done and what I still need to work on, so I will remember and so my collaborators can see it too (when it has been pushed to GitHub or other <a href="https://happygitwithr.com/">version control</a> repos).</p>
<p>Next, I’ll set up a <code>Data</code> folder inside the <code>Main Project</code> folder. This is where all my data/spreadsheets/.txt files and data dictionaries will go. The original data files will stay inside this folder, while I create two other subsubfolders inside this <code>Data</code> folder called <code>Transformed</code> and <code>Models</code>. In <code>Transformed</code>, I will typically save <code>.rds</code> files that were a result of cleaning and transforming the data, including imputing missing data. I will touch more on exactly how I do that later below. A <code>Models</code> subfolder will obviously store fitted models and any validation/sensitivity analyses of those models.[@morrisChoosingSensitivityAnalyses2014]</p>
<p>Now, back to the <code>Main Project</code> folder, I’ll set up another folder within it called <code>R</code>. This will be where all of my <code>.R</code> scripts/files live. I will number them sequentially along with a title for a specific purpose, like so</p>
<hr>
<ul>
<li><p><code>main.R</code></p></li>
<li><p><code>01-functions.R</code></p></li>
<li><p><code>02-cleaning.R</code></p></li>
<li><p><code>03-inspection.R</code></p></li>
<li><p><code>04-analysis.R</code></p></li>
<li><p><code>04.5-validation.R</code></p></li>
<li><p><code>05-sensitivity.R</code></p></li>
<li><p><code>06-tables.R</code></p></li>
</ul>
<hr>
</section>
<section id="setting-up-the-functions-script" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="setting-up-the-functions-script"><span class="header-section-number">2.2</span> Setting up the Functions Script</h2>
<hr>
<p>All potential <code>R</code> packages and custom functions that I need will belong in <code>01-functions.R</code>. This <code>.R</code> file will only serve this purpose and nothing else. As you’ve guessed by now, the other <code>.R</code> files will be doing the same, they have very specific purposes and are organized to reflect this.</p>
<p>An example of the first script can be found below.</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Necessary Packages ------------------------------------</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>req_packs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rms"</span>, <span class="st">"concurve"</span>, <span class="st">"mice"</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"tidyverse"</span>, <span class="st">"parallel"</span>, </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"bayesplot"</span>, <span class="st">"projpred"</span>, </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Hmisc"</span>, <span class="st">"loo"</span>, <span class="st">"rstan"</span>, <span class="st">"here"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"tryCatchLog"</span>, <span class="st">"futile.logger"</span>, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"patchwork"</span>, <span class="st">"corrplot"</span>, <span class="st">"beepr"</span>, </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">"summarytools"</span>, <span class="st">"broom"</span>, <span class="st">"wakefield"</span>, </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>               <span class="st">"boot"</span>, <span class="st">"mfp"</span>, <span class="st">"knitr"</span>, <span class="st">"flextable"</span>, </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>               <span class="st">"MASS"</span>, <span class="st">"lme4"</span>, <span class="st">"brms"</span>, <span class="st">"miceMNAR"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Load all packages at once</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(req_packs, library, </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Loggings messages </span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">keep.source =</span> <span class="cn">TRUE</span>)        </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"tryCatchLog.write.error.dump.file"</span> <span class="ot">=</span> <span class="cn">TRUE</span>) </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for random number generator</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1031</span>) <span class="co"># My birthday</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co"># RStan Settings  -------------------------------------</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="st">"red"</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> <span class="dv">4</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="fu">has_build_tools</span>(<span class="at">debug =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Stan Settings  ---------------------------------------</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>dotR <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">Sys.getenv</span>(<span class="st">"HOME"</span>), <span class="st">".R"</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(dotR)) <span class="fu">dir.create</span>(dotR)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dotR, <span class="st">"Makevars"</span>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(M)) <span class="fu">file.create</span>(M)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">CXX14FLAGS=-O3 -march=native -mtune=native -fPIC"</span>,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CXX14=g++"</span>, </span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> M, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">append =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<p>The script above loads all the necessary <code>R</code> packages each time it is called, along with the specified functions, so most of the other <code>.R</code> files will depend upon this one.</p>
<p>However, I will not be running each of these <code>.R</code> files/scripts individually, line by line, or by selecting all the lines in an <code>.R</code> file and running the script.</p>
<p>Instead, after I’ve created all these files (figuring out what I need to do carefully and writing it down and annotating it), every single <code>.R</code> file except for <code>main.R</code> will have the following script, which I will explain later below (or some iteration of this script to match the name of the file) at the beginning:</p>
<hr>
</section>
<section id="setting-up-the-error-catching-script" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="setting-up-the-error-catching-script"><span class="header-section-number">2.3</span> Setting up the Error Catching Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"here"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set_here</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(futile.logger)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tryCatchLog)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Keeps source code file name and line number tracking</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">keep.source =</span> <span class="cn">TRUE</span>)        </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"tryCatchLog.write.error.dump.file"</span> <span class="ot">=</span> <span class="cn">TRUE</span>) </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Logs messages into a file </span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(<span class="st">"my_app.log"</span>))  </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.threshold</span>(INFO)   </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Function that catches any messages</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="st">"script.R"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<p>You’ll notice several things. First, I’m once again calling the <a href="https://cran.r-project.org/package=here"><code>here</code></a> package and telling it that I’m working within this folder (<code>R</code>), and then I’m calling the <code>01-functions.R</code> file by using the <code>source()</code> function, but also notice how the <code>source()</code> function is followed by a <code>here()</code> function/argument. This <code>here()</code> function allows you to fully control files in a specific folder from anywhere else, without having to actually be in that folder. So, suppose I was in the <code>Main Project</code> -&gt; <code>Data</code> -&gt; <code>Models</code> folder and I was saving my work there (in the <code>Models</code> folder), which is pretty far from the <code>R</code> folder, I can still, using functions like <code>source()</code>, <code>save()</code>, etc., call or manipulate files from a totally different folder by specifying the hierarchy using <code>here()</code>. This can also be done in other ways, but those are far more cumbersome, and not flexible.</p>
<p>This is how I always call the necessary packages and functions I need from every <code>.R</code> script, simply by using the <code>source()</code> function and using <code>here()</code> to direct it to the <code>01-functions.R</code> file in the <code>R</code> folder. Now let’s look at the next few lines.</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(<span class="st">"script.log"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.threshold</span>(INFO)    </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="st">"script.R"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<p>This script is designed to catch any warnings that occur inside the <code>.R</code> script and save them to a .log file in another subfolder within the <code>R</code> folder called <code>Errors</code>. So here’s an example of a full script for a mix of data generation and inspection, so that you can see it in action.</p>
<hr>
</section>
<section id="example-of-data-loading-inspection" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="example-of-data-loading-inspection"><span class="header-section-number">2.4</span> Example of Data Loading &amp; Inspection</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"here"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set_here</span>()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>)) <span class="co"># Loads all R functions</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># First we need some data</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1031</span>) <span class="co"># My birthday</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose you wanted to simulate a clinical trial</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"simstudy"</span>)  </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulating a Clinical Trial --------------------------</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"male"</span>, <span class="at">dist =</span> <span class="st">"binary"</span>, </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula =</span> .<span class="dv">5</span> , <span class="at">id=</span><span class="st">"cid"</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">"over65"</span>, </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">dist =</span> <span class="st">"binary"</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula =</span> <span class="st">"-1.7 + .8 * male"</span>, </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def,<span class="at">varname =</span> <span class="st">"baseDBP"</span>, </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">dist =</span> <span class="st">"normal"</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">formula =</span> <span class="dv">70</span>, <span class="at">variance =</span> <span class="dv">40</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">"age"</span>, </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">dist =</span> <span class="st">"normal"</span>, </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula =</span> <span class="dv">10</span>, </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">variance =</span> <span class="dv">2</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">"visits"</span>, </span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">dist =</span> <span class="st">"poisson"</span>, </span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="st">"1.5 - 0.2 * age + 0.5 * male"</span>, </span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">"weight"</span>, </span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">dist =</span> <span class="st">"normal"</span>,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>                 <span class="at">formula =</span> <span class="dv">60</span>, <span class="at">variance =</span> <span class="dv">10</span>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>dtstudy <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">500</span>, def)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>study <span class="ot">&lt;-</span> <span class="fu">trtAssign</span>(dtstudy, <span class="at">nTrt =</span> <span class="dv">2</span>, </span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>                   <span class="at">balanced =</span> <span class="cn">FALSE</span>, <span class="at">grpName =</span> <span class="st">"rxGrp"</span>)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>study <span class="ot">&lt;-</span>  <span class="fu">as.data.frame</span>(study)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>iq <span class="ot">&lt;-</span> iq <span class="ot">&lt;-</span> wakefield<span class="sc">::</span><span class="fu">iq</span>(<span class="dv">500</span>)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>height <span class="ot">&lt;-</span> height <span class="ot">&lt;-</span> wakefield<span class="sc">::</span><span class="fu">height</span>(<span class="dv">500</span>)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>income <span class="ot">&lt;-</span> income <span class="ot">&lt;-</span> wakefield<span class="sc">::</span><span class="fu">income</span>(<span class="dv">500</span>, </span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>                              <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">name =</span> <span class="st">"Income"</span>)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>SAT_score <span class="ot">&lt;-</span> wakefield<span class="sc">::</span><span class="fu">sat</span>(<span class="dv">500</span>, <span class="at">mean =</span> <span class="dv">1500</span>, </span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sd =</span> <span class="dv">100</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">2400</span>, </span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>                 <span class="at">digits =</span> <span class="dv">0</span>, <span class="at">name =</span> <span class="st">"SAT"</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>visits <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(study<span class="sc">$</span>visits)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Add noisy predictors</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>study[, <span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">FUN =</span> <span class="cf">function</span>(i) </span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>                         (<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">500</span>, </span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>                                <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)))</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>varname <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"x%d"</span>, (<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>))</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(study)[<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>] <span class="ot">&lt;-</span> varname</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>study1 <span class="ot">&lt;-</span> <span class="fu">trtAssign</span>(dtstudy, <span class="at">n =</span> <span class="dv">2</span>, <span class="at">balanced =</span> <span class="cn">TRUE</span>, </span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>                    <span class="at">strata =</span> <span class="fu">c</span>(<span class="st">"male"</span>, <span class="st">"over65"</span>), </span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">grpName =</span> <span class="st">"rxGrp"</span>)</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>study1</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspecting Data  -------------------------------------</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>summarytools<span class="sc">::</span><span class="fu">view</span>(<span class="fu">dfSummary</span>(study))</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>over65 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(study<span class="sc">$</span>over65)</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>male <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(study<span class="sc">$</span>male)</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>rxGrp <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(study<span class="sc">$</span>rxGrp)</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>study_formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(baseDBP <span class="sc">~</span> .)</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">spearman2</span>(study_formula, study))</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>)</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>x_1 <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> ., <span class="at">data =</span> study)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial Data Analysis  ------------------------------</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>(cormatrix <span class="ot">&lt;-</span> (<span class="fu">cor</span>(x_1)))</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#BB4444"</span>, <span class="st">"#EE9988"</span>, </span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"#FFFFFF"</span>, </span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"#77AADD"</span>, <span class="st">"#4477AA"</span>))</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cormatrix, <span class="at">method =</span> <span class="st">"color"</span>, </span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">col</span>(<span class="dv">200</span>), </span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.cex =</span> <span class="fl">0.40</span>,</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span> <span class="st">"black"</span>, <span class="at">number.cex =</span> .<span class="dv">35</span>)</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>clus1 <span class="ot">&lt;-</span> <span class="fu">varclus</span>(x_1, <span class="at">similarity =</span> <span class="st">"h"</span>)</span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>clus2 <span class="ot">&lt;-</span> <span class="fu">varclus</span>(x_1, <span class="at">similarity =</span> <span class="st">"s"</span>)</span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>clus3 <span class="ot">&lt;-</span> <span class="fu">varclus</span>(x_1, <span class="at">similarity =</span> <span class="st">"p"</span>)</span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clus1, <span class="at">ylab =</span> <span class="st">"Hoeffing's D statistic"</span>, </span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.75</span>)</span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Hierarchical Cluster Analysis"</span>)</span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clus2, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.75</span>)</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clus3, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.75</span>)</span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>Pre <span class="ot">&lt;-</span> <span class="fu">names</span>(study)</span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>(fmla <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"~"</span>, </span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">paste</span>(Pre, </span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>                                <span class="at">collapse =</span> <span class="st">"+"</span>))))</span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Redundancy analysis </span></span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>redun <span class="ot">&lt;-</span> <span class="fu">redun</span>(fmla,</span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> study,</span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">r2 =</span> <span class="fl">0.90</span>, <span class="at">type =</span> <span class="st">"ordinary"</span>, <span class="at">allcat =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">tlinear =</span> <span class="cn">FALSE</span>, <span class="at">iterms =</span> <span class="cn">FALSE</span>, <span class="at">pr =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<p>The above script simulated some fake data for a hypothetical clinical trial (usually we use this first script to load data from a .csv or .txt file) and then we used several functions to inspect the dataframe for the structure and distributions of the variables and missing data, etc. We also attempted to properly code the variables. Now, in order to capture any possible errors, we will have to run this entire script from another <code>R</code> script instead of running it line by line or selecting all the code and running it.</p>
<p>We will do this from a Main source script, which will allow us to use the <code>tryCatchLog()</code> function.</p>
<hr>
</section>
<section id="example-of-the-main-source-script" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="example-of-the-main-source-script"><span class="header-section-number">2.5</span> Example of the Main Source Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"here"</span>) </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tryCatchLog"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"futile.logger"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set_here</span>() <span class="co"># Load and set here</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">here</span>() <span class="co"># Call here</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">keep.source =</span> <span class="cn">TRUE</span>)        </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"tryCatchLog.write.error.dump.file"</span> <span class="ot">=</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Script loads all necessary functions</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"01-functions.log"</span>)))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>))) </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Line script to clean the data</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"02-cleaning.log"</span>)))</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"02-cleaning.R"</span>))) </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Line script below to inspect the data</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"03-inspection.log"</span>)))</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"03-inspection.R"</span>)))  </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Load saved objects from cleanings</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"03.5-load_data.log"</span>)))</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"03.5-load_data.R"</span>))) </span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Main analysis script</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"04-analysis.log"</span>)))</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"04-analysis.R"</span>)))  </span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Below is the validation of main analysis results </span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"04.5-validation.log"</span>)))</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"04.5-validation.R"</span>))) </span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the sensitivity of the results by</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="co"># varying assumptions/multiple parameters</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"05-sensitivity.log"</span>)))</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"05-sensitivity.R"</span>))) </span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate tables and figures of all your results </span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"06-tables.log"</span>)))</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"06-tables.R"</span>))) </span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Export these into actual files that can be</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a><span class="co"># inserted into papers, reports, etc.</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"07-export.log"</span>)))</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"07-export.R"</span>))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<p>If anything went wrong during the simulations and their inspections in the first script from above, it would have been captured by the error-catching scripts that we have set up, which would be placed within a .log file in the <code>Errors</code> folder, which is inside the <code>R</code> folder.</p>
<hr>
</section>
<section id="setting-the-seed" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="setting-the-seed"><span class="header-section-number">2.6</span> Setting the Seed</h2>
<hr>
<blockquote class="blockquote">
<p>Also, note that we have set the seed using a specific random number generator algorithm. This is not that important, however, it is important to correctly set the seed for reproducing any random numbers generated. This requires even more careful thought when running a simulation study, in which the states of the simulation need to be saved for a particular repetition, and so that streams do not overlap.[@morrisUsingSimulationStudies2019]</p>
</blockquote>
<hr>
<p>I will admit that the error script is not <em>perfect</em> at capturing warnings, but for most things, if something wrong occurs when a script is run, the function <code>tryCatchLog()</code> and its .log file usually catches the warning, so I would know that something went wrong and what specifically.</p>
<p>However, some may be skeptical of this approach and ask why I need to catch these errors and save them if I ran the scripts? Why not just scroll up and look at the console to see the errors or warnings?</p>
<p>Many reasons:</p>
<hr>
<ul>
<li>Suppose the analyses take a very long time, and are computationally intensive, and <code>R</code>/<a href="https://rstudio.com/"><code>RStudio</code></a> crashes, you may not be able to figure out what went wrong.</li>
<li>Suppose the analysis completed but because there was so much occurring in the console (for example, sampling from a posterior) that you missed the warnings/errors and got results that you don’t know have issues.</li>
</ul>
<hr>
<p>Thus, having this system set up to catch errors in every script also helps us automate the entire workflow once we’ve carefully set it up. After each <code>.R</code> script has one of these message-catching scripts, we can run our entire analysis from start to finish from <code>main.R</code> with one command. This not only makes your workspace organized, but also makes it easier for others to reproduce your work if you share your files and folders via a repository.</p>
<hr>
<p>So, now the <code>Error</code> folder will contain .txt files with any warning messages or errors.</p>
<p>Typically, when I’m setting up a new project, I will also add a few other folders such as an <code>Outputs</code> folder, where I will save tables and graphs, and a <code>Report</code> folder, where I might be working on a manuscript.</p>
<p>Now that I’ve mentioned my hierarchy and how I catch errors, I can mention some other things that I believe are absolutely heinous practices.</p>
<p>Many people often will run an entire analysis and have several objects/vectors stored in their Global Environment in <code>R</code> and <code>RStudio</code>. Suppose they’re taking a break, finished with the analysis, turning off the computer, or stepping away for whatever reason, what they’ll typically do is click the save button on the top right pane and “Save the workspace image”. Indeed, if they don’t do that themselves, the IDE <code>RStudio</code> will explicitly ask them if they wish to save their workspace image.</p>
<p>This is a horrific practice and you should never do this because it can lead to several problems such as:</p>
<ul>
<li><p>having several saved objects and packages conflict with one another once they’re all loaded together at once</p></li>
<li><p>having giant workspace images, that will probably cause <code>R</code>, and especially <code>RStudio</code> to constantly crash</p></li>
<li><p>not allowing you to load very specific objects that you need at a time while leaving everything else</p></li>
</ul>
<p>I would say that it is a good idea to never save the workspace image, ever. It is also quite easy to turn off. Simply go the <code>RStudio</code> menu and click <em>Preferences</em>, and in the <em>General</em> section, you will see the following options:</p>
<hr>
<p><img data-enlargeable="" width="500" style="cursor: zoom-in" src="https://res.cloudinary.com/less-likely/image/upload/v1604649526/Site/RStudio_Default_Save_Options.png"></p>
<hr>
<p>It is essential to uncheck everything under <em>R Sessions</em>, <em>Workspace</em>, and <em>History</em>, so that you do not set your self up for a future disaster.</p>
<p>Instead of using these convenient but highly problematic options, always use the <code>saveRDS()</code> base <code>R</code> function, where the first argument is the object in your environment that you want to save, and the second argument is the path where you want to save it, which of course should be using the <code>here()</code> function.</p>
<p>Now suppose I decided to use multiple imputation because I had a dataset with many missing values, and suppose I had a grasp of the missing data mechanism, and so I used something like the not-at-random fully conditional specification approach (<strong>NARFCS</strong>)[@tompsettUseNotatrandomFully2018] to attempt to handle data that I believe to be missing not at random (<strong>MNAR</strong>), and I wanted to save the imputed dataset, and only load the imputed dataset next time. This is how I would do it (in the vaguest way possible). First, I’ll start with the dataset that we generated above and generate missing values via different missing data mechanisms using the <code>ampute()</code> function from the <code>mice</code> package.[@buurenMiceMultivariateImputation2011]</p>
<hr>
<blockquote class="blockquote">
<p><strong>Important</strong>: This is all assuming that one has carefully constructed an imputation model, and that multiple imputation is the most appropriate solution. As many others have pointed out, simply running a script like <code>mice(data)</code> in <code>R</code> without careful thought to the imputation model, is a very, very bad idea. Missing data is an extremely complex topic and I recommend everyone carefully read the works[@buurenFlexibleImputationMissing2018] of missing data researchers such as:</p>
</blockquote>
<ul>
<li><p><a href="https://stefvanbuuren.name/fimd/">Stef van Buuren</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://twitter.com/tmorris_mrc">Tim Morris</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://www.ctu.mrc.ac.uk/about-us/senior-staff/ian-white/">Ian White</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://scholar.google.com/citations?user=5q4fhUoAAAAJ&amp;hl=en">Donald Rubin</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://thestatsgeek.com/">Jonathan Bartlett</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://www.paulgstf.com/">Paul Gustafson</a></p>
<blockquote class="blockquote">

</blockquote></li>
</ul>
<hr>
</section>
<section id="example-of-a-multiple-imputation-script" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="example-of-a-multiple-imputation-script"><span class="header-section-number">2.7</span> Example of a Multiple Imputation Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"beepr"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Package that uses multiple imputation</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># by chained equations</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mice"</span>) </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Missing Data  --------------------------------</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>study_mnar <span class="ot">&lt;-</span> <span class="fu">ampute</span>(<span class="at">data =</span> study[, <span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>], </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prop =</span> <span class="fl">0.65</span>, <span class="at">mech =</span> <span class="st">"MNAR"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>mnar_patterns <span class="ot">&lt;-</span> study_mnar<span class="sc">$</span>patterns</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>mnar_weight <span class="ot">&lt;-</span> study_mnar<span class="sc">$</span>weight</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>study_mnar_rerun <span class="ot">&lt;-</span> <span class="fu">ampute</span>(<span class="at">data =</span> study[, <span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>], </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prop =</span> <span class="fl">0.5</span>, </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mech =</span> <span class="st">"MNAR"</span>, </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">patterns =</span> mnar_patterns,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">weights =</span> mnar_weight)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>study_mar <span class="ot">&lt;-</span> <span class="fu">ampute</span>(<span class="at">data =</span> study[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">prop =</span> <span class="fl">0.5</span>, </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mech =</span> <span class="st">"MAR"</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>mar_patterns <span class="ot">&lt;-</span> study_mar<span class="sc">$</span>patterns</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>mar_weight <span class="ot">&lt;-</span> study_mar<span class="sc">$</span>weight</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>study_mar_rerun <span class="ot">&lt;-</span> <span class="fu">ampute</span>(<span class="at">data =</span> study[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>], </span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prop =</span> <span class="fl">0.5</span>, </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mech =</span> <span class="st">"MAR"</span>, </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">patterns =</span> mar_patterns,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weights =</span> mar_weight)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>study_mar_rerun[[<span class="dv">11</span>]]<span class="sc">$</span>over65 <span class="sc">%&gt;%</span> </span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>()</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>study_mar_rerun[[<span class="dv">11</span>]]<span class="sc">$</span>male <span class="sc">%&gt;%</span> </span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>()</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>study_mar_rerun[[<span class="dv">11</span>]]<span class="sc">$</span>rxGrp <span class="sc">%&gt;%</span> </span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>()</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> study_mnar_rerun<span class="sc">$</span>amp</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> study_mar_rerun<span class="sc">$</span>amp</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect Data</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df) <span class="co"># Inspect data frame</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df) <span class="co"># High level summary of dataframe</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(df)) <span class="co"># Look at missing values etc.</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(df))</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>summarytools<span class="sc">::</span><span class="fu">view</span>(<span class="fu">dfSummary</span>(df)) </span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df2) <span class="co"># Inspect data frame</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df2) <span class="co"># High level summary of dataframe</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(df2)) <span class="co"># Look at missing values etc.</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(df2))</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>summarytools<span class="sc">::</span><span class="fu">view</span>(<span class="fu">dfSummary</span>(df2)) </span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare Data for Imputation -------------------------</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> df</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>temp2 <span class="ot">&lt;-</span> df2</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a><span class="fu">missing_plot</span>(temp)</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a><span class="fu">missing_plot</span>(temp2)</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Set-up predictor matrix</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>predMatrix <span class="ot">&lt;-</span> <span class="fu">make.predictorMatrix</span>(temp)</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>predMatrix2 <span class="ot">&lt;-</span> <span class="fu">make.predictorMatrix</span>(temp2)</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Set-up predictor matrix for unidentifiable part:</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>predSens <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>), <span class="at">ncol =</span> <span class="dv">6</span>, <span class="at">nrow =</span> <span class="dv">6</span>)</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predSens) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">":"</span>, <span class="fu">names</span>(temp), <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(predSens) <span class="ot">&lt;-</span> <span class="fu">names</span>(temp)</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Set-up list with sensitivity parameter values</span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>pSens <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">list</span>(<span class="fu">list</span>(<span class="st">""</span>)), <span class="fu">ncol</span>(temp))</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pSens) <span class="ot">&lt;-</span> <span class="fu">names</span>(temp)</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>pSens[[<span class="st">"rxGrp"</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="sc">-</span>.<span class="dv">4</span>)</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>pSens[[<span class="st">"baseDBP"</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="sc">-</span>.<span class="dv">4</span>)</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>pSens[[<span class="st">"male"</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="sc">-</span>.<span class="dv">4</span>)</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>pSens[[<span class="st">"over65"</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="sc">-</span>.<span class="dv">2</span>)</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a><span class="co"># MICE RI Imputation  ----------------------------------</span></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>z1 <span class="ot">&lt;-</span> <span class="fu">parlmice</span>(<span class="at">data =</span> temp, <span class="at">method =</span> <span class="st">"ri"</span>,</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>              <span class="at">predictorMatrix =</span> predMatrix,</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>              <span class="at">m =</span> <span class="dv">8</span>, <span class="at">maxit =</span> <span class="dv">1</span>, </span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>              <span class="at">cluster.seed =</span> <span class="dv">1031</span>, <span class="at">n.core =</span> <span class="dv">4</span>, </span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>              <span class="at">n.imp.core =</span> <span class="dv">2</span>, <span class="at">cl.type =</span> <span class="st">"FORK"</span>, </span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>              <span class="at">ridge =</span> <span class="fl">1e-04</span>, <span class="at">remove.collinear =</span> <span class="cn">TRUE</span>, </span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>              <span class="at">remove.constant =</span> <span class="cn">FALSE</span>, <span class="at">allow.na =</span> <span class="cn">TRUE</span>) </span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>z2 <span class="ot">&lt;-</span> <span class="fu">parlmice</span>(<span class="at">data =</span> temp2, <span class="at">method =</span> <span class="st">"pmm"</span>,</span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>              <span class="at">predictorMatrix =</span> predMatrix2,</span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>              <span class="at">m =</span> <span class="dv">8</span>, <span class="at">maxit =</span> <span class="dv">1</span>, </span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>              <span class="at">cluster.seed =</span> <span class="dv">1031</span>, <span class="at">n.core =</span> <span class="dv">4</span>, </span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>              <span class="at">ridge =</span> <span class="fl">1e-04</span>, <span class="at">remove.collinear =</span> <span class="cn">TRUE</span>, </span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>              <span class="at">n.imp.core =</span> <span class="dv">2</span>, <span class="at">cl.type =</span> <span class="st">"FORK"</span>) </span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>zfinal <span class="ot">&lt;-</span> <span class="fu">cbind</span>(z1, z2)</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a><span class="co"># Heckman Imputation  ----------------------------------</span></span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>baseDBP <span class="ot">&lt;-</span> temp<span class="sc">$</span>baseDBP</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>JointModelEq<span class="ot">&lt;-</span><span class="fu">generate_JointModelEq</span>(<span class="at">data=</span>temp, </span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">varMNAR=</span><span class="st">"baseDBP"</span>)</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>JointModelEq[,<span class="st">"baseDBP_var_sel"</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>JointModelEq[,<span class="st">"baseDBP_var_out"</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>arg <span class="ot">&lt;-</span> <span class="fu">MNARargument</span>(<span class="at">data =</span> temp, <span class="at">varMNAR =</span> <span class="st">"baseDBP"</span>, </span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>                    <span class="at">JointModelEq =</span> JointModelEq)</span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a>arg<span class="sc">$</span>method[<span class="st">"age"</span>] <span class="ot">&lt;-</span> <span class="st">"ri"</span></span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>arg<span class="sc">$</span>method[<span class="st">"visits"</span>] <span class="ot">&lt;-</span> <span class="st">"ri"</span></span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>arg<span class="sc">$</span>method[<span class="st">"weight"</span>] <span class="ot">&lt;-</span> <span class="st">"ri"</span></span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>arg<span class="sc">$</span>method[<span class="st">"iq"</span>] <span class="ot">&lt;-</span> <span class="st">"ri"</span></span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>arg<span class="sc">$</span>method[<span class="st">"height"</span>] <span class="ot">&lt;-</span> <span class="st">"ri"</span></span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>imp1 <span class="ot">&lt;-</span> <span class="fu">parlmice</span>(<span class="at">data =</span> arg<span class="sc">$</span>data_mod,</span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> arg<span class="sc">$</span>method,</span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>                  <span class="at">predictorMatrix =</span> arg<span class="sc">$</span>predictorMatrix,</span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>                  <span class="at">JointModelEq =</span> arg<span class="sc">$</span>JointModelEq,</span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> arg<span class="sc">$</span>control,</span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>                  <span class="at">maxit =</span> <span class="dv">1</span>, <span class="at">m =</span> <span class="dv">8</span>,</span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster.seed =</span> <span class="dv">1031</span>, <span class="at">n.core =</span> <span class="dv">4</span>, </span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>                  <span class="at">n.imp.core =</span> <span class="dv">2</span>, <span class="at">cl.type =</span> <span class="st">"FORK"</span>)</span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>analysis1 <span class="ot">&lt;-</span> <span class="fu">with</span>(zfinal, <span class="fu">glm</span>(baseDBP <span class="sc">~</span> age <span class="sc">+</span> visits <span class="sc">+</span> weight <span class="sc">+</span> iq <span class="sc">+</span> height <span class="sc">+</span> rxGrp <span class="sc">+</span> male <span class="sc">+</span> over65))</span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">pool</span>(analysis1)</span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result1)</span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>z2 <span class="ot">&lt;-</span> <span class="fu">parlmice</span>(<span class="at">data =</span> temp2, <span class="at">method =</span> <span class="st">"pmm"</span>,</span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a>              <span class="at">predictorMatrix =</span> predMatrix2,</span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>              <span class="at">m =</span> <span class="dv">8</span>, <span class="at">maxit =</span> <span class="dv">1</span>, </span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a>              <span class="at">cluster.seed =</span> <span class="dv">1031</span>, <span class="at">n.core =</span> <span class="dv">4</span>, </span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a>              <span class="at">n.imp.core =</span> <span class="dv">2</span>, <span class="at">cl.type =</span> <span class="st">"FORK"</span>) </span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a>heckman <span class="ot">&lt;-</span> <span class="fu">cbind</span>(imp1, z2)</span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>) <span class="co"># I will touch on this function below.</span></span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(zfinal, <span class="fu">here</span>(<span class="st">"Main Project"</span>, <span class="st">"Data"</span>, </span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"zfinal.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<p>Here is the workflow truly showing its advantages, <code>saveRDS()</code> is saving a very specific object (<code>zfinal</code>, the imputed dataset) into the <code>Data</code> folder by using the hierarchical structure of the folder which can easily be navigated using <code>here()</code>. Notice how to save something and use <code>here()</code> to specify the location, the first argument is <code>Main Project</code>, followed by <code>Data</code>, and then comes the object name (<code>zfinal.rds</code>).</p>
<p>Now I have saved my imputed dataset as an object called <code>zfinal.rds</code> and it is saved in the <code>Data</code> folder even though I am hypothetically working from the <code>R</code> folder.</p>
<p>Also notice that I use the <code>beep()</code> function from the <a href="https://cran.r-project.org/package=beepr">beepr</a> <code>R</code> package, which can be quite handy in letting you know if a particular script or analysis is done.</p>
<p>Next time, if I cleared my entire global environment and wanted to only load the imputed dataset, I would simply have to just click on the <code>zfinal.rds</code> file in the <code>Data</code> folder and it would load into the environment or I could use the following command,</p>
<hr>
</section>
<section id="saving-and-reading-data-carefully" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="saving-and-reading-data-carefully"><span class="header-section-number">2.8</span> Saving and Reading Data Carefully</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The function readRDS() and saveRDS()</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># are possibly the most important base R functions</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>zfinal <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"zfinal.rds"</span>, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">here</span>(<span class="st">"Main Project"</span>, <span class="st">"Data"</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"zfinal.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<p>This gives us full control over the environment, and it’s also why I encourage people to turn off the automatic prompt to save the workspace that <a href="https://rstudio.com/"><code>RStudio</code></a> gives you by default (I am certain even Hadley Wickham has said the same on multiple occasions).</p>
<p>So if I now wanted to include the imputed dataset into one of my <code>.R</code> scripts that I am trying to automate with one command, whether for reproducibility, or speed, etc., I could do it with absolute control.</p>
<p>This is also how I save my models and how I validate them, which is especially handy because running those can also take an excruciatingly long time.</p>
<p>Here’s an example of a script that would be in the <code>04-analysis.R</code> script, I’m leaving out the warning-catching script now to avoid making this too long. I don’t need to load the <a href="https://cran.r-project.org/package=brms"><code>brms</code></a> package because I’m already calling it from the first <code>.R</code> script, <code>01-functions.R</code> (but I’m just showing it for now to avoid confusion), and then I am saving it in the <code>Models</code> folder which is found in the <code>Data</code> folder. And again, the <code>beep()</code> function would let me know when the script is over, and scripts like this can often take very long, due to the computational intensity.</p>
<p>The script below is an analysis script whose results we plan on saving once completed. Due to the arguments I have set (iterations, warmups, chains, and using an imputed dataset), it can often take a long time before it is finished, and if I did happen to do other tasks while I was waiting on that, the output would automatically save to the <code>Models</code> folder via <code>saveRDS()</code>, and I would also receive a notification via the <code>beep()</code> function, preventing me from wasting any time.</p>
<hr>
</section>
<section id="example-modeling-script" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="example-modeling-script"><span class="header-section-number">2.9</span> Example Modeling Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calling all packages, please report for duty</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>)) </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"brms"</span>) </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a script I used previously</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># where I used Bayes for regularization  </span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Although these are all generic options </span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior Information  --------------------------------</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>sample_z <span class="ot">&lt;-</span> <span class="fu">complete</span>(zfinal, <span class="dv">1</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>n_1 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(sample_z) <span class="co"># of observations</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>k_1 <span class="ot">&lt;-</span> (<span class="fu">ncol</span>(sample_z) <span class="sc">-</span> <span class="dv">1</span>) <span class="co"># of predictors</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>p0_1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Prior for the number of relevant variables</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>tau0_1 <span class="ot">&lt;-</span> p0_1 <span class="sc">/</span> (k_1 <span class="sc">-</span> p0_1) <span class="sc">*</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(n_1) <span class="co"># tau scale</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Regularized horseshoe prior</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>hs_prior <span class="ot">&lt;-</span> <span class="fu">set_prior</span>(<span class="st">"horseshoe(scale_global = tau0_1, </span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="st">                      scale_slab = 1)"</span>, <span class="at">class =</span> <span class="st">"b"</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"future"</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multiprocess)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Regularized Bayesian quantile</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co"># regression using regularized horseshoe prior</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">brm_multiple</span>(</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(baseDBP <span class="sc">~</span> age <span class="sc">+</span> visits <span class="sc">+</span> weight <span class="sc">+</span> iq <span class="sc">+</span> height <span class="sc">+</span> rxGrp <span class="sc">+</span> male <span class="sc">+</span> over65, </span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">quantile =</span> <span class="fl">0.50</span>),</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> zfinal, <span class="at">prior =</span> hs_prior, </span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">family =</span> <span class="fu">asym_laplace</span>(), <span class="at">sample_prior =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">seed =</span> <span class="dv">1031</span>, <span class="at">future =</span> F,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>     <span class="at">iter =</span> <span class="dv">1000</span>, <span class="at">warmup =</span> <span class="dv">500</span>, <span class="at">chains =</span> <span class="dv">4</span>, </span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>     <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">combine =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>     <span class="at">control =</span> <span class="fu">list</span>(<span class="at">max_treedepth =</span> <span class="dv">10</span>, </span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>                    <span class="at">adapt_delta =</span> <span class="fl">0.80</span>)) <span class="ot">-&gt;</span> pen_model_1</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Principled way of saving results</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pen_model_1,   </span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>        <span class="fu">here</span>(<span class="st">"Main Project"</span>, <span class="st">"Data"</span>, <span class="st">"Models"</span>, </span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>             <span class="st">"pen_model_1.rds"</span>)) </span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<p>So I’ve saved the full contents of the fitted model (<code>pen_model_1</code>), which are usually several gigabytes large in size, within the <code>Models</code> folder. Once again, notice how the <code>here()</code> function allows you to work from a subfolder like <code>R</code>, which is inside the <code>Main Project</code> folder, and allows you to specify the hierarchy, and where you are within it, and save to whichever folder you wish, in this case <code>Models</code>, which is inside of <code>Data</code>. Now, I will typically conduct model checks and make sure it is performing well, and not misspecified,</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>)) </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect RHat values ---------------------------</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>rhats_1 <span class="ot">&lt;-</span> pen_model_1<span class="sc">$</span>rhats</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>rhats_1_df <span class="ot">&lt;-</span> (rhats_1 <span class="sc">&lt;=</span> <span class="fl">1.1</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>((<span class="fu">as.numeric</span>(<span class="fu">table</span>(rhats_1_df)) <span class="sc">/</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">nrow</span>(rhats_1_df) <span class="sc">*</span> <span class="fu">ncol</span>(rhats_1_df)) <span class="sc">*</span> <span class="dv">100</span>))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>rhats_1_vec <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(<span class="fu">c</span>(</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  rhats_1[, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(rhats_1)])))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">here</span>(<span class="st">"Outputs"</span>, <span class="st">"Figures"</span>, <span class="st">"Diagnostics"</span>, </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">"OUTCOME_COMP_rhat.pdf"</span>))</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_rhat_hist</span>(rhats_1_vec) <span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Model 1 Chain Convergence"</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect Effective Sample Size ----------------------</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_neff_hist</span>(rhats_1_vec) <span class="sc">+</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Effective Sample Size"</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect Divergences ---------------------------</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">here</span>(<span class="st">"Outputs"</span>, <span class="st">"Figures"</span>, </span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Diagnostics"</span>, <span class="st">"OUTCOME_1.pdf"</span>))</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_nuts_divergence</span>(<span class="fu">nuts_params</span>(pen_model_1), </span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">log_posterior</span>(pen_model_1))</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Residual Plots ----------------------------</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>df_resid_stan_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">fitted</span>(pen_model_1)[, <span class="dv">1</span>], </span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">residuals</span>(pen_model_1)[, <span class="dv">1</span>])</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">here</span>(<span class="st">"Outputs"</span>, <span class="st">"Figures"</span>, </span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Diagnostics"</span>, <span class="st">"OUTCOME_1.pdf"</span>))</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_resid_stan_1, </span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">residuals</span>(pen_model_1)[, <span class="dv">1</span>])) <span class="sc">+</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Model 1 Residuals"</span>)</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>(sum1 <span class="ot">&lt;-</span> (<span class="fu">posterior_summary</span>(pen_model_1))[<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>, ])</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_intervals</span>(pen_model_1, <span class="at">point_est =</span> <span class="st">"median"</span>, </span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>               <span class="at">prob =</span> <span class="fl">0.95</span>, <span class="at">prob_outer =</span> <span class="dv">0</span>, </span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>               <span class="at">pars =</span> <span class="fu">parnames</span>(pen_model_1)) <span class="sc">+</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_discrete</span>() <span class="sc">+</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>, </span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>,</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">0.05</span>, <span class="at">xmax =</span> <span class="fl">0.05</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="dv">7</span>,</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"darkred"</span>, <span class="at">alpha =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>,</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.05</span>, <span class="at">xend =</span> <span class="sc">-</span><span class="fl">0.05</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">7</span>,</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"#990000"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, </span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> .<span class="dv">75</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>,</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.05</span>, <span class="at">xend =</span> <span class="fl">0.05</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">7</span>,</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"#990000"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, </span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> .<span class="dv">75</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Change in Outcome 1"</span>)</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">here</span>(<span class="st">"Outputs"</span>, <span class="st">"Figures"</span>, <span class="st">"OUTCOME_1.pdf"</span>))</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_hist</span>(pen_model_1)</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior Predictive Checks</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">here</span>(<span class="st">"Outputs"</span>, <span class="st">"Figures"</span>, <span class="st">"Diagnostics"</span>, </span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>         <span class="st">"OUTCOME_1check.pdf"</span>))</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(pen_model_1, <span class="at">nsamples =</span> <span class="dv">250</span>) <span class="sc">+</span> </span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Posterior Predictive Check: Model 1"</span>)</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Shows dens_overlay plot by default</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>bayes_rsq1 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(pen_model_1)</span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>bayes_rsq1 <span class="ot">&lt;-</span> <span class="fu">print</span>(<span class="fu">median</span>(bayes_rsq1))</span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(sum1, <span class="fu">here</span>(<span class="st">"Outputs"</span>, <span class="st">"Tables"</span>, </span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"OUTCOME_1.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<p>Once I have fit my model and done some initial checks, I usually conduct some more thorough checks using k-fold cross-validation or nested cross-validation, or bootstrap optimism.</p>
<p>A script of this can be found below.</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 10-Fold Cross-Validations -------------------------</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>kfold_1 <span class="ot">&lt;-</span> <span class="fu">kfold</span>(pen_model_1, <span class="at">K =</span> <span class="dv">10</span>, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_fits =</span> <span class="cn">TRUE</span>, <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(kfold_1, <span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"Models"</span>, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Validation"</span>, <span class="st">"kfold_1.rds"</span>))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>kfp_1 <span class="ot">&lt;-</span> <span class="fu">kfold_predict</span>(kfold_1)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(kfp_1, <span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"Models"</span>, </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Validation"</span>, <span class="st">"kfp_1.rds"</span>))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kfold_rmse</span>(<span class="at">y =</span> kfp_1<span class="sc">$</span>y, </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">yrep =</span> kfp_1<span class="sc">$</span>yrep, </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"rmse"</span>, </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">reps =</span> <span class="dv">5000</span>, </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="at">cores =</span> <span class="dv">4</span>)[[<span class="dv">2</span>]][[<span class="st">"t"</span>]]<span class="er">)</span> <span class="ot">-&gt;</span> kfold_rmse_1</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>kfold_rmse_1 <span class="ot">&lt;-</span> <span class="fu">median</span>(kfold_rmse_1)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(kfold_rmse_1, </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"Models"</span>, </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Validation"</span>, <span class="st">"kfold_rmse_1.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<p>Once I’ve written all my analysis and validation scripts, I’ll typically create a subfolder in the <code>Outputs</code> folder called <code>Figures</code> and <code>Tables</code> and save them appropriately with the help <code>here()</code>.</p>
<hr>
</section>
<section id="example-table-script" class="level2" data-number="2.10">
<h2 data-number="2.10" class="anchored" data-anchor-id="example-table-script"><span class="header-section-number">2.10</span> Example Table Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in Validation Objects ------------------------</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>kfold_1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"kfold_1.rds"</span>, </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">here</span>(<span class="st">"Main Project"</span>, <span class="st">"Data"</span>, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Models"</span>, <span class="st">"Validation"</span>, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"kfold_1.rds"</span>))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>kfold_2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"kfold_1.rds"</span>, </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">here</span>(<span class="st">"Main Project"</span>, <span class="st">"Data"</span>, </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Models"</span>, <span class="st">"Validation"</span>, </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"kfold_2.rds"</span>))</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>kfp_1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"kfp_1.rds"</span>, </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">here</span>(<span class="st">"Main Project"</span>, <span class="st">"Data"</span>, </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Models"</span>, <span class="st">"Validation"</span>, </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"kfp_1.rds"</span>))</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>kfp_2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"kfp_1.rds"</span>, </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">here</span>(<span class="st">"Main Project"</span>, <span class="st">"Data"</span>, </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Models"</span>,<span class="st">"Validation"</span>, </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"kfp_2.rds"</span>))</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Estimates from Objects ---------------------</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>KFOLDIC_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(kfold_1[[<span class="st">"estimates"</span>]][<span class="dv">3</span>], </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>                     kfold_2[[<span class="st">"estimates"</span>]][<span class="dv">3</span>])</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>KFOLDIC_SE_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(kfold_1[[<span class="st">"estimates"</span>]][<span class="dv">3</span>, <span class="dv">2</span>], </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>                        kfold_2[[<span class="st">"estimates"</span>]][<span class="dv">3</span>, <span class="dv">2</span>])</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>BAYES_R2 <span class="ot">&lt;-</span> <span class="fu">c</span>(bayes_rsq1, bayes_rsq2), <span class="dv">2</span><span class="er">)</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>KFOLD_ELPD_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(kfold_1[[<span class="st">"estimates"</span>]][<span class="dv">1</span>], </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>                        kfold_2[[<span class="st">"estimates"</span>]][<span class="dv">1</span>])</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>KFOLD_ELPD_SE_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(kfold_1[[<span class="st">"estimates"</span>]][<span class="dv">1</span>, <span class="dv">2</span>], </span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>                           kfold_2[[<span class="st">"estimates"</span>]][<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>Outcome <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"OUTCOME_1"</span>, <span class="st">"OUTCOME_2"</span>)</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct Data Frames ------------------------------</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>table4 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Outcome, BAYES_R2, KFOLD_ELPD_1, </span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>                     KFOLD_ELPD_SE_1, KFOLDIC_1, </span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>                     KFOLDIC_SE_1)</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table4) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Outcome"</span>, <span class="st">"Bayes R^2"</span>, </span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"10-fold CV ELPD"</span>, </span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"10-fold CV ELPD SE"</span>,</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"10-fold CV IC"</span>, </span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"10-fold CV IC SE"</span>)</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Export as Tables ----------------------------------</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(table4, <span class="fu">here</span>(<span class="st">"Main Project"</span>,<span class="st">"Outputs"</span>, </span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Tables"</span>, <span class="st">"Table4.csv"</span>))</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>table5 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Outcome, KFOLD_ELPD_1, </span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>                     KFOLD_ELPD_SE_1, </span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>                     KFOLDIC_1, KFOLDIC_SE_1)</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table5) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Outcome"</span>, <span class="st">"10-fold CV ELPD"</span>, </span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"10-fold CV ELPD SE"</span>,</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"10-fold CV IC"</span>, </span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"10-fold CV IC SE"</span>)</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(table5, </span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>          <span class="fu">here</span>(<span class="st">"Main Project"</span>,<span class="st">"Outputs"</span>, <span class="st">"Tables"</span>, </span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Table5.csv"</span>))</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Tables From Sensitivity Analyses --------------</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(sens_table_OUTCOME_1, </span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>          <span class="fu">here</span>(<span class="st">"Main Project"</span>,<span class="st">"Outputs"</span>, <span class="st">"Tables"</span>, </span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Table7_OUTCOME_1.csv"</span>))</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(sens_table_OUTCOME_2, </span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>          <span class="fu">here</span>(<span class="st">"Main Project"</span>,<span class="st">"Outputs"</span>, <span class="st">"Tables"</span>, </span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Table7_OUTCOME_2.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<p>Then, I’ll go back to the <code>README.Rmd</code> file, make notes of the hierarchy of the entire folder and subfolders, and what’s been completed, and what still needs to be done.</p>
<p>Now, suppose I deleted all of my saved models, imputed data, graphs, and tables, (which would be a devastating blow!) and only had the original dataset and organized scripts. Anyone could go into my project and simply highlight the entire <code>main.R</code> file and run it, and they would get all the same outputs and models, assuming a seed was set in advance, which is essential. Although, it might take them a long time to get the same outputs (if computationally intensive)… they would likely be able to get all the exact same results.</p>
<hr>
</section>
</section>
<section id="possible-drawbacks-of-this-approach" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Possible Drawbacks of this Approach</h1>
<hr>
<p>Every proposal tends to have drawbacks or limitations, and those who do not explicitly tell you about them are misleading you. In the approach I have outlined above, one major drawback is that it takes a somewhat long time to set up and therefore could deter many statisticians and data analysts. The other drawback is that by loading all your functions and libraries in the first <code>01_functions.R</code> script, there is potential for conflict between functions, therefore you’ll have to be mindful of what packages you need and when. Indeed, I ran into this issue when loading the <code>brms</code> package, which had several functions that conflicted with the base <code>R</code> functions. So please be mindful of this.</p>
<p>Further, and most importantly, I have no evidence that this approach can truly prevent errors, it is simply a belief I have as a result of my own experiences and suggesting them to others, and hearing positive comments. So please, take that into account, although I would be grateful if you were able to share your positive or even negative experiences using this approach below.</p>
<hr>
<p>Please, please annotate your scripts, as I have done so several times above to explain some of the functions. This is not only helpful for others who are trying to go through your code and understand it, but also for yourself. If you end up forgetting what function does what, and what steps you were taking, you will be in for a really frustrating time, and possibly prone to making serious mistakes.</p>
<p>Here’s what my project folders tend to look like (figure below). And here is a <a href="https://github.com/zadrafi/statworkflow">template GitHub repo</a> to show what the structure typically looks like.</p>
<hr>
<p><img data-enlargeable="" width="400" style="cursor: zoom-in" src="https://res.cloudinary.com/less-likely/image/upload/v1592068111/Site/Screen_Shot_2020-06-13_at_11.38.26_AM.png"></p>
<hr>
<p>It should go without saying that sharing your data (if possible) and code will help you and your collaborators catch errors before it’s too late, but also, sharing them with others/the public after a project is done will <em>also</em> help catch possible errors that you/your collaborators/reviewers didn’t catch, which may mislead other researchers and also result in a much more stressful situation for you.</p>
<p>And last but not least, it is also essential to give extensive details on which version of <code>R</code> you used and which packages you used and their versions. This is because many scripts that once worked on previous versions of the software may no longer give the same results or may not even work at all. In order for someone to reproduce your results, they’ll need to know the environment on which you ran your analyses on. You can provide these details easily simply by running the script <code>sessionInfo()</code>, which should be at the end of every <code>R</code> script you run.</p>
<hr>
</section>
<section id="helpful-resources" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Helpful Resources</h1>
<hr>
<ul>
<li><a href="https://stackoverflow.com/questions/1429907/workflow-for-statistical-analysis-and-report-writing">Workflow for Statistical Analysis and Report Writing</a></li>
</ul>
<hr>
<ul>
<li><a href="https://stackoverflow.com/questions/19967478/how-to-save-data-file-into-rdata">How to Save Data File into .RData?</a></li>
</ul>
<hr>
<ul>
<li><a href="https://www.youtube.com/watch?v=Ry2xjTBtNFE">Basic Data Entry Using Excel</a></li>
</ul>
<hr>
<ul>
<li><a href="https://www.kristianbrock.com/post/send-me-data/">Sending Me Data in Excel</a></li>
</ul>
<hr>
<ul>
<li><a href="https://happygitwithr.com/">Happy Git and GitHub for the useR</a></li>
</ul>
<hr>
</section>
<section id="environment" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Environment</h1>
<hr>
<p>The analyses were run on:</p>
<hr>
<div class="cell">
<pre><code>#&gt; R version 4.5.0 (2025-04-11)
#&gt; Platform: aarch64-apple-darwin20
#&gt; Running under: macOS Sequoia 15.6.1
#&gt; 
#&gt; Matrix products: default
#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib 
#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1
#&gt; 
#&gt; Random number generation:
#&gt;  RNG:     Mersenne-Twister 
#&gt;  Normal:  Inversion 
#&gt;  Sample:  Rejection 
#&gt;  
#&gt; locale:
#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
#&gt; 
#&gt; time zone: America/New_York
#&gt; tzcode source: internal
#&gt; 
#&gt; attached base packages:
#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;  [1] htmlwidgets_1.6.4 compiler_4.5.0    fastmap_1.2.0     cli_3.6.5        
#&gt;  [5] tools_4.5.0       htmltools_0.5.8.1 rstudioapi_0.17.1 yaml_2.3.10      
#&gt;  [9] rmarkdown_2.29    knitr_1.50        jsonlite_2.0.0    xfun_0.53        
#&gt; [13] digest_0.6.37     rlang_1.1.6       evaluate_1.0.5</code></pre>
</div>
<hr>
</section>
<section id="references" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> References</h1>
<hr>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/lesslikely\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb14" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="an">layout:</span><span class="co"> post</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> 'Quality Control in Statistical Analyses'</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> 'Zad Rafi'</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2020-06-13</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="an">lastmod:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Experienced statisticians and data analysts are familiar with stories where a coding error has led to an entire conclusion changing, even leading to a retraction. It's the sort of stuff that keeps people up at night."</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="an">archives:</span><span class="co"> statistics</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="an">slug:</span><span class="co"> statistics-quality-control</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="an">url:</span><span class="co"> statistics/statistics-quality-control</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="an">zotero:</span><span class="co"> true </span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"> </span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - statistics</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="an">tags:</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">  - statistical reporting</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">  - statistical science</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">  - statistical workflow</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">  - data management</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> https://res.cloudinary.com/less-likely/image/upload/v1613136545/Site/diagram.png</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="an">og_image:</span><span class="co"> https://res.cloudinary.com/less-likely/image/upload/v1613136545/Site/diagram.png</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="an">keywords:</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">  - statistical reporting</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">  - statistics</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">  - accuracy</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">  - data science</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="an">codefolding_show:</span><span class="co"> "show"  </span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co">  blogdown::html_page:</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include = FALSE, message=FALSE}</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">collapse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">comment =</span> <span class="st">"#&gt;"</span>)</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>Experienced statisticians and data analysts are familiar with stories</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>where a coding error has led to an entire conclusion changing, [or even</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>a</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>retraction](https://jamanetwork.com/journals/jama/fullarticle/2752474).<span class="sc">\[</span>\@aboumatarNoticeRetractionAboumatar2019<span class="sc">\]</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>It's the sort of stuff that keeps people up at night. Unfortunately, not</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>many of us think about these sorts of scenarios until we realize it's</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>very possible that it could happen to any of us.</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>To me, it seems that many of these issues could be avoided by having a</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>principled data management and statistical workflow, and making it as</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>transparent, open, and reproducible as possible. I'd like to quickly go</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>over a few things that I've found helpful over the years, and I'll first</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>start with data management and data entry and then move onto analysis</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>workflows. I largely consider this to be a living document, and I'm sure</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>many people who will read this will have far better suggestions, so</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>please leave them down below in the comments!</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>Before I go on, I want to emphasize that backing up your data, scripts,</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>and <span class="co">[</span><span class="ot">using version control</span><span class="co">](https://happygitwithr.com/)</span> is extremely</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>important. There is no debate about this. It's necessary so that other</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>collaborators/colleagues can inspect your work and catch potential</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>mistakes or see overall progress, but more importantly, it will prevent</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>you from losing your data in a disaster, and it'll help you catch your</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>own mistakes, since you'll be the most familiar with the data and</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>scripts.</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Entry &amp; Management</span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>A nice paper that I'd like to review is the one by [Broman &amp; Woo,</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>2018](https://doi.org/10.1080/00031305.2017.1375989) on how to manage</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>your data when working with</span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>spreadsheets.<span class="sc">\[</span>\@bromanDataOrganizationSpreadsheets2018<span class="sc">\]</span> The sad</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>reality is that even though spreadsheets like Microsoft Excel or Google</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>Sheets are available everywhere, and easy to use, there are many risks</span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>when working with spreadsheets, just ask any [statistician who works in</span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>genetics](https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-1044-7?fbclid=IwAR06eQ5LTg2LX5byJBWfC6rJdAbAGXKvy3PUOhzPsVjUGqb7KqB1V_x36M0)</span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>or any bioinformatician.<span class="sc">\[</span>\@ziemannGeneNameErrors2016<span class="sc">\]</span></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>One of the most fatal errors [occurred</span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>recently](https://theconversation.com/why-you-should-never-use-microsoft-excel-to-count-coronavirus-cases-147681)</span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>when a group of researchers lost thousands of documented COVID cases</span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>because they entered data for each case as a column instead of a row,</span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>and Excel has a limit on how many columns and rows it can handle</span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>(**1,048,576 rows** and **16,384 columns**, [according to</span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>Microsoft](https://support.microsoft.com/en-us/office/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3)),</span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>as a result, most of these cases were lost, resulting in an enormous</span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>waste of resources due to a careless and ignorant mistake, highlighting</span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>the dangers of recklessly inputting data and conducting statistical</span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a>analyses. There is no doubt that reviewing principles of good data</span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a>management and workflow are essential to any data analyst. I'd like to</span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a>touch on some of the most important points of [Broman &amp; Woo,</span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a>2018](https://doi.org/10.1080/00031305.2017.1375989) paper before moving</span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a>onto some other "principles" I'd like to share:</span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a><span class="fu">## General Principle: Be Consistent With Everything</span></span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="dt">&gt;</span></span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When labeling missing values (<span class="in">`NA`</span>, <span class="in">`N/A`</span>, etc.):</span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#7aa864; font-weight: 700;"</span><span class="dt">&gt;</span>Good<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: Choose one method (<span class="in">`NA`</span>, <span class="in">`N/A`</span>, etc.) and stick with it.<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#CD5C5C; font-weight: 700;"</span><span class="dt">&gt;</span>Bad<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: Leaving cells empty to indicate missingness.<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a>* * *  </span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When labeling response variables: </span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#7aa864; font-weight: 700;"</span><span class="dt">&gt;</span>Good<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: If you label a response variable consistently, for example, <span class="in">`fat-free-mass`</span> in every instance to refer to the same variable.<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#CD5C5C; font-weight: 700;"</span><span class="dt">&gt;</span>Bad<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: If you label a response variable <span class="in">`fat-free-mass`</span> in one script/sheet, and <span class="in">`ffm`</span>/<span class="in">`fat_free_mass`</span> in another.<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a>* * *  </span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When formatting variable predictor names:</span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#7aa864; font-weight: 700;"</span><span class="dt">&gt;</span>Good<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: <span class="in">`predictor_1_week12`</span>, <span class="in">`predictor_2_week12`</span>, <span class="in">`response_variable_week12`</span>. This is consistent, with the order of the names, and dates/weeks, so it is easier to organize, inspect, and clean. Same thing applies to labeling response variables and pretty much all variables.<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#CD5C5C; font-weight: 700;"</span><span class="dt">&gt;</span>Bad<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: When you label one variable <span class="in">`week12_predictor_1`</span>, the next <span class="in">`predictor_2_week12`</span>, and the last, <span class="in">`12_week_response`</span>. Just _no_.<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb14-122"><a href="#cb14-122" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-123"><a href="#cb14-123" aria-hidden="true" tabindex="-1"></a>* * *  </span>
<span id="cb14-124"><a href="#cb14-124" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-125"><a href="#cb14-125" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When formatting dates:</span>
<span id="cb14-126"><a href="#cb14-126" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#7aa864; font-weight: 700;"</span><span class="dt">&gt;</span>Good<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: Use one format, <span class="in">`YYYY-MM-DD`</span>, consistently.<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb14-127"><a href="#cb14-127" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#CD5C5C; font-weight: 700;"</span><span class="dt">&gt;</span>Bad<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: Everything else.<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span>  </span>
<span id="cb14-128"><a href="#cb14-128" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-129"><a href="#cb14-129" aria-hidden="true" tabindex="-1"></a>* * *  </span>
<span id="cb14-130"><a href="#cb14-130" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-131"><a href="#cb14-131" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When filling out cells:</span>
<span id="cb14-132"><a href="#cb14-132" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#7aa864; font-weight: 700;"</span><span class="dt">&gt;</span>Good<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: One cell = one thing. No more, no less.<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb14-133"><a href="#cb14-133" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#CD5C5C; font-weight: 700;"</span><span class="dt">&gt;</span>Bad<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: One cell = multiple entries or no entries at all.<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span>  </span>
<span id="cb14-134"><a href="#cb14-134" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-135"><a href="#cb14-135" aria-hidden="true" tabindex="-1"></a>* * *  </span>
<span id="cb14-136"><a href="#cb14-136" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-137"><a href="#cb14-137" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When keeping track of the data:</span>
<span id="cb14-138"><a href="#cb14-138" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#7aa864; font-weight: 700;"</span><span class="dt">&gt;</span>Good<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: Create a comprehensive data dictionary so anyone can look at it and understand the spreadsheets/dataframes/variables. <span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb14-139"><a href="#cb14-139" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#CD5C5C; font-weight: 700;"</span><span class="dt">&gt;</span>Bad<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: Expecting yourself and others to figure it out based on the variable names that you thought were brilliant.<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span>  </span>
<span id="cb14-140"><a href="#cb14-140" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-141"><a href="#cb14-141" aria-hidden="true" tabindex="-1"></a>* * *  </span>
<span id="cb14-142"><a href="#cb14-142" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-143"><a href="#cb14-143" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When using Excel or Google Sheet's shiny features:</span>
<span id="cb14-144"><a href="#cb14-144" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#7aa864; font-weight: 700;"</span><span class="dt">&gt;</span>Good<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: Avoid using any of them, any formulas, highlighting, _italicizing_, <span class="dt">&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"font-weight:700;"</span><span class="dt">&gt;</span>bolding<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>, etc.<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb14-145"><a href="#cb14-145" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#CD5C5C; font-weight: 700;"</span><span class="dt">&gt;</span>Bad<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: If you're the type of person to create charts in Excel.<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span>  </span>
<span id="cb14-146"><a href="#cb14-146" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-147"><a href="#cb14-147" aria-hidden="true" tabindex="-1"></a>* * *  </span>
<span id="cb14-148"><a href="#cb14-148" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-149"><a href="#cb14-149" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Planning for disasters:</span>
<span id="cb14-150"><a href="#cb14-150" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#7aa864; font-weight: 700;"</span><span class="dt">&gt;</span>Good<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: Always, always, backup your files, save them in .txt files. Keep backups of those. And most importantly, <span class="co">[</span><span class="ot">**use version control!**</span><span class="co">](https://happygitwithr.com/)</span><span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb14-151"><a href="#cb14-151" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#CD5C5C; font-weight: 700;"</span><span class="dt">&gt;</span>Bad<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: You don't really plan for disasters and go with the flow.<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span>  </span>
<span id="cb14-152"><a href="#cb14-152" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span>
<span id="cb14-153"><a href="#cb14-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-154"><a href="#cb14-154" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-155"><a href="#cb14-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-156"><a href="#cb14-156" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Last but not least, when entering cases:</span>
<span id="cb14-157"><a href="#cb14-157" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb14-158"><a href="#cb14-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-159"><a href="#cb14-159" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#7aa864; font-weight: 700;"</span><span class="dt">&gt;</span>Good<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: Rows</span>
<span id="cb14-160"><a href="#cb14-160" aria-hidden="true" tabindex="-1"></a>        are for cases and observations, and columns are for variables</span>
<span id="cb14-161"><a href="#cb14-161" aria-hidden="true" tabindex="-1"></a>        and characteristics. Please do not switch these up!</span>
<span id="cb14-162"><a href="#cb14-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-163"><a href="#cb14-163" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb14-164"><a href="#cb14-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-165"><a href="#cb14-165" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">span</span><span class="ot"> style</span><span class="op">=</span><span class="st">"color:#CD5C5C; font-weight: 700;"</span><span class="dt">&gt;</span>Bad<span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span>: Using</span>
<span id="cb14-166"><a href="#cb14-166" aria-hidden="true" tabindex="-1"></a>        them interchangeably.</span>
<span id="cb14-167"><a href="#cb14-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-168"><a href="#cb14-168" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-169"><a href="#cb14-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-170"><a href="#cb14-170" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setting Up a Principled Statistical Workflow</span></span>
<span id="cb14-171"><a href="#cb14-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-172"><a href="#cb14-172" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-173"><a href="#cb14-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-174"><a href="#cb14-174" aria-hidden="true" tabindex="-1"></a>Here's what I've been doing for many years and what seems to work for me</span>
<span id="cb14-175"><a href="#cb14-175" aria-hidden="true" tabindex="-1"></a>(none of these ideas are originally mine, and I actually picked them up</span>
<span id="cb14-176"><a href="#cb14-176" aria-hidden="true" tabindex="-1"></a>over the years from others' advice, which will be linked below).</span>
<span id="cb14-177"><a href="#cb14-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-178"><a href="#cb14-178" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-179"><a href="#cb14-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-180"><a href="#cb14-180" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setting up the Project Folder</span></span>
<span id="cb14-181"><a href="#cb14-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-182"><a href="#cb14-182" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-183"><a href="#cb14-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-184"><a href="#cb14-184" aria-hidden="true" tabindex="-1"></a>When setting up a folder specific for a project (if you're not doing</span>
<span id="cb14-185"><a href="#cb14-185" aria-hidden="true" tabindex="-1"></a>this, you absolutely need to), first, I will create a folder with the</span>
<span id="cb14-186"><a href="#cb14-186" aria-hidden="true" tabindex="-1"></a>title of my project, and usually have an</span>
<span id="cb14-187"><a href="#cb14-187" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`RStudio`</span><span class="co">](https://rstudio.com/)</span> project set up in there.</span>
<span id="cb14-188"><a href="#cb14-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-189"><a href="#cb14-189" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-190"><a href="#cb14-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-191"><a href="#cb14-191" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Disclaimer: while much of this advice will be familiar and easy to</span></span>
<span id="cb14-192"><a href="#cb14-192" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; understand for those who use </span><span class="in">`R`</span><span class="at">, I think the general principles are</span></span>
<span id="cb14-193"><a href="#cb14-193" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; widely applicable, especially for those who use scripts in their</span></span>
<span id="cb14-194"><a href="#cb14-194" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; statistical software).</span></span>
<span id="cb14-195"><a href="#cb14-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-196"><a href="#cb14-196" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-197"><a href="#cb14-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-198"><a href="#cb14-198" aria-hidden="true" tabindex="-1"></a>This folder will contain many other folders (more on that below), so the</span>
<span id="cb14-199"><a href="#cb14-199" aria-hidden="true" tabindex="-1"></a>structure will end up being a bit complex.</span>
<span id="cb14-200"><a href="#cb14-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-201"><a href="#cb14-201" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-202"><a href="#cb14-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-203"><a href="#cb14-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Structure of Workflow, eval=FALSE, include=FALSE}</span></span>
<span id="cb14-204"><a href="#cb14-204" aria-hidden="true" tabindex="-1"></a> diagram <span class="ot">&lt;-</span>  DiagrammeR<span class="sc">::</span><span class="fu">grViz</span>(<span class="st">"digraph {</span></span>
<span id="cb14-205"><a href="#cb14-205" aria-hidden="true" tabindex="-1"></a><span class="st">  graph [layout = dot, rankdir = TB, </span></span>
<span id="cb14-206"><a href="#cb14-206" aria-hidden="true" tabindex="-1"></a><span class="st">         compound = true, </span></span>
<span id="cb14-207"><a href="#cb14-207" aria-hidden="true" tabindex="-1"></a><span class="st">         nodesep = .5, ranksep = .25]</span></span>
<span id="cb14-208"><a href="#cb14-208" aria-hidden="true" tabindex="-1"></a><span class="st">  node [shape = circle,</span></span>
<span id="cb14-209"><a href="#cb14-209" aria-hidden="true" tabindex="-1"></a><span class="st">      fixedsize = true,</span></span>
<span id="cb14-210"><a href="#cb14-210" aria-hidden="true" tabindex="-1"></a><span class="st">      fontsize = 9.5,</span></span>
<span id="cb14-211"><a href="#cb14-211" aria-hidden="true" tabindex="-1"></a><span class="st">      fontname = Helvetica, </span></span>
<span id="cb14-212"><a href="#cb14-212" aria-hidden="true" tabindex="-1"></a><span class="st">      fontcolor = '#000000',</span></span>
<span id="cb14-213"><a href="#cb14-213" aria-hidden="true" tabindex="-1"></a><span class="st">      width = .99,</span></span>
<span id="cb14-214"><a href="#cb14-214" aria-hidden="true" tabindex="-1"></a><span class="st">      height = .99,</span></span>
<span id="cb14-215"><a href="#cb14-215" aria-hidden="true" tabindex="-1"></a><span class="st">      style = filled,</span></span>
<span id="cb14-216"><a href="#cb14-216" aria-hidden="true" tabindex="-1"></a><span class="st">      color = '#91A3B0',</span></span>
<span id="cb14-217"><a href="#cb14-217" aria-hidden="true" tabindex="-1"></a><span class="st">      label = '']</span></span>
<span id="cb14-218"><a href="#cb14-218" aria-hidden="true" tabindex="-1"></a><span class="st">  edge [color = grey, arrowhead = normal, arrowtail = inv]    </span></span>
<span id="cb14-219"><a href="#cb14-219" aria-hidden="true" tabindex="-1"></a><span class="st">  rec1 [label = 'Main Project </span><span class="sc">\n</span><span class="st">Folder']</span></span>
<span id="cb14-220"><a href="#cb14-220" aria-hidden="true" tabindex="-1"></a><span class="st">  rec2 [label = 'Data </span><span class="sc">\n</span><span class="st">Folder', fillcolor = '#3f8f9b']</span></span>
<span id="cb14-221"><a href="#cb14-221" aria-hidden="true" tabindex="-1"></a><span class="st">  rec3 [label =  'R Scripts </span><span class="sc">\n</span><span class="st">Folder', fillcolor = '#7aa864']</span></span>
<span id="cb14-222"><a href="#cb14-222" aria-hidden="true" tabindex="-1"></a><span class="st">  rec4 [label = 'Errors </span><span class="sc">\n</span><span class="st">Folder', fillcolor = '#d46c5b']</span></span>
<span id="cb14-223"><a href="#cb14-223" aria-hidden="true" tabindex="-1"></a><span class="st">  rec5 [label = 'Outputs </span><span class="sc">\n</span><span class="st">Folder', fillcolor = '#E69F00']</span></span>
<span id="cb14-224"><a href="#cb14-224" aria-hidden="true" tabindex="-1"></a><span class="st">  rec6 [label = 'README.md </span><span class="sc">\n</span><span class="st">File', fillcolor = pink]</span></span>
<span id="cb14-225"><a href="#cb14-225" aria-hidden="true" tabindex="-1"></a><span class="st">  rec7 [label = '.here </span><span class="sc">\n</span><span class="st">File', fillcolor = white]</span></span>
<span id="cb14-226"><a href="#cb14-226" aria-hidden="true" tabindex="-1"></a><span class="st">  rec8 [label = 'Reports </span><span class="sc">\n</span><span class="st">Folder', fillcolor = '#91A3B0']</span></span>
<span id="cb14-227"><a href="#cb14-227" aria-hidden="true" tabindex="-1"></a><span class="st">  rec9 [label = 'Stored Models </span><span class="sc">\n</span><span class="st">Folder', fillcolor = '#3f8f9b']</span></span>
<span id="cb14-228"><a href="#cb14-228" aria-hidden="true" tabindex="-1"></a><span class="st">  rec10 [label = 'source.R', fillcolor = '#7aa864']</span></span>
<span id="cb14-229"><a href="#cb14-229" aria-hidden="true" tabindex="-1"></a><span class="st">  rec11 [label = '02-cleaning.txt', fillcolor = '#d46c5b']</span></span>
<span id="cb14-230"><a href="#cb14-230" aria-hidden="true" tabindex="-1"></a><span class="st">  rec12 [label = 'Figures </span><span class="sc">\n</span><span class="st">Folder', fillcolor = '#E69F00']</span></span>
<span id="cb14-231"><a href="#cb14-231" aria-hidden="true" tabindex="-1"></a><span class="st">  rec13 [label = 'HTML Files </span><span class="sc">\n</span><span class="st">Folder', fillcolor = '#91A3B0']</span></span>
<span id="cb14-232"><a href="#cb14-232" aria-hidden="true" tabindex="-1"></a><span class="st">  rec14 [label = 'Spreadsheets </span><span class="sc">\n</span><span class="st">Folder', fillcolor = '#3f8f9b']</span></span>
<span id="cb14-233"><a href="#cb14-233" aria-hidden="true" tabindex="-1"></a><span class="st">  rec15 [label = '01-functions.R', fillcolor = '#7aa864']</span></span>
<span id="cb14-234"><a href="#cb14-234" aria-hidden="true" tabindex="-1"></a><span class="st">  rec16 [label = '03-inspection.txt', fillcolor = '#d46c5b']</span></span>
<span id="cb14-235"><a href="#cb14-235" aria-hidden="true" tabindex="-1"></a><span class="st">  rec17 [label = 'Tables </span><span class="sc">\n</span><span class="st">Folder', fillcolor = '#E69F00']</span></span>
<span id="cb14-236"><a href="#cb14-236" aria-hidden="true" tabindex="-1"></a><span class="st">  rec18 [label = 'Text Files </span><span class="sc">\n</span><span class="st">Folder', fillcolor = '#3f8f9b']</span></span>
<span id="cb14-237"><a href="#cb14-237" aria-hidden="true" tabindex="-1"></a><span class="st">  rec19 [label = '02-cleaning.R', fillcolor = '#7aa864']</span></span>
<span id="cb14-238"><a href="#cb14-238" aria-hidden="true" tabindex="-1"></a><span class="st">  rec20 [label = '04-analysis.txt', fillcolor = '#d46c5b']</span></span>
<span id="cb14-239"><a href="#cb14-239" aria-hidden="true" tabindex="-1"></a><span class="st">  rec21 [label = 'Manuscripts </span><span class="sc">\n</span><span class="st">Folder', fillcolor = '#91A3B0']</span></span>
<span id="cb14-240"><a href="#cb14-240" aria-hidden="true" tabindex="-1"></a><span class="st">  rec22 [label = '03-inspection.R', fillcolor = '#7aa864']</span></span>
<span id="cb14-241"><a href="#cb14-241" aria-hidden="true" tabindex="-1"></a><span class="st">  rec23 [label = '05-sensitivity.txt', fillcolor = '#d46c5b']</span></span>
<span id="cb14-242"><a href="#cb14-242" aria-hidden="true" tabindex="-1"></a><span class="st">  rec24 [label = 'LaTeX Files </span><span class="sc">\n</span><span class="st">Folder', fillcolor = '#91A3B0']</span></span>
<span id="cb14-243"><a href="#cb14-243" aria-hidden="true" tabindex="-1"></a><span class="st">  rec25 [label = '04-analysis.R', fillcolor = '#7aa864']</span></span>
<span id="cb14-244"><a href="#cb14-244" aria-hidden="true" tabindex="-1"></a><span class="st">  rec26 [label = '06-tables.txt', fillcolor = '#d46c5b']</span></span>
<span id="cb14-245"><a href="#cb14-245" aria-hidden="true" tabindex="-1"></a><span class="st">  rec27 [label = '05-sensitivity.R', fillcolor = '#7aa864']</span></span>
<span id="cb14-246"><a href="#cb14-246" aria-hidden="true" tabindex="-1"></a><span class="st">  rec28 [label = '06-tables.R', fillcolor = '#7aa864']</span></span>
<span id="cb14-247"><a href="#cb14-247" aria-hidden="true" tabindex="-1"></a><span class="st">  rec29 [label = '.git Files ', fillcolor = white]</span></span>
<span id="cb14-248"><a href="#cb14-248" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb14-249"><a href="#cb14-249" aria-hidden="true" tabindex="-1"></a><span class="st">  # edge definitions with the node IDs</span></span>
<span id="cb14-250"><a href="#cb14-250" aria-hidden="true" tabindex="-1"></a><span class="st">  {rec7 rec6 rec29} -&gt; rec1 -&gt; {rec2 rec3 rec4 rec5 rec8}</span></span>
<span id="cb14-251"><a href="#cb14-251" aria-hidden="true" tabindex="-1"></a><span class="st">  {rec3 -&gt; rec10}</span></span>
<span id="cb14-252"><a href="#cb14-252" aria-hidden="true" tabindex="-1"></a><span class="st">  {rec10-&gt; rec15-&gt; rec19-&gt; rec22} </span></span>
<span id="cb14-253"><a href="#cb14-253" aria-hidden="true" tabindex="-1"></a><span class="st"> {rec10 -&gt; rec25-&gt; rec27-&gt; rec28}</span></span>
<span id="cb14-254"><a href="#cb14-254" aria-hidden="true" tabindex="-1"></a><span class="st">  rec5 -&gt; {rec12 rec17} </span></span>
<span id="cb14-255"><a href="#cb14-255" aria-hidden="true" tabindex="-1"></a><span class="st">  rec8 -&gt; {rec13 rec21}  </span></span>
<span id="cb14-256"><a href="#cb14-256" aria-hidden="true" tabindex="-1"></a><span class="st">  rec21-&gt; rec24</span></span>
<span id="cb14-257"><a href="#cb14-257" aria-hidden="true" tabindex="-1"></a><span class="st">  rec2 -&gt; {rec9 rec14 rec18}</span></span>
<span id="cb14-258"><a href="#cb14-258" aria-hidden="true" tabindex="-1"></a><span class="st">  rec4 -&gt; rec11-&gt; rec16 </span></span>
<span id="cb14-259"><a href="#cb14-259" aria-hidden="true" tabindex="-1"></a><span class="st">  rec4 -&gt; rec20-&gt; rec23-&gt; rec26</span></span>
<span id="cb14-260"><a href="#cb14-260" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb14-261"><a href="#cb14-261" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span>, <span class="at">height =</span> <span class="dv">700</span>, <span class="at">width =</span> <span class="dv">700</span>)</span>
<span id="cb14-262"><a href="#cb14-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-263"><a href="#cb14-263" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(vtree)</span>
<span id="cb14-264"><a href="#cb14-264" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-265"><a href="#cb14-265" aria-hidden="true" tabindex="-1"></a> diagram1 <span class="ot">&lt;-</span> <span class="fu">grVizToImageFile</span>(diagram, <span class="at">width =</span> <span class="cn">NULL</span>, <span class="at">height =</span> <span class="cn">NULL</span>, <span class="at">format =</span><span class="st">"pdf"</span>,</span>
<span id="cb14-266"><a href="#cb14-266" aria-hidden="true" tabindex="-1"></a>             <span class="at">folder =</span> <span class="st">"."</span>, <span class="at">filename =</span> <span class="st">"diagram.pdf"</span>)</span>
<span id="cb14-267"><a href="#cb14-267" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb14-268"><a href="#cb14-268" aria-hidden="true" tabindex="-1"></a>  diagram2 <span class="ot">&lt;-</span> <span class="fu">grVizToImageFile</span>(diagram, <span class="at">width =</span> <span class="cn">NULL</span>, <span class="at">height =</span> <span class="cn">NULL</span>, <span class="at">format =</span><span class="st">"png"</span>,</span>
<span id="cb14-269"><a href="#cb14-269" aria-hidden="true" tabindex="-1"></a>             <span class="at">folder =</span> <span class="st">"."</span>, <span class="at">filename =</span> <span class="st">"diagram.png"</span>)</span>
<span id="cb14-270"><a href="#cb14-270" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb14-271"><a href="#cb14-271" aria-hidden="true" tabindex="-1"></a>pdftools<span class="sc">::</span><span class="fu">pdf_convert</span>(<span class="st">"/Users/zad/Desktop/GitHub/LessLikely/content/post/statistics/diagram.pdf"</span>, <span class="st">"png"</span>, <span class="dv">1</span>, <span class="st">"/Users/zad/Desktop/GitHub/LessLikely/content/post/statistics/diagram.png"</span>)</span>
<span id="cb14-272"><a href="#cb14-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-273"><a href="#cb14-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-274"><a href="#cb14-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-275"><a href="#cb14-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE, include = FALSE, fig.height=5, fig.width=5}</span></span>
<span id="cb14-276"><a href="#cb14-276" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb14-277"><a href="#cb14-277" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb14-278"><a href="#cb14-278" aria-hidden="true" tabindex="-1"></a>URL <span class="ot">&lt;-</span> <span class="st">"~/Desktop/GitHub/LessLikely/content/post/statistics/diagram.pdf"</span></span>
<span id="cb14-279"><a href="#cb14-279" aria-hidden="true" tabindex="-1"></a>URL2 <span class="ot">&lt;-</span> <span class="st">"~/Desktop/GitHub/LessLikely/content/post/statistics/diagram.png"</span></span>
<span id="cb14-280"><a href="#cb14-280" aria-hidden="true" tabindex="-1"></a><span class="fu">include_graphics</span>(URL, <span class="at">auto_pdf =</span> T, <span class="at">error =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb14-281"><a href="#cb14-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">render_markdown</span>(<span class="at">strict =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-282"><a href="#cb14-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-283"><a href="#cb14-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-284"><a href="#cb14-284" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> data-enlargeable style</span><span class="op">=</span><span class="st">"cursor: zoom-in"</span><span class="ot"> src</span><span class="op">=</span><span class="st">"https://res.cloudinary.com/less-likely/image/upload/v1613136545/Site/diagram.png"</span><span class="ot"> alt</span><span class="op">=</span><span class="st">"workflow"</span><span class="dt">/&gt;</span></span>
<span id="cb14-285"><a href="#cb14-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-286"><a href="#cb14-286" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-287"><a href="#cb14-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-288"><a href="#cb14-288" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; It may be a bit difficult to read the words within the circles, but</span></span>
<span id="cb14-289"><a href="#cb14-289" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; clicking on the diagram should enlargen it and allow you to zoom in,</span></span>
<span id="cb14-290"><a href="#cb14-290" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; giving you a sense of how I organize all these scripts and files.</span></span>
<span id="cb14-291"><a href="#cb14-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-292"><a href="#cb14-292" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-293"><a href="#cb14-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-294"><a href="#cb14-294" aria-hidden="true" tabindex="-1"></a>If this ends up confusing you, you can just scroll all the way down to</span>
<span id="cb14-295"><a href="#cb14-295" aria-hidden="true" tabindex="-1"></a>see an image of what the folder structure looks like.</span>
<span id="cb14-296"><a href="#cb14-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-297"><a href="#cb14-297" aria-hidden="true" tabindex="-1"></a>Instead of constantly changing the working directory to each subfolder</span>
<span id="cb14-298"><a href="#cb14-298" aria-hidden="true" tabindex="-1"></a>when I need to do something inside that subfolder for a particular</span>
<span id="cb14-299"><a href="#cb14-299" aria-hidden="true" tabindex="-1"></a>project or analysis, I set the project folder as the working directory</span>
<span id="cb14-300"><a href="#cb14-300" aria-hidden="true" tabindex="-1"></a>only once, and then run the following:</span>
<span id="cb14-301"><a href="#cb14-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-302"><a href="#cb14-302" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-303"><a href="#cb14-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-304"><a href="#cb14-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Setting Project Folder, eval=FALSE, include=TRUE}</span></span>
<span id="cb14-305"><a href="#cb14-305" aria-hidden="true" tabindex="-1"></a><span class="co"># Very seriously consider installing the `here` package</span></span>
<span id="cb14-306"><a href="#cb14-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-307"><a href="#cb14-307" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/package=here</span></span>
<span id="cb14-308"><a href="#cb14-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-309"><a href="#cb14-309" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"here"</span>) </span>
<span id="cb14-310"><a href="#cb14-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-311"><a href="#cb14-311" aria-hidden="true" tabindex="-1"></a><span class="co"># This and the scripts below take</span></span>
<span id="cb14-312"><a href="#cb14-312" aria-hidden="true" tabindex="-1"></a><span class="co"># the directory used and set it as the top</span></span>
<span id="cb14-313"><a href="#cb14-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-314"><a href="#cb14-314" aria-hidden="true" tabindex="-1"></a><span class="fu">set_here</span>() </span>
<span id="cb14-315"><a href="#cb14-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-316"><a href="#cb14-316" aria-hidden="true" tabindex="-1"></a><span class="fu">here</span>()</span>
<span id="cb14-317"><a href="#cb14-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-318"><a href="#cb14-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-319"><a href="#cb14-319" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-320"><a href="#cb14-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-321"><a href="#cb14-321" aria-hidden="true" tabindex="-1"></a>This not only sets the working directory, but gives you far more control</span>
<span id="cb14-322"><a href="#cb14-322" aria-hidden="true" tabindex="-1"></a>over how you can save your files from any place within the hierarchical</span>
<span id="cb14-323"><a href="#cb14-323" aria-hidden="true" tabindex="-1"></a>folder structure. It will create a file called <span class="in">`.here`</span> inside the</span>
<span id="cb14-324"><a href="#cb14-324" aria-hidden="true" tabindex="-1"></a><span class="in">`Main Project`</span> folder, which will indicate that this is the top level of</span>
<span id="cb14-325"><a href="#cb14-325" aria-hidden="true" tabindex="-1"></a>the hierarchy.</span>
<span id="cb14-326"><a href="#cb14-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-327"><a href="#cb14-327" aria-hidden="true" tabindex="-1"></a>Then, I will usually have created a <span class="in">`README.Rmd`</span> file in the</span>
<span id="cb14-328"><a href="#cb14-328" aria-hidden="true" tabindex="-1"></a><span class="in">`Main Project`</span> folder with updates on what I've done and what I still</span>
<span id="cb14-329"><a href="#cb14-329" aria-hidden="true" tabindex="-1"></a>need to work on, so I will remember and so my collaborators can see it</span>
<span id="cb14-330"><a href="#cb14-330" aria-hidden="true" tabindex="-1"></a>too (when it has been pushed to GitHub or other [version</span>
<span id="cb14-331"><a href="#cb14-331" aria-hidden="true" tabindex="-1"></a>control](https://happygitwithr.com/) repos).</span>
<span id="cb14-332"><a href="#cb14-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-333"><a href="#cb14-333" aria-hidden="true" tabindex="-1"></a>Next, I'll set up a <span class="in">`Data`</span> folder inside the <span class="in">`Main Project`</span> folder. This</span>
<span id="cb14-334"><a href="#cb14-334" aria-hidden="true" tabindex="-1"></a>is where all my data/spreadsheets/.txt files and data dictionaries will</span>
<span id="cb14-335"><a href="#cb14-335" aria-hidden="true" tabindex="-1"></a>go. The original data files will stay inside this folder, while I create</span>
<span id="cb14-336"><a href="#cb14-336" aria-hidden="true" tabindex="-1"></a>two other subsubfolders inside this <span class="in">`Data`</span> folder called <span class="in">`Transformed`</span></span>
<span id="cb14-337"><a href="#cb14-337" aria-hidden="true" tabindex="-1"></a>and <span class="in">`Models`</span>. In <span class="in">`Transformed`</span>, I will typically save <span class="in">`.rds`</span> files that</span>
<span id="cb14-338"><a href="#cb14-338" aria-hidden="true" tabindex="-1"></a>were a result of cleaning and transforming the data, including imputing</span>
<span id="cb14-339"><a href="#cb14-339" aria-hidden="true" tabindex="-1"></a>missing data. I will touch more on exactly how I do that later below. A</span>
<span id="cb14-340"><a href="#cb14-340" aria-hidden="true" tabindex="-1"></a><span class="in">`Models`</span> subfolder will obviously store fitted models and any</span>
<span id="cb14-341"><a href="#cb14-341" aria-hidden="true" tabindex="-1"></a>validation/sensitivity analyses of those</span>
<span id="cb14-342"><a href="#cb14-342" aria-hidden="true" tabindex="-1"></a>models.<span class="sc">\[</span>\@morrisChoosingSensitivityAnalyses2014<span class="sc">\]</span></span>
<span id="cb14-343"><a href="#cb14-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-344"><a href="#cb14-344" aria-hidden="true" tabindex="-1"></a>Now, back to the <span class="in">`Main Project`</span> folder, I'll set up another folder</span>
<span id="cb14-345"><a href="#cb14-345" aria-hidden="true" tabindex="-1"></a>within it called <span class="in">`R`</span>. This will be where all of my <span class="in">`.R`</span> scripts/files</span>
<span id="cb14-346"><a href="#cb14-346" aria-hidden="true" tabindex="-1"></a>live. I will number them sequentially along with a title for a specific</span>
<span id="cb14-347"><a href="#cb14-347" aria-hidden="true" tabindex="-1"></a>purpose, like so</span>
<span id="cb14-348"><a href="#cb14-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-349"><a href="#cb14-349" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-350"><a href="#cb14-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-351"><a href="#cb14-351" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`main.R`</span></span>
<span id="cb14-352"><a href="#cb14-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-353"><a href="#cb14-353" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`01-functions.R`</span></span>
<span id="cb14-354"><a href="#cb14-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-355"><a href="#cb14-355" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`02-cleaning.R`</span></span>
<span id="cb14-356"><a href="#cb14-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-357"><a href="#cb14-357" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`03-inspection.R`</span></span>
<span id="cb14-358"><a href="#cb14-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-359"><a href="#cb14-359" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`04-analysis.R`</span></span>
<span id="cb14-360"><a href="#cb14-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-361"><a href="#cb14-361" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`04.5-validation.R`</span></span>
<span id="cb14-362"><a href="#cb14-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-363"><a href="#cb14-363" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`05-sensitivity.R`</span></span>
<span id="cb14-364"><a href="#cb14-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-365"><a href="#cb14-365" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`06-tables.R`</span></span>
<span id="cb14-366"><a href="#cb14-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-367"><a href="#cb14-367" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-368"><a href="#cb14-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-369"><a href="#cb14-369" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setting up the Functions Script</span></span>
<span id="cb14-370"><a href="#cb14-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-371"><a href="#cb14-371" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-372"><a href="#cb14-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-373"><a href="#cb14-373" aria-hidden="true" tabindex="-1"></a>All potential <span class="in">`R`</span> packages and custom functions that I need will belong</span>
<span id="cb14-374"><a href="#cb14-374" aria-hidden="true" tabindex="-1"></a>in <span class="in">`01-functions.R`</span>. This <span class="in">`.R`</span> file will only serve this purpose and</span>
<span id="cb14-375"><a href="#cb14-375" aria-hidden="true" tabindex="-1"></a>nothing else. As you've guessed by now, the other <span class="in">`.R`</span> files will be</span>
<span id="cb14-376"><a href="#cb14-376" aria-hidden="true" tabindex="-1"></a>doing the same, they have very specific purposes and are organized to</span>
<span id="cb14-377"><a href="#cb14-377" aria-hidden="true" tabindex="-1"></a>reflect this.</span>
<span id="cb14-378"><a href="#cb14-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-379"><a href="#cb14-379" aria-hidden="true" tabindex="-1"></a>An example of the first script can be found below.</span>
<span id="cb14-380"><a href="#cb14-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-381"><a href="#cb14-381" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-382"><a href="#cb14-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-383"><a href="#cb14-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Beginning Functions Script, eval=FALSE, include=TRUE}</span></span>
<span id="cb14-384"><a href="#cb14-384" aria-hidden="true" tabindex="-1"></a><span class="co"># Necessary Packages ------------------------------------</span></span>
<span id="cb14-385"><a href="#cb14-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-386"><a href="#cb14-386" aria-hidden="true" tabindex="-1"></a>req_packs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rms"</span>, <span class="st">"concurve"</span>, <span class="st">"mice"</span>, </span>
<span id="cb14-387"><a href="#cb14-387" aria-hidden="true" tabindex="-1"></a>               <span class="st">"tidyverse"</span>, <span class="st">"parallel"</span>, </span>
<span id="cb14-388"><a href="#cb14-388" aria-hidden="true" tabindex="-1"></a>               <span class="st">"bayesplot"</span>, <span class="st">"projpred"</span>, </span>
<span id="cb14-389"><a href="#cb14-389" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Hmisc"</span>, <span class="st">"loo"</span>, <span class="st">"rstan"</span>, <span class="st">"here"</span>,</span>
<span id="cb14-390"><a href="#cb14-390" aria-hidden="true" tabindex="-1"></a>               <span class="st">"tryCatchLog"</span>, <span class="st">"futile.logger"</span>, </span>
<span id="cb14-391"><a href="#cb14-391" aria-hidden="true" tabindex="-1"></a>               <span class="st">"patchwork"</span>, <span class="st">"corrplot"</span>, <span class="st">"beepr"</span>, </span>
<span id="cb14-392"><a href="#cb14-392" aria-hidden="true" tabindex="-1"></a>               <span class="st">"summarytools"</span>, <span class="st">"broom"</span>, <span class="st">"wakefield"</span>, </span>
<span id="cb14-393"><a href="#cb14-393" aria-hidden="true" tabindex="-1"></a>               <span class="st">"boot"</span>, <span class="st">"mfp"</span>, <span class="st">"knitr"</span>, <span class="st">"flextable"</span>, </span>
<span id="cb14-394"><a href="#cb14-394" aria-hidden="true" tabindex="-1"></a>               <span class="st">"MASS"</span>, <span class="st">"lme4"</span>, <span class="st">"brms"</span>, <span class="st">"miceMNAR"</span>)</span>
<span id="cb14-395"><a href="#cb14-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-396"><a href="#cb14-396" aria-hidden="true" tabindex="-1"></a><span class="co"># Load all packages at once</span></span>
<span id="cb14-397"><a href="#cb14-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-398"><a href="#cb14-398" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(req_packs, library, </span>
<span id="cb14-399"><a href="#cb14-399" aria-hidden="true" tabindex="-1"></a>       <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-400"><a href="#cb14-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-401"><a href="#cb14-401" aria-hidden="true" tabindex="-1"></a><span class="co"># Loggings messages </span></span>
<span id="cb14-402"><a href="#cb14-402" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">keep.source =</span> <span class="cn">TRUE</span>)        </span>
<span id="cb14-403"><a href="#cb14-403" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"tryCatchLog.write.error.dump.file"</span> <span class="ot">=</span> <span class="cn">TRUE</span>) </span>
<span id="cb14-404"><a href="#cb14-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-405"><a href="#cb14-405" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for random number generator</span></span>
<span id="cb14-406"><a href="#cb14-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-407"><a href="#cb14-407" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb14-408"><a href="#cb14-408" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1031</span>) <span class="co"># My birthday</span></span>
<span id="cb14-409"><a href="#cb14-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-410"><a href="#cb14-410" aria-hidden="true" tabindex="-1"></a><span class="co"># RStan Settings  -------------------------------------</span></span>
<span id="cb14-411"><a href="#cb14-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-412"><a href="#cb14-412" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb14-413"><a href="#cb14-413" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="st">"red"</span>)</span>
<span id="cb14-414"><a href="#cb14-414" aria-hidden="true" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-415"><a href="#cb14-415" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> <span class="dv">4</span>)</span>
<span id="cb14-416"><a href="#cb14-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-417"><a href="#cb14-417" aria-hidden="true" tabindex="-1"></a><span class="fu">has_build_tools</span>(<span class="at">debug =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-418"><a href="#cb14-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-419"><a href="#cb14-419" aria-hidden="true" tabindex="-1"></a><span class="co"># Stan Settings  ---------------------------------------</span></span>
<span id="cb14-420"><a href="#cb14-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-421"><a href="#cb14-421" aria-hidden="true" tabindex="-1"></a>dotR <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">Sys.getenv</span>(<span class="st">"HOME"</span>), <span class="st">".R"</span>)</span>
<span id="cb14-422"><a href="#cb14-422" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(dotR)) <span class="fu">dir.create</span>(dotR)</span>
<span id="cb14-423"><a href="#cb14-423" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dotR, <span class="st">"Makevars"</span>)</span>
<span id="cb14-424"><a href="#cb14-424" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(M)) <span class="fu">file.create</span>(M)</span>
<span id="cb14-425"><a href="#cb14-425" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">CXX14FLAGS=-O3 -march=native -mtune=native -fPIC"</span>,</span>
<span id="cb14-426"><a href="#cb14-426" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CXX14=g++"</span>, </span>
<span id="cb14-427"><a href="#cb14-427" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> M, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">append =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-428"><a href="#cb14-428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-429"><a href="#cb14-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-430"><a href="#cb14-430" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-431"><a href="#cb14-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-432"><a href="#cb14-432" aria-hidden="true" tabindex="-1"></a>The script above loads all the necessary <span class="in">`R`</span> packages each time it is</span>
<span id="cb14-433"><a href="#cb14-433" aria-hidden="true" tabindex="-1"></a>called, along with the specified functions, so most of the other <span class="in">`.R`</span></span>
<span id="cb14-434"><a href="#cb14-434" aria-hidden="true" tabindex="-1"></a>files will depend upon this one.</span>
<span id="cb14-435"><a href="#cb14-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-436"><a href="#cb14-436" aria-hidden="true" tabindex="-1"></a>However, I will not be running each of these <span class="in">`.R`</span> files/scripts</span>
<span id="cb14-437"><a href="#cb14-437" aria-hidden="true" tabindex="-1"></a>individually, line by line, or by selecting all the lines in an <span class="in">`.R`</span></span>
<span id="cb14-438"><a href="#cb14-438" aria-hidden="true" tabindex="-1"></a>file and running the script.</span>
<span id="cb14-439"><a href="#cb14-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-440"><a href="#cb14-440" aria-hidden="true" tabindex="-1"></a>Instead, after I've created all these files (figuring out what I need to</span>
<span id="cb14-441"><a href="#cb14-441" aria-hidden="true" tabindex="-1"></a>do carefully and writing it down and annotating it), every single <span class="in">`.R`</span></span>
<span id="cb14-442"><a href="#cb14-442" aria-hidden="true" tabindex="-1"></a>file except for <span class="in">`main.R`</span> will have the following script, which I will</span>
<span id="cb14-443"><a href="#cb14-443" aria-hidden="true" tabindex="-1"></a>explain later below (or some iteration of this script to match the name</span>
<span id="cb14-444"><a href="#cb14-444" aria-hidden="true" tabindex="-1"></a>of the file) at the beginning:</span>
<span id="cb14-445"><a href="#cb14-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-446"><a href="#cb14-446" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-447"><a href="#cb14-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-448"><a href="#cb14-448" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setting up the Error Catching Script</span></span>
<span id="cb14-449"><a href="#cb14-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-450"><a href="#cb14-450" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-451"><a href="#cb14-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-452"><a href="#cb14-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Beginning Error Script, eval=FALSE, include=TRUE}</span></span>
<span id="cb14-453"><a href="#cb14-453" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"here"</span>)</span>
<span id="cb14-454"><a href="#cb14-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-455"><a href="#cb14-455" aria-hidden="true" tabindex="-1"></a><span class="fu">set_here</span>()</span>
<span id="cb14-456"><a href="#cb14-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-457"><a href="#cb14-457" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>))</span>
<span id="cb14-458"><a href="#cb14-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-459"><a href="#cb14-459" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(futile.logger)</span>
<span id="cb14-460"><a href="#cb14-460" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tryCatchLog)</span>
<span id="cb14-461"><a href="#cb14-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-462"><a href="#cb14-462" aria-hidden="true" tabindex="-1"></a><span class="co"># Keeps source code file name and line number tracking</span></span>
<span id="cb14-463"><a href="#cb14-463" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">keep.source =</span> <span class="cn">TRUE</span>)        </span>
<span id="cb14-464"><a href="#cb14-464" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"tryCatchLog.write.error.dump.file"</span> <span class="ot">=</span> <span class="cn">TRUE</span>) </span>
<span id="cb14-465"><a href="#cb14-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-466"><a href="#cb14-466" aria-hidden="true" tabindex="-1"></a><span class="co"># Logs messages into a file </span></span>
<span id="cb14-467"><a href="#cb14-467" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(<span class="st">"my_app.log"</span>))  </span>
<span id="cb14-468"><a href="#cb14-468" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.threshold</span>(INFO)   </span>
<span id="cb14-469"><a href="#cb14-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-470"><a href="#cb14-470" aria-hidden="true" tabindex="-1"></a><span class="co"># Function that catches any messages</span></span>
<span id="cb14-471"><a href="#cb14-471" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="st">"script.R"</span>))</span>
<span id="cb14-472"><a href="#cb14-472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-473"><a href="#cb14-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-474"><a href="#cb14-474" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-475"><a href="#cb14-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-476"><a href="#cb14-476" aria-hidden="true" tabindex="-1"></a>You'll notice several things. First, I'm once again calling the</span>
<span id="cb14-477"><a href="#cb14-477" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`here`</span><span class="co">](https://cran.r-project.org/package=here)</span> package and telling it</span>
<span id="cb14-478"><a href="#cb14-478" aria-hidden="true" tabindex="-1"></a>that I'm working within this folder (<span class="in">`R`</span>), and then I'm calling the</span>
<span id="cb14-479"><a href="#cb14-479" aria-hidden="true" tabindex="-1"></a><span class="in">`01-functions.R`</span> file by using the <span class="in">`source()`</span> function, but also notice</span>
<span id="cb14-480"><a href="#cb14-480" aria-hidden="true" tabindex="-1"></a>how the <span class="in">`source()`</span> function is followed by a <span class="in">`here()`</span> function/argument.</span>
<span id="cb14-481"><a href="#cb14-481" aria-hidden="true" tabindex="-1"></a>This <span class="in">`here()`</span> function allows you to fully control files in a specific</span>
<span id="cb14-482"><a href="#cb14-482" aria-hidden="true" tabindex="-1"></a>folder from anywhere else, without having to actually be in that folder.</span>
<span id="cb14-483"><a href="#cb14-483" aria-hidden="true" tabindex="-1"></a>So, suppose I was in the <span class="in">`Main Project`</span> -<span class="sc">\&gt;</span> <span class="in">`Data`</span> -<span class="sc">\&gt;</span> <span class="in">`Models`</span> folder</span>
<span id="cb14-484"><a href="#cb14-484" aria-hidden="true" tabindex="-1"></a>and I was saving my work there (in the <span class="in">`Models`</span> folder), which is pretty</span>
<span id="cb14-485"><a href="#cb14-485" aria-hidden="true" tabindex="-1"></a>far from the <span class="in">`R`</span> folder, I can still, using functions like <span class="in">`source()`</span>,</span>
<span id="cb14-486"><a href="#cb14-486" aria-hidden="true" tabindex="-1"></a><span class="in">`save()`</span>, etc., call or manipulate files from a totally different folder</span>
<span id="cb14-487"><a href="#cb14-487" aria-hidden="true" tabindex="-1"></a>by specifying the hierarchy using <span class="in">`here()`</span>. This can also be done in</span>
<span id="cb14-488"><a href="#cb14-488" aria-hidden="true" tabindex="-1"></a>other ways, but those are far more cumbersome, and not flexible.</span>
<span id="cb14-489"><a href="#cb14-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-490"><a href="#cb14-490" aria-hidden="true" tabindex="-1"></a>This is how I always call the necessary packages and functions I need</span>
<span id="cb14-491"><a href="#cb14-491" aria-hidden="true" tabindex="-1"></a>from every <span class="in">`.R`</span> script, simply by using the <span class="in">`source()`</span> function and</span>
<span id="cb14-492"><a href="#cb14-492" aria-hidden="true" tabindex="-1"></a>using <span class="in">`here()`</span> to direct it to the <span class="in">`01-functions.R`</span> file in the <span class="in">`R`</span></span>
<span id="cb14-493"><a href="#cb14-493" aria-hidden="true" tabindex="-1"></a>folder. Now let's look at the next few lines.</span>
<span id="cb14-494"><a href="#cb14-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-495"><a href="#cb14-495" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-496"><a href="#cb14-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-497"><a href="#cb14-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Error Script, eval=FALSE, include=TRUE}</span></span>
<span id="cb14-498"><a href="#cb14-498" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(<span class="st">"script.log"</span>))</span>
<span id="cb14-499"><a href="#cb14-499" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.threshold</span>(INFO)    </span>
<span id="cb14-500"><a href="#cb14-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-501"><a href="#cb14-501" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="st">"script.R"</span>))</span>
<span id="cb14-502"><a href="#cb14-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-503"><a href="#cb14-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-504"><a href="#cb14-504" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-505"><a href="#cb14-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-506"><a href="#cb14-506" aria-hidden="true" tabindex="-1"></a>This script is designed to catch any warnings that occur inside the <span class="in">`.R`</span></span>
<span id="cb14-507"><a href="#cb14-507" aria-hidden="true" tabindex="-1"></a>script and save them to a .log file in another subfolder within the <span class="in">`R`</span></span>
<span id="cb14-508"><a href="#cb14-508" aria-hidden="true" tabindex="-1"></a>folder called <span class="in">`Errors`</span>. So here's an example of a full script for a mix</span>
<span id="cb14-509"><a href="#cb14-509" aria-hidden="true" tabindex="-1"></a>of data generation and inspection, so that you can see it in action.</span>
<span id="cb14-510"><a href="#cb14-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-511"><a href="#cb14-511" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-512"><a href="#cb14-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-513"><a href="#cb14-513" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example of Data Loading &amp; Inspection</span></span>
<span id="cb14-514"><a href="#cb14-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-515"><a href="#cb14-515" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-516"><a href="#cb14-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-517"><a href="#cb14-517" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Example 1, eval=FALSE, include=TRUE}</span></span>
<span id="cb14-518"><a href="#cb14-518" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"here"</span>)</span>
<span id="cb14-519"><a href="#cb14-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-520"><a href="#cb14-520" aria-hidden="true" tabindex="-1"></a><span class="fu">set_here</span>()</span>
<span id="cb14-521"><a href="#cb14-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-522"><a href="#cb14-522" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>)) <span class="co"># Loads all R functions</span></span>
<span id="cb14-523"><a href="#cb14-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-524"><a href="#cb14-524" aria-hidden="true" tabindex="-1"></a><span class="co"># First we need some data</span></span>
<span id="cb14-525"><a href="#cb14-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-526"><a href="#cb14-526" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb14-527"><a href="#cb14-527" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1031</span>) <span class="co"># My birthday</span></span>
<span id="cb14-528"><a href="#cb14-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-529"><a href="#cb14-529" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose you wanted to simulate a clinical trial</span></span>
<span id="cb14-530"><a href="#cb14-530" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"simstudy"</span>)  </span>
<span id="cb14-531"><a href="#cb14-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-532"><a href="#cb14-532" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulating a Clinical Trial --------------------------</span></span>
<span id="cb14-533"><a href="#cb14-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-534"><a href="#cb14-534" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"male"</span>, <span class="at">dist =</span> <span class="st">"binary"</span>, </span>
<span id="cb14-535"><a href="#cb14-535" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula =</span> .<span class="dv">5</span> , <span class="at">id=</span><span class="st">"cid"</span>)</span>
<span id="cb14-536"><a href="#cb14-536" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">"over65"</span>, </span>
<span id="cb14-537"><a href="#cb14-537" aria-hidden="true" tabindex="-1"></a>               <span class="at">dist =</span> <span class="st">"binary"</span>,</span>
<span id="cb14-538"><a href="#cb14-538" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula =</span> <span class="st">"-1.7 + .8 * male"</span>, </span>
<span id="cb14-539"><a href="#cb14-539" aria-hidden="true" tabindex="-1"></a>               <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb14-540"><a href="#cb14-540" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def,<span class="at">varname =</span> <span class="st">"baseDBP"</span>, </span>
<span id="cb14-541"><a href="#cb14-541" aria-hidden="true" tabindex="-1"></a>               <span class="at">dist =</span> <span class="st">"normal"</span>,</span>
<span id="cb14-542"><a href="#cb14-542" aria-hidden="true" tabindex="-1"></a>                 <span class="at">formula =</span> <span class="dv">70</span>, <span class="at">variance =</span> <span class="dv">40</span>)</span>
<span id="cb14-543"><a href="#cb14-543" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">"age"</span>, </span>
<span id="cb14-544"><a href="#cb14-544" aria-hidden="true" tabindex="-1"></a>               <span class="at">dist =</span> <span class="st">"normal"</span>, </span>
<span id="cb14-545"><a href="#cb14-545" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula =</span> <span class="dv">10</span>, </span>
<span id="cb14-546"><a href="#cb14-546" aria-hidden="true" tabindex="-1"></a>               <span class="at">variance =</span> <span class="dv">2</span>)</span>
<span id="cb14-547"><a href="#cb14-547" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">"visits"</span>, </span>
<span id="cb14-548"><a href="#cb14-548" aria-hidden="true" tabindex="-1"></a>               <span class="at">dist =</span> <span class="st">"poisson"</span>, </span>
<span id="cb14-549"><a href="#cb14-549" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="st">"1.5 - 0.2 * age + 0.5 * male"</span>, </span>
<span id="cb14-550"><a href="#cb14-550" aria-hidden="true" tabindex="-1"></a>    <span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb14-551"><a href="#cb14-551" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">"weight"</span>, </span>
<span id="cb14-552"><a href="#cb14-552" aria-hidden="true" tabindex="-1"></a>               <span class="at">dist =</span> <span class="st">"normal"</span>,</span>
<span id="cb14-553"><a href="#cb14-553" aria-hidden="true" tabindex="-1"></a>                 <span class="at">formula =</span> <span class="dv">60</span>, <span class="at">variance =</span> <span class="dv">10</span>)</span>
<span id="cb14-554"><a href="#cb14-554" aria-hidden="true" tabindex="-1"></a>dtstudy <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">500</span>, def)</span>
<span id="cb14-555"><a href="#cb14-555" aria-hidden="true" tabindex="-1"></a>study <span class="ot">&lt;-</span> <span class="fu">trtAssign</span>(dtstudy, <span class="at">nTrt =</span> <span class="dv">2</span>, </span>
<span id="cb14-556"><a href="#cb14-556" aria-hidden="true" tabindex="-1"></a>                   <span class="at">balanced =</span> <span class="cn">FALSE</span>, <span class="at">grpName =</span> <span class="st">"rxGrp"</span>)</span>
<span id="cb14-557"><a href="#cb14-557" aria-hidden="true" tabindex="-1"></a>study <span class="ot">&lt;-</span>  <span class="fu">as.data.frame</span>(study)</span>
<span id="cb14-558"><a href="#cb14-558" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>iq <span class="ot">&lt;-</span> iq <span class="ot">&lt;-</span> wakefield<span class="sc">::</span><span class="fu">iq</span>(<span class="dv">500</span>)</span>
<span id="cb14-559"><a href="#cb14-559" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>height <span class="ot">&lt;-</span> height <span class="ot">&lt;-</span> wakefield<span class="sc">::</span><span class="fu">height</span>(<span class="dv">500</span>)</span>
<span id="cb14-560"><a href="#cb14-560" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>income <span class="ot">&lt;-</span> income <span class="ot">&lt;-</span> wakefield<span class="sc">::</span><span class="fu">income</span>(<span class="dv">500</span>, </span>
<span id="cb14-561"><a href="#cb14-561" aria-hidden="true" tabindex="-1"></a>                              <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">name =</span> <span class="st">"Income"</span>)</span>
<span id="cb14-562"><a href="#cb14-562" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>SAT_score <span class="ot">&lt;-</span> wakefield<span class="sc">::</span><span class="fu">sat</span>(<span class="dv">500</span>, <span class="at">mean =</span> <span class="dv">1500</span>, </span>
<span id="cb14-563"><a href="#cb14-563" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sd =</span> <span class="dv">100</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">2400</span>, </span>
<span id="cb14-564"><a href="#cb14-564" aria-hidden="true" tabindex="-1"></a>                 <span class="at">digits =</span> <span class="dv">0</span>, <span class="at">name =</span> <span class="st">"SAT"</span>)</span>
<span id="cb14-565"><a href="#cb14-565" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>visits <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(study<span class="sc">$</span>visits)</span>
<span id="cb14-566"><a href="#cb14-566" aria-hidden="true" tabindex="-1"></a><span class="co"># Add noisy predictors</span></span>
<span id="cb14-567"><a href="#cb14-567" aria-hidden="true" tabindex="-1"></a>study[, <span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">FUN =</span> <span class="cf">function</span>(i) </span>
<span id="cb14-568"><a href="#cb14-568" aria-hidden="true" tabindex="-1"></a>                         (<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">500</span>, </span>
<span id="cb14-569"><a href="#cb14-569" aria-hidden="true" tabindex="-1"></a>                                <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)))</span>
<span id="cb14-570"><a href="#cb14-570" aria-hidden="true" tabindex="-1"></a>varname <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"x%d"</span>, (<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>))</span>
<span id="cb14-571"><a href="#cb14-571" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(study)[<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>] <span class="ot">&lt;-</span> varname</span>
<span id="cb14-572"><a href="#cb14-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-573"><a href="#cb14-573" aria-hidden="true" tabindex="-1"></a>study1 <span class="ot">&lt;-</span> <span class="fu">trtAssign</span>(dtstudy, <span class="at">n =</span> <span class="dv">2</span>, <span class="at">balanced =</span> <span class="cn">TRUE</span>, </span>
<span id="cb14-574"><a href="#cb14-574" aria-hidden="true" tabindex="-1"></a>                    <span class="at">strata =</span> <span class="fu">c</span>(<span class="st">"male"</span>, <span class="st">"over65"</span>), </span>
<span id="cb14-575"><a href="#cb14-575" aria-hidden="true" tabindex="-1"></a>    <span class="at">grpName =</span> <span class="st">"rxGrp"</span>)</span>
<span id="cb14-576"><a href="#cb14-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-577"><a href="#cb14-577" aria-hidden="true" tabindex="-1"></a>study1</span>
<span id="cb14-578"><a href="#cb14-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-579"><a href="#cb14-579" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspecting Data  -------------------------------------</span></span>
<span id="cb14-580"><a href="#cb14-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-581"><a href="#cb14-581" aria-hidden="true" tabindex="-1"></a>summarytools<span class="sc">::</span><span class="fu">view</span>(<span class="fu">dfSummary</span>(study))</span>
<span id="cb14-582"><a href="#cb14-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-583"><a href="#cb14-583" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>over65 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(study<span class="sc">$</span>over65)</span>
<span id="cb14-584"><a href="#cb14-584" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>male <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(study<span class="sc">$</span>male)</span>
<span id="cb14-585"><a href="#cb14-585" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>rxGrp <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(study<span class="sc">$</span>rxGrp)</span>
<span id="cb14-586"><a href="#cb14-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-587"><a href="#cb14-587" aria-hidden="true" tabindex="-1"></a>study_formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(baseDBP <span class="sc">~</span> .)</span>
<span id="cb14-588"><a href="#cb14-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-589"><a href="#cb14-589" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">spearman2</span>(study_formula, study))</span>
<span id="cb14-590"><a href="#cb14-590" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>)</span>
<span id="cb14-591"><a href="#cb14-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-592"><a href="#cb14-592" aria-hidden="true" tabindex="-1"></a>x_1 <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> ., <span class="at">data =</span> study)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb14-593"><a href="#cb14-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-594"><a href="#cb14-594" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial Data Analysis  ------------------------------</span></span>
<span id="cb14-595"><a href="#cb14-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-596"><a href="#cb14-596" aria-hidden="true" tabindex="-1"></a>(cormatrix <span class="ot">&lt;-</span> (<span class="fu">cor</span>(x_1)))</span>
<span id="cb14-597"><a href="#cb14-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-598"><a href="#cb14-598" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#BB4444"</span>, <span class="st">"#EE9988"</span>, </span>
<span id="cb14-599"><a href="#cb14-599" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"#FFFFFF"</span>, </span>
<span id="cb14-600"><a href="#cb14-600" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"#77AADD"</span>, <span class="st">"#4477AA"</span>))</span>
<span id="cb14-601"><a href="#cb14-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-602"><a href="#cb14-602" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cormatrix, <span class="at">method =</span> <span class="st">"color"</span>, </span>
<span id="cb14-603"><a href="#cb14-603" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">col</span>(<span class="dv">200</span>), </span>
<span id="cb14-604"><a href="#cb14-604" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.cex =</span> <span class="fl">0.40</span>,</span>
<span id="cb14-605"><a href="#cb14-605" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span> <span class="st">"black"</span>, <span class="at">number.cex =</span> .<span class="dv">35</span>)</span>
<span id="cb14-606"><a href="#cb14-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-607"><a href="#cb14-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-608"><a href="#cb14-608" aria-hidden="true" tabindex="-1"></a>clus1 <span class="ot">&lt;-</span> <span class="fu">varclus</span>(x_1, <span class="at">similarity =</span> <span class="st">"h"</span>)</span>
<span id="cb14-609"><a href="#cb14-609" aria-hidden="true" tabindex="-1"></a>clus2 <span class="ot">&lt;-</span> <span class="fu">varclus</span>(x_1, <span class="at">similarity =</span> <span class="st">"s"</span>)</span>
<span id="cb14-610"><a href="#cb14-610" aria-hidden="true" tabindex="-1"></a>clus3 <span class="ot">&lt;-</span> <span class="fu">varclus</span>(x_1, <span class="at">similarity =</span> <span class="st">"p"</span>)</span>
<span id="cb14-611"><a href="#cb14-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-612"><a href="#cb14-612" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clus1, <span class="at">ylab =</span> <span class="st">"Hoeffing's D statistic"</span>, </span>
<span id="cb14-613"><a href="#cb14-613" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.75</span>)</span>
<span id="cb14-614"><a href="#cb14-614" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Hierarchical Cluster Analysis"</span>)</span>
<span id="cb14-615"><a href="#cb14-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-616"><a href="#cb14-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-617"><a href="#cb14-617" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clus2, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.75</span>)</span>
<span id="cb14-618"><a href="#cb14-618" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clus3, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.75</span>)</span>
<span id="cb14-619"><a href="#cb14-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-620"><a href="#cb14-620" aria-hidden="true" tabindex="-1"></a>Pre <span class="ot">&lt;-</span> <span class="fu">names</span>(study)</span>
<span id="cb14-621"><a href="#cb14-621" aria-hidden="true" tabindex="-1"></a>(fmla <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"~"</span>, </span>
<span id="cb14-622"><a href="#cb14-622" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">paste</span>(Pre, </span>
<span id="cb14-623"><a href="#cb14-623" aria-hidden="true" tabindex="-1"></a>                                <span class="at">collapse =</span> <span class="st">"+"</span>))))</span>
<span id="cb14-624"><a href="#cb14-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-625"><a href="#cb14-625" aria-hidden="true" tabindex="-1"></a><span class="co"># Redundancy analysis </span></span>
<span id="cb14-626"><a href="#cb14-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-627"><a href="#cb14-627" aria-hidden="true" tabindex="-1"></a>redun <span class="ot">&lt;-</span> <span class="fu">redun</span>(fmla,</span>
<span id="cb14-628"><a href="#cb14-628" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> study,</span>
<span id="cb14-629"><a href="#cb14-629" aria-hidden="true" tabindex="-1"></a>  <span class="at">r2 =</span> <span class="fl">0.90</span>, <span class="at">type =</span> <span class="st">"ordinary"</span>, <span class="at">allcat =</span> <span class="cn">FALSE</span>,</span>
<span id="cb14-630"><a href="#cb14-630" aria-hidden="true" tabindex="-1"></a>  <span class="at">tlinear =</span> <span class="cn">FALSE</span>, <span class="at">iterms =</span> <span class="cn">FALSE</span>, <span class="at">pr =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-631"><a href="#cb14-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-632"><a href="#cb14-632" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-633"><a href="#cb14-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-634"><a href="#cb14-634" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-635"><a href="#cb14-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-636"><a href="#cb14-636" aria-hidden="true" tabindex="-1"></a>The above script simulated some fake data for a hypothetical clinical</span>
<span id="cb14-637"><a href="#cb14-637" aria-hidden="true" tabindex="-1"></a>trial (usually we use this first script to load data from a .csv or .txt</span>
<span id="cb14-638"><a href="#cb14-638" aria-hidden="true" tabindex="-1"></a>file) and then we used several functions to inspect the dataframe for</span>
<span id="cb14-639"><a href="#cb14-639" aria-hidden="true" tabindex="-1"></a>the structure and distributions of the variables and missing data, etc.</span>
<span id="cb14-640"><a href="#cb14-640" aria-hidden="true" tabindex="-1"></a>We also attempted to properly code the variables. Now, in order to</span>
<span id="cb14-641"><a href="#cb14-641" aria-hidden="true" tabindex="-1"></a>capture any possible errors, we will have to run this entire script from</span>
<span id="cb14-642"><a href="#cb14-642" aria-hidden="true" tabindex="-1"></a>another <span class="in">`R`</span> script instead of running it line by line or selecting all</span>
<span id="cb14-643"><a href="#cb14-643" aria-hidden="true" tabindex="-1"></a>the code and running it.</span>
<span id="cb14-644"><a href="#cb14-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-645"><a href="#cb14-645" aria-hidden="true" tabindex="-1"></a>We will do this from a Main source script, which will allow us to use</span>
<span id="cb14-646"><a href="#cb14-646" aria-hidden="true" tabindex="-1"></a>the <span class="in">`tryCatchLog()`</span> function.</span>
<span id="cb14-647"><a href="#cb14-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-648"><a href="#cb14-648" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-649"><a href="#cb14-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-650"><a href="#cb14-650" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example of the Main Source Script</span></span>
<span id="cb14-651"><a href="#cb14-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-652"><a href="#cb14-652" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-653"><a href="#cb14-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-654"><a href="#cb14-654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Main Source Script, eval=FALSE, include=TRUE}</span></span>
<span id="cb14-655"><a href="#cb14-655" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"here"</span>) </span>
<span id="cb14-656"><a href="#cb14-656" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tryCatchLog"</span>)</span>
<span id="cb14-657"><a href="#cb14-657" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"futile.logger"</span>)</span>
<span id="cb14-658"><a href="#cb14-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-659"><a href="#cb14-659" aria-hidden="true" tabindex="-1"></a><span class="fu">set_here</span>() <span class="co"># Load and set here</span></span>
<span id="cb14-660"><a href="#cb14-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-661"><a href="#cb14-661" aria-hidden="true" tabindex="-1"></a><span class="fu">here</span>() <span class="co"># Call here</span></span>
<span id="cb14-662"><a href="#cb14-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-663"><a href="#cb14-663" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">keep.source =</span> <span class="cn">TRUE</span>)        </span>
<span id="cb14-664"><a href="#cb14-664" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"tryCatchLog.write.error.dump.file"</span> <span class="ot">=</span> <span class="cn">TRUE</span>) </span>
<span id="cb14-665"><a href="#cb14-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-666"><a href="#cb14-666" aria-hidden="true" tabindex="-1"></a><span class="co"># Script loads all necessary functions</span></span>
<span id="cb14-667"><a href="#cb14-667" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb14-668"><a href="#cb14-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"01-functions.log"</span>)))</span>
<span id="cb14-669"><a href="#cb14-669" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>))) </span>
<span id="cb14-670"><a href="#cb14-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-671"><a href="#cb14-671" aria-hidden="true" tabindex="-1"></a><span class="co"># Line script to clean the data</span></span>
<span id="cb14-672"><a href="#cb14-672" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb14-673"><a href="#cb14-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"02-cleaning.log"</span>)))</span>
<span id="cb14-674"><a href="#cb14-674" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"02-cleaning.R"</span>))) </span>
<span id="cb14-675"><a href="#cb14-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-676"><a href="#cb14-676" aria-hidden="true" tabindex="-1"></a><span class="co"># Line script below to inspect the data</span></span>
<span id="cb14-677"><a href="#cb14-677" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb14-678"><a href="#cb14-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"03-inspection.log"</span>)))</span>
<span id="cb14-679"><a href="#cb14-679" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"03-inspection.R"</span>)))  </span>
<span id="cb14-680"><a href="#cb14-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-681"><a href="#cb14-681" aria-hidden="true" tabindex="-1"></a><span class="co"># Load saved objects from cleanings</span></span>
<span id="cb14-682"><a href="#cb14-682" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb14-683"><a href="#cb14-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"03.5-load_data.log"</span>)))</span>
<span id="cb14-684"><a href="#cb14-684" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"03.5-load_data.R"</span>))) </span>
<span id="cb14-685"><a href="#cb14-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-686"><a href="#cb14-686" aria-hidden="true" tabindex="-1"></a><span class="co"># Main analysis script</span></span>
<span id="cb14-687"><a href="#cb14-687" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb14-688"><a href="#cb14-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"04-analysis.log"</span>)))</span>
<span id="cb14-689"><a href="#cb14-689" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"04-analysis.R"</span>)))  </span>
<span id="cb14-690"><a href="#cb14-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-691"><a href="#cb14-691" aria-hidden="true" tabindex="-1"></a><span class="co"># Below is the validation of main analysis results </span></span>
<span id="cb14-692"><a href="#cb14-692" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb14-693"><a href="#cb14-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"04.5-validation.log"</span>)))</span>
<span id="cb14-694"><a href="#cb14-694" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"04.5-validation.R"</span>))) </span>
<span id="cb14-695"><a href="#cb14-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-696"><a href="#cb14-696" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the sensitivity of the results by</span></span>
<span id="cb14-697"><a href="#cb14-697" aria-hidden="true" tabindex="-1"></a><span class="co"># varying assumptions/multiple parameters</span></span>
<span id="cb14-698"><a href="#cb14-698" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb14-699"><a href="#cb14-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"05-sensitivity.log"</span>)))</span>
<span id="cb14-700"><a href="#cb14-700" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"05-sensitivity.R"</span>))) </span>
<span id="cb14-701"><a href="#cb14-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-702"><a href="#cb14-702" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate tables and figures of all your results </span></span>
<span id="cb14-703"><a href="#cb14-703" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb14-704"><a href="#cb14-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"06-tables.log"</span>)))</span>
<span id="cb14-705"><a href="#cb14-705" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"06-tables.R"</span>))) </span>
<span id="cb14-706"><a href="#cb14-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-707"><a href="#cb14-707" aria-hidden="true" tabindex="-1"></a><span class="co"># Export these into actual files that can be</span></span>
<span id="cb14-708"><a href="#cb14-708" aria-hidden="true" tabindex="-1"></a><span class="co"># inserted into papers, reports, etc.</span></span>
<span id="cb14-709"><a href="#cb14-709" aria-hidden="true" tabindex="-1"></a><span class="fu">flog.appender</span>(<span class="fu">appender.file</span>(</span>
<span id="cb14-710"><a href="#cb14-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"Errors"</span>, <span class="st">"07-export.log"</span>)))</span>
<span id="cb14-711"><a href="#cb14-711" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatchLog</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"07-export.R"</span>))) </span>
<span id="cb14-712"><a href="#cb14-712" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-713"><a href="#cb14-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-714"><a href="#cb14-714" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-715"><a href="#cb14-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-716"><a href="#cb14-716" aria-hidden="true" tabindex="-1"></a>If anything went wrong during the simulations and their inspections in</span>
<span id="cb14-717"><a href="#cb14-717" aria-hidden="true" tabindex="-1"></a>the first script from above, it would have been captured by the</span>
<span id="cb14-718"><a href="#cb14-718" aria-hidden="true" tabindex="-1"></a>error-catching scripts that we have set up, which would be placed within</span>
<span id="cb14-719"><a href="#cb14-719" aria-hidden="true" tabindex="-1"></a>a .log file in the <span class="in">`Errors`</span> folder, which is inside the <span class="in">`R`</span> folder.</span>
<span id="cb14-720"><a href="#cb14-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-721"><a href="#cb14-721" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-722"><a href="#cb14-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-723"><a href="#cb14-723" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setting the Seed</span></span>
<span id="cb14-724"><a href="#cb14-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-725"><a href="#cb14-725" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-726"><a href="#cb14-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-727"><a href="#cb14-727" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Also, note that we have set the seed using a specific random number</span></span>
<span id="cb14-728"><a href="#cb14-728" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; generator algorithm. This is not that important, however, it is</span></span>
<span id="cb14-729"><a href="#cb14-729" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; important to correctly set the seed for reproducing any random numbers</span></span>
<span id="cb14-730"><a href="#cb14-730" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; generated. This requires even more careful thought when running a</span></span>
<span id="cb14-731"><a href="#cb14-731" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; simulation study, in which the states of the simulation need to be</span></span>
<span id="cb14-732"><a href="#cb14-732" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; saved for a particular repetition, and so that streams do not</span></span>
<span id="cb14-733"><a href="#cb14-733" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; overlap.</span><span class="sc">\[</span><span class="at">\@morrisUsingSimulationStudies2019</span><span class="sc">\]</span></span>
<span id="cb14-734"><a href="#cb14-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-735"><a href="#cb14-735" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-736"><a href="#cb14-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-737"><a href="#cb14-737" aria-hidden="true" tabindex="-1"></a>I will admit that the error script is not *perfect* at capturing</span>
<span id="cb14-738"><a href="#cb14-738" aria-hidden="true" tabindex="-1"></a>warnings, but for most things, if something wrong occurs when a script</span>
<span id="cb14-739"><a href="#cb14-739" aria-hidden="true" tabindex="-1"></a>is run, the function <span class="in">`tryCatchLog()`</span> and its .log file usually catches</span>
<span id="cb14-740"><a href="#cb14-740" aria-hidden="true" tabindex="-1"></a>the warning, so I would know that something went wrong and what</span>
<span id="cb14-741"><a href="#cb14-741" aria-hidden="true" tabindex="-1"></a>specifically.</span>
<span id="cb14-742"><a href="#cb14-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-743"><a href="#cb14-743" aria-hidden="true" tabindex="-1"></a>However, some may be skeptical of this approach and ask why I need to</span>
<span id="cb14-744"><a href="#cb14-744" aria-hidden="true" tabindex="-1"></a>catch these errors and save them if I ran the scripts? Why not just</span>
<span id="cb14-745"><a href="#cb14-745" aria-hidden="true" tabindex="-1"></a>scroll up and look at the console to see the errors or warnings?</span>
<span id="cb14-746"><a href="#cb14-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-747"><a href="#cb14-747" aria-hidden="true" tabindex="-1"></a>Many reasons:</span>
<span id="cb14-748"><a href="#cb14-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-749"><a href="#cb14-749" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-750"><a href="#cb14-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-751"><a href="#cb14-751" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Suppose the analyses take a very long time, and are computationally</span>
<span id="cb14-752"><a href="#cb14-752" aria-hidden="true" tabindex="-1"></a>    intensive, and <span class="in">`R`</span>/<span class="co">[</span><span class="ot">`RStudio`</span><span class="co">](https://rstudio.com/)</span> crashes, you</span>
<span id="cb14-753"><a href="#cb14-753" aria-hidden="true" tabindex="-1"></a>    may not be able to figure out what went wrong.</span>
<span id="cb14-754"><a href="#cb14-754" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Suppose the analysis completed but because there was so much</span>
<span id="cb14-755"><a href="#cb14-755" aria-hidden="true" tabindex="-1"></a>    occurring in the console (for example, sampling from a posterior)</span>
<span id="cb14-756"><a href="#cb14-756" aria-hidden="true" tabindex="-1"></a>    that you missed the warnings/errors and got results that you don't</span>
<span id="cb14-757"><a href="#cb14-757" aria-hidden="true" tabindex="-1"></a>    know have issues.</span>
<span id="cb14-758"><a href="#cb14-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-759"><a href="#cb14-759" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-760"><a href="#cb14-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-761"><a href="#cb14-761" aria-hidden="true" tabindex="-1"></a>Thus, having this system set up to catch errors in every script also</span>
<span id="cb14-762"><a href="#cb14-762" aria-hidden="true" tabindex="-1"></a>helps us automate the entire workflow once we've carefully set it up.</span>
<span id="cb14-763"><a href="#cb14-763" aria-hidden="true" tabindex="-1"></a>After each <span class="in">`.R`</span> script has one of these message-catching scripts, we can</span>
<span id="cb14-764"><a href="#cb14-764" aria-hidden="true" tabindex="-1"></a>run our entire analysis from start to finish from <span class="in">`main.R`</span> with one</span>
<span id="cb14-765"><a href="#cb14-765" aria-hidden="true" tabindex="-1"></a>command. This not only makes your workspace organized, but also makes it</span>
<span id="cb14-766"><a href="#cb14-766" aria-hidden="true" tabindex="-1"></a>easier for others to reproduce your work if you share your files and</span>
<span id="cb14-767"><a href="#cb14-767" aria-hidden="true" tabindex="-1"></a>folders via a repository.</span>
<span id="cb14-768"><a href="#cb14-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-769"><a href="#cb14-769" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-770"><a href="#cb14-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-771"><a href="#cb14-771" aria-hidden="true" tabindex="-1"></a>So, now the <span class="in">`Error`</span> folder will contain .txt files with any warning</span>
<span id="cb14-772"><a href="#cb14-772" aria-hidden="true" tabindex="-1"></a>messages or errors.</span>
<span id="cb14-773"><a href="#cb14-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-774"><a href="#cb14-774" aria-hidden="true" tabindex="-1"></a>Typically, when I'm setting up a new project, I will also add a few</span>
<span id="cb14-775"><a href="#cb14-775" aria-hidden="true" tabindex="-1"></a>other folders such as an <span class="in">`Outputs`</span> folder, where I will save tables and</span>
<span id="cb14-776"><a href="#cb14-776" aria-hidden="true" tabindex="-1"></a>graphs, and a <span class="in">`Report`</span> folder, where I might be working on a manuscript.</span>
<span id="cb14-777"><a href="#cb14-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-778"><a href="#cb14-778" aria-hidden="true" tabindex="-1"></a>Now that I've mentioned my hierarchy and how I catch errors, I can</span>
<span id="cb14-779"><a href="#cb14-779" aria-hidden="true" tabindex="-1"></a>mention some other things that I believe are absolutely heinous</span>
<span id="cb14-780"><a href="#cb14-780" aria-hidden="true" tabindex="-1"></a>practices.</span>
<span id="cb14-781"><a href="#cb14-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-782"><a href="#cb14-782" aria-hidden="true" tabindex="-1"></a>Many people often will run an entire analysis and have several</span>
<span id="cb14-783"><a href="#cb14-783" aria-hidden="true" tabindex="-1"></a>objects/vectors stored in their Global Environment in <span class="in">`R`</span> and <span class="in">`RStudio`</span>.</span>
<span id="cb14-784"><a href="#cb14-784" aria-hidden="true" tabindex="-1"></a>Suppose they're taking a break, finished with the analysis, turning off</span>
<span id="cb14-785"><a href="#cb14-785" aria-hidden="true" tabindex="-1"></a>the computer, or stepping away for whatever reason, what they'll</span>
<span id="cb14-786"><a href="#cb14-786" aria-hidden="true" tabindex="-1"></a>typically do is click the save button on the top right pane and "Save</span>
<span id="cb14-787"><a href="#cb14-787" aria-hidden="true" tabindex="-1"></a>the workspace image". Indeed, if they don't do that themselves, the IDE</span>
<span id="cb14-788"><a href="#cb14-788" aria-hidden="true" tabindex="-1"></a><span class="in">`RStudio`</span> will explicitly ask them if they wish to save their workspace</span>
<span id="cb14-789"><a href="#cb14-789" aria-hidden="true" tabindex="-1"></a>image.</span>
<span id="cb14-790"><a href="#cb14-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-791"><a href="#cb14-791" aria-hidden="true" tabindex="-1"></a>This is a horrific practice and you should never do this because it can</span>
<span id="cb14-792"><a href="#cb14-792" aria-hidden="true" tabindex="-1"></a>lead to several problems such as:</span>
<span id="cb14-793"><a href="#cb14-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-794"><a href="#cb14-794" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>having several saved objects and packages conflict with one another</span>
<span id="cb14-795"><a href="#cb14-795" aria-hidden="true" tabindex="-1"></a>    once they're all loaded together at once</span>
<span id="cb14-796"><a href="#cb14-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-797"><a href="#cb14-797" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>having giant workspace images, that will probably cause <span class="in">`R`</span>, and</span>
<span id="cb14-798"><a href="#cb14-798" aria-hidden="true" tabindex="-1"></a>    especially <span class="in">`RStudio`</span> to constantly crash</span>
<span id="cb14-799"><a href="#cb14-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-800"><a href="#cb14-800" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>not allowing you to load very specific objects that you need at a</span>
<span id="cb14-801"><a href="#cb14-801" aria-hidden="true" tabindex="-1"></a>    time while leaving everything else</span>
<span id="cb14-802"><a href="#cb14-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-803"><a href="#cb14-803" aria-hidden="true" tabindex="-1"></a>I would say that it is a good idea to never save the workspace image,</span>
<span id="cb14-804"><a href="#cb14-804" aria-hidden="true" tabindex="-1"></a>ever. It is also quite easy to turn off. Simply go the <span class="in">`RStudio`</span> menu</span>
<span id="cb14-805"><a href="#cb14-805" aria-hidden="true" tabindex="-1"></a>and click *Preferences*, and in the *General* section, you will see the</span>
<span id="cb14-806"><a href="#cb14-806" aria-hidden="true" tabindex="-1"></a>following options:</span>
<span id="cb14-807"><a href="#cb14-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-808"><a href="#cb14-808" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-809"><a href="#cb14-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-810"><a href="#cb14-810" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> data-enlargeable width</span><span class="op">=</span><span class="st">"500"</span><span class="ot"> style</span><span class="op">=</span><span class="st">"cursor: zoom-in"</span><span class="ot"> src </span><span class="op">=</span><span class="st">"https://res.cloudinary.com/less-likely/image/upload/v1604649526/Site/RStudio_Default_Save_Options.png"</span><span class="dt">&gt;</span></span>
<span id="cb14-811"><a href="#cb14-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-812"><a href="#cb14-812" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-813"><a href="#cb14-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-814"><a href="#cb14-814" aria-hidden="true" tabindex="-1"></a>It is essential to uncheck everything under *R Sessions*, *Workspace*,</span>
<span id="cb14-815"><a href="#cb14-815" aria-hidden="true" tabindex="-1"></a>and *History*, so that you do not set your self up for a future</span>
<span id="cb14-816"><a href="#cb14-816" aria-hidden="true" tabindex="-1"></a>disaster.</span>
<span id="cb14-817"><a href="#cb14-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-818"><a href="#cb14-818" aria-hidden="true" tabindex="-1"></a>Instead of using these convenient but highly problematic options, always</span>
<span id="cb14-819"><a href="#cb14-819" aria-hidden="true" tabindex="-1"></a>use the <span class="in">`saveRDS()`</span> base <span class="in">`R`</span> function, where the first argument is the</span>
<span id="cb14-820"><a href="#cb14-820" aria-hidden="true" tabindex="-1"></a>object in your environment that you want to save, and the second</span>
<span id="cb14-821"><a href="#cb14-821" aria-hidden="true" tabindex="-1"></a>argument is the path where you want to save it, which of course should</span>
<span id="cb14-822"><a href="#cb14-822" aria-hidden="true" tabindex="-1"></a>be using the <span class="in">`here()`</span> function.</span>
<span id="cb14-823"><a href="#cb14-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-824"><a href="#cb14-824" aria-hidden="true" tabindex="-1"></a>Now suppose I decided to use multiple imputation because I had a dataset</span>
<span id="cb14-825"><a href="#cb14-825" aria-hidden="true" tabindex="-1"></a>with many missing values, and suppose I had a grasp of the missing data</span>
<span id="cb14-826"><a href="#cb14-826" aria-hidden="true" tabindex="-1"></a>mechanism, and so I used something like the not-at-random fully</span>
<span id="cb14-827"><a href="#cb14-827" aria-hidden="true" tabindex="-1"></a>conditional specification approach</span>
<span id="cb14-828"><a href="#cb14-828" aria-hidden="true" tabindex="-1"></a>(**NARFCS**)<span class="sc">\[</span>\@tompsettUseNotatrandomFully2018<span class="sc">\]</span> to attempt to handle</span>
<span id="cb14-829"><a href="#cb14-829" aria-hidden="true" tabindex="-1"></a>data that I believe to be missing not at random (**MNAR**), and I wanted</span>
<span id="cb14-830"><a href="#cb14-830" aria-hidden="true" tabindex="-1"></a>to save the imputed dataset, and only load the imputed dataset next</span>
<span id="cb14-831"><a href="#cb14-831" aria-hidden="true" tabindex="-1"></a>time. This is how I would do it (in the vaguest way possible). First,</span>
<span id="cb14-832"><a href="#cb14-832" aria-hidden="true" tabindex="-1"></a>I'll start with the dataset that we generated above and generate missing</span>
<span id="cb14-833"><a href="#cb14-833" aria-hidden="true" tabindex="-1"></a>values via different missing data mechanisms using the <span class="in">`ampute()`</span></span>
<span id="cb14-834"><a href="#cb14-834" aria-hidden="true" tabindex="-1"></a>function from the <span class="in">`mice`</span></span>
<span id="cb14-835"><a href="#cb14-835" aria-hidden="true" tabindex="-1"></a>package.<span class="sc">\[</span>\@buurenMiceMultivariateImputation2011<span class="sc">\]</span></span>
<span id="cb14-836"><a href="#cb14-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-837"><a href="#cb14-837" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-838"><a href="#cb14-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-839"><a href="#cb14-839" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **Important**: This is all assuming that one has carefully constructed</span></span>
<span id="cb14-840"><a href="#cb14-840" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; an imputation model, and that multiple imputation is the most</span></span>
<span id="cb14-841"><a href="#cb14-841" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; appropriate solution. As many others have pointed out, simply running</span></span>
<span id="cb14-842"><a href="#cb14-842" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; a script like </span><span class="in">`mice(data)`</span><span class="at"> in </span><span class="in">`R`</span><span class="at"> without careful thought to the</span></span>
<span id="cb14-843"><a href="#cb14-843" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; imputation model, is a very, very bad idea. Missing data is an</span></span>
<span id="cb14-844"><a href="#cb14-844" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; extremely complex topic and I recommend everyone carefully read the</span></span>
<span id="cb14-845"><a href="#cb14-845" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; works</span><span class="sc">\[</span><span class="at">\@buurenFlexibleImputationMissing2018</span><span class="sc">\]</span><span class="at"> of missing data</span></span>
<span id="cb14-846"><a href="#cb14-846" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; researchers such as:</span></span>
<span id="cb14-847"><a href="#cb14-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-848"><a href="#cb14-848" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Stef van Buuren</span><span class="co">](https://stefvanbuuren.name/fimd/)</span></span>
<span id="cb14-849"><a href="#cb14-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-850"><a href="#cb14-850" aria-hidden="true" tabindex="-1"></a><span class="at">    &gt; </span></span>
<span id="cb14-851"><a href="#cb14-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-852"><a href="#cb14-852" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Tim Morris</span><span class="co">](https://twitter.com/tmorris_mrc)</span></span>
<span id="cb14-853"><a href="#cb14-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-854"><a href="#cb14-854" aria-hidden="true" tabindex="-1"></a><span class="at">    &gt; </span></span>
<span id="cb14-855"><a href="#cb14-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-856"><a href="#cb14-856" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>[Ian</span>
<span id="cb14-857"><a href="#cb14-857" aria-hidden="true" tabindex="-1"></a>    White](https://www.ctu.mrc.ac.uk/about-us/senior-staff/ian-white/)</span>
<span id="cb14-858"><a href="#cb14-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-859"><a href="#cb14-859" aria-hidden="true" tabindex="-1"></a><span class="at">    &gt; </span></span>
<span id="cb14-860"><a href="#cb14-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-861"><a href="#cb14-861" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>[Donald</span>
<span id="cb14-862"><a href="#cb14-862" aria-hidden="true" tabindex="-1"></a>    Rubin](https://scholar.google.com/citations?user=5q4fhUoAAAAJ&amp;hl=en)</span>
<span id="cb14-863"><a href="#cb14-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-864"><a href="#cb14-864" aria-hidden="true" tabindex="-1"></a><span class="at">    &gt; </span></span>
<span id="cb14-865"><a href="#cb14-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-866"><a href="#cb14-866" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Jonathan Bartlett</span><span class="co">](https://thestatsgeek.com/)</span></span>
<span id="cb14-867"><a href="#cb14-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-868"><a href="#cb14-868" aria-hidden="true" tabindex="-1"></a><span class="at">    &gt; </span></span>
<span id="cb14-869"><a href="#cb14-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-870"><a href="#cb14-870" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Paul Gustafson</span><span class="co">](https://www.paulgstf.com/)</span></span>
<span id="cb14-871"><a href="#cb14-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-872"><a href="#cb14-872" aria-hidden="true" tabindex="-1"></a><span class="at">    &gt; </span></span>
<span id="cb14-873"><a href="#cb14-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-874"><a href="#cb14-874" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-875"><a href="#cb14-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-876"><a href="#cb14-876" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example of a Multiple Imputation Script</span></span>
<span id="cb14-877"><a href="#cb14-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-878"><a href="#cb14-878" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-879"><a href="#cb14-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-880"><a href="#cb14-880" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Example of Imputing Data, eval=FALSE, include=TRUE}</span></span>
<span id="cb14-881"><a href="#cb14-881" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>))</span>
<span id="cb14-882"><a href="#cb14-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-883"><a href="#cb14-883" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"beepr"</span>)</span>
<span id="cb14-884"><a href="#cb14-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-885"><a href="#cb14-885" aria-hidden="true" tabindex="-1"></a><span class="co"># Package that uses multiple imputation</span></span>
<span id="cb14-886"><a href="#cb14-886" aria-hidden="true" tabindex="-1"></a><span class="co"># by chained equations</span></span>
<span id="cb14-887"><a href="#cb14-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-888"><a href="#cb14-888" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mice"</span>) </span>
<span id="cb14-889"><a href="#cb14-889" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb14-890"><a href="#cb14-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-891"><a href="#cb14-891" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Missing Data  --------------------------------</span></span>
<span id="cb14-892"><a href="#cb14-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-893"><a href="#cb14-893" aria-hidden="true" tabindex="-1"></a>study_mnar <span class="ot">&lt;-</span> <span class="fu">ampute</span>(<span class="at">data =</span> study[, <span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>], </span>
<span id="cb14-894"><a href="#cb14-894" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prop =</span> <span class="fl">0.65</span>, <span class="at">mech =</span> <span class="st">"MNAR"</span>)</span>
<span id="cb14-895"><a href="#cb14-895" aria-hidden="true" tabindex="-1"></a>mnar_patterns <span class="ot">&lt;-</span> study_mnar<span class="sc">$</span>patterns</span>
<span id="cb14-896"><a href="#cb14-896" aria-hidden="true" tabindex="-1"></a>mnar_weight <span class="ot">&lt;-</span> study_mnar<span class="sc">$</span>weight</span>
<span id="cb14-897"><a href="#cb14-897" aria-hidden="true" tabindex="-1"></a>study_mnar_rerun <span class="ot">&lt;-</span> <span class="fu">ampute</span>(<span class="at">data =</span> study[, <span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>], </span>
<span id="cb14-898"><a href="#cb14-898" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prop =</span> <span class="fl">0.5</span>, </span>
<span id="cb14-899"><a href="#cb14-899" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mech =</span> <span class="st">"MNAR"</span>, </span>
<span id="cb14-900"><a href="#cb14-900" aria-hidden="true" tabindex="-1"></a>                           <span class="at">patterns =</span> mnar_patterns,</span>
<span id="cb14-901"><a href="#cb14-901" aria-hidden="true" tabindex="-1"></a>                           <span class="at">weights =</span> mnar_weight)</span>
<span id="cb14-902"><a href="#cb14-902" aria-hidden="true" tabindex="-1"></a>study_mar <span class="ot">&lt;-</span> <span class="fu">ampute</span>(<span class="at">data =</span> study[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">prop =</span> <span class="fl">0.5</span>, </span>
<span id="cb14-903"><a href="#cb14-903" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mech =</span> <span class="st">"MAR"</span>)</span>
<span id="cb14-904"><a href="#cb14-904" aria-hidden="true" tabindex="-1"></a>mar_patterns <span class="ot">&lt;-</span> study_mar<span class="sc">$</span>patterns</span>
<span id="cb14-905"><a href="#cb14-905" aria-hidden="true" tabindex="-1"></a>mar_weight <span class="ot">&lt;-</span> study_mar<span class="sc">$</span>weight</span>
<span id="cb14-906"><a href="#cb14-906" aria-hidden="true" tabindex="-1"></a>study_mar_rerun <span class="ot">&lt;-</span> <span class="fu">ampute</span>(<span class="at">data =</span> study[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>], </span>
<span id="cb14-907"><a href="#cb14-907" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prop =</span> <span class="fl">0.5</span>, </span>
<span id="cb14-908"><a href="#cb14-908" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mech =</span> <span class="st">"MAR"</span>, </span>
<span id="cb14-909"><a href="#cb14-909" aria-hidden="true" tabindex="-1"></a>                          <span class="at">patterns =</span> mar_patterns,</span>
<span id="cb14-910"><a href="#cb14-910" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weights =</span> mar_weight)</span>
<span id="cb14-911"><a href="#cb14-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-912"><a href="#cb14-912" aria-hidden="true" tabindex="-1"></a>study_mar_rerun[[<span class="dv">11</span>]]<span class="sc">$</span>over65 <span class="sc">%&gt;%</span> </span>
<span id="cb14-913"><a href="#cb14-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>()</span>
<span id="cb14-914"><a href="#cb14-914" aria-hidden="true" tabindex="-1"></a>study_mar_rerun[[<span class="dv">11</span>]]<span class="sc">$</span>male <span class="sc">%&gt;%</span> </span>
<span id="cb14-915"><a href="#cb14-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>()</span>
<span id="cb14-916"><a href="#cb14-916" aria-hidden="true" tabindex="-1"></a>study_mar_rerun[[<span class="dv">11</span>]]<span class="sc">$</span>rxGrp <span class="sc">%&gt;%</span> </span>
<span id="cb14-917"><a href="#cb14-917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>()</span>
<span id="cb14-918"><a href="#cb14-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-919"><a href="#cb14-919" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> study_mnar_rerun<span class="sc">$</span>amp</span>
<span id="cb14-920"><a href="#cb14-920" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> study_mar_rerun<span class="sc">$</span>amp</span>
<span id="cb14-921"><a href="#cb14-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-922"><a href="#cb14-922" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect Data</span></span>
<span id="cb14-923"><a href="#cb14-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-924"><a href="#cb14-924" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df) <span class="co"># Inspect data frame</span></span>
<span id="cb14-925"><a href="#cb14-925" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df) <span class="co"># High level summary of dataframe</span></span>
<span id="cb14-926"><a href="#cb14-926" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(df)) <span class="co"># Look at missing values etc.</span></span>
<span id="cb14-927"><a href="#cb14-927" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(df))</span>
<span id="cb14-928"><a href="#cb14-928" aria-hidden="true" tabindex="-1"></a>summarytools<span class="sc">::</span><span class="fu">view</span>(<span class="fu">dfSummary</span>(df)) </span>
<span id="cb14-929"><a href="#cb14-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-930"><a href="#cb14-930" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df2) <span class="co"># Inspect data frame</span></span>
<span id="cb14-931"><a href="#cb14-931" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df2) <span class="co"># High level summary of dataframe</span></span>
<span id="cb14-932"><a href="#cb14-932" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(df2)) <span class="co"># Look at missing values etc.</span></span>
<span id="cb14-933"><a href="#cb14-933" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(df2))</span>
<span id="cb14-934"><a href="#cb14-934" aria-hidden="true" tabindex="-1"></a>summarytools<span class="sc">::</span><span class="fu">view</span>(<span class="fu">dfSummary</span>(df2)) </span>
<span id="cb14-935"><a href="#cb14-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-936"><a href="#cb14-936" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare Data for Imputation -------------------------</span></span>
<span id="cb14-937"><a href="#cb14-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-938"><a href="#cb14-938" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> df</span>
<span id="cb14-939"><a href="#cb14-939" aria-hidden="true" tabindex="-1"></a>temp2 <span class="ot">&lt;-</span> df2</span>
<span id="cb14-940"><a href="#cb14-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-941"><a href="#cb14-941" aria-hidden="true" tabindex="-1"></a><span class="fu">missing_plot</span>(temp)</span>
<span id="cb14-942"><a href="#cb14-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-943"><a href="#cb14-943" aria-hidden="true" tabindex="-1"></a><span class="fu">missing_plot</span>(temp2)</span>
<span id="cb14-944"><a href="#cb14-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-945"><a href="#cb14-945" aria-hidden="true" tabindex="-1"></a><span class="co"># Set-up predictor matrix</span></span>
<span id="cb14-946"><a href="#cb14-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-947"><a href="#cb14-947" aria-hidden="true" tabindex="-1"></a>predMatrix <span class="ot">&lt;-</span> <span class="fu">make.predictorMatrix</span>(temp)</span>
<span id="cb14-948"><a href="#cb14-948" aria-hidden="true" tabindex="-1"></a>predMatrix2 <span class="ot">&lt;-</span> <span class="fu">make.predictorMatrix</span>(temp2)</span>
<span id="cb14-949"><a href="#cb14-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-950"><a href="#cb14-950" aria-hidden="true" tabindex="-1"></a><span class="co"># Set-up predictor matrix for unidentifiable part:</span></span>
<span id="cb14-951"><a href="#cb14-951" aria-hidden="true" tabindex="-1"></a>predSens <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>), <span class="at">ncol =</span> <span class="dv">6</span>, <span class="at">nrow =</span> <span class="dv">6</span>)</span>
<span id="cb14-952"><a href="#cb14-952" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predSens) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">":"</span>, <span class="fu">names</span>(temp), <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb14-953"><a href="#cb14-953" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(predSens) <span class="ot">&lt;-</span> <span class="fu">names</span>(temp)</span>
<span id="cb14-954"><a href="#cb14-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-955"><a href="#cb14-955" aria-hidden="true" tabindex="-1"></a><span class="co"># Set-up list with sensitivity parameter values</span></span>
<span id="cb14-956"><a href="#cb14-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-957"><a href="#cb14-957" aria-hidden="true" tabindex="-1"></a>pSens <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">list</span>(<span class="fu">list</span>(<span class="st">""</span>)), <span class="fu">ncol</span>(temp))</span>
<span id="cb14-958"><a href="#cb14-958" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pSens) <span class="ot">&lt;-</span> <span class="fu">names</span>(temp)</span>
<span id="cb14-959"><a href="#cb14-959" aria-hidden="true" tabindex="-1"></a>pSens[[<span class="st">"rxGrp"</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="sc">-</span>.<span class="dv">4</span>)</span>
<span id="cb14-960"><a href="#cb14-960" aria-hidden="true" tabindex="-1"></a>pSens[[<span class="st">"baseDBP"</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="sc">-</span>.<span class="dv">4</span>)</span>
<span id="cb14-961"><a href="#cb14-961" aria-hidden="true" tabindex="-1"></a>pSens[[<span class="st">"male"</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="sc">-</span>.<span class="dv">4</span>)</span>
<span id="cb14-962"><a href="#cb14-962" aria-hidden="true" tabindex="-1"></a>pSens[[<span class="st">"over65"</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="sc">-</span>.<span class="dv">2</span>)</span>
<span id="cb14-963"><a href="#cb14-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-964"><a href="#cb14-964" aria-hidden="true" tabindex="-1"></a><span class="co"># MICE RI Imputation  ----------------------------------</span></span>
<span id="cb14-965"><a href="#cb14-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-966"><a href="#cb14-966" aria-hidden="true" tabindex="-1"></a>z1 <span class="ot">&lt;-</span> <span class="fu">parlmice</span>(<span class="at">data =</span> temp, <span class="at">method =</span> <span class="st">"ri"</span>,</span>
<span id="cb14-967"><a href="#cb14-967" aria-hidden="true" tabindex="-1"></a>              <span class="at">predictorMatrix =</span> predMatrix,</span>
<span id="cb14-968"><a href="#cb14-968" aria-hidden="true" tabindex="-1"></a>              <span class="at">m =</span> <span class="dv">8</span>, <span class="at">maxit =</span> <span class="dv">1</span>, </span>
<span id="cb14-969"><a href="#cb14-969" aria-hidden="true" tabindex="-1"></a>              <span class="at">cluster.seed =</span> <span class="dv">1031</span>, <span class="at">n.core =</span> <span class="dv">4</span>, </span>
<span id="cb14-970"><a href="#cb14-970" aria-hidden="true" tabindex="-1"></a>              <span class="at">n.imp.core =</span> <span class="dv">2</span>, <span class="at">cl.type =</span> <span class="st">"FORK"</span>, </span>
<span id="cb14-971"><a href="#cb14-971" aria-hidden="true" tabindex="-1"></a>              <span class="at">ridge =</span> <span class="fl">1e-04</span>, <span class="at">remove.collinear =</span> <span class="cn">TRUE</span>, </span>
<span id="cb14-972"><a href="#cb14-972" aria-hidden="true" tabindex="-1"></a>              <span class="at">remove.constant =</span> <span class="cn">FALSE</span>, <span class="at">allow.na =</span> <span class="cn">TRUE</span>) </span>
<span id="cb14-973"><a href="#cb14-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-974"><a href="#cb14-974" aria-hidden="true" tabindex="-1"></a>z2 <span class="ot">&lt;-</span> <span class="fu">parlmice</span>(<span class="at">data =</span> temp2, <span class="at">method =</span> <span class="st">"pmm"</span>,</span>
<span id="cb14-975"><a href="#cb14-975" aria-hidden="true" tabindex="-1"></a>              <span class="at">predictorMatrix =</span> predMatrix2,</span>
<span id="cb14-976"><a href="#cb14-976" aria-hidden="true" tabindex="-1"></a>              <span class="at">m =</span> <span class="dv">8</span>, <span class="at">maxit =</span> <span class="dv">1</span>, </span>
<span id="cb14-977"><a href="#cb14-977" aria-hidden="true" tabindex="-1"></a>              <span class="at">cluster.seed =</span> <span class="dv">1031</span>, <span class="at">n.core =</span> <span class="dv">4</span>, </span>
<span id="cb14-978"><a href="#cb14-978" aria-hidden="true" tabindex="-1"></a>              <span class="at">ridge =</span> <span class="fl">1e-04</span>, <span class="at">remove.collinear =</span> <span class="cn">TRUE</span>, </span>
<span id="cb14-979"><a href="#cb14-979" aria-hidden="true" tabindex="-1"></a>              <span class="at">n.imp.core =</span> <span class="dv">2</span>, <span class="at">cl.type =</span> <span class="st">"FORK"</span>) </span>
<span id="cb14-980"><a href="#cb14-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-981"><a href="#cb14-981" aria-hidden="true" tabindex="-1"></a>zfinal <span class="ot">&lt;-</span> <span class="fu">cbind</span>(z1, z2)</span>
<span id="cb14-982"><a href="#cb14-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-983"><a href="#cb14-983" aria-hidden="true" tabindex="-1"></a><span class="co"># Heckman Imputation  ----------------------------------</span></span>
<span id="cb14-984"><a href="#cb14-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-985"><a href="#cb14-985" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>baseDBP <span class="ot">&lt;-</span> temp<span class="sc">$</span>baseDBP</span>
<span id="cb14-986"><a href="#cb14-986" aria-hidden="true" tabindex="-1"></a>JointModelEq<span class="ot">&lt;-</span><span class="fu">generate_JointModelEq</span>(<span class="at">data=</span>temp, </span>
<span id="cb14-987"><a href="#cb14-987" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">varMNAR=</span><span class="st">"baseDBP"</span>)</span>
<span id="cb14-988"><a href="#cb14-988" aria-hidden="true" tabindex="-1"></a>JointModelEq[,<span class="st">"baseDBP_var_sel"</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb14-989"><a href="#cb14-989" aria-hidden="true" tabindex="-1"></a>JointModelEq[,<span class="st">"baseDBP_var_out"</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb14-990"><a href="#cb14-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-991"><a href="#cb14-991" aria-hidden="true" tabindex="-1"></a>arg <span class="ot">&lt;-</span> <span class="fu">MNARargument</span>(<span class="at">data =</span> temp, <span class="at">varMNAR =</span> <span class="st">"baseDBP"</span>, </span>
<span id="cb14-992"><a href="#cb14-992" aria-hidden="true" tabindex="-1"></a>                    <span class="at">JointModelEq =</span> JointModelEq)</span>
<span id="cb14-993"><a href="#cb14-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-994"><a href="#cb14-994" aria-hidden="true" tabindex="-1"></a>arg<span class="sc">$</span>method[<span class="st">"age"</span>] <span class="ot">&lt;-</span> <span class="st">"ri"</span></span>
<span id="cb14-995"><a href="#cb14-995" aria-hidden="true" tabindex="-1"></a>arg<span class="sc">$</span>method[<span class="st">"visits"</span>] <span class="ot">&lt;-</span> <span class="st">"ri"</span></span>
<span id="cb14-996"><a href="#cb14-996" aria-hidden="true" tabindex="-1"></a>arg<span class="sc">$</span>method[<span class="st">"weight"</span>] <span class="ot">&lt;-</span> <span class="st">"ri"</span></span>
<span id="cb14-997"><a href="#cb14-997" aria-hidden="true" tabindex="-1"></a>arg<span class="sc">$</span>method[<span class="st">"iq"</span>] <span class="ot">&lt;-</span> <span class="st">"ri"</span></span>
<span id="cb14-998"><a href="#cb14-998" aria-hidden="true" tabindex="-1"></a>arg<span class="sc">$</span>method[<span class="st">"height"</span>] <span class="ot">&lt;-</span> <span class="st">"ri"</span></span>
<span id="cb14-999"><a href="#cb14-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1000"><a href="#cb14-1000" aria-hidden="true" tabindex="-1"></a>imp1 <span class="ot">&lt;-</span> <span class="fu">parlmice</span>(<span class="at">data =</span> arg<span class="sc">$</span>data_mod,</span>
<span id="cb14-1001"><a href="#cb14-1001" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> arg<span class="sc">$</span>method,</span>
<span id="cb14-1002"><a href="#cb14-1002" aria-hidden="true" tabindex="-1"></a>                  <span class="at">predictorMatrix =</span> arg<span class="sc">$</span>predictorMatrix,</span>
<span id="cb14-1003"><a href="#cb14-1003" aria-hidden="true" tabindex="-1"></a>                  <span class="at">JointModelEq =</span> arg<span class="sc">$</span>JointModelEq,</span>
<span id="cb14-1004"><a href="#cb14-1004" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> arg<span class="sc">$</span>control,</span>
<span id="cb14-1005"><a href="#cb14-1005" aria-hidden="true" tabindex="-1"></a>                  <span class="at">maxit =</span> <span class="dv">1</span>, <span class="at">m =</span> <span class="dv">8</span>,</span>
<span id="cb14-1006"><a href="#cb14-1006" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster.seed =</span> <span class="dv">1031</span>, <span class="at">n.core =</span> <span class="dv">4</span>, </span>
<span id="cb14-1007"><a href="#cb14-1007" aria-hidden="true" tabindex="-1"></a>                  <span class="at">n.imp.core =</span> <span class="dv">2</span>, <span class="at">cl.type =</span> <span class="st">"FORK"</span>)</span>
<span id="cb14-1008"><a href="#cb14-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1009"><a href="#cb14-1009" aria-hidden="true" tabindex="-1"></a>analysis1 <span class="ot">&lt;-</span> <span class="fu">with</span>(zfinal, <span class="fu">glm</span>(baseDBP <span class="sc">~</span> age <span class="sc">+</span> visits <span class="sc">+</span> weight <span class="sc">+</span> iq <span class="sc">+</span> height <span class="sc">+</span> rxGrp <span class="sc">+</span> male <span class="sc">+</span> over65))</span>
<span id="cb14-1010"><a href="#cb14-1010" aria-hidden="true" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">pool</span>(analysis1)</span>
<span id="cb14-1011"><a href="#cb14-1011" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result1)</span>
<span id="cb14-1012"><a href="#cb14-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1013"><a href="#cb14-1013" aria-hidden="true" tabindex="-1"></a>z2 <span class="ot">&lt;-</span> <span class="fu">parlmice</span>(<span class="at">data =</span> temp2, <span class="at">method =</span> <span class="st">"pmm"</span>,</span>
<span id="cb14-1014"><a href="#cb14-1014" aria-hidden="true" tabindex="-1"></a>              <span class="at">predictorMatrix =</span> predMatrix2,</span>
<span id="cb14-1015"><a href="#cb14-1015" aria-hidden="true" tabindex="-1"></a>              <span class="at">m =</span> <span class="dv">8</span>, <span class="at">maxit =</span> <span class="dv">1</span>, </span>
<span id="cb14-1016"><a href="#cb14-1016" aria-hidden="true" tabindex="-1"></a>              <span class="at">cluster.seed =</span> <span class="dv">1031</span>, <span class="at">n.core =</span> <span class="dv">4</span>, </span>
<span id="cb14-1017"><a href="#cb14-1017" aria-hidden="true" tabindex="-1"></a>              <span class="at">n.imp.core =</span> <span class="dv">2</span>, <span class="at">cl.type =</span> <span class="st">"FORK"</span>) </span>
<span id="cb14-1018"><a href="#cb14-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1019"><a href="#cb14-1019" aria-hidden="true" tabindex="-1"></a>heckman <span class="ot">&lt;-</span> <span class="fu">cbind</span>(imp1, z2)</span>
<span id="cb14-1020"><a href="#cb14-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1021"><a href="#cb14-1021" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>) <span class="co"># I will touch on this function below.</span></span>
<span id="cb14-1022"><a href="#cb14-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1023"><a href="#cb14-1023" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(zfinal, <span class="fu">here</span>(<span class="st">"Main Project"</span>, <span class="st">"Data"</span>, </span>
<span id="cb14-1024"><a href="#cb14-1024" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"zfinal.rds"</span>))</span>
<span id="cb14-1025"><a href="#cb14-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-1026"><a href="#cb14-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1027"><a href="#cb14-1027" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1028"><a href="#cb14-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1029"><a href="#cb14-1029" aria-hidden="true" tabindex="-1"></a>Here is the workflow truly showing its advantages, <span class="in">`saveRDS()`</span> is saving</span>
<span id="cb14-1030"><a href="#cb14-1030" aria-hidden="true" tabindex="-1"></a>a very specific object (<span class="in">`zfinal`</span>, the imputed dataset) into the <span class="in">`Data`</span></span>
<span id="cb14-1031"><a href="#cb14-1031" aria-hidden="true" tabindex="-1"></a>folder by using the hierarchical structure of the folder which can</span>
<span id="cb14-1032"><a href="#cb14-1032" aria-hidden="true" tabindex="-1"></a>easily be navigated using <span class="in">`here()`</span>. Notice how to save something and use</span>
<span id="cb14-1033"><a href="#cb14-1033" aria-hidden="true" tabindex="-1"></a><span class="in">`here()`</span> to specify the location, the first argument is <span class="in">`Main Project`</span>,</span>
<span id="cb14-1034"><a href="#cb14-1034" aria-hidden="true" tabindex="-1"></a>followed by <span class="in">`Data`</span>, and then comes the object name (<span class="in">`zfinal.rds`</span>).</span>
<span id="cb14-1035"><a href="#cb14-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1036"><a href="#cb14-1036" aria-hidden="true" tabindex="-1"></a>Now I have saved my imputed dataset as an object called <span class="in">`zfinal.rds`</span> and</span>
<span id="cb14-1037"><a href="#cb14-1037" aria-hidden="true" tabindex="-1"></a>it is saved in the <span class="in">`Data`</span> folder even though I am hypothetically working</span>
<span id="cb14-1038"><a href="#cb14-1038" aria-hidden="true" tabindex="-1"></a>from the <span class="in">`R`</span> folder.</span>
<span id="cb14-1039"><a href="#cb14-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1040"><a href="#cb14-1040" aria-hidden="true" tabindex="-1"></a>Also notice that I use the <span class="in">`beep()`</span> function from the</span>
<span id="cb14-1041"><a href="#cb14-1041" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">beepr</span><span class="co">](https://cran.r-project.org/package=beepr)</span> <span class="in">`R`</span> package, which can</span>
<span id="cb14-1042"><a href="#cb14-1042" aria-hidden="true" tabindex="-1"></a>be quite handy in letting you know if a particular script or analysis is</span>
<span id="cb14-1043"><a href="#cb14-1043" aria-hidden="true" tabindex="-1"></a>done.</span>
<span id="cb14-1044"><a href="#cb14-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1045"><a href="#cb14-1045" aria-hidden="true" tabindex="-1"></a>Next time, if I cleared my entire global environment and wanted to only</span>
<span id="cb14-1046"><a href="#cb14-1046" aria-hidden="true" tabindex="-1"></a>load the imputed dataset, I would simply have to just click on the</span>
<span id="cb14-1047"><a href="#cb14-1047" aria-hidden="true" tabindex="-1"></a><span class="in">`zfinal.rds`</span> file in the <span class="in">`Data`</span> folder and it would load into the</span>
<span id="cb14-1048"><a href="#cb14-1048" aria-hidden="true" tabindex="-1"></a>environment or I could use the following command,</span>
<span id="cb14-1049"><a href="#cb14-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1050"><a href="#cb14-1050" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1051"><a href="#cb14-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1052"><a href="#cb14-1052" aria-hidden="true" tabindex="-1"></a><span class="fu">## Saving and Reading Data Carefully</span></span>
<span id="cb14-1053"><a href="#cb14-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1054"><a href="#cb14-1054" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1055"><a href="#cb14-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1056"><a href="#cb14-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Reading Saved Data, eval=FALSE, include=TRUE}</span></span>
<span id="cb14-1057"><a href="#cb14-1057" aria-hidden="true" tabindex="-1"></a><span class="co"># The function readRDS() and saveRDS()</span></span>
<span id="cb14-1058"><a href="#cb14-1058" aria-hidden="true" tabindex="-1"></a><span class="co"># are possibly the most important base R functions</span></span>
<span id="cb14-1059"><a href="#cb14-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1060"><a href="#cb14-1060" aria-hidden="true" tabindex="-1"></a>zfinal <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"zfinal.rds"</span>, </span>
<span id="cb14-1061"><a href="#cb14-1061" aria-hidden="true" tabindex="-1"></a>             <span class="fu">here</span>(<span class="st">"Main Project"</span>, <span class="st">"Data"</span>, </span>
<span id="cb14-1062"><a href="#cb14-1062" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"zfinal.rds"</span>))</span>
<span id="cb14-1063"><a href="#cb14-1063" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-1064"><a href="#cb14-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1065"><a href="#cb14-1065" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1066"><a href="#cb14-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1067"><a href="#cb14-1067" aria-hidden="true" tabindex="-1"></a>This gives us full control over the environment, and it's also why I</span>
<span id="cb14-1068"><a href="#cb14-1068" aria-hidden="true" tabindex="-1"></a>encourage people to turn off the automatic prompt to save the workspace</span>
<span id="cb14-1069"><a href="#cb14-1069" aria-hidden="true" tabindex="-1"></a>that <span class="co">[</span><span class="ot">`RStudio`</span><span class="co">](https://rstudio.com/)</span> gives you by default (I am</span>
<span id="cb14-1070"><a href="#cb14-1070" aria-hidden="true" tabindex="-1"></a>certain even Hadley Wickham has said the same on multiple occasions).</span>
<span id="cb14-1071"><a href="#cb14-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1072"><a href="#cb14-1072" aria-hidden="true" tabindex="-1"></a>So if I now wanted to include the imputed dataset into one of my <span class="in">`.R`</span></span>
<span id="cb14-1073"><a href="#cb14-1073" aria-hidden="true" tabindex="-1"></a>scripts that I am trying to automate with one command, whether for</span>
<span id="cb14-1074"><a href="#cb14-1074" aria-hidden="true" tabindex="-1"></a>reproducibility, or speed, etc., I could do it with absolute control.</span>
<span id="cb14-1075"><a href="#cb14-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1076"><a href="#cb14-1076" aria-hidden="true" tabindex="-1"></a>This is also how I save my models and how I validate them, which is</span>
<span id="cb14-1077"><a href="#cb14-1077" aria-hidden="true" tabindex="-1"></a>especially handy because running those can also take an excruciatingly</span>
<span id="cb14-1078"><a href="#cb14-1078" aria-hidden="true" tabindex="-1"></a>long time.</span>
<span id="cb14-1079"><a href="#cb14-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1080"><a href="#cb14-1080" aria-hidden="true" tabindex="-1"></a>Here's an example of a script that would be in the <span class="in">`04-analysis.R`</span></span>
<span id="cb14-1081"><a href="#cb14-1081" aria-hidden="true" tabindex="-1"></a>script, I'm leaving out the warning-catching script now to avoid making</span>
<span id="cb14-1082"><a href="#cb14-1082" aria-hidden="true" tabindex="-1"></a>this too long. I don't need to load the</span>
<span id="cb14-1083"><a href="#cb14-1083" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`brms`</span><span class="co">](https://cran.r-project.org/package=brms)</span> package because I'm</span>
<span id="cb14-1084"><a href="#cb14-1084" aria-hidden="true" tabindex="-1"></a>already calling it from the first <span class="in">`.R`</span> script, <span class="in">`01-functions.R`</span> (but I'm</span>
<span id="cb14-1085"><a href="#cb14-1085" aria-hidden="true" tabindex="-1"></a>just showing it for now to avoid confusion), and then I am saving it in</span>
<span id="cb14-1086"><a href="#cb14-1086" aria-hidden="true" tabindex="-1"></a>the <span class="in">`Models`</span> folder which is found in the <span class="in">`Data`</span> folder. And again, the</span>
<span id="cb14-1087"><a href="#cb14-1087" aria-hidden="true" tabindex="-1"></a><span class="in">`beep()`</span> function would let me know when the script is over, and scripts</span>
<span id="cb14-1088"><a href="#cb14-1088" aria-hidden="true" tabindex="-1"></a>like this can often take very long, due to the computational intensity.</span>
<span id="cb14-1089"><a href="#cb14-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1090"><a href="#cb14-1090" aria-hidden="true" tabindex="-1"></a>The script below is an analysis script whose results we plan on saving</span>
<span id="cb14-1091"><a href="#cb14-1091" aria-hidden="true" tabindex="-1"></a>once completed. Due to the arguments I have set (iterations, warmups,</span>
<span id="cb14-1092"><a href="#cb14-1092" aria-hidden="true" tabindex="-1"></a>chains, and using an imputed dataset), it can often take a long time</span>
<span id="cb14-1093"><a href="#cb14-1093" aria-hidden="true" tabindex="-1"></a>before it is finished, and if I did happen to do other tasks while I was</span>
<span id="cb14-1094"><a href="#cb14-1094" aria-hidden="true" tabindex="-1"></a>waiting on that, the output would automatically save to the <span class="in">`Models`</span></span>
<span id="cb14-1095"><a href="#cb14-1095" aria-hidden="true" tabindex="-1"></a>folder via <span class="in">`saveRDS()`</span>, and I would also receive a notification via the</span>
<span id="cb14-1096"><a href="#cb14-1096" aria-hidden="true" tabindex="-1"></a><span class="in">`beep()`</span> function, preventing me from wasting any time.</span>
<span id="cb14-1097"><a href="#cb14-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1098"><a href="#cb14-1098" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1099"><a href="#cb14-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1100"><a href="#cb14-1100" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example Modeling Script</span></span>
<span id="cb14-1101"><a href="#cb14-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1102"><a href="#cb14-1102" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1103"><a href="#cb14-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1104"><a href="#cb14-1104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Analysis Script, eval=FALSE, include=TRUE}</span></span>
<span id="cb14-1105"><a href="#cb14-1105" aria-hidden="true" tabindex="-1"></a><span class="co"># Calling all packages, please report for duty</span></span>
<span id="cb14-1106"><a href="#cb14-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1107"><a href="#cb14-1107" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>)) </span>
<span id="cb14-1108"><a href="#cb14-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1109"><a href="#cb14-1109" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"brms"</span>) </span>
<span id="cb14-1110"><a href="#cb14-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1111"><a href="#cb14-1111" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a script I used previously</span></span>
<span id="cb14-1112"><a href="#cb14-1112" aria-hidden="true" tabindex="-1"></a><span class="co"># where I used Bayes for regularization  </span></span>
<span id="cb14-1113"><a href="#cb14-1113" aria-hidden="true" tabindex="-1"></a><span class="co"># Although these are all generic options </span></span>
<span id="cb14-1114"><a href="#cb14-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1115"><a href="#cb14-1115" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior Information  --------------------------------</span></span>
<span id="cb14-1116"><a href="#cb14-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1117"><a href="#cb14-1117" aria-hidden="true" tabindex="-1"></a>sample_z <span class="ot">&lt;-</span> <span class="fu">complete</span>(zfinal, <span class="dv">1</span>)</span>
<span id="cb14-1118"><a href="#cb14-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1119"><a href="#cb14-1119" aria-hidden="true" tabindex="-1"></a>n_1 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(sample_z) <span class="co"># of observations</span></span>
<span id="cb14-1120"><a href="#cb14-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1121"><a href="#cb14-1121" aria-hidden="true" tabindex="-1"></a>k_1 <span class="ot">&lt;-</span> (<span class="fu">ncol</span>(sample_z) <span class="sc">-</span> <span class="dv">1</span>) <span class="co"># of predictors</span></span>
<span id="cb14-1122"><a href="#cb14-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1123"><a href="#cb14-1123" aria-hidden="true" tabindex="-1"></a>p0_1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Prior for the number of relevant variables</span></span>
<span id="cb14-1124"><a href="#cb14-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1125"><a href="#cb14-1125" aria-hidden="true" tabindex="-1"></a>tau0_1 <span class="ot">&lt;-</span> p0_1 <span class="sc">/</span> (k_1 <span class="sc">-</span> p0_1) <span class="sc">*</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(n_1) <span class="co"># tau scale</span></span>
<span id="cb14-1126"><a href="#cb14-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1127"><a href="#cb14-1127" aria-hidden="true" tabindex="-1"></a><span class="co"># Regularized horseshoe prior</span></span>
<span id="cb14-1128"><a href="#cb14-1128" aria-hidden="true" tabindex="-1"></a>hs_prior <span class="ot">&lt;-</span> <span class="fu">set_prior</span>(<span class="st">"horseshoe(scale_global = tau0_1, </span></span>
<span id="cb14-1129"><a href="#cb14-1129" aria-hidden="true" tabindex="-1"></a><span class="st">                      scale_slab = 1)"</span>, <span class="at">class =</span> <span class="st">"b"</span>)</span>
<span id="cb14-1130"><a href="#cb14-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1131"><a href="#cb14-1131" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"future"</span>)</span>
<span id="cb14-1132"><a href="#cb14-1132" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multiprocess)</span>
<span id="cb14-1133"><a href="#cb14-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1134"><a href="#cb14-1134" aria-hidden="true" tabindex="-1"></a><span class="co"># Regularized Bayesian quantile</span></span>
<span id="cb14-1135"><a href="#cb14-1135" aria-hidden="true" tabindex="-1"></a><span class="co"># regression using regularized horseshoe prior</span></span>
<span id="cb14-1136"><a href="#cb14-1136" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">brm_multiple</span>(</span>
<span id="cb14-1137"><a href="#cb14-1137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(baseDBP <span class="sc">~</span> age <span class="sc">+</span> visits <span class="sc">+</span> weight <span class="sc">+</span> iq <span class="sc">+</span> height <span class="sc">+</span> rxGrp <span class="sc">+</span> male <span class="sc">+</span> over65, </span>
<span id="cb14-1138"><a href="#cb14-1138" aria-hidden="true" tabindex="-1"></a>     <span class="at">quantile =</span> <span class="fl">0.50</span>),</span>
<span id="cb14-1139"><a href="#cb14-1139" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> zfinal, <span class="at">prior =</span> hs_prior, </span>
<span id="cb14-1140"><a href="#cb14-1140" aria-hidden="true" tabindex="-1"></a>     <span class="at">family =</span> <span class="fu">asym_laplace</span>(), <span class="at">sample_prior =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-1141"><a href="#cb14-1141" aria-hidden="true" tabindex="-1"></a>     <span class="at">seed =</span> <span class="dv">1031</span>, <span class="at">future =</span> F,</span>
<span id="cb14-1142"><a href="#cb14-1142" aria-hidden="true" tabindex="-1"></a>     <span class="at">iter =</span> <span class="dv">1000</span>, <span class="at">warmup =</span> <span class="dv">500</span>, <span class="at">chains =</span> <span class="dv">4</span>, </span>
<span id="cb14-1143"><a href="#cb14-1143" aria-hidden="true" tabindex="-1"></a>     <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">combine =</span> <span class="cn">TRUE</span>, </span>
<span id="cb14-1144"><a href="#cb14-1144" aria-hidden="true" tabindex="-1"></a>     <span class="at">control =</span> <span class="fu">list</span>(<span class="at">max_treedepth =</span> <span class="dv">10</span>, </span>
<span id="cb14-1145"><a href="#cb14-1145" aria-hidden="true" tabindex="-1"></a>                    <span class="at">adapt_delta =</span> <span class="fl">0.80</span>)) <span class="ot">-&gt;</span> pen_model_1</span>
<span id="cb14-1146"><a href="#cb14-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1147"><a href="#cb14-1147" aria-hidden="true" tabindex="-1"></a><span class="co"># Principled way of saving results</span></span>
<span id="cb14-1148"><a href="#cb14-1148" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pen_model_1,   </span>
<span id="cb14-1149"><a href="#cb14-1149" aria-hidden="true" tabindex="-1"></a>        <span class="fu">here</span>(<span class="st">"Main Project"</span>, <span class="st">"Data"</span>, <span class="st">"Models"</span>, </span>
<span id="cb14-1150"><a href="#cb14-1150" aria-hidden="true" tabindex="-1"></a>             <span class="st">"pen_model_1.rds"</span>)) </span>
<span id="cb14-1151"><a href="#cb14-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1152"><a href="#cb14-1152" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">3</span>)</span>
<span id="cb14-1153"><a href="#cb14-1153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-1154"><a href="#cb14-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1155"><a href="#cb14-1155" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1156"><a href="#cb14-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1157"><a href="#cb14-1157" aria-hidden="true" tabindex="-1"></a>So I've saved the full contents of the fitted model (<span class="in">`pen_model_1`</span>),</span>
<span id="cb14-1158"><a href="#cb14-1158" aria-hidden="true" tabindex="-1"></a>which are usually several gigabytes large in size, within the <span class="in">`Models`</span></span>
<span id="cb14-1159"><a href="#cb14-1159" aria-hidden="true" tabindex="-1"></a>folder. Once again, notice how the <span class="in">`here()`</span> function allows you to work</span>
<span id="cb14-1160"><a href="#cb14-1160" aria-hidden="true" tabindex="-1"></a>from a subfolder like <span class="in">`R`</span>, which is inside the <span class="in">`Main Project`</span> folder,</span>
<span id="cb14-1161"><a href="#cb14-1161" aria-hidden="true" tabindex="-1"></a>and allows you to specify the hierarchy, and where you are within it,</span>
<span id="cb14-1162"><a href="#cb14-1162" aria-hidden="true" tabindex="-1"></a>and save to whichever folder you wish, in this case <span class="in">`Models`</span>, which is</span>
<span id="cb14-1163"><a href="#cb14-1163" aria-hidden="true" tabindex="-1"></a>inside of <span class="in">`Data`</span>. Now, I will typically conduct model checks and make</span>
<span id="cb14-1164"><a href="#cb14-1164" aria-hidden="true" tabindex="-1"></a>sure it is performing well, and not misspecified,</span>
<span id="cb14-1165"><a href="#cb14-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1166"><a href="#cb14-1166" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1167"><a href="#cb14-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1168"><a href="#cb14-1168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Checking, eval=FALSE, include=TRUE}</span></span>
<span id="cb14-1169"><a href="#cb14-1169" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>)) </span>
<span id="cb14-1170"><a href="#cb14-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1171"><a href="#cb14-1171" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect RHat values ---------------------------</span></span>
<span id="cb14-1172"><a href="#cb14-1172" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb14-1173"><a href="#cb14-1173" aria-hidden="true" tabindex="-1"></a>rhats_1 <span class="ot">&lt;-</span> pen_model_1<span class="sc">$</span>rhats</span>
<span id="cb14-1174"><a href="#cb14-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1175"><a href="#cb14-1175" aria-hidden="true" tabindex="-1"></a>rhats_1_df <span class="ot">&lt;-</span> (rhats_1 <span class="sc">&lt;=</span> <span class="fl">1.1</span>)</span>
<span id="cb14-1176"><a href="#cb14-1176" aria-hidden="true" tabindex="-1"></a>((<span class="fu">as.numeric</span>(<span class="fu">table</span>(rhats_1_df)) <span class="sc">/</span> </span>
<span id="cb14-1177"><a href="#cb14-1177" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">nrow</span>(rhats_1_df) <span class="sc">*</span> <span class="fu">ncol</span>(rhats_1_df)) <span class="sc">*</span> <span class="dv">100</span>))</span>
<span id="cb14-1178"><a href="#cb14-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1179"><a href="#cb14-1179" aria-hidden="true" tabindex="-1"></a>rhats_1_vec <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(<span class="fu">c</span>(</span>
<span id="cb14-1180"><a href="#cb14-1180" aria-hidden="true" tabindex="-1"></a>  rhats_1[, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(rhats_1)])))</span>
<span id="cb14-1181"><a href="#cb14-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1182"><a href="#cb14-1182" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">here</span>(<span class="st">"Outputs"</span>, <span class="st">"Figures"</span>, <span class="st">"Diagnostics"</span>, </span>
<span id="cb14-1183"><a href="#cb14-1183" aria-hidden="true" tabindex="-1"></a>         <span class="st">"OUTCOME_COMP_rhat.pdf"</span>))</span>
<span id="cb14-1184"><a href="#cb14-1184" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_rhat_hist</span>(rhats_1_vec) <span class="sc">+</span></span>
<span id="cb14-1185"><a href="#cb14-1185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Model 1 Chain Convergence"</span>)</span>
<span id="cb14-1186"><a href="#cb14-1186" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb14-1187"><a href="#cb14-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1188"><a href="#cb14-1188" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect Effective Sample Size ----------------------</span></span>
<span id="cb14-1189"><a href="#cb14-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1190"><a href="#cb14-1190" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_neff_hist</span>(rhats_1_vec) <span class="sc">+</span></span>
<span id="cb14-1191"><a href="#cb14-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Effective Sample Size"</span>)</span>
<span id="cb14-1192"><a href="#cb14-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1193"><a href="#cb14-1193" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect Divergences ---------------------------</span></span>
<span id="cb14-1194"><a href="#cb14-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1195"><a href="#cb14-1195" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">here</span>(<span class="st">"Outputs"</span>, <span class="st">"Figures"</span>, </span>
<span id="cb14-1196"><a href="#cb14-1196" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Diagnostics"</span>, <span class="st">"OUTCOME_1.pdf"</span>))</span>
<span id="cb14-1197"><a href="#cb14-1197" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_nuts_divergence</span>(<span class="fu">nuts_params</span>(pen_model_1), </span>
<span id="cb14-1198"><a href="#cb14-1198" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">log_posterior</span>(pen_model_1))</span>
<span id="cb14-1199"><a href="#cb14-1199" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb14-1200"><a href="#cb14-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1201"><a href="#cb14-1201" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Residual Plots ----------------------------</span></span>
<span id="cb14-1202"><a href="#cb14-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1203"><a href="#cb14-1203" aria-hidden="true" tabindex="-1"></a>df_resid_stan_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">fitted</span>(pen_model_1)[, <span class="dv">1</span>], </span>
<span id="cb14-1204"><a href="#cb14-1204" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">residuals</span>(pen_model_1)[, <span class="dv">1</span>])</span>
<span id="cb14-1205"><a href="#cb14-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1206"><a href="#cb14-1206" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">here</span>(<span class="st">"Outputs"</span>, <span class="st">"Figures"</span>, </span>
<span id="cb14-1207"><a href="#cb14-1207" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Diagnostics"</span>, <span class="st">"OUTCOME_1.pdf"</span>))</span>
<span id="cb14-1208"><a href="#cb14-1208" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_resid_stan_1, </span>
<span id="cb14-1209"><a href="#cb14-1209" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">residuals</span>(pen_model_1)[, <span class="dv">1</span>])) <span class="sc">+</span></span>
<span id="cb14-1210"><a href="#cb14-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb14-1211"><a href="#cb14-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb14-1212"><a href="#cb14-1212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Model 1 Residuals"</span>)</span>
<span id="cb14-1213"><a href="#cb14-1213" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb14-1214"><a href="#cb14-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1215"><a href="#cb14-1215" aria-hidden="true" tabindex="-1"></a>(sum1 <span class="ot">&lt;-</span> (<span class="fu">posterior_summary</span>(pen_model_1))[<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>, ])</span>
<span id="cb14-1216"><a href="#cb14-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1217"><a href="#cb14-1217" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_intervals</span>(pen_model_1, <span class="at">point_est =</span> <span class="st">"median"</span>, </span>
<span id="cb14-1218"><a href="#cb14-1218" aria-hidden="true" tabindex="-1"></a>               <span class="at">prob =</span> <span class="fl">0.95</span>, <span class="at">prob_outer =</span> <span class="dv">0</span>, </span>
<span id="cb14-1219"><a href="#cb14-1219" aria-hidden="true" tabindex="-1"></a>               <span class="at">pars =</span> <span class="fu">parnames</span>(pen_model_1)) <span class="sc">+</span></span>
<span id="cb14-1220"><a href="#cb14-1220" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_discrete</span>() <span class="sc">+</span></span>
<span id="cb14-1221"><a href="#cb14-1221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),</span>
<span id="cb14-1222"><a href="#cb14-1222" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),</span>
<span id="cb14-1223"><a href="#cb14-1223" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>, </span>
<span id="cb14-1224"><a href="#cb14-1224" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb14-1225"><a href="#cb14-1225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>,</span>
<span id="cb14-1226"><a href="#cb14-1226" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">0.05</span>, <span class="at">xmax =</span> <span class="fl">0.05</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="dv">7</span>,</span>
<span id="cb14-1227"><a href="#cb14-1227" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"darkred"</span>, <span class="at">alpha =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb14-1228"><a href="#cb14-1228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>,</span>
<span id="cb14-1229"><a href="#cb14-1229" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.05</span>, <span class="at">xend =</span> <span class="sc">-</span><span class="fl">0.05</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">7</span>,</span>
<span id="cb14-1230"><a href="#cb14-1230" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"#990000"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, </span>
<span id="cb14-1231"><a href="#cb14-1231" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> .<span class="dv">75</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb14-1232"><a href="#cb14-1232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>,</span>
<span id="cb14-1233"><a href="#cb14-1233" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.05</span>, <span class="at">xend =</span> <span class="fl">0.05</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">7</span>,</span>
<span id="cb14-1234"><a href="#cb14-1234" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"#990000"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, </span>
<span id="cb14-1235"><a href="#cb14-1235" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> .<span class="dv">75</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb14-1236"><a href="#cb14-1236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Change in Outcome 1"</span>)</span>
<span id="cb14-1237"><a href="#cb14-1237" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb14-1238"><a href="#cb14-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1239"><a href="#cb14-1239" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">here</span>(<span class="st">"Outputs"</span>, <span class="st">"Figures"</span>, <span class="st">"OUTCOME_1.pdf"</span>))</span>
<span id="cb14-1240"><a href="#cb14-1240" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_hist</span>(pen_model_1)</span>
<span id="cb14-1241"><a href="#cb14-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1242"><a href="#cb14-1242" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior Predictive Checks</span></span>
<span id="cb14-1243"><a href="#cb14-1243" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb14-1244"><a href="#cb14-1244" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">here</span>(<span class="st">"Outputs"</span>, <span class="st">"Figures"</span>, <span class="st">"Diagnostics"</span>, </span>
<span id="cb14-1245"><a href="#cb14-1245" aria-hidden="true" tabindex="-1"></a>         <span class="st">"OUTCOME_1check.pdf"</span>))</span>
<span id="cb14-1246"><a href="#cb14-1246" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(pen_model_1, <span class="at">nsamples =</span> <span class="dv">250</span>) <span class="sc">+</span> </span>
<span id="cb14-1247"><a href="#cb14-1247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Posterior Predictive Check: Model 1"</span>)</span>
<span id="cb14-1248"><a href="#cb14-1248" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb14-1249"><a href="#cb14-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1250"><a href="#cb14-1250" aria-hidden="true" tabindex="-1"></a><span class="co"># Shows dens_overlay plot by default</span></span>
<span id="cb14-1251"><a href="#cb14-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1252"><a href="#cb14-1252" aria-hidden="true" tabindex="-1"></a>bayes_rsq1 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(pen_model_1)</span>
<span id="cb14-1253"><a href="#cb14-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1254"><a href="#cb14-1254" aria-hidden="true" tabindex="-1"></a>bayes_rsq1 <span class="ot">&lt;-</span> <span class="fu">print</span>(<span class="fu">median</span>(bayes_rsq1))</span>
<span id="cb14-1255"><a href="#cb14-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1256"><a href="#cb14-1256" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(sum1, <span class="fu">here</span>(<span class="st">"Outputs"</span>, <span class="st">"Tables"</span>, </span>
<span id="cb14-1257"><a href="#cb14-1257" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"OUTCOME_1.csv"</span>))</span>
<span id="cb14-1258"><a href="#cb14-1258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-1259"><a href="#cb14-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1260"><a href="#cb14-1260" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1261"><a href="#cb14-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1262"><a href="#cb14-1262" aria-hidden="true" tabindex="-1"></a>Once I have fit my model and done some initial checks, I usually conduct</span>
<span id="cb14-1263"><a href="#cb14-1263" aria-hidden="true" tabindex="-1"></a>some more thorough checks using k-fold cross-validation or nested</span>
<span id="cb14-1264"><a href="#cb14-1264" aria-hidden="true" tabindex="-1"></a>cross-validation, or bootstrap optimism.</span>
<span id="cb14-1265"><a href="#cb14-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1266"><a href="#cb14-1266" aria-hidden="true" tabindex="-1"></a>A script of this can be found below.</span>
<span id="cb14-1267"><a href="#cb14-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1268"><a href="#cb14-1268" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1269"><a href="#cb14-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1270"><a href="#cb14-1270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE, include=TRUE}</span></span>
<span id="cb14-1271"><a href="#cb14-1271" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>))</span>
<span id="cb14-1272"><a href="#cb14-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1273"><a href="#cb14-1273" aria-hidden="true" tabindex="-1"></a><span class="co"># 10-Fold Cross-Validations -------------------------</span></span>
<span id="cb14-1274"><a href="#cb14-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1275"><a href="#cb14-1275" aria-hidden="true" tabindex="-1"></a>kfold_1 <span class="ot">&lt;-</span> <span class="fu">kfold</span>(pen_model_1, <span class="at">K =</span> <span class="dv">10</span>, </span>
<span id="cb14-1276"><a href="#cb14-1276" aria-hidden="true" tabindex="-1"></a>                 <span class="at">save_fits =</span> <span class="cn">TRUE</span>, <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb14-1277"><a href="#cb14-1277" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(kfold_1, <span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"Models"</span>, </span>
<span id="cb14-1278"><a href="#cb14-1278" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Validation"</span>, <span class="st">"kfold_1.rds"</span>))</span>
<span id="cb14-1279"><a href="#cb14-1279" aria-hidden="true" tabindex="-1"></a>kfp_1 <span class="ot">&lt;-</span> <span class="fu">kfold_predict</span>(kfold_1)</span>
<span id="cb14-1280"><a href="#cb14-1280" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(kfp_1, <span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"Models"</span>, </span>
<span id="cb14-1281"><a href="#cb14-1281" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Validation"</span>, <span class="st">"kfp_1.rds"</span>))</span>
<span id="cb14-1282"><a href="#cb14-1282" aria-hidden="true" tabindex="-1"></a><span class="fu">kfold_rmse</span>(<span class="at">y =</span> kfp_1<span class="sc">$</span>y, </span>
<span id="cb14-1283"><a href="#cb14-1283" aria-hidden="true" tabindex="-1"></a>           <span class="at">yrep =</span> kfp_1<span class="sc">$</span>yrep, </span>
<span id="cb14-1284"><a href="#cb14-1284" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"rmse"</span>, </span>
<span id="cb14-1285"><a href="#cb14-1285" aria-hidden="true" tabindex="-1"></a>           <span class="at">reps =</span> <span class="dv">5000</span>, </span>
<span id="cb14-1286"><a href="#cb14-1286" aria-hidden="true" tabindex="-1"></a><span class="at">cores =</span> <span class="dv">4</span>)[[<span class="dv">2</span>]][[<span class="st">"t"</span>]]<span class="er">)</span> <span class="ot">-&gt;</span> kfold_rmse_1</span>
<span id="cb14-1287"><a href="#cb14-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1288"><a href="#cb14-1288" aria-hidden="true" tabindex="-1"></a>kfold_rmse_1 <span class="ot">&lt;-</span> <span class="fu">median</span>(kfold_rmse_1)</span>
<span id="cb14-1289"><a href="#cb14-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1290"><a href="#cb14-1290" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(kfold_rmse_1, </span>
<span id="cb14-1291"><a href="#cb14-1291" aria-hidden="true" tabindex="-1"></a>        <span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"Models"</span>, </span>
<span id="cb14-1292"><a href="#cb14-1292" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Validation"</span>, <span class="st">"kfold_rmse_1.rds"</span>))</span>
<span id="cb14-1293"><a href="#cb14-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1294"><a href="#cb14-1294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-1295"><a href="#cb14-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1296"><a href="#cb14-1296" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1297"><a href="#cb14-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1298"><a href="#cb14-1298" aria-hidden="true" tabindex="-1"></a>Once I've written all my analysis and validation scripts, I'll typically</span>
<span id="cb14-1299"><a href="#cb14-1299" aria-hidden="true" tabindex="-1"></a>create a subfolder in the <span class="in">`Outputs`</span> folder called <span class="in">`Figures`</span> and <span class="in">`Tables`</span></span>
<span id="cb14-1300"><a href="#cb14-1300" aria-hidden="true" tabindex="-1"></a>and save them appropriately with the help <span class="in">`here()`</span>.</span>
<span id="cb14-1301"><a href="#cb14-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1302"><a href="#cb14-1302" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1303"><a href="#cb14-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1304"><a href="#cb14-1304" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example Table Script</span></span>
<span id="cb14-1305"><a href="#cb14-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1306"><a href="#cb14-1306" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1307"><a href="#cb14-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1308"><a href="#cb14-1308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Table Script, eval=FALSE, include=TRUE}</span></span>
<span id="cb14-1309"><a href="#cb14-1309" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"01-functions.R"</span>))</span>
<span id="cb14-1310"><a href="#cb14-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1311"><a href="#cb14-1311" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in Validation Objects ------------------------</span></span>
<span id="cb14-1312"><a href="#cb14-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1313"><a href="#cb14-1313" aria-hidden="true" tabindex="-1"></a>kfold_1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"kfold_1.rds"</span>, </span>
<span id="cb14-1314"><a href="#cb14-1314" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">here</span>(<span class="st">"Main Project"</span>, <span class="st">"Data"</span>, </span>
<span id="cb14-1315"><a href="#cb14-1315" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Models"</span>, <span class="st">"Validation"</span>, </span>
<span id="cb14-1316"><a href="#cb14-1316" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"kfold_1.rds"</span>))</span>
<span id="cb14-1317"><a href="#cb14-1317" aria-hidden="true" tabindex="-1"></a>kfold_2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"kfold_1.rds"</span>, </span>
<span id="cb14-1318"><a href="#cb14-1318" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">here</span>(<span class="st">"Main Project"</span>, <span class="st">"Data"</span>, </span>
<span id="cb14-1319"><a href="#cb14-1319" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Models"</span>, <span class="st">"Validation"</span>, </span>
<span id="cb14-1320"><a href="#cb14-1320" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"kfold_2.rds"</span>))</span>
<span id="cb14-1321"><a href="#cb14-1321" aria-hidden="true" tabindex="-1"></a>kfp_1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"kfp_1.rds"</span>, </span>
<span id="cb14-1322"><a href="#cb14-1322" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">here</span>(<span class="st">"Main Project"</span>, <span class="st">"Data"</span>, </span>
<span id="cb14-1323"><a href="#cb14-1323" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Models"</span>, <span class="st">"Validation"</span>, </span>
<span id="cb14-1324"><a href="#cb14-1324" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"kfp_1.rds"</span>))</span>
<span id="cb14-1325"><a href="#cb14-1325" aria-hidden="true" tabindex="-1"></a>kfp_2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"kfp_1.rds"</span>, </span>
<span id="cb14-1326"><a href="#cb14-1326" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">here</span>(<span class="st">"Main Project"</span>, <span class="st">"Data"</span>, </span>
<span id="cb14-1327"><a href="#cb14-1327" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Models"</span>,<span class="st">"Validation"</span>, </span>
<span id="cb14-1328"><a href="#cb14-1328" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"kfp_2.rds"</span>))</span>
<span id="cb14-1329"><a href="#cb14-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1330"><a href="#cb14-1330" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Estimates from Objects ---------------------</span></span>
<span id="cb14-1331"><a href="#cb14-1331" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb14-1332"><a href="#cb14-1332" aria-hidden="true" tabindex="-1"></a>KFOLDIC_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(kfold_1[[<span class="st">"estimates"</span>]][<span class="dv">3</span>], </span>
<span id="cb14-1333"><a href="#cb14-1333" aria-hidden="true" tabindex="-1"></a>                     kfold_2[[<span class="st">"estimates"</span>]][<span class="dv">3</span>])</span>
<span id="cb14-1334"><a href="#cb14-1334" aria-hidden="true" tabindex="-1"></a>KFOLDIC_SE_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(kfold_1[[<span class="st">"estimates"</span>]][<span class="dv">3</span>, <span class="dv">2</span>], </span>
<span id="cb14-1335"><a href="#cb14-1335" aria-hidden="true" tabindex="-1"></a>                        kfold_2[[<span class="st">"estimates"</span>]][<span class="dv">3</span>, <span class="dv">2</span>])</span>
<span id="cb14-1336"><a href="#cb14-1336" aria-hidden="true" tabindex="-1"></a>BAYES_R2 <span class="ot">&lt;-</span> <span class="fu">c</span>(bayes_rsq1, bayes_rsq2), <span class="dv">2</span><span class="er">)</span></span>
<span id="cb14-1337"><a href="#cb14-1337" aria-hidden="true" tabindex="-1"></a>KFOLD_ELPD_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(kfold_1[[<span class="st">"estimates"</span>]][<span class="dv">1</span>], </span>
<span id="cb14-1338"><a href="#cb14-1338" aria-hidden="true" tabindex="-1"></a>                        kfold_2[[<span class="st">"estimates"</span>]][<span class="dv">1</span>])</span>
<span id="cb14-1339"><a href="#cb14-1339" aria-hidden="true" tabindex="-1"></a>KFOLD_ELPD_SE_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(kfold_1[[<span class="st">"estimates"</span>]][<span class="dv">1</span>, <span class="dv">2</span>], </span>
<span id="cb14-1340"><a href="#cb14-1340" aria-hidden="true" tabindex="-1"></a>                           kfold_2[[<span class="st">"estimates"</span>]][<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb14-1341"><a href="#cb14-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1342"><a href="#cb14-1342" aria-hidden="true" tabindex="-1"></a>Outcome <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"OUTCOME_1"</span>, <span class="st">"OUTCOME_2"</span>)</span>
<span id="cb14-1343"><a href="#cb14-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1344"><a href="#cb14-1344" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct Data Frames ------------------------------</span></span>
<span id="cb14-1345"><a href="#cb14-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1346"><a href="#cb14-1346" aria-hidden="true" tabindex="-1"></a>table4 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Outcome, BAYES_R2, KFOLD_ELPD_1, </span>
<span id="cb14-1347"><a href="#cb14-1347" aria-hidden="true" tabindex="-1"></a>                     KFOLD_ELPD_SE_1, KFOLDIC_1, </span>
<span id="cb14-1348"><a href="#cb14-1348" aria-hidden="true" tabindex="-1"></a>                     KFOLDIC_SE_1)</span>
<span id="cb14-1349"><a href="#cb14-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1350"><a href="#cb14-1350" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table4) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Outcome"</span>, <span class="st">"Bayes R^2"</span>, </span>
<span id="cb14-1351"><a href="#cb14-1351" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"10-fold CV ELPD"</span>, </span>
<span id="cb14-1352"><a href="#cb14-1352" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"10-fold CV ELPD SE"</span>,</span>
<span id="cb14-1353"><a href="#cb14-1353" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"10-fold CV IC"</span>, </span>
<span id="cb14-1354"><a href="#cb14-1354" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"10-fold CV IC SE"</span>)</span>
<span id="cb14-1355"><a href="#cb14-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1356"><a href="#cb14-1356" aria-hidden="true" tabindex="-1"></a><span class="co"># Export as Tables ----------------------------------</span></span>
<span id="cb14-1357"><a href="#cb14-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1358"><a href="#cb14-1358" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(table4, <span class="fu">here</span>(<span class="st">"Main Project"</span>,<span class="st">"Outputs"</span>, </span>
<span id="cb14-1359"><a href="#cb14-1359" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Tables"</span>, <span class="st">"Table4.csv"</span>))</span>
<span id="cb14-1360"><a href="#cb14-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1361"><a href="#cb14-1361" aria-hidden="true" tabindex="-1"></a>table5 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Outcome, KFOLD_ELPD_1, </span>
<span id="cb14-1362"><a href="#cb14-1362" aria-hidden="true" tabindex="-1"></a>                     KFOLD_ELPD_SE_1, </span>
<span id="cb14-1363"><a href="#cb14-1363" aria-hidden="true" tabindex="-1"></a>                     KFOLDIC_1, KFOLDIC_SE_1)</span>
<span id="cb14-1364"><a href="#cb14-1364" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table5) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Outcome"</span>, <span class="st">"10-fold CV ELPD"</span>, </span>
<span id="cb14-1365"><a href="#cb14-1365" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"10-fold CV ELPD SE"</span>,</span>
<span id="cb14-1366"><a href="#cb14-1366" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"10-fold CV IC"</span>, </span>
<span id="cb14-1367"><a href="#cb14-1367" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"10-fold CV IC SE"</span>)</span>
<span id="cb14-1368"><a href="#cb14-1368" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(table5, </span>
<span id="cb14-1369"><a href="#cb14-1369" aria-hidden="true" tabindex="-1"></a>          <span class="fu">here</span>(<span class="st">"Main Project"</span>,<span class="st">"Outputs"</span>, <span class="st">"Tables"</span>, </span>
<span id="cb14-1370"><a href="#cb14-1370" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Table5.csv"</span>))</span>
<span id="cb14-1371"><a href="#cb14-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1372"><a href="#cb14-1372" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Tables From Sensitivity Analyses --------------</span></span>
<span id="cb14-1373"><a href="#cb14-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1374"><a href="#cb14-1374" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(sens_table_OUTCOME_1, </span>
<span id="cb14-1375"><a href="#cb14-1375" aria-hidden="true" tabindex="-1"></a>          <span class="fu">here</span>(<span class="st">"Main Project"</span>,<span class="st">"Outputs"</span>, <span class="st">"Tables"</span>, </span>
<span id="cb14-1376"><a href="#cb14-1376" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Table7_OUTCOME_1.csv"</span>))</span>
<span id="cb14-1377"><a href="#cb14-1377" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(sens_table_OUTCOME_2, </span>
<span id="cb14-1378"><a href="#cb14-1378" aria-hidden="true" tabindex="-1"></a>          <span class="fu">here</span>(<span class="st">"Main Project"</span>,<span class="st">"Outputs"</span>, <span class="st">"Tables"</span>, </span>
<span id="cb14-1379"><a href="#cb14-1379" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Table7_OUTCOME_2.csv"</span>))</span>
<span id="cb14-1380"><a href="#cb14-1380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-1381"><a href="#cb14-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1382"><a href="#cb14-1382" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1383"><a href="#cb14-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1384"><a href="#cb14-1384" aria-hidden="true" tabindex="-1"></a>Then, I'll go back to the <span class="in">`README.Rmd`</span> file, make notes of the hierarchy</span>
<span id="cb14-1385"><a href="#cb14-1385" aria-hidden="true" tabindex="-1"></a>of the entire folder and subfolders, and what's been completed, and what</span>
<span id="cb14-1386"><a href="#cb14-1386" aria-hidden="true" tabindex="-1"></a>still needs to be done.</span>
<span id="cb14-1387"><a href="#cb14-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1388"><a href="#cb14-1388" aria-hidden="true" tabindex="-1"></a>Now, suppose I deleted all of my saved models, imputed data, graphs, and</span>
<span id="cb14-1389"><a href="#cb14-1389" aria-hidden="true" tabindex="-1"></a>tables, (which would be a devastating blow!) and only had the original</span>
<span id="cb14-1390"><a href="#cb14-1390" aria-hidden="true" tabindex="-1"></a>dataset and organized scripts. Anyone could go into my project and</span>
<span id="cb14-1391"><a href="#cb14-1391" aria-hidden="true" tabindex="-1"></a>simply highlight the entire <span class="in">`main.R`</span> file and run it, and they would get</span>
<span id="cb14-1392"><a href="#cb14-1392" aria-hidden="true" tabindex="-1"></a>all the same outputs and models, assuming a seed was set in advance,</span>
<span id="cb14-1393"><a href="#cb14-1393" aria-hidden="true" tabindex="-1"></a>which is essential. Although, it might take them a long time to get the</span>
<span id="cb14-1394"><a href="#cb14-1394" aria-hidden="true" tabindex="-1"></a>same outputs (if computationally intensive)... they would likely be able</span>
<span id="cb14-1395"><a href="#cb14-1395" aria-hidden="true" tabindex="-1"></a>to get all the exact same results.</span>
<span id="cb14-1396"><a href="#cb14-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1397"><a href="#cb14-1397" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1398"><a href="#cb14-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1399"><a href="#cb14-1399" aria-hidden="true" tabindex="-1"></a><span class="fu"># Possible Drawbacks of this Approach</span></span>
<span id="cb14-1400"><a href="#cb14-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1401"><a href="#cb14-1401" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1402"><a href="#cb14-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1403"><a href="#cb14-1403" aria-hidden="true" tabindex="-1"></a>Every proposal tends to have drawbacks or limitations, and those who do</span>
<span id="cb14-1404"><a href="#cb14-1404" aria-hidden="true" tabindex="-1"></a>not explicitly tell you about them are misleading you. In the approach I</span>
<span id="cb14-1405"><a href="#cb14-1405" aria-hidden="true" tabindex="-1"></a>have outlined above, one major drawback is that it takes a somewhat long</span>
<span id="cb14-1406"><a href="#cb14-1406" aria-hidden="true" tabindex="-1"></a>time to set up and therefore could deter many statisticians and data</span>
<span id="cb14-1407"><a href="#cb14-1407" aria-hidden="true" tabindex="-1"></a>analysts. The other drawback is that by loading all your functions and</span>
<span id="cb14-1408"><a href="#cb14-1408" aria-hidden="true" tabindex="-1"></a>libraries in the first <span class="in">`01_functions.R`</span> script, there is potential for</span>
<span id="cb14-1409"><a href="#cb14-1409" aria-hidden="true" tabindex="-1"></a>conflict between functions, therefore you'll have to be mindful of what</span>
<span id="cb14-1410"><a href="#cb14-1410" aria-hidden="true" tabindex="-1"></a>packages you need and when. Indeed, I ran into this issue when loading</span>
<span id="cb14-1411"><a href="#cb14-1411" aria-hidden="true" tabindex="-1"></a>the <span class="in">`brms`</span> package, which had several functions that conflicted with the</span>
<span id="cb14-1412"><a href="#cb14-1412" aria-hidden="true" tabindex="-1"></a>base <span class="in">`R`</span> functions. So please be mindful of this.</span>
<span id="cb14-1413"><a href="#cb14-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1414"><a href="#cb14-1414" aria-hidden="true" tabindex="-1"></a>Further, and most importantly, I have no evidence that this approach can</span>
<span id="cb14-1415"><a href="#cb14-1415" aria-hidden="true" tabindex="-1"></a>truly prevent errors, it is simply a belief I have as a result of my own</span>
<span id="cb14-1416"><a href="#cb14-1416" aria-hidden="true" tabindex="-1"></a>experiences and suggesting them to others, and hearing positive</span>
<span id="cb14-1417"><a href="#cb14-1417" aria-hidden="true" tabindex="-1"></a>comments. So please, take that into account, although I would be</span>
<span id="cb14-1418"><a href="#cb14-1418" aria-hidden="true" tabindex="-1"></a>grateful if you were able to share your positive or even negative</span>
<span id="cb14-1419"><a href="#cb14-1419" aria-hidden="true" tabindex="-1"></a>experiences using this approach below.</span>
<span id="cb14-1420"><a href="#cb14-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1421"><a href="#cb14-1421" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1422"><a href="#cb14-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1423"><a href="#cb14-1423" aria-hidden="true" tabindex="-1"></a>Please, please annotate your scripts, as I have done so several times</span>
<span id="cb14-1424"><a href="#cb14-1424" aria-hidden="true" tabindex="-1"></a>above to explain some of the functions. This is not only helpful for</span>
<span id="cb14-1425"><a href="#cb14-1425" aria-hidden="true" tabindex="-1"></a>others who are trying to go through your code and understand it, but</span>
<span id="cb14-1426"><a href="#cb14-1426" aria-hidden="true" tabindex="-1"></a>also for yourself. If you end up forgetting what function does what, and</span>
<span id="cb14-1427"><a href="#cb14-1427" aria-hidden="true" tabindex="-1"></a>what steps you were taking, you will be in for a really frustrating</span>
<span id="cb14-1428"><a href="#cb14-1428" aria-hidden="true" tabindex="-1"></a>time, and possibly prone to making serious mistakes.</span>
<span id="cb14-1429"><a href="#cb14-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1430"><a href="#cb14-1430" aria-hidden="true" tabindex="-1"></a>Here's what my project folders tend to look like (figure below). And</span>
<span id="cb14-1431"><a href="#cb14-1431" aria-hidden="true" tabindex="-1"></a>here is a [template GitHub</span>
<span id="cb14-1432"><a href="#cb14-1432" aria-hidden="true" tabindex="-1"></a>repo](https://github.com/zadrafi/statworkflow) to show what the</span>
<span id="cb14-1433"><a href="#cb14-1433" aria-hidden="true" tabindex="-1"></a>structure typically looks like.</span>
<span id="cb14-1434"><a href="#cb14-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1435"><a href="#cb14-1435" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1436"><a href="#cb14-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1437"><a href="#cb14-1437" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> data-enlargeable width</span><span class="op">=</span><span class="st">"400"</span><span class="ot"> style</span><span class="op">=</span><span class="st">"cursor: zoom-in"</span><span class="ot"> src </span><span class="op">=</span><span class="st">"https://res.cloudinary.com/less-likely/image/upload/v1592068111/Site/Screen_Shot_2020-06-13_at_11.38.26_AM.png"</span><span class="dt">&gt;</span></span>
<span id="cb14-1438"><a href="#cb14-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1439"><a href="#cb14-1439" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1440"><a href="#cb14-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1441"><a href="#cb14-1441" aria-hidden="true" tabindex="-1"></a>It should go without saying that sharing your data (if possible) and</span>
<span id="cb14-1442"><a href="#cb14-1442" aria-hidden="true" tabindex="-1"></a>code will help you and your collaborators catch errors before it's too</span>
<span id="cb14-1443"><a href="#cb14-1443" aria-hidden="true" tabindex="-1"></a>late, but also, sharing them with others/the public after a project is</span>
<span id="cb14-1444"><a href="#cb14-1444" aria-hidden="true" tabindex="-1"></a>done will *also* help catch possible errors that you/your</span>
<span id="cb14-1445"><a href="#cb14-1445" aria-hidden="true" tabindex="-1"></a>collaborators/reviewers didn't catch, which may mislead other</span>
<span id="cb14-1446"><a href="#cb14-1446" aria-hidden="true" tabindex="-1"></a>researchers and also result in a much more stressful situation for you.</span>
<span id="cb14-1447"><a href="#cb14-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1448"><a href="#cb14-1448" aria-hidden="true" tabindex="-1"></a>And last but not least, it is also essential to give extensive details</span>
<span id="cb14-1449"><a href="#cb14-1449" aria-hidden="true" tabindex="-1"></a>on which version of <span class="in">`R`</span> you used and which packages you used and their</span>
<span id="cb14-1450"><a href="#cb14-1450" aria-hidden="true" tabindex="-1"></a>versions. This is because many scripts that once worked on previous</span>
<span id="cb14-1451"><a href="#cb14-1451" aria-hidden="true" tabindex="-1"></a>versions of the software may no longer give the same results or may not</span>
<span id="cb14-1452"><a href="#cb14-1452" aria-hidden="true" tabindex="-1"></a>even work at all. In order for someone to reproduce your results,</span>
<span id="cb14-1453"><a href="#cb14-1453" aria-hidden="true" tabindex="-1"></a>they'll need to know the environment on which you ran your analyses on.</span>
<span id="cb14-1454"><a href="#cb14-1454" aria-hidden="true" tabindex="-1"></a>You can provide these details easily simply by running the script</span>
<span id="cb14-1455"><a href="#cb14-1455" aria-hidden="true" tabindex="-1"></a><span class="in">`sessionInfo()`</span>, which should be at the end of every <span class="in">`R`</span> script you run.</span>
<span id="cb14-1456"><a href="#cb14-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1457"><a href="#cb14-1457" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1458"><a href="#cb14-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1459"><a href="#cb14-1459" aria-hidden="true" tabindex="-1"></a><span class="fu"># Helpful Resources</span></span>
<span id="cb14-1460"><a href="#cb14-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1461"><a href="#cb14-1461" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1462"><a href="#cb14-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1463"><a href="#cb14-1463" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>[Workflow for Statistical Analysis and Report</span>
<span id="cb14-1464"><a href="#cb14-1464" aria-hidden="true" tabindex="-1"></a>    Writing](https://stackoverflow.com/questions/1429907/workflow-for-statistical-analysis-and-report-writing)</span>
<span id="cb14-1465"><a href="#cb14-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1466"><a href="#cb14-1466" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1467"><a href="#cb14-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1468"><a href="#cb14-1468" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>[How to Save Data File into</span>
<span id="cb14-1469"><a href="#cb14-1469" aria-hidden="true" tabindex="-1"></a>    .RData?](https://stackoverflow.com/questions/19967478/how-to-save-data-file-into-rdata)</span>
<span id="cb14-1470"><a href="#cb14-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1471"><a href="#cb14-1471" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1472"><a href="#cb14-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1473"><a href="#cb14-1473" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>[Basic Data Entry Using</span>
<span id="cb14-1474"><a href="#cb14-1474" aria-hidden="true" tabindex="-1"></a>    Excel](https://www.youtube.com/watch?v=Ry2xjTBtNFE)</span>
<span id="cb14-1475"><a href="#cb14-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1476"><a href="#cb14-1476" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1477"><a href="#cb14-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1478"><a href="#cb14-1478" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>[Sending Me Data in</span>
<span id="cb14-1479"><a href="#cb14-1479" aria-hidden="true" tabindex="-1"></a>    Excel](https://www.kristianbrock.com/post/send-me-data/)</span>
<span id="cb14-1480"><a href="#cb14-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1481"><a href="#cb14-1481" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1482"><a href="#cb14-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1483"><a href="#cb14-1483" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Happy Git and GitHub for the useR</span><span class="co">](https://happygitwithr.com/)</span></span>
<span id="cb14-1484"><a href="#cb14-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1485"><a href="#cb14-1485" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1486"><a href="#cb14-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1487"><a href="#cb14-1487" aria-hidden="true" tabindex="-1"></a><span class="fu"># Environment</span></span>
<span id="cb14-1488"><a href="#cb14-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1489"><a href="#cb14-1489" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1490"><a href="#cb14-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1491"><a href="#cb14-1491" aria-hidden="true" tabindex="-1"></a>The analyses were run on:</span>
<span id="cb14-1492"><a href="#cb14-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1493"><a href="#cb14-1493" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1494"><a href="#cb14-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1495"><a href="#cb14-1495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Session Info, include=TRUE, echo=FALSE}</span></span>
<span id="cb14-1496"><a href="#cb14-1496" aria-hidden="true" tabindex="-1"></a>si <span class="ot">&lt;-</span> <span class="fu">sessionInfo</span>()</span>
<span id="cb14-1497"><a href="#cb14-1497" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(si, <span class="at">RNG =</span> <span class="cn">TRUE</span>, <span class="at">locale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-1498"><a href="#cb14-1498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-1499"><a href="#cb14-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1500"><a href="#cb14-1500" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb14-1501"><a href="#cb14-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1502"><a href="#cb14-1502" aria-hidden="true" tabindex="-1"></a><span class="fu"># References</span></span>
<span id="cb14-1503"><a href="#cb14-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1504"><a href="#cb14-1504" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2025, Less Likely</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/zadrafi/lesslikely/edit/main/posts/statistics/statistical-quality-control.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/zadrafi/lesslikely/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/Lester_Domes">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/yourusername">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>