<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Less Likely Blog</title>
<link>https://lesslikely.com/blog.html</link>
<atom:link href="https://lesslikely.com/blog.xml" rel="self" type="application/rss+xml"/>
<description>Latest posts on statistical science and methodology</description>
<image>
<url>https://lesslikely.com/logo.png</url>
<title>Less Likely Blog</title>
<link>https://lesslikely.com/blog.html</link>
</image>
<generator>quarto-1.7.34</generator>
<lastBuildDate>Mon, 01 Feb 2021 05:00:00 GMT</lastBuildDate>
<item>
  <title>Simulation of a Two-Group Parallel-Arm RCT with Interim Analyses</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/interim_analyses.html</link>
  <description><![CDATA[ 





<script src="interim_analyses_files/libs/kePrint-0.0.1/kePrint.js"></script>
<p><link href="interim_analyses_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet"></p>
<hr>
<p>Recently <a href="https://twitter.com/ADAlthousePhD">Andrew Althouse</a> informed me that he was going to simulate a two-group parallel-arm randomized trial with interim analyses using the <a href="https://CRAN.R-project.org/package=rpact"><code>rpact</code></a> <code>R</code> package, so I offered to also help in constructing the <code>R</code> code to do so. He already has a number of <code>R</code> scripts on his GitHub repo for doing similar simulations, which can be <a href="https://github.com/aalthous/RCT-Simulation-v1">viewed here</a> and a number of tweets explaining these simulations. For this example, his goal was to simulate a trial where the outcome was binary and the probability of death for each group could be tuned in addition to:</p>
<hr>
<ul>
<li>the total number of participants</li>
</ul>
<hr>
<ul>
<li>the number of interim analyses</li>
</ul>
<hr>
<ul>
<li>the schedule of the interim analyses</li>
</ul>
<hr>
<ul>
<li>the group-sequential design used</li>
</ul>
<hr>
<p>along with the usual trial analysis parameters such as:</p>
<hr>
<ul>
<li>the <img src="https://latex.codecogs.com/png.latex?%5Calpha">-level</li>
</ul>
<hr>
<ul>
<li>the type of test (1-sided vs.&nbsp;2-sided).</li>
</ul>
<hr>
<p>The goal was to be able to produce a table of various statistics such as:</p>
<hr>
<ul>
<li>the odds ratio</li>
</ul>
<hr>
<ul>
<li>the confidence limits</li>
</ul>
<hr>
<ul>
<li>the <img src="https://latex.codecogs.com/png.latex?P">-value</li>
</ul>
<hr>
<ul>
<li>the number of successes</li>
</ul>
<hr>
<p>for each of the interim analyses specified.</p>
<hr>
<p>The function below is a reflection of our efforts to do so, and also returns several plots from the <a href="https://CRAN.R-project.org/package=rpact"><code>rpact</code></a> package for the design that is chosen along with a plot comparing the design to other designs. In order to get similar results, you will need to load the <code>R</code> function first, and then simply enter the proper inputs. While there may be more efficient ways to write the code, for example using <code>lapply()</code> instead of for loops, we have chosen not to do so, and we have also tried to minimize the number of <code>R</code> packages necessary for the function to work but the following will be required:</p>
<hr>
<ul>
<li><a href="https://CRAN.R-project.org/package=rpact"><code>rpact</code></a></li>
</ul>
<hr>
<ul>
<li><a href="https://CRAN.R-project.org/package=stringr"><code>stringr</code></a></li>
</ul>
<hr>
<p>You can quickly install and load both using:</p>
<hr>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">req_packs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rpact"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stringr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggplot2"</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(req_packs)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(req_packs, library, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">character.only =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<hr>
<section id="setting-up-the-function" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setting up the Function</h1>
<hr>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @title Simulation of a Two-Group Parallel-Arm Trial With Interim Analyses</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @docType Custom function for simulation from the rpact package</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @author Andrew Althouse with edits by Zad Rafi</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: If you want to confirm "type 1 error" under different stopping rules,</span></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' make death = in the two treatment arms (e.g. no treatment effect)</span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: I have set this one up to test the power for a treatment that would reduce mortality</span></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' from 40% in control group (1) to 30% in treatment group (2)</span></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Trial Design Parameters - Part 1</span></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Here we will specify the basics: total N patients to enroll, and death rate for each treatment arm</span></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Trial Design Parameters - Part 2</span></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Here we will define the interim analysis strategy and stopping rules</span></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' For this trial we will include provisions for efficacy stopping only (no pre-specified futility stopping)</span></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' We will use the rpact package to compute the stopping/success thresholds at the interim and final analysis</span></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Required packages: rpact and stringr</span></span>
<span id="cb2-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param nSims # The number of simulations, the default is 1000</span></span>
<span id="cb2-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param nPatients # here is where you specify the planned max number of patients you want included in each RCT</span></span>
<span id="cb2-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param death1 # here is where you specify the event rate for patients receiving 'treatment 1' in these trial</span></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param death2 # here is where you specify the event rate for patients receiving 'treatment 2' in these trials</span></span>
<span id="cb2-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param nLooks # here is where you put the number of looks that will take place (INCLUDING the final analysis)</span></span>
<span id="cb2-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param analyses_scheduled # schedule of interim analyses</span></span>
<span id="cb2-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param sided # Whether the test is 1-sided or 2-sided</span></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param alpha # Specified alpha level, the default is 0.05</span></span>
<span id="cb2-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param informationRates #</span></span>
<span id="cb2-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param trials # The total number of trials you wish to load in the table results. </span></span>
<span id="cb2-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param typeOfDesign # The type of design.</span></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param seed # Argument to set the seed for the simulations</span></span>
<span id="cb2-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @return list of dataframes and plots</span></span>
<span id="cb2-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @example See below this code block</span></span>
<span id="cb2-29">interim_sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nPatients =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">death1 =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">death2 =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, </span>
<span id="cb2-30">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nLooks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">analyses_scheduled =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb2-31">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sided =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, </span>
<span id="cb2-32">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">informationRates =</span> analyses_scheduled, </span>
<span id="cb2-33">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">typeOfDesign =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"asOF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nSims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trials =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb2-34">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>) {</span>
<span id="cb2-35"></span>
<span id="cb2-36">efficacy_thresholds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(nLooks)</span>
<span id="cb2-37">design <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getDesignGroupSequential</span>(</span>
<span id="cb2-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sided =</span> sided, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> alpha,</span>
<span id="cb2-39">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">informationRates =</span> analyses_scheduled,</span>
<span id="cb2-40">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">typeOfDesign =</span> typeOfDesign)</span>
<span id="cb2-41">design_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getDesignGroupSequential</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">typeOfDesign =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pocock</span></span>
<span id="cb2-42">design_3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getDesignGroupSequential</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">typeOfDesign =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"asP"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Alpha-spending Pocock</span></span>
<span id="cb2-43">design_4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getDesignGroupSequential</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">typeOfDesign =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OF"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># O'Brien-Fleming</span></span>
<span id="cb2-44">designSet <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getDesignSet</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">designs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(design, design_2,</span>
<span id="cb2-45">                                      design_3, design_4),</span>
<span id="cb2-46">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variedParameters =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"typeOfDesign"</span>)</span>
<span id="cb2-47"></span>
<span id="cb2-48"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb2-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(seed)</span>
<span id="cb2-50"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks) {</span>
<span id="cb2-51">  efficacy_thresholds[j] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> design<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>stageLevels[j]</span>
<span id="cb2-52">}</span>
<span id="cb2-53"></span>
<span id="cb2-54">analyses_nPatients <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> analyses_scheduled <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> nPatients</span>
<span id="cb2-55">efficacy_thresholds</span>
<span id="cb2-56">pb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">txtProgressBar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> nSims, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">initial =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb2-57">trialnum <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(nSims)</span>
<span id="cb2-58">or <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> nLooks, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> nSims))</span>
<span id="cb2-59">lcl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> nLooks, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> nSims))</span>
<span id="cb2-60">ucl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> nLooks, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> nSims))</span>
<span id="cb2-61">pval <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> nLooks, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> nSims))</span>
<span id="cb2-62">success <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> nLooks, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> nSims))</span>
<span id="cb2-63"></span>
<span id="cb2-64">strings <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OR_%d"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LCL_%d"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UCL_%d"</span>,</span>
<span id="cb2-65">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pval_%d"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Success_%d"</span>)</span>
<span id="cb2-66"></span>
<span id="cb2-67"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(or) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OR_%d"</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks))</span>
<span id="cb2-68"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(lcl) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LCL_%d"</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks))</span>
<span id="cb2-69"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(ucl) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UCL_%d"</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks))</span>
<span id="cb2-70"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(pval) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pval_%d"</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks))</span>
<span id="cb2-71"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(success) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Success_%d"</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks))</span>
<span id="cb2-72">overall_success <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(nSims)</span>
<span id="cb2-73">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(trialnum, or, lcl, ucl,</span>
<span id="cb2-74">                 pval, success, overall_success)</span>
<span id="cb2-75"></span>
<span id="cb2-76"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb2-77"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(seed)</span>
<span id="cb2-78">time <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.time</span>(</span>
<span id="cb2-79"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nSims) {</span>
<span id="cb2-80">  trialnum[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> i</span>
<span id="cb2-81">  pid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, nPatients, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-82">  treatment <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, nPatients <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb2-83">  deathprob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(nPatients)</span>
<span id="cb2-84">  deathprob[treatment <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> death1</span>
<span id="cb2-85">  deathprob[treatment <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> death2</span>
<span id="cb2-86">  death <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbinom</span>(nPatients, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, deathprob)</span>
<span id="cb2-87">  trialdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(pid, treatment, death))</span>
<span id="cb2-88"></span>
<span id="cb2-89">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks) {</span>
<span id="cb2-90">    analysisdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(trialdata, pid <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> analyses_nPatients[j])</span>
<span id="cb2-91">    model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(death <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> treatment,</span>
<span id="cb2-92">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">binomial</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logit"</span>),</span>
<span id="cb2-93">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> analysisdata)</span>
<span id="cb2-94">    or[i, j] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(model)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>coefficients[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb2-95">    lcl[i, j] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">confint.default</span>((model))[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb2-96">    ucl[i, j] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">confint.default</span>((model))[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb2-97">    pval[i, j] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(model)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>coefficients[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>]</span>
<span id="cb2-98">    success[i, j] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(or[i, j] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> pval[i, j] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> efficacy_thresholds[j], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb2-99">  }</span>
<span id="cb2-100">  overall_success[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-101">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks) {</span>
<span id="cb2-102">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (success[i, j] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {</span>
<span id="cb2-103">      overall_success[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-104">    }</span>
<span id="cb2-105">  }</span>
<span id="cb2-106">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setTxtProgressBar</span>(pb, i)</span>
<span id="cb2-107">})</span>
<span id="cb2-108"></span>
<span id="cb2-109">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(trialnum, or, lcl, ucl, pval,</span>
<span id="cb2-110">                 success, overall_success)</span>
<span id="cb2-111">simulation_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(),</span>
<span id="cb2-112">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> nPatients, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(df))))</span>
<span id="cb2-113"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(simulation_results) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trialnum"</span>, (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(</span>
<span id="cb2-114">  rbind,</span>
<span id="cb2-115">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(strings),</span>
<span id="cb2-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(j) {</span>
<span id="cb2-117">      (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(rbind, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks,</span>
<span id="cb2-118">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) ((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(strings, i)))</span>
<span id="cb2-119">      )[]))[, j]</span>
<span id="cb2-120">    }</span>
<span id="cb2-121">  )</span>
<span id="cb2-122">)), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"overall_success"</span>)</span>
<span id="cb2-123">simulation_results[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(df), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(simulation_results))] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (df[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect</span>(</span>
<span id="cb2-124">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(df),</span>
<span id="cb2-125">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(simulation_results)</span>
<span id="cb2-126">)])</span>
<span id="cb2-127">simulation_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(simulation_results)</span>
<span id="cb2-128"></span>
<span id="cb2-129">outputs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simulation_results[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(simulation_results))]</span>
<span id="cb2-130"></span>
<span id="cb2-131">cols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks)</span>
<span id="cb2-132">rows <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(strings))</span>
<span id="cb2-133">interim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(</span>
<span id="cb2-134">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(strings), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> nLooks,</span>
<span id="cb2-135">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dimnames =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>((rows), (cols)), </span>
<span id="cb2-136">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(strings) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> nLooks)))</span>
<span id="cb2-137"></span>
<span id="cb2-138"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> cols) {</span>
<span id="cb2-139">  interim[, i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_subset</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(outputs), i)</span>
<span id="cb2-140">}</span>
<span id="cb2-141"></span>
<span id="cb2-142"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(interim) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Interim_Look_%d"</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks))</span>
<span id="cb2-143"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(simulation_results)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TrialNum"</span>)</span>
<span id="cb2-144"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(simulation_results)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(simulation_results)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Overall_Success"</span>)</span>
<span id="cb2-145">simulation_results_trials <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(simulation_results, trials)</span>
<span id="cb2-146">results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-147">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(design),</span>
<span id="cb2-148">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(time),</span>
<span id="cb2-149">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(design, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-150">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-151">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb2-152">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb2-153">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>)</span>
<span id="cb2-154">    ),</span>
<span id="cb2-155">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(designSet, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-156">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-157">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb2-158">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb2-159">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>)</span>
<span id="cb2-160">    ),</span>
<span id="cb2-161">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(overall_success),</span>
<span id="cb2-162">  simulation_results_trials)</span>
<span id="cb2-163"></span>
<span id="cb2-164"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(results) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb2-165">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Design Summary"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time to complete simulation"</span>, </span>
<span id="cb2-166">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Design Plot"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plot of Various Designs"</span>, </span>
<span id="cb2-167">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table of Overall Success"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simulation Results"</span>)</span>
<span id="cb2-168"></span>
<span id="cb2-169"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(results)</span>
<span id="cb2-170">}</span></code></pre></div>
<hr>
</section>
<section id="a-simulated-example" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> A Simulated Example</h1>
<hr>
<hr>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">interim_sim</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nPatients =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">death1 =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">death2 =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nLooks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb3-2">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">analyses_scheduled =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb3-3">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sided =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">typeOfDesign =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"asOF"</span>,</span>
<span id="cb3-4">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">informationRates =</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb3-5">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nSims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trials =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>)</span></code></pre></div>
<hr>
</section>
<section id="examining-the-results" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Examining the Results</h1>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">results[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; $`Design Summary`</span></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; $`Time to complete simulation`</span></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;    user  system elapsed </span></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   7.053   0.672   7.723 </span></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; $`Main Design Plot`</span></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; NULL</span></span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; $`Plot of Various Designs`</span></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; NULL</span></span>
<span id="cb4-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb4-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; $`Table of Overall Success`</span></span>
<span id="cb4-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; overall_success</span></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   0   1 </span></span>
<span id="cb4-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 134 866</span></span></code></pre></div>
<hr>
<hr>
<p>To examine the results, I used the kableExtra package, though this is not necessary, and simply using the following script will suffice</p>
<hr>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">table_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> results[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>]]</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">View</span>(table_results) </span></code></pre></div>
<hr>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="lightable-classic" data-quarto-postprocess="true" style="font-size: 16px; font-family: Cambria; margin-left: auto; margin-right: auto;border-bottom: 0;">
<colgroup>
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
</colgroup>
<thead>
<tr>
<th data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide;">
</th>
<th colspan="5" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<p>Interim_Look_1</p>
</div>
</th>
<th colspan="5" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<p>Interim_Look_2</p>
</div>
</th>
<th colspan="5" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<p>Interim_Look_3</p>
</div>
</th>
<th colspan="5" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<p>Interim_Look_4</p>
</div>
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide;">
</th>
</tr>
<tr>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
TrialNum
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
OR_1
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
LCL_1
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
UCL_1
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Pval_1
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Success_1
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
OR_2
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
LCL_2
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
UCL_2
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Pval_2
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Success_2
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
OR_3
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
LCL_3
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
UCL_3
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Pval_3
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Success_3
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
OR_4
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
LCL_4
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
UCL_4
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Pval_4
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Success_4
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Overall_Success
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.936</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.565</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.55</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.797</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.868</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.601</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.255</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.453</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.036</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.767</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.398</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.818</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.891</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.687</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.157</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.387</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">2</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.87</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.519</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.459</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.598</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.757</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.525</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.092</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.136</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.745</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.551</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.007</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.056</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.721</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.555</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.936</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.014</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">3</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.59</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.35</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.996</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.048</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.555</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.382</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.806</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.002</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.676</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.5</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.916</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.011</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.686</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.529</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.89</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.005</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">4</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.652</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.385</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.103</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.111</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.671</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.461</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.976</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.037</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.725</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.533</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.988</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.042</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.75</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.576</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.976</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.032</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">5</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.674</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.398</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.142</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.143</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.763</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.526</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.108</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.155</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.835</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.617</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.132</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.246</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.764</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.587</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.994</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.045</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">6</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.525</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.309</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.892</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.017</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.622</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.427</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.907</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.014</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.668</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.491</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.909</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.01</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.625</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.479</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.815</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.001</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">7</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.742</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.433</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.269</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.275</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.769</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.525</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.125</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.175</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.76</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.558</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.037</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.083</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.719</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.551</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.938</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.015</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">8</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.661</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.394</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.108</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.116</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.437</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.301</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.632</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.535</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.397</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.721</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.551</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.425</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.714</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">9</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.288</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.76</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">2.183</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.348</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.113</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.769</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.612</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.571</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.87</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.645</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.173</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.361</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.771</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.596</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.999</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.049</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">10</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.783</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.466</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.316</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.356</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.701</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.484</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.015</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.06</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.655</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.482</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.89</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.007</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.614</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.472</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.798</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">11</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.577</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.344</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.968</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.037</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.639</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.444</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.921</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.016</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.56</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.415</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.754</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.577</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.446</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.748</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">12</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.538</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.315</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.919</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.023</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.629</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.434</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.913</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.015</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.576</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.426</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.78</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.561</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.431</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.731</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">13</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.79</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.474</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.315</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.364</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.763</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.531</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.095</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.142</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.789</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.588</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.06</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.115</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.791</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.611</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.025</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.076</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">14</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.535</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.318</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.902</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.019</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.69</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.477</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.999</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.049</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.583</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.43</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.792</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.001</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.621</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.477</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.809</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">15</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.695</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.419</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.152</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.158</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.744</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.516</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.073</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.114</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.73</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.541</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.985</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.04</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.64</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.493</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.83</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.001</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">16</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.116</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.657</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.896</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.685</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.763</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.526</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.108</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.155</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.69</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.509</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.935</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.017</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.69</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.532</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.896</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.005</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">17</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.533</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.32</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.886</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.015</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.585</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.407</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.839</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.004</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.679</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.504</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.913</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.011</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.622</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.48</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.806</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">18</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.613</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.364</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.033</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.066</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.692</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.478</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.05</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.78</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.577</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.055</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.107</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.705</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.543</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.914</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.008</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">19</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.841</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.502</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.409</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.511</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.768</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.531</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.11</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.16</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.685</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.506</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.927</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.014</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.665</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.511</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.864</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.002</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">20</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.275</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.159</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.476</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.449</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.31</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.651</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.498</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.369</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.672</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.498</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.384</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.646</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="text-align: center; padding: 0;">
<span style="text-decoration: underline;">Abbreviations: </span>
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center; padding: 0;">
<sup></sup> TrialNum: Trial Number | OR: Odds Ratio | LCL: Lower Confidence Level | UCL: Upper Confidence Level | Pval: P-value
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
</tr>
</tfoot>

</table>
</div>
<hr>
</section>
<section id="statistical-environment" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Statistical Environment</h1>
<hr>
<p>The analyses were run on:</p>
<hr>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">si <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sessionInfo</span>()</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(si, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">RNG =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locale =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; R version 4.5.0 (2025-04-11)</span></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb6-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Matrix products: default</span></span>
<span id="cb6-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span id="cb6-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb6-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Random number generation:</span></span>
<span id="cb6-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  RNG:     L'Ecuyer-CMRG </span></span>
<span id="cb6-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  Normal:  Inversion </span></span>
<span id="cb6-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  Sample:  Rejection </span></span>
<span id="cb6-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  </span></span>
<span id="cb6-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; locale:</span></span>
<span id="cb6-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span id="cb6-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb6-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; time zone: America/New_York</span></span>
<span id="cb6-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; tzcode source: internal</span></span>
<span id="cb6-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb6-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; attached base packages:</span></span>
<span id="cb6-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [1] splines   grid      stats4    parallel  stats     graphics  grDevices</span></span>
<span id="cb6-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [8] utils     datasets  methods   base     </span></span>
<span id="cb6-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb6-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; other attached packages:</span></span>
<span id="cb6-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [1] cli_3.6.5             texPreview_2.1.0      tinytex_0.57         </span></span>
<span id="cb6-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [4] rmarkdown_2.29        brms_2.22.0           bootImpute_1.2.2     </span></span>
<span id="cb6-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [7] knitr_1.50            boot_1.3-31           gtsummary_2.2.0      </span></span>
<span id="cb6-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [10] reshape2_1.4.4        ProfileLikelihood_1.3 ImputeRobust_1.3-1   </span></span>
<span id="cb6-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [13] gamlss_5.4-22         gamlss.dist_6.1-1     gamlss.data_6.0-6    </span></span>
<span id="cb6-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [16] mvtnorm_1.3-3         performance_0.14.0    summarytools_1.1.4   </span></span>
<span id="cb6-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [19] rpact_4.2.1           tidybayes_3.0.7       htmltools_0.5.8.1    </span></span>
<span id="cb6-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [22] Statamarkdown_0.9.2   car_3.1-3             carData_3.0-5        </span></span>
<span id="cb6-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [25] qqplotr_0.0.6         ggcorrplot_0.1.4.1    mitml_0.4-5          </span></span>
<span id="cb6-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [28] pbmcapply_1.5.1       Amelia_1.8.3          Rcpp_1.0.14          </span></span>
<span id="cb6-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [31] blogdown_1.21         doParallel_1.0.17     iterators_1.0.14     </span></span>
<span id="cb6-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [34] foreach_1.5.2         lattice_0.22-7        bayesplot_1.12.0     </span></span>
<span id="cb6-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [37] wesanderson_0.3.7     VIM_6.2.2             colorspace_2.1-1     </span></span>
<span id="cb6-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [40] here_1.0.1            progress_1.2.3        loo_2.8.0            </span></span>
<span id="cb6-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [43] mi_1.1                Matrix_1.7-3          broom_1.0.8          </span></span>
<span id="cb6-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [46] yardstick_1.3.2       svglite_2.2.1         Cairo_1.6-2          </span></span>
<span id="cb6-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [49] cowplot_1.1.3         mgcv_1.9-3            nlme_3.1-168         </span></span>
<span id="cb6-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [52] xfun_0.52             broom.mixed_0.2.9.6   reticulate_1.42.0    </span></span>
<span id="cb6-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [55] kableExtra_1.4.0      posterior_1.6.1       checkmate_2.3.2      </span></span>
<span id="cb6-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [58] parallelly_1.45.0     miceFast_0.8.5        randomForest_4.7-1.2 </span></span>
<span id="cb6-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [61] missForest_1.5        miceadds_3.17-44      quantreg_6.1         </span></span>
<span id="cb6-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [64] SparseM_1.84-2        MCMCpack_1.7-1        MASS_7.3-65          </span></span>
<span id="cb6-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [67] coda_0.19-4.1         latex2exp_0.9.6       rstan_2.32.7         </span></span>
<span id="cb6-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [70] StanHeaders_2.32.10   lubridate_1.9.4       forcats_1.0.0        </span></span>
<span id="cb6-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [73] stringr_1.5.1         dplyr_1.1.4           purrr_1.0.4          </span></span>
<span id="cb6-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [76] readr_2.1.5           tibble_3.2.1          ggplot2_3.5.2        </span></span>
<span id="cb6-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [79] tidyverse_2.0.0       ggtext_0.1.2          concurve_2.7.7       </span></span>
<span id="cb6-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [82] showtext_0.9-7        showtextdb_3.0        sysfonts_0.8.9       </span></span>
<span id="cb6-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [85] future.apply_1.11.3   future_1.58.0         tidyr_1.3.1          </span></span>
<span id="cb6-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [88] magrittr_2.0.3        mice_3.18.0           rms_8.0-0            </span></span>
<span id="cb6-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [91] Hmisc_5.2-3          </span></span>
<span id="cb6-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb6-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; loaded via a namespace (and not attached):</span></span>
<span id="cb6-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   [1] dichromat_2.0-0.1       nnet_7.3-20             TH.data_1.1-3          </span></span>
<span id="cb6-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   [4] vctrs_0.6.5             digest_0.6.37           png_0.1-8              </span></span>
<span id="cb6-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   [7] shape_1.4.6.1           proxy_0.4-27            magick_2.8.6           </span></span>
<span id="cb6-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [10] fontLiberation_0.1.0    withr_3.0.2             ggpubr_0.6.0           </span></span>
<span id="cb6-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [13] survival_3.8-3          doRNG_1.8.6.2           emmeans_1.11.1         </span></span>
<span id="cb6-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [16] MatrixModels_0.5-4      systemfonts_1.2.3       ragg_1.4.0             </span></span>
<span id="cb6-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [19] zoo_1.8-14              V8_6.0.4                ggdist_3.3.3           </span></span>
<span id="cb6-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [22] DEoptimR_1.1-3-1        Formula_1.2-5           prettyunits_1.2.0      </span></span>
<span id="cb6-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [25] rematch2_2.1.2          httr_1.4.7              rstatix_0.7.2          </span></span>
<span id="cb6-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [28] globals_0.18.0          rstudioapi_0.17.1       extremevalues_2.4.1    </span></span>
<span id="cb6-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [31] pan_1.9                 generics_0.1.4          base64enc_0.1-3        </span></span>
<span id="cb6-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [34] curl_6.2.3              mitools_2.4             desc_1.4.3             </span></span>
<span id="cb6-72"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [37] xtable_1.8-4            svUnit_1.0.6            pracma_2.4.4           </span></span>
<span id="cb6-73"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [40] evaluate_1.0.3          hms_1.1.3               glmnet_4.1-9           </span></span>
<span id="cb6-74"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [43] lmtest_0.9-40           robustbase_0.99-4-1     matrixStats_1.5.0      </span></span>
<span id="cb6-75"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [46] svgPanZoom_0.3.4        class_7.3-23            pillar_1.10.2          </span></span>
<span id="cb6-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [49] caTools_1.18.3          compiler_4.5.0          stringi_1.8.7          </span></span>
<span id="cb6-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [52] jomo_2.7-6              minqa_1.2.8             plyr_1.8.9             </span></span>
<span id="cb6-78"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [55] crayon_1.5.3            abind_1.4-8             metadat_1.4-0          </span></span>
<span id="cb6-79"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [58] sp_2.2-0                mathjaxr_1.8-0          rapportools_1.2        </span></span>
<span id="cb6-80"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [61] twosamples_2.0.1        sandwich_3.1-1          whisker_0.4.1          </span></span>
<span id="cb6-81"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [64] codetools_0.2-20        multcomp_1.4-28         textshaping_1.0.1      </span></span>
<span id="cb6-82"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [67] bcaboot_0.2-3           openssl_2.3.3           flextable_0.9.9        </span></span>
<span id="cb6-83"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [70] QuickJSR_1.7.0          e1071_1.7-16            gridtext_0.1.5         </span></span>
<span id="cb6-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [73] lme4_1.1-37             fs_1.6.6                itertools_0.1-3        </span></span>
<span id="cb6-85"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [76] listenv_0.9.1           Rdpack_2.6.4            pkgbuild_1.4.8         </span></span>
<span id="cb6-86"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [79] estimability_1.5.1      ggsignif_0.6.4          tzdb_0.5.0             </span></span>
<span id="cb6-87"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [82] pkgconfig_2.0.3         tools_4.5.0             rbibutils_2.3          </span></span>
<span id="cb6-88"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [85] viridisLite_0.4.2       DBI_1.2.3               numDeriv_2016.8-1.1    </span></span>
<span id="cb6-89"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [88] fastmap_1.2.0           scales_1.4.0            officer_0.6.10         </span></span>
<span id="cb6-90"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [91] opdisDownsampling_1.0.1 insight_1.3.0           rpart_4.1.24           </span></span>
<span id="cb6-91"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [94] farver_2.1.2            reformulas_0.4.1        survminer_0.5.0        </span></span>
<span id="cb6-92"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [97] yaml_2.3.10             foreign_0.8-90          lifecycle_1.0.4        </span></span>
<span id="cb6-93"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [100] askpass_1.2.1           backports_1.5.0         Brobdingnag_1.2-9      </span></span>
<span id="cb6-94"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [103] timechange_0.3.0        gtable_0.3.6            arrayhelpers_1.1-0     </span></span>
<span id="cb6-95"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [106] metafor_4.8-0           jsonlite_2.0.0          bitops_1.0-9           </span></span>
<span id="cb6-96"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [109] qqconf_1.3.2            zip_2.3.3               ranger_0.17.0          </span></span>
<span id="cb6-97"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [112] RcppParallel_5.1.10     polspline_1.1.25        bridgesampling_1.1-2   </span></span>
<span id="cb6-98"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [115] survMisc_0.5.6          distributional_0.5.0    pander_0.6.6           </span></span>
<span id="cb6-99"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [118] details_0.4.0           KMsurv_0.1-6            rappdirs_0.3.3         </span></span>
<span id="cb6-100"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [121] glue_1.8.0              tcltk_4.5.0             gdtools_0.4.2          </span></span>
<span id="cb6-101"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [124] rprojroot_2.0.4         mcmc_0.9-8              gridExtra_2.3          </span></span>
<span id="cb6-102"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [127] R6_2.6.1                arm_1.14-4              labeling_0.4.3         </span></span>
<span id="cb6-103"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [130] km.ci_0.5-6             vcd_1.4-13              clipr_0.8.0            </span></span>
<span id="cb6-104"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [133] cluster_2.1.8.1         rngtools_1.5.2          nloptr_2.2.1           </span></span>
<span id="cb6-105"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [136] rstantools_2.4.0        tidyselect_1.2.1        htmlTable_2.4.3        </span></span>
<span id="cb6-106"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [139] tensorA_0.36.2.1        xml2_1.3.8              inline_0.3.21          </span></span>
<span id="cb6-107"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [142] fontBitstreamVera_0.1.1 furrr_0.3.1             laeken_0.5.3           </span></span>
<span id="cb6-108"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [145] pryr_0.1.6              fontquiver_0.2.1        data.table_1.17.4      </span></span>
<span id="cb6-109"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [148] htmlwidgets_1.6.4       RColorBrewer_1.1-3      rlang_1.1.6            </span></span>
<span id="cb6-110"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [151] uuid_1.2-1</span></span></code></pre></div>
<hr>
</section>
<section id="article-citation" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Article Citation</h1>


<!-- -->

</section>

 ]]></description>
  <category>statistics</category>
  <guid>https://lesslikely.com/posts/statistics/interim_analyses.html</guid>
  <pubDate>Mon, 01 Feb 2021 05:00:00 GMT</pubDate>
  <media:content url="https://lesslikely.com/images/norm.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Simulation of a Two-Group Parallel-Arm RCT with Interim Analyses</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/interim_analyses.html</link>
  <description><![CDATA[ 





<script src="interim_analyses_files/libs/kePrint-0.0.1/kePrint.js"></script>
<p><link href="interim_analyses_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet"></p>
<hr>
<p>Recently <a href="https://twitter.com/ADAlthousePhD">Andrew Althouse</a> informed me that he was going to simulate a two-group parallel-arm randomized trial with interim analyses using the <a href="https://CRAN.R-project.org/package=rpact"><code>rpact</code></a> <code>R</code> package, so I offered to also help in constructing the <code>R</code> code to do so. He already has a number of <code>R</code> scripts on his GitHub repo for doing similar simulations, which can be <a href="https://github.com/aalthous/RCT-Simulation-v1">viewed here</a> and a number of tweets explaining these simulations. For this example, his goal was to simulate a trial where the outcome was binary and the probability of death for each group could be tuned in addition to:</p>
<hr>
<ul>
<li>the total number of participants</li>
</ul>
<hr>
<ul>
<li>the number of interim analyses</li>
</ul>
<hr>
<ul>
<li>the schedule of the interim analyses</li>
</ul>
<hr>
<ul>
<li>the group-sequential design used</li>
</ul>
<hr>
<p>along with the usual trial analysis parameters such as:</p>
<hr>
<ul>
<li>the <img src="https://latex.codecogs.com/png.latex?%5Calpha">-level</li>
</ul>
<hr>
<ul>
<li>the type of test (1-sided vs.&nbsp;2-sided).</li>
</ul>
<hr>
<p>The goal was to be able to produce a table of various statistics such as:</p>
<hr>
<ul>
<li>the odds ratio</li>
</ul>
<hr>
<ul>
<li>the confidence limits</li>
</ul>
<hr>
<ul>
<li>the <img src="https://latex.codecogs.com/png.latex?P">-value</li>
</ul>
<hr>
<ul>
<li>the number of successes</li>
</ul>
<hr>
<p>for each of the interim analyses specified.</p>
<hr>
<p>The function below is a reflection of our efforts to do so, and also returns several plots from the <a href="https://CRAN.R-project.org/package=rpact"><code>rpact</code></a> package for the design that is chosen along with a plot comparing the design to other designs. In order to get similar results, you will need to load the <code>R</code> function first, and then simply enter the proper inputs. While there may be more efficient ways to write the code, for example using <code>lapply()</code> instead of for loops, we have chosen not to do so, and we have also tried to minimize the number of <code>R</code> packages necessary for the function to work but the following will be required:</p>
<hr>
<ul>
<li><a href="https://CRAN.R-project.org/package=rpact"><code>rpact</code></a></li>
</ul>
<hr>
<ul>
<li><a href="https://CRAN.R-project.org/package=stringr"><code>stringr</code></a></li>
</ul>
<hr>
<p>You can quickly install and load both using:</p>
<hr>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">req_packs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rpact"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stringr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggplot2"</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(req_packs)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(req_packs, library, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">character.only =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<hr>
<section id="setting-up-the-function" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setting up the Function</h1>
<hr>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @title Simulation of a Two-Group Parallel-Arm Trial With Interim Analyses</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @docType Custom function for simulation from the rpact package</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @author Andrew Althouse with edits by Zad Rafi</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: If you want to confirm "type 1 error" under different stopping rules,</span></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' make death = in the two treatment arms (e.g. no treatment effect)</span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: I have set this one up to test the power for a treatment that would reduce mortality</span></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' from 40% in control group (1) to 30% in treatment group (2)</span></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Trial Design Parameters - Part 1</span></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Here we will specify the basics: total N patients to enroll, and death rate for each treatment arm</span></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Trial Design Parameters - Part 2</span></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Here we will define the interim analysis strategy and stopping rules</span></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' For this trial we will include provisions for efficacy stopping only (no pre-specified futility stopping)</span></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' We will use the rpact package to compute the stopping/success thresholds at the interim and final analysis</span></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Required packages: rpact and stringr</span></span>
<span id="cb2-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param nSims # The number of simulations, the default is 1000</span></span>
<span id="cb2-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param nPatients # here is where you specify the planned max number of patients you want included in each RCT</span></span>
<span id="cb2-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param death1 # here is where you specify the event rate for patients receiving 'treatment 1' in these trial</span></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param death2 # here is where you specify the event rate for patients receiving 'treatment 2' in these trials</span></span>
<span id="cb2-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param nLooks # here is where you put the number of looks that will take place (INCLUDING the final analysis)</span></span>
<span id="cb2-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param analyses_scheduled # schedule of interim analyses</span></span>
<span id="cb2-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param sided # Whether the test is 1-sided or 2-sided</span></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param alpha # Specified alpha level, the default is 0.05</span></span>
<span id="cb2-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param informationRates #</span></span>
<span id="cb2-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param trials # The total number of trials you wish to load in the table results. </span></span>
<span id="cb2-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param typeOfDesign # The type of design.</span></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param seed # Argument to set the seed for the simulations</span></span>
<span id="cb2-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @return list of dataframes and plots</span></span>
<span id="cb2-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @example See below this code block</span></span>
<span id="cb2-29">interim_sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nPatients =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">death1 =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">death2 =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, </span>
<span id="cb2-30">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nLooks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">analyses_scheduled =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb2-31">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sided =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, </span>
<span id="cb2-32">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">informationRates =</span> analyses_scheduled, </span>
<span id="cb2-33">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">typeOfDesign =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"asOF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nSims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trials =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb2-34">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>) {</span>
<span id="cb2-35"></span>
<span id="cb2-36">efficacy_thresholds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(nLooks)</span>
<span id="cb2-37">design <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getDesignGroupSequential</span>(</span>
<span id="cb2-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sided =</span> sided, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> alpha,</span>
<span id="cb2-39">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">informationRates =</span> analyses_scheduled,</span>
<span id="cb2-40">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">typeOfDesign =</span> typeOfDesign)</span>
<span id="cb2-41">design_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getDesignGroupSequential</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">typeOfDesign =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pocock</span></span>
<span id="cb2-42">design_3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getDesignGroupSequential</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">typeOfDesign =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"asP"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Alpha-spending Pocock</span></span>
<span id="cb2-43">design_4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getDesignGroupSequential</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">typeOfDesign =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OF"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># O'Brien-Fleming</span></span>
<span id="cb2-44">designSet <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getDesignSet</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">designs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(design, design_2,</span>
<span id="cb2-45">                                      design_3, design_4),</span>
<span id="cb2-46">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variedParameters =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"typeOfDesign"</span>)</span>
<span id="cb2-47"></span>
<span id="cb2-48"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb2-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(seed)</span>
<span id="cb2-50"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks) {</span>
<span id="cb2-51">  efficacy_thresholds[j] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> design<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>stageLevels[j]</span>
<span id="cb2-52">}</span>
<span id="cb2-53"></span>
<span id="cb2-54">analyses_nPatients <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> analyses_scheduled <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> nPatients</span>
<span id="cb2-55">efficacy_thresholds</span>
<span id="cb2-56">pb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">txtProgressBar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> nSims, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">initial =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb2-57">trialnum <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(nSims)</span>
<span id="cb2-58">or <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> nLooks, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> nSims))</span>
<span id="cb2-59">lcl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> nLooks, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> nSims))</span>
<span id="cb2-60">ucl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> nLooks, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> nSims))</span>
<span id="cb2-61">pval <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> nLooks, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> nSims))</span>
<span id="cb2-62">success <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> nLooks, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> nSims))</span>
<span id="cb2-63"></span>
<span id="cb2-64">strings <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OR_%d"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LCL_%d"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UCL_%d"</span>,</span>
<span id="cb2-65">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pval_%d"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Success_%d"</span>)</span>
<span id="cb2-66"></span>
<span id="cb2-67"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(or) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OR_%d"</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks))</span>
<span id="cb2-68"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(lcl) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LCL_%d"</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks))</span>
<span id="cb2-69"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(ucl) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UCL_%d"</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks))</span>
<span id="cb2-70"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(pval) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pval_%d"</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks))</span>
<span id="cb2-71"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(success) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Success_%d"</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks))</span>
<span id="cb2-72">overall_success <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(nSims)</span>
<span id="cb2-73">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(trialnum, or, lcl, ucl,</span>
<span id="cb2-74">                 pval, success, overall_success)</span>
<span id="cb2-75"></span>
<span id="cb2-76"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb2-77"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(seed)</span>
<span id="cb2-78">time <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.time</span>(</span>
<span id="cb2-79"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nSims) {</span>
<span id="cb2-80">  trialnum[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> i</span>
<span id="cb2-81">  pid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, nPatients, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-82">  treatment <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, nPatients <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb2-83">  deathprob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(nPatients)</span>
<span id="cb2-84">  deathprob[treatment <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> death1</span>
<span id="cb2-85">  deathprob[treatment <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> death2</span>
<span id="cb2-86">  death <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbinom</span>(nPatients, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, deathprob)</span>
<span id="cb2-87">  trialdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(pid, treatment, death))</span>
<span id="cb2-88"></span>
<span id="cb2-89">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks) {</span>
<span id="cb2-90">    analysisdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(trialdata, pid <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> analyses_nPatients[j])</span>
<span id="cb2-91">    model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(death <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> treatment,</span>
<span id="cb2-92">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">binomial</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logit"</span>),</span>
<span id="cb2-93">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> analysisdata)</span>
<span id="cb2-94">    or[i, j] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(model)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>coefficients[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb2-95">    lcl[i, j] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">confint.default</span>((model))[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb2-96">    ucl[i, j] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">confint.default</span>((model))[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb2-97">    pval[i, j] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(model)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>coefficients[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>]</span>
<span id="cb2-98">    success[i, j] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(or[i, j] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> pval[i, j] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> efficacy_thresholds[j], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb2-99">  }</span>
<span id="cb2-100">  overall_success[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-101">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks) {</span>
<span id="cb2-102">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (success[i, j] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {</span>
<span id="cb2-103">      overall_success[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-104">    }</span>
<span id="cb2-105">  }</span>
<span id="cb2-106">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setTxtProgressBar</span>(pb, i)</span>
<span id="cb2-107">})</span>
<span id="cb2-108"></span>
<span id="cb2-109">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(trialnum, or, lcl, ucl, pval,</span>
<span id="cb2-110">                 success, overall_success)</span>
<span id="cb2-111">simulation_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(),</span>
<span id="cb2-112">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> nPatients, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(df))))</span>
<span id="cb2-113"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(simulation_results) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trialnum"</span>, (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(</span>
<span id="cb2-114">  rbind,</span>
<span id="cb2-115">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(strings),</span>
<span id="cb2-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(j) {</span>
<span id="cb2-117">      (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(rbind, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks,</span>
<span id="cb2-118">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) ((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(strings, i)))</span>
<span id="cb2-119">      )[]))[, j]</span>
<span id="cb2-120">    }</span>
<span id="cb2-121">  )</span>
<span id="cb2-122">)), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"overall_success"</span>)</span>
<span id="cb2-123">simulation_results[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(df), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(simulation_results))] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (df[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect</span>(</span>
<span id="cb2-124">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(df),</span>
<span id="cb2-125">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(simulation_results)</span>
<span id="cb2-126">)])</span>
<span id="cb2-127">simulation_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(simulation_results)</span>
<span id="cb2-128"></span>
<span id="cb2-129">outputs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simulation_results[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(simulation_results))]</span>
<span id="cb2-130"></span>
<span id="cb2-131">cols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks)</span>
<span id="cb2-132">rows <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(strings))</span>
<span id="cb2-133">interim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(</span>
<span id="cb2-134">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(strings), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> nLooks,</span>
<span id="cb2-135">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dimnames =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>((rows), (cols)), </span>
<span id="cb2-136">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(strings) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> nLooks)))</span>
<span id="cb2-137"></span>
<span id="cb2-138"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> cols) {</span>
<span id="cb2-139">  interim[, i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_subset</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(outputs), i)</span>
<span id="cb2-140">}</span>
<span id="cb2-141"></span>
<span id="cb2-142"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(interim) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Interim_Look_%d"</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nLooks))</span>
<span id="cb2-143"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(simulation_results)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TrialNum"</span>)</span>
<span id="cb2-144"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(simulation_results)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(simulation_results)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Overall_Success"</span>)</span>
<span id="cb2-145">simulation_results_trials <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(simulation_results, trials)</span>
<span id="cb2-146">results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-147">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(design),</span>
<span id="cb2-148">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(time),</span>
<span id="cb2-149">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(design, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-150">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-151">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb2-152">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb2-153">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>)</span>
<span id="cb2-154">    ),</span>
<span id="cb2-155">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(designSet, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-156">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-157">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb2-158">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb2-159">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>)</span>
<span id="cb2-160">    ),</span>
<span id="cb2-161">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(overall_success),</span>
<span id="cb2-162">  simulation_results_trials)</span>
<span id="cb2-163"></span>
<span id="cb2-164"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(results) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb2-165">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Design Summary"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time to complete simulation"</span>, </span>
<span id="cb2-166">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Design Plot"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plot of Various Designs"</span>, </span>
<span id="cb2-167">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table of Overall Success"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simulation Results"</span>)</span>
<span id="cb2-168"></span>
<span id="cb2-169"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(results)</span>
<span id="cb2-170">}</span></code></pre></div>
<hr>
</section>
<section id="a-simulated-example" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> A Simulated Example</h1>
<hr>
<hr>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">interim_sim</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nPatients =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">death1 =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">death2 =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nLooks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb3-2">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">analyses_scheduled =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb3-3">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sided =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">typeOfDesign =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"asOF"</span>,</span>
<span id="cb3-4">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">informationRates =</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb3-5">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nSims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trials =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>)</span></code></pre></div>
<hr>
</section>
<section id="examining-the-results" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Examining the Results</h1>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">results[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; $`Design Summary`</span></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; $`Time to complete simulation`</span></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;    user  system elapsed </span></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   7.053   0.672   7.723 </span></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; $`Main Design Plot`</span></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; NULL</span></span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; $`Plot of Various Designs`</span></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; NULL</span></span>
<span id="cb4-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb4-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; $`Table of Overall Success`</span></span>
<span id="cb4-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; overall_success</span></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   0   1 </span></span>
<span id="cb4-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 134 866</span></span></code></pre></div>
<hr>
<hr>
<p>To examine the results, I used the kableExtra package, though this is not necessary, and simply using the following script will suffice</p>
<hr>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">table_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> results[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>]]</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">View</span>(table_results) </span></code></pre></div>
<hr>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="lightable-classic" data-quarto-postprocess="true" style="font-size: 16px; font-family: Cambria; margin-left: auto; margin-right: auto;border-bottom: 0;">
<colgroup>
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
</colgroup>
<thead>
<tr>
<th data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide;">
</th>
<th colspan="5" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<p>Interim_Look_1</p>
</div>
</th>
<th colspan="5" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<p>Interim_Look_2</p>
</div>
</th>
<th colspan="5" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<p>Interim_Look_3</p>
</div>
</th>
<th colspan="5" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<p>Interim_Look_4</p>
</div>
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide;">
</th>
</tr>
<tr>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
TrialNum
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
OR_1
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
LCL_1
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
UCL_1
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Pval_1
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Success_1
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
OR_2
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
LCL_2
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
UCL_2
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Pval_2
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Success_2
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
OR_3
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
LCL_3
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
UCL_3
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Pval_3
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Success_3
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
OR_4
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
LCL_4
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
UCL_4
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Pval_4
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Success_4
</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
Overall_Success
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.936</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.565</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.55</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.797</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.868</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.601</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.255</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.453</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.036</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.767</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.398</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.818</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.891</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.687</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.157</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.387</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">2</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.87</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.519</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.459</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.598</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.757</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.525</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.092</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.136</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.745</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.551</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.007</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.056</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.721</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.555</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.936</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.014</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">3</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.59</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.35</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.996</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.048</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.555</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.382</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.806</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.002</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.676</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.5</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.916</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.011</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.686</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.529</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.89</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.005</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">4</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.652</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.385</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.103</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.111</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.671</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.461</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.976</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.037</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.725</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.533</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.988</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.042</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.75</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.576</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.976</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.032</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">5</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.674</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.398</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.142</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.143</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.763</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.526</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.108</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.155</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.835</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.617</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.132</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.246</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.764</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.587</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.994</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.045</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">6</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.525</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.309</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.892</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.017</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.622</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.427</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.907</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.014</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.668</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.491</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.909</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.01</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.625</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.479</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.815</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.001</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">7</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.742</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.433</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.269</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.275</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.769</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.525</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.125</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.175</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.76</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.558</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.037</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.083</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.719</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.551</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.938</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.015</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">8</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.661</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.394</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.108</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.116</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.437</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.301</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.632</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.535</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.397</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.721</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.551</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.425</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.714</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">9</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.288</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.76</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">2.183</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.348</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.113</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.769</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.612</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.571</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.87</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.645</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.173</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.361</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.771</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.596</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.999</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.049</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">10</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.783</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.466</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.316</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.356</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.701</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.484</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.015</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.06</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.655</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.482</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.89</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.007</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.614</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.472</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.798</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">11</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.577</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.344</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.968</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.037</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.639</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.444</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.921</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.016</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.56</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.415</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.754</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.577</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.446</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.748</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">12</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.538</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.315</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.919</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.023</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.629</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.434</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.913</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.015</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.576</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.426</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.78</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.561</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.431</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.731</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">13</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.79</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.474</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.315</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.364</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.763</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.531</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.095</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.142</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.789</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.588</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.06</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.115</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.791</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.611</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.025</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.076</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">14</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.535</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.318</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.902</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.019</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.69</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.477</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.999</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.049</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.583</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.43</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.792</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.001</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.621</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.477</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.809</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">15</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.695</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.419</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.152</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.158</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.744</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.516</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.073</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.114</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.73</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.541</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.985</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.04</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.64</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.493</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.83</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.001</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">16</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.116</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.657</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.896</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.685</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.763</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.526</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.108</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.155</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.69</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.509</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.935</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.017</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.69</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.532</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.896</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.005</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">17</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.533</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.32</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.886</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.015</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.585</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.407</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.839</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.004</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.679</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.504</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.913</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.011</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.622</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.48</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.806</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">18</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.613</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.364</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.033</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.066</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.692</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.478</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.05</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.78</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.577</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.055</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.107</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.705</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.543</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.914</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.008</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">19</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.841</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.502</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.409</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.511</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.768</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.531</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1.11</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.16</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.685</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.506</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.927</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.014</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.665</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.511</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.864</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.002</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align: center; font-weight: bold; color: rgba(102, 102, 102, 255) !important;">
<span style="     color: rgba(119, 119, 119, 255) !important;">20</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.275</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.159</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.476</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.449</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.31</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.651</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.498</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.369</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.672</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.498</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.384</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0.646</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">0</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
<td style="text-align: center;">
<span style="     color: rgba(119, 119, 119, 255) !important;">1</span>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="text-align: center; padding: 0;">
<span style="text-decoration: underline;">Abbreviations: </span>
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
</tr>
<tr>
<td style="text-align: center; padding: 0;">
<sup></sup> TrialNum: Trial Number | OR: Odds Ratio | LCL: Lower Confidence Level | UCL: Upper Confidence Level | Pval: P-value
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
<td style="text-align: center;">
</td>
</tr>
</tfoot>

</table>
</div>
<hr>
</section>
<section id="statistical-environment" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Statistical Environment</h1>
<hr>
<p>The analyses were run on:</p>
<hr>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">si <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sessionInfo</span>()</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(si, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">RNG =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locale =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; R version 4.5.0 (2025-04-11)</span></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb6-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Matrix products: default</span></span>
<span id="cb6-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span id="cb6-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb6-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Random number generation:</span></span>
<span id="cb6-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  RNG:     L'Ecuyer-CMRG </span></span>
<span id="cb6-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  Normal:  Inversion </span></span>
<span id="cb6-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  Sample:  Rejection </span></span>
<span id="cb6-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  </span></span>
<span id="cb6-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; locale:</span></span>
<span id="cb6-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span id="cb6-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb6-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; time zone: America/New_York</span></span>
<span id="cb6-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; tzcode source: internal</span></span>
<span id="cb6-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb6-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; attached base packages:</span></span>
<span id="cb6-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [1] splines   grid      stats4    parallel  stats     graphics  grDevices</span></span>
<span id="cb6-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [8] utils     datasets  methods   base     </span></span>
<span id="cb6-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb6-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; other attached packages:</span></span>
<span id="cb6-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [1] cli_3.6.5             texPreview_2.1.0      tinytex_0.57         </span></span>
<span id="cb6-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [4] rmarkdown_2.29        brms_2.22.0           bootImpute_1.2.2     </span></span>
<span id="cb6-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [7] knitr_1.50            boot_1.3-31           gtsummary_2.2.0      </span></span>
<span id="cb6-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [10] reshape2_1.4.4        ProfileLikelihood_1.3 ImputeRobust_1.3-1   </span></span>
<span id="cb6-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [13] gamlss_5.4-22         gamlss.dist_6.1-1     gamlss.data_6.0-6    </span></span>
<span id="cb6-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [16] mvtnorm_1.3-3         performance_0.14.0    summarytools_1.1.4   </span></span>
<span id="cb6-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [19] rpact_4.2.1           tidybayes_3.0.7       htmltools_0.5.8.1    </span></span>
<span id="cb6-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [22] Statamarkdown_0.9.2   car_3.1-3             carData_3.0-5        </span></span>
<span id="cb6-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [25] qqplotr_0.0.6         ggcorrplot_0.1.4.1    mitml_0.4-5          </span></span>
<span id="cb6-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [28] pbmcapply_1.5.1       Amelia_1.8.3          Rcpp_1.0.14          </span></span>
<span id="cb6-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [31] blogdown_1.21         doParallel_1.0.17     iterators_1.0.14     </span></span>
<span id="cb6-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [34] foreach_1.5.2         lattice_0.22-7        bayesplot_1.12.0     </span></span>
<span id="cb6-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [37] wesanderson_0.3.7     VIM_6.2.2             colorspace_2.1-1     </span></span>
<span id="cb6-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [40] here_1.0.1            progress_1.2.3        loo_2.8.0            </span></span>
<span id="cb6-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [43] mi_1.1                Matrix_1.7-3          broom_1.0.8          </span></span>
<span id="cb6-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [46] yardstick_1.3.2       svglite_2.2.1         Cairo_1.6-2          </span></span>
<span id="cb6-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [49] cowplot_1.1.3         mgcv_1.9-3            nlme_3.1-168         </span></span>
<span id="cb6-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [52] xfun_0.52             broom.mixed_0.2.9.6   reticulate_1.42.0    </span></span>
<span id="cb6-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [55] kableExtra_1.4.0      posterior_1.6.1       checkmate_2.3.2      </span></span>
<span id="cb6-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [58] parallelly_1.45.0     miceFast_0.8.5        randomForest_4.7-1.2 </span></span>
<span id="cb6-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [61] missForest_1.5        miceadds_3.17-44      quantreg_6.1         </span></span>
<span id="cb6-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [64] SparseM_1.84-2        MCMCpack_1.7-1        MASS_7.3-65          </span></span>
<span id="cb6-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [67] coda_0.19-4.1         latex2exp_0.9.6       rstan_2.32.7         </span></span>
<span id="cb6-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [70] StanHeaders_2.32.10   lubridate_1.9.4       forcats_1.0.0        </span></span>
<span id="cb6-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [73] stringr_1.5.1         dplyr_1.1.4           purrr_1.0.4          </span></span>
<span id="cb6-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [76] readr_2.1.5           tibble_3.2.1          ggplot2_3.5.2        </span></span>
<span id="cb6-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [79] tidyverse_2.0.0       ggtext_0.1.2          concurve_2.7.7       </span></span>
<span id="cb6-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [82] showtext_0.9-7        showtextdb_3.0        sysfonts_0.8.9       </span></span>
<span id="cb6-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [85] future.apply_1.11.3   future_1.58.0         tidyr_1.3.1          </span></span>
<span id="cb6-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [88] magrittr_2.0.3        mice_3.18.0           rms_8.0-0            </span></span>
<span id="cb6-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [91] Hmisc_5.2-3          </span></span>
<span id="cb6-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb6-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; loaded via a namespace (and not attached):</span></span>
<span id="cb6-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   [1] dichromat_2.0-0.1       nnet_7.3-20             TH.data_1.1-3          </span></span>
<span id="cb6-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   [4] vctrs_0.6.5             digest_0.6.37           png_0.1-8              </span></span>
<span id="cb6-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   [7] shape_1.4.6.1           proxy_0.4-27            magick_2.8.6           </span></span>
<span id="cb6-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [10] fontLiberation_0.1.0    withr_3.0.2             ggpubr_0.6.0           </span></span>
<span id="cb6-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [13] survival_3.8-3          doRNG_1.8.6.2           emmeans_1.11.1         </span></span>
<span id="cb6-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [16] MatrixModels_0.5-4      systemfonts_1.2.3       ragg_1.4.0             </span></span>
<span id="cb6-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [19] zoo_1.8-14              V8_6.0.4                ggdist_3.3.3           </span></span>
<span id="cb6-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [22] DEoptimR_1.1-3-1        Formula_1.2-5           prettyunits_1.2.0      </span></span>
<span id="cb6-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [25] rematch2_2.1.2          httr_1.4.7              rstatix_0.7.2          </span></span>
<span id="cb6-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [28] globals_0.18.0          rstudioapi_0.17.1       extremevalues_2.4.1    </span></span>
<span id="cb6-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [31] pan_1.9                 generics_0.1.4          base64enc_0.1-3        </span></span>
<span id="cb6-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [34] curl_6.2.3              mitools_2.4             desc_1.4.3             </span></span>
<span id="cb6-72"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [37] xtable_1.8-4            svUnit_1.0.6            pracma_2.4.4           </span></span>
<span id="cb6-73"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [40] evaluate_1.0.3          hms_1.1.3               glmnet_4.1-9           </span></span>
<span id="cb6-74"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [43] lmtest_0.9-40           robustbase_0.99-4-1     matrixStats_1.5.0      </span></span>
<span id="cb6-75"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [46] svgPanZoom_0.3.4        class_7.3-23            pillar_1.10.2          </span></span>
<span id="cb6-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [49] caTools_1.18.3          compiler_4.5.0          stringi_1.8.7          </span></span>
<span id="cb6-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [52] jomo_2.7-6              minqa_1.2.8             plyr_1.8.9             </span></span>
<span id="cb6-78"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [55] crayon_1.5.3            abind_1.4-8             metadat_1.4-0          </span></span>
<span id="cb6-79"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [58] sp_2.2-0                mathjaxr_1.8-0          rapportools_1.2        </span></span>
<span id="cb6-80"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [61] twosamples_2.0.1        sandwich_3.1-1          whisker_0.4.1          </span></span>
<span id="cb6-81"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [64] codetools_0.2-20        multcomp_1.4-28         textshaping_1.0.1      </span></span>
<span id="cb6-82"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [67] bcaboot_0.2-3           openssl_2.3.3           flextable_0.9.9        </span></span>
<span id="cb6-83"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [70] QuickJSR_1.7.0          e1071_1.7-16            gridtext_0.1.5         </span></span>
<span id="cb6-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [73] lme4_1.1-37             fs_1.6.6                itertools_0.1-3        </span></span>
<span id="cb6-85"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [76] listenv_0.9.1           Rdpack_2.6.4            pkgbuild_1.4.8         </span></span>
<span id="cb6-86"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [79] estimability_1.5.1      ggsignif_0.6.4          tzdb_0.5.0             </span></span>
<span id="cb6-87"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [82] pkgconfig_2.0.3         tools_4.5.0             rbibutils_2.3          </span></span>
<span id="cb6-88"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [85] viridisLite_0.4.2       DBI_1.2.3               numDeriv_2016.8-1.1    </span></span>
<span id="cb6-89"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [88] fastmap_1.2.0           scales_1.4.0            officer_0.6.10         </span></span>
<span id="cb6-90"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [91] opdisDownsampling_1.0.1 insight_1.3.0           rpart_4.1.24           </span></span>
<span id="cb6-91"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [94] farver_2.1.2            reformulas_0.4.1        survminer_0.5.0        </span></span>
<span id="cb6-92"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [97] yaml_2.3.10             foreign_0.8-90          lifecycle_1.0.4        </span></span>
<span id="cb6-93"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [100] askpass_1.2.1           backports_1.5.0         Brobdingnag_1.2-9      </span></span>
<span id="cb6-94"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [103] timechange_0.3.0        gtable_0.3.6            arrayhelpers_1.1-0     </span></span>
<span id="cb6-95"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [106] metafor_4.8-0           jsonlite_2.0.0          bitops_1.0-9           </span></span>
<span id="cb6-96"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [109] qqconf_1.3.2            zip_2.3.3               ranger_0.17.0          </span></span>
<span id="cb6-97"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [112] RcppParallel_5.1.10     polspline_1.1.25        bridgesampling_1.1-2   </span></span>
<span id="cb6-98"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [115] survMisc_0.5.6          distributional_0.5.0    pander_0.6.6           </span></span>
<span id="cb6-99"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [118] details_0.4.0           KMsurv_0.1-6            rappdirs_0.3.3         </span></span>
<span id="cb6-100"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [121] glue_1.8.0              tcltk_4.5.0             gdtools_0.4.2          </span></span>
<span id="cb6-101"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [124] rprojroot_2.0.4         mcmc_0.9-8              gridExtra_2.3          </span></span>
<span id="cb6-102"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [127] R6_2.6.1                arm_1.14-4              labeling_0.4.3         </span></span>
<span id="cb6-103"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [130] km.ci_0.5-6             vcd_1.4-13              clipr_0.8.0            </span></span>
<span id="cb6-104"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [133] cluster_2.1.8.1         rngtools_1.5.2          nloptr_2.2.1           </span></span>
<span id="cb6-105"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [136] rstantools_2.4.0        tidyselect_1.2.1        htmlTable_2.4.3        </span></span>
<span id="cb6-106"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [139] tensorA_0.36.2.1        xml2_1.3.8              inline_0.3.21          </span></span>
<span id="cb6-107"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [142] fontBitstreamVera_0.1.1 furrr_0.3.1             laeken_0.5.3           </span></span>
<span id="cb6-108"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [145] pryr_0.1.6              fontquiver_0.2.1        data.table_1.17.4      </span></span>
<span id="cb6-109"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [148] htmlwidgets_1.6.4       RColorBrewer_1.1-3      rlang_1.1.6            </span></span>
<span id="cb6-110"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [151] uuid_1.2-1</span></span></code></pre></div>
<hr>
</section>
<section id="article-citation" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Article Citation</h1>


<!-- -->

</section>

 ]]></description>
  <category>statistics</category>
  <guid>https://lesslikely.com/posts/statistics/interim_analyses.html</guid>
  <pubDate>Mon, 01 Feb 2021 00:00:00 GMT</pubDate>
  <media:content url="https://lesslikely.com/images/norm.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Tables, Graphs, and Computations from Rafi &amp; Greenland (2020)</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/RG2020BMC.html</link>
  <description><![CDATA[ 





<script src="RG2020BMC_files/libs/kePrint-0.0.1/kePrint.js"></script>
<p><link href="RG2020BMC_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet"></p>
<center>
<img src="https://res.cloudinary.com/less-likely/image/upload/v1602038429/Site/confidencecurve.svg" width="100" style="cursor: zoom-in" align="right">
</center>
<hr>
<p>The following post provides <em>some</em> of the code that was used to construct the figures and tables from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland, 2020</a><span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>1</sup></span>. An enhanced PDF version of the paper can be <a href="https://rdcu.be/b789P">found here</a>. For further discussion of the computations, see the appendix of the <a href="https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM1_ESM.pdf">main paper</a>, along with our <a href="https://arxiv.org/pdf/2008.12991.pdf">technical supplement</a>.<span class="citation" data-cites="greenlandTechnicalIssuesInterpretation2020"><sup>2</sup></span></p>
<hr>
<blockquote class="blockquote">
<p><strong>Disclaimer:</strong> I am responsible for all the code and mistakes below, and none of them can be attributed to my coauthors or my fellow package developers.</p>
</blockquote>
<hr>
<p>In order to recreate the functions, I would recommend installing the latest version of <a href="https://data.lesslikely.com/concurve/"><code>concurve</code></a> from <a href="https://cran.r-project.org/package=concurve">CRAN</a>, as it has patched some issues with graphing when the outcome is binary. Use the script below to get the latest version and load the <code>R</code> package. A number of other <code>R</code> packages are also used in this post, which are listed below.</p>
<hr>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"concurve"</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"concurve"</span>)</span></code></pre></div>
<hr>
<section id="valid-p-values-are-uniform-under-the-null-model" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="valid-p-values-are-uniform-under-the-null-model"><span class="header-section-number">0.1</span> Valid <img src="https://latex.codecogs.com/png.latex?P">-values Are Uniform Under the Null Model</h2>
<hr>
<p>Here we show that valid <img src="https://latex.codecogs.com/png.latex?P">-values have specific properties, when the null model is true. We first generate two variables (<img src="https://latex.codecogs.com/png.latex?Y">, <img src="https://latex.codecogs.com/png.latex?X">) that come from the same normal distribution with a <img src="https://latex.codecogs.com/png.latex?%5Cmu"> of 0 and <img src="https://latex.codecogs.com/png.latex?%5Csigma"> of 1, each with a total of <code>1000</code> observations. We assume that there is no relationship between these two variables. We run a simple t-test between <img src="https://latex.codecogs.com/png.latex?Y"> and <img src="https://latex.codecogs.com/png.latex?X"> and iterate this <code>100000</code> times and compute <code>100000</code> <img src="https://latex.codecogs.com/png.latex?P">-values to see the overall distribution of the <img src="https://latex.codecogs.com/png.latex?P">-values, which we then plot using a histogram./</p>
<hr>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb2-2">set.seed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span></span>
<span id="cb2-3">n.sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb2-4">t.sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n.sim)</span>
<span id="cb2-5">n.samp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n.sim) {</span>
<span id="cb2-8">    X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-9">    Y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-10">    df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(X, Y)</span>
<span id="cb2-11">    t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t.test</span>(X, Y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df)</span>
<span id="cb2-12">    t.sim[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> t[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]]</span>
<span id="cb2-13">}</span>
<span id="cb2-14"></span>
<span id="cb2-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> t.sim)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb2-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#99c7c7"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of P-values Under the Null"</span>,</span>
<span id="cb2-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P-value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-4-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>This can also be shown using the <a href="https://cran.r-project.org/package=TeachingDemos"><code>TeachingDemos</code></a> <code>R</code> package, which has a function dedicated to showing this phenomenon.</p>
<hr>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TeachingDemos"</span>)</span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Attaching package: 'TeachingDemos'</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; The following object is masked from 'package:plotly':</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;     subplot</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; The following objects are masked from 'package:Hmisc':</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;     cnvrt.coords, subplot</span></span>
<span id="cb3-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb3-11">set.seed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span></span>
<span id="cb3-12">obs_p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Pvalue.norm.sim</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mu =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mu0 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma0 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alternative =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"two.sided"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>,</span>
<span id="cb3-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">B =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e+05</span>)</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-5-1.svg" data-fig-align="center" width="768"></p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> obs_p)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb4-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#99c7c7"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of P-values Under the Null"</span>,</span>
<span id="cb4-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P-value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-5-2.svg" data-fig-align="center" width="768"></p>
<hr>
<p>As you can see, when the null model is true, the distribution of <img src="https://latex.codecogs.com/png.latex?P">-values is uniform. Valid <img src="https://latex.codecogs.com/png.latex?P">-values are uniform under the null hypothesis and their corresponding <img src="https://latex.codecogs.com/png.latex?S">-values are exponentially distributed. We run the same simulation as before, but then convert the obtained <img src="https://latex.codecogs.com/png.latex?P">-values into <img src="https://latex.codecogs.com/png.latex?S">-values, to see how they are distributed.</p>
<hr>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb5-2">set.seed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span></span>
<span id="cb5-3">n.sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb5-4">t.sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n.sim)</span>
<span id="cb5-5">n.samp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n.sim) {</span>
<span id="cb5-8">    X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-9">    Y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-10">    df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(X, Y)</span>
<span id="cb5-11">    t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t.test</span>(X, Y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df)</span>
<span id="cb5-12">    t.sim[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> t[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]]</span>
<span id="cb5-13">}</span>
<span id="cb5-14"></span>
<span id="cb5-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log2</span>(t.sim))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,</span>
<span id="cb5-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of S-values Under the Null"</span>,</span>
<span id="cb5-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S-value (Bits of Information)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-6-1.svg" data-fig-align="center" width="768"></p>
<hr>
</section>
<section id="posterior-predictive-p-values" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="posterior-predictive-p-values"><span class="header-section-number">0.2</span> Posterior Predictive <img src="https://latex.codecogs.com/png.latex?P">-values</h2>
<hr>
<p>Despite the name, posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values are not considered valid frequentist <img src="https://latex.codecogs.com/png.latex?P">-values because they do not meet the uniformity criterion, instead they are pulled towards the parameter value <code>0.5</code>. For further discussion, see our <a href="https://arxiv.org/pdf/2008.12991.pdf">technical supplement</a> along with <a href="https://doi.org/10.1080/00031305.2018.1529625">Greenland (2019)</a> for comprehensive theoretical discussions.[<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup>3</sup></span>;<span class="citation" data-cites="greenlandTechnicalIssuesInterpretation2020"><sup>2</sup></span>]</p>
<p>A quick excerpt from our main paper and the technical supplement explains why this is not the case,</p>
<hr>
<blockquote class="blockquote">
<p>As discussed in the Supplement, in Bayesian settings one may see certain <img src="https://latex.codecogs.com/png.latex?P">-values that are not valid frequentist <img src="https://latex.codecogs.com/png.latex?P">-values, the primary example being the posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-value<span class="citation" data-cites="bayarriValuesCompositeNull2000"><sup>4</sup></span>;<span class="citation" data-cites="robinsAsymptoticDistributionValues2000"><sup>5</sup></span>; unfortunately, the negative logs of such invalid <img src="https://latex.codecogs.com/png.latex?P">-values do not measure surprisal at the statistic given the model, and so are not valid <img src="https://latex.codecogs.com/png.latex?S">-values.</p>
<p>The decision rule “reject <strong>H</strong> if <img src="https://latex.codecogs.com/png.latex?p%5Cleq"> <img src="https://latex.codecogs.com/png.latex?%5Calpha">” will reject <strong>H</strong> 100<img src="https://latex.codecogs.com/png.latex?%5Calpha">% of the time under sampling from a model <strong>M</strong> obeying <strong>H</strong> (i.e., the Type-1 error rate of the test will be <img src="https://latex.codecogs.com/png.latex?%5Calpha">) provided the random variable <img src="https://latex.codecogs.com/png.latex?P"> corresponding to <img src="https://latex.codecogs.com/png.latex?p"> is valid (uniform under the model <strong>M</strong> used to compute it), but not necessarily otherwise[<span class="citation" data-cites="kuffnerWhyArePvalues2019"><sup>6</sup></span>]. This is one reason why frequentist writers reject invalid <img src="https://latex.codecogs.com/png.latex?P">-values (such as posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values, which highly concentrate around 0.50) and devote considerable technical coverage to uniform <img src="https://latex.codecogs.com/png.latex?P">-values<span class="citation" data-cites="kuffnerWhyArePvalues2019"><sup>6</sup></span>;<span class="citation" data-cites="robinsAsymptoticDistributionValues2000"><sup>5</sup></span>;<span class="citation" data-cites="bayarriValuesCompositeNull2000"><sup>4</sup></span>. A valid <img src="https://latex.codecogs.com/png.latex?P">-value (“U-value”) translates into an exponentially distributed <img src="https://latex.codecogs.com/png.latex?S">-value with a mean of 1 nat or <img src="https://latex.codecogs.com/png.latex?%5Clog_%7B2%7D(e)=1.443"> bits where <img src="https://latex.codecogs.com/png.latex?e"> is the base of the natural logs.</p>
<p>Uniformity is also central to the “refutational information” interpretation of the <img src="https://latex.codecogs.com/png.latex?S">-value used here, for it is necessary to ensure that the <img src="https://latex.codecogs.com/png.latex?P">-value <img src="https://latex.codecogs.com/png.latex?p"> from which <img src="https://latex.codecogs.com/png.latex?s"> is derived is in fact the percentile of the observed value of the test statistic in the distribution of the statistic under <strong>M</strong>, thus making small <img src="https://latex.codecogs.com/png.latex?p"> surprising under <strong>M</strong> and making <img src="https://latex.codecogs.com/png.latex?s"> the corresponding degree of surprise. Because posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values do not translate into sampling percentiles of the statistic under the hypothesis (in fact, they are pulled toward 0.5 from the correct percentiles)<span class="citation" data-cites="robinsAsymptoticDistributionValues2000"><sup>5</sup></span>;<span class="citation" data-cites="bayarriValuesCompositeNull2000"><sup>4</sup></span>, the resulting negative log does not measure surprisal at the statistic given <strong>M</strong>, and so is not a valid <img src="https://latex.codecogs.com/png.latex?S">-value in our terms.</p>
</blockquote>
<hr>
<p>And indeed, we can show this phenomenon below with simulations. Here we fit a simple Bayesian regression model with a weakly informative prior <code>normal(0, 10)</code> using <a href="https://mc-stan.org/rstanarm"><code>rstanarm</code></a>, where both the predictor and response variable come from the same distribution and have the same location and scale parameters (<img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%200">, <img src="https://latex.codecogs.com/png.latex?%5Csigma%20=%201">. We then calculate the observed test statistics, along with their distributions, and convert them into posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values and plot them using <a href="https://mc-stan.org/bayesplot"><code>Bayesplot</code></a> functions. Then, we iterate this <code>1000</code> times to examine the distribution of posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values and compare them to standard <img src="https://latex.codecogs.com/png.latex?P">-values that are known to be uniform.</p>
<p>But first, we’ll generate the distribution of the test statistic from one model.</p>
<hr>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bayesplot"</span>)</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rstan"</span>)</span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rstanarm"</span>)</span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rstan_options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">auto_write =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb6-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mc.cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb6-6">teal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#99c7c7"</span>)</span>
<span id="cb6-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">color_scheme_set</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"teal"</span>)</span>
<span id="cb6-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb6-9">n.samp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb6-10">X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-11">Y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-12">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(X, Y)</span>
<span id="cb6-13">mod1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stan_glm</span>(Y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> X, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chains =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">refresh =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb6-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in if (!prior_dist_name %in% unlist(ok_dists)) {: argument is of length zero</span></span>
<span id="cb6-16">yrep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">posterior_predict</span>(mod1)</span>
<span id="cb6-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error: object 'mod1' not found</span></span>
<span id="cb6-18"></span>
<span id="cb6-19">h <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ppc_stat</span>(Y, yrep, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"median"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Posterior Test Statistic"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">yaxis_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">on =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb6-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error: object 'yrep' not found</span></span>
<span id="cb6-23"></span>
<span id="cb6-24">values_all <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> h[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_env"</span>]][[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T_yrep"</span>]]</span>
<span id="cb6-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error: object 'h' not found</span></span>
<span id="cb6-26">prob_to_find <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> h[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_env"</span>]][[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T_y"</span>]]</span>
<span id="cb6-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error: object 'h' not found</span></span>
<span id="cb6-28">quantInv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(distr, value) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ecdf</span>(distr)(value)</span>
<span id="cb6-29">posterior_p_value <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantInv</span>(values_all, prob_to_find)</span>
<span id="cb6-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error: object 'values_all' not found</span></span>
<span id="cb6-31"></span>
<span id="cb6-32">l <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ppc_stat_2d</span>(Y, yrep) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Posterior Test Statistic"</span>)</span>
<span id="cb6-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error: object 'yrep' not found</span></span>
<span id="cb6-34"></span>
<span id="cb6-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(h)</span>
<span id="cb6-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'h' not found</span></span>
<span id="cb6-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(l)</span>
<span id="cb6-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'l' not found</span></span></code></pre></div>
<hr>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(prob_to_find)</span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'print': object 'prob_to_find' not found</span></span></code></pre></div>
<hr>
<p>The above is the posterior predictive test statistic for one model, along with it’s distribution. Now let’s iterate this process, convert them into posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values, and generate their distribution.</p>
<hr>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rstan_options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">auto_write =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mc.cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb8-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb8-4">set.seed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span></span>
<span id="cb8-5">n.sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb8-6">ppp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n.sim)</span>
<span id="cb8-7">n.samp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb8-8"></span>
<span id="cb8-9">quantInv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(distr, value) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ecdf</span>(distr)(value)</span>
<span id="cb8-10"></span>
<span id="cb8-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(ppp)) {</span>
<span id="cb8-12">    X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb8-13">    Y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb8-14">    df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(X, Y)</span>
<span id="cb8-15">    mod1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stan_glm</span>(Y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> X, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chains =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb8-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">refresh =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb8-17">    yrep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">posterior_predict</span>(mod1)</span>
<span id="cb8-18">    h <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ppc_stat</span>(Y, yrep, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"median"</span>)</span>
<span id="cb8-19">    values_all <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> h[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_env"</span>]][[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T_yrep"</span>]]</span>
<span id="cb8-20">    prob_to_find <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> h[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_env"</span>]][[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T_y"</span>]]</span>
<span id="cb8-21">    posterior_p_value <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantInv</span>(values_all, prob_to_find)</span>
<span id="cb8-22">    ppp[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> posterior_p_value</span>
<span id="cb8-23">}</span>
<span id="cb8-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in if (!prior_dist_name %in% unlist(ok_dists)) {: argument is of length zero</span></span>
<span id="cb8-25"></span>
<span id="cb8-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ppp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb8-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#99c7c7"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Posterior Predictive P-values"</span>,</span>
<span id="cb8-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"From Simulation of 1000 Simple Linear Regressions"</span>,</span>
<span id="cb8-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Posterior Predictive P-value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb8-30">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-8-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>We can also show this in <code>Stata 16.1</code>, using their new <code>bayesstats ppvalues</code> command which generates posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values.</p>
<hr>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb9-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">version</span> 16.1</span>
<span id="cb9-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">set</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">obs</span> 100</span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">Generate variables from a normal distribution like before</span></span>
<span id="cb9-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*/</span></span>
<span id="cb9-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">generate</span> x = rnormal(0, 1)</span>
<span id="cb9-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">generate</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span> = rnormal(0, 1)</span>
<span id="cb9-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">We set up our model here </span></span>
<span id="cb9-10"></span>
<span id="cb9-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*/</span></span>
<span id="cb9-12">parallel initialize 8, f</span>
<span id="cb9-13">bayesmh <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span> x, likelihood(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>({<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>})) prior({<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>}, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(0, 10)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">///</span></span>
<span id="cb9-14">prior({<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>:}, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(0, 10)) rseed(1031) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">saving</span>(coutput_pred, <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">replace</span>) mcmcsize(1000)</span>
<span id="cb9-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">We use the bayespredict command to make predictions from the model</span></span>
<span id="cb9-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*/</span></span>
<span id="cb9-18">bayespredict (<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">mean</span>:@mean({_resid})) (<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>:@variance({_resid})), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">///</span></span>
<span id="cb9-19">rseed(1031) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">saving</span>(coutput_pred, <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">replace</span>) </span>
<span id="cb9-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">Then we calculate the posterior predictive P-values</span></span>
<span id="cb9-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*/</span></span>
<span id="cb9-23">bayesstats ppvalues {<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">mean</span>} <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">using</span> coutput_pred</span>
<span id="cb9-24">#&gt; . <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">version</span> 16.1</span>
<span id="cb9-25">#&gt; </span>
<span id="cb9-26">#&gt; . <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">set</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">obs</span> 100</span>
<span id="cb9-27">#&gt; Number <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">of</span> observations (_N) was 0, now 100.</span>
<span id="cb9-28">#&gt; </span>
<span id="cb9-29">#&gt; . <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; Generate variables from a normal distribution like before</span></span>
<span id="cb9-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; */</span></span>
<span id="cb9-32">#&gt; . <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">generate</span> x = rnormal(0, 1)</span>
<span id="cb9-33">#&gt; </span>
<span id="cb9-34">#&gt; . <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">generate</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span> = rnormal(0, 1)</span>
<span id="cb9-35">#&gt; </span>
<span id="cb9-36">#&gt; . <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; We set up our model here </span></span>
<span id="cb9-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; </span></span>
<span id="cb9-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; */</span></span>
<span id="cb9-40">#&gt; . parallel initialize 8, f</span>
<span id="cb9-41">#&gt; <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">N</span> Child processes: 8</span>
<span id="cb9-42">#&gt; Stata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">dir</span>:  /Applications/Stata/StataBE.app/Contents/MacOS/stata-<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">be</span></span>
<span id="cb9-43">#&gt; </span>
<span id="cb9-44">#&gt; . bayesmh <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span> x, likelihood(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>({<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>})) prior({<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>}, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(0, 10)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">///</span></span>
<span id="cb9-45">#&gt; &gt; prior({<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>:}, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(0, 10)) rseed(1031) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">saving</span>(coutput_pred, <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">replace</span>) mcmcsize(1000)</span>
<span id="cb9-46">#&gt;   </span>
<span id="cb9-47">#&gt; Burn-<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ...</span>
<span id="cb9-48">#&gt; Simulation ...</span>
<span id="cb9-49">#&gt; </span>
<span id="cb9-50">#&gt; Model summary</span>
<span id="cb9-51">#&gt; ------------------------------------------------------------------------------</span>
<span id="cb9-52">#&gt; Likelihood: </span>
<span id="cb9-53">#&gt;   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span> ~ <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(xb_y,{<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>})</span>
<span id="cb9-54">#&gt; </span>
<span id="cb9-55">#&gt; Priors: </span>
<span id="cb9-56">#&gt;   {<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>:x <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">_cons</span>} ~ <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(0,10)                                               (1)</span>
<span id="cb9-57">#&gt;         {<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>} ~ <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(0,10)</span>
<span id="cb9-58">#&gt; ------------------------------------------------------------------------------</span>
<span id="cb9-59">#&gt; (1) Parameters are elements <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">of</span> the linear form xb_y.</span>
<span id="cb9-60">#&gt; </span>
<span id="cb9-61">#&gt; Bayesian <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span> regression                       MCMC iterations  =      3,500</span>
<span id="cb9-62">#&gt; Random-walk Metropolis–Hastings sampling         Burn-<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span>          =      2,500</span>
<span id="cb9-63">#&gt;                                                  MCMC <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">sample</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">size</span> =      1,000</span>
<span id="cb9-64">#&gt;                                                  Number <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">of</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">obs</span>    =        100</span>
<span id="cb9-65">#&gt;                                                  Acceptance rate  =      .2068</span>
<span id="cb9-66">#&gt;                                                  Efficiency:  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span> =     .03878</span>
<span id="cb9-67">#&gt;                                                               avg =     .07757</span>
<span id="cb9-68">#&gt; Log marginal-likelihood = -149.68351                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span> =      .1317</span>
<span id="cb9-69">#&gt;  </span>
<span id="cb9-70">#&gt; ------------------------------------------------------------------------------</span>
<span id="cb9-71">#&gt;              |                                                Equal-tailed</span>
<span id="cb9-72">#&gt;              |      Mean   Std. <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">dev</span>.     MCSE     Median  [95% cred. interval]</span>
<span id="cb9-73">#&gt; -------------+----------------------------------------------------------------</span>
<span id="cb9-74">#&gt; <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>            |</span>
<span id="cb9-75">#&gt;            x | -.0758396    .097915   .008532  -.0704775  -.2600037   .1054718</span>
<span id="cb9-76">#&gt;        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">_cons</span> |  .0238076   .1107038   .014035   .0326669  -.1793756   .2293247</span>
<span id="cb9-77">#&gt; -------------+----------------------------------------------------------------</span>
<span id="cb9-78">#&gt;          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span> |  .9773565   .1313659   .021096   .9384637   .7882847   1.323255</span>
<span id="cb9-79">#&gt; ------------------------------------------------------------------------------</span>
<span id="cb9-80">#&gt; </span>
<span id="cb9-81">#&gt; file coutput_pred.dta saved.</span>
<span id="cb9-82">#&gt; </span>
<span id="cb9-83">#&gt; . <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; We use the bayespredict command to make predictions from the model</span></span>
<span id="cb9-85"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; */</span></span>
<span id="cb9-86">#&gt; . bayespredict (<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">mean</span>:@mean({_resid})) (<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>:@variance({_resid})), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">///</span></span>
<span id="cb9-87">#&gt; &gt; rseed(1031) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">saving</span>(coutput_pred, <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">replace</span>) </span>
<span id="cb9-88">#&gt; </span>
<span id="cb9-89">#&gt; Computing predictions ...</span>
<span id="cb9-90">#&gt; </span>
<span id="cb9-91">#&gt; file coutput_pred.dta saved.</span>
<span id="cb9-92">#&gt; file coutput_pred.ster saved.</span>
<span id="cb9-93">#&gt; </span>
<span id="cb9-94">#&gt; . <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-95"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; Then we calculate the posterior predictive P-values</span></span>
<span id="cb9-96"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; */</span></span>
<span id="cb9-97">#&gt; . bayesstats ppvalues {<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">mean</span>} <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">using</span> coutput_pred</span>
<span id="cb9-98">#&gt; </span>
<span id="cb9-99">#&gt; Posterior predictive summary   MCMC <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">sample</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">size</span> =     1,000</span>
<span id="cb9-100">#&gt; </span>
<span id="cb9-101">#&gt; -----------------------------------------------------------</span>
<span id="cb9-102">#&gt;            T |      Mean   Std. <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">dev</span>.  E(T_obs)  P(T&gt;=T_obs)</span>
<span id="cb9-103">#&gt; -------------+---------------------------------------------</span>
<span id="cb9-104">#&gt;         <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">mean</span> |  .0004223   .0957513    .008651         .495</span>
<span id="cb9-105">#&gt; -----------------------------------------------------------</span>
<span id="cb9-106">#&gt; Note: P(T&gt;=T_obs) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">close</span> to 0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> 1 indicates lack <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">of</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fit</span>.</span>
<span id="cb9-107">#&gt; </span>
<span id="cb9-108">#&gt; .</span></code></pre></div>
<hr>
<p>As we can see from the <code>R</code> plot above, the test statistics are are generally concentrated around <code>0.5</code> and the distribution (as shown above via the <code>R</code> code) hardly resembles the uniform distribution of <img src="https://latex.codecogs.com/png.latex?P">-value under the null model. Further, the base-2 log transformation of posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values is not exponentially distributed, making them invalid <img src="https://latex.codecogs.com/png.latex?S">-values in our terms.</p>
<hr>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log2</span>(ppp)))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,</span>
<span id="cb10-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of -log2(Posterior Predictive P-values)"</span>,</span>
<span id="cb10-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S-values Produced From Posterior Predictive P-values"</span>,</span>
<span id="cb10-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-log2(Posterior Predictive P-value)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span>
<span id="cb10-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Warning: Removed 100 rows containing non-finite outside the scale range (`stat_bin()`).</span></span>
<span id="cb10-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Warning in max(f): no non-missing arguments to max; returning -Inf</span></span>
<span id="cb10-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in `geom_histogram()`:</span></span>
<span id="cb10-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; ! Problem while computing stat.</span></span>
<span id="cb10-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; ℹ Error occurred in the 1st layer.</span></span>
<span id="cb10-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Caused by error in `seq_len()`:</span></span>
<span id="cb10-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; ! argument must be coercible to non-negative integer</span></span></code></pre></div>
<hr>
</section>
<section id="table-1-some-p-values-s-values-maximum-likelihood-ratios-and-likelihood-ratio-statistics" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="table-1-some-p-values-s-values-maximum-likelihood-ratios-and-likelihood-ratio-statistics"><span class="header-section-number">0.3</span> Table 1: Some <img src="https://latex.codecogs.com/png.latex?P">-values, <img src="https://latex.codecogs.com/png.latex?S">-values, Maximum Likelihood Ratios, and Likelihood Ratio Statistics</h2>
<hr>
<p>Here, we look at some common <img src="https://latex.codecogs.com/png.latex?P">-values, and how they correspond to other information statistics and likelihood measures.</p>
<hr>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">pvalue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>,</span>
<span id="cb11-2">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-04</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"5 sigma (~ 2.9 in 10 million)"</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1 in 100 million (GWAS)"</span>),</span>
<span id="cb11-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6 sigma (~ 1 in a billion)"</span>))</span>
<span id="cb11-4"></span>
<span id="cb11-5">svalue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log2</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>,</span>
<span id="cb11-6">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-04</span>)), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">21.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">26.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">29.9</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb11-7"></span>
<span id="cb11-8">pvalue[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">formatC</span>(pvalue[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"e"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb11-9"></span>
<span id="cb11-10">mlr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.26</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.94</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.87</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.83</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">27.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">51.4</span>,</span>
<span id="cb11-11">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1935</span>, (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)), (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)), (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb11-12"></span>
<span id="cb11-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># likelihood ratio statistic</span></span>
<span id="cb11-14"></span>
<span id="cb11-15">lr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00016</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.016</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.45</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.32</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.71</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.84</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.02</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.63</span>,</span>
<span id="cb11-16">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.88</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">26.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">32.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.4</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb11-17"></span>
<span id="cb11-18">table1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(pvalue, svalue, mlr, lr)</span>
<span id="cb11-19"></span>
<span id="cb11-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(table1) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P-value (compatibility)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S-value (bits)"</span>,</span>
<span id="cb11-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Maximum Likelihood Ratio"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Deviance Statistic 2ln(MLR)"</span>)</span>
<span id="cb11-22"></span>
<span id="cb11-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kbl</span>(table1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"html"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">padding =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longtable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb11-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_spec</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_spec</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full_width =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">html_font =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cambria"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lightable_options =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"basic"</span>,</span>
<span id="cb11-28">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">font_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixed_thead =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">enabled =</span> F)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">footnote</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">general_title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Abbreviations: "</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title_format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"underline"</span>,</span>
<span id="cb11-30">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">general =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table 1 $P$-values                  and binary $S$-values, with corresponding maximum-likelihood ratios (MLR) and deviance (likelihood-ratio) statistics for a simple test hypothesis H under background assumptions A"</span>))</span></code></pre></div>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">P-value (compatibility)</th>
<th style="text-align: right;">S-value (bits)</th>
<th style="text-align: right;">Maximum Likelihood Ratio</th>
<th style="text-align: right;">Deviance Statistic 2ln(MLR)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.99</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1.00e+00</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.9</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">1.01e+00</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.5</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.26e+00</td>
<td style="text-align: right;">0.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.25</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">1.94e+00</td>
<td style="text-align: right;">1.32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.1</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">3.87e+00</td>
<td style="text-align: right;">2.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.05</td>
<td style="text-align: right;">4.32</td>
<td style="text-align: right;">6.83e+00</td>
<td style="text-align: right;">3.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.025</td>
<td style="text-align: right;">5.32</td>
<td style="text-align: right;">1.23e+01</td>
<td style="text-align: right;">5.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.01</td>
<td style="text-align: right;">6.64</td>
<td style="text-align: right;">2.76e+01</td>
<td style="text-align: right;">6.63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.005</td>
<td style="text-align: right;">7.64</td>
<td style="text-align: right;">5.14e+01</td>
<td style="text-align: right;">7.88</td>
</tr>
<tr class="even">
<td style="text-align: left;">1e-04</td>
<td style="text-align: right;">13.29</td>
<td style="text-align: right;">1.94e+03</td>
<td style="text-align: right;">15.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5 sigma (~ 2.9 in 10 million)</td>
<td style="text-align: right;">21.70</td>
<td style="text-align: right;">5.20e+05</td>
<td style="text-align: right;">26.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">1 in 100 million (GWAS)</td>
<td style="text-align: right;">26.60</td>
<td style="text-align: right;">1.40e+07</td>
<td style="text-align: right;">32.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6 sigma (~ 1 in a billion)</td>
<td style="text-align: right;">29.90</td>
<td style="text-align: right;">1.30e+08</td>
<td style="text-align: right;">37.40</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style="text-decoration: underline;">Abbreviations: </span></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Table 1 $P$-values and binary $S$-values, with corresponding maximum-likelihood ratios (MLR) and deviance (likelihood-ratio) statistics for a simple test hypothesis H under background assumptions A</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<hr>
<p>For further discussion of 5 and 6 sigma cutoffs, see<span class="citation" data-cites="cousinsJeffreysLindleyParadox2017"><sup>7</sup></span>.</p>
<hr>
</section>
<section id="frequentist-interval-estimate-percentiles" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="frequentist-interval-estimate-percentiles"><span class="header-section-number">0.4</span> Frequentist Interval Estimate Percentiles</h2>
</section>
<section id="refer-to-long-run-coverage" class="level2" data-number="0.5">
<h2 data-number="0.5" class="anchored" data-anchor-id="refer-to-long-run-coverage"><span class="header-section-number">0.5</span> Refer to Long-Run Coverage</h2>
<hr>
<p>Here we simulate a study where one group with 100 participants has an <img src="https://latex.codecogs.com/png.latex?%5Cmu"> of <code>100</code> with a <img src="https://latex.codecogs.com/png.latex?%5Csigma"> of <code>20</code> and the second group has the same number of participants but an average of <code>80</code> and a standard deviation of <code>20.</code> We compare them using a Welch’s <img src="https://latex.codecogs.com/png.latex?t">-test and generate 95% compatibility intervals several times, specifically <code>100</code> times, and then plot them. Since we know the mean difference is <code>20</code>, we wish to see how often the interval estimates cover this true parameter value.</p>
<hr>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-12-1.svg" data-fig-align="center" width="1056"></p>
<hr>
<p>This shows that the intervals tend to vary simply as a result of randomness, and that the proper interpretation of the attached percentile is about long run coverage of the true parameter. However, this does not preclude interpretation of a single interval estimate from a study.[<span class="citation" data-cites="coxChapterIntervalEstimation1974"><sup>8</sup></span>] As we write in the <em>Replace unrealistic “confidence” claims with compatibility measures</em> section of our paper.[<span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>1</sup></span>]</p>
<hr>
<blockquote class="blockquote">
<p>The fact that “confidence” refers to the procedure behavior, not the reported interval, seems to be lost on most researchers. Remarking on this subtlety, when Jerzy Neyman discussed his confidence concept in 1934 at a meeting of the Royal Statistical Society, Arthur Bowley replied, “I am not at all sure that the ‘confidence’ is not a confidence trick.”<span class="citation" data-cites="bowleyDiscussionDrNeyman1934"><sup>9</sup></span>. And indeed, 40 years later, Cox and Hinkley warned, “interval estimates cannot be taken as probability statements about parameters, and foremost is the interpretation ‘such and such parameter values are consistent with the data.’”<span class="citation" data-cites="coxChapterIntervalEstimation1974"><sup>8</sup></span>. Unfortunately, the word “consistency” is used for several other concepts in statistics, while in logic it refers to an absolute condition (of noncontradiction); thus, its use in place of “confidence” would risk further confusion.</p>
<p>To address the problems above, we exploit the fact that a 95% CI summarizes the results of varying the test hypothesis H over a range of parameter values, displaying all values for which <img src="https://latex.codecogs.com/png.latex?p"> &gt; 0.05<span class="citation" data-cites="coxPrinciplesStatisticalInference2006"><sup>10</sup></span> and hence <img src="https://latex.codecogs.com/png.latex?s"> &lt; 4.32 bits<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup>3</sup></span>;<span class="citation" data-cites="amrheinInferentialStatisticsDescriptive2019"><sup>11</sup></span>. Thus the CI contains a range of parameter values that are more compatible with the data than are values outside the interval, under the background assumptions<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup>3</sup></span>;<span class="citation" data-cites="greenlandStatisticalTestsValues2016"><sup>12</sup></span>. Unconditionally (and thus even if the background assumptions are uncertain), the interval shows the values of the parameter which, when combined with the background assumptions, produce a test model that is “highly compatible” with the data in the sense of having less than 4.32 bits of information against it. We thus refer to CI as compatibility intervals rather than confidence intervals<span class="citation" data-cites="greenlandAreConfidenceIntervals2019"><sup>13</sup></span>;<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup>3</sup></span>;<span class="citation" data-cites="amrheinInferentialStatisticsDescriptive2019"><sup>11</sup></span>; their abbreviation remains “CI.” We reject calling these intervals “uncertainty intervals,” because they do not capture uncertainty about background assumptions<span class="citation" data-cites="greenlandAreConfidenceIntervals2019"><sup>13</sup></span>.</p>
</blockquote>
<hr>
<p>Indeed, this also has to do with our paper on deemphasizing the model assumptions that are often behind common statistical outputs, and why it is necessary to treat them as uncertain, rather than given.[<span class="citation" data-cites="greenlandAidScientificInference2020"><sup>14</sup></span>] For example, a 95% interval estimate is assumed to be free of bias in its construction, however, it’s coverage claims are no longer so, once there are systematic errors in play. Many of these common, classical statistical procedures are designed to deal with random variation, and less so with bias (a relatively new field, with shiny new methods).</p>
<hr>
</section>
<section id="brown-et-al.-2017-reanalysis" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Brown et al.&nbsp;(2017) Reanalysis</h1>
<hr>
<p>Taken from the <a href="https://doi.org/10.1001/jama.2017.3415">Brown et al. data.</a>[<span class="citation" data-cites="brownAssociationSerotonergicAntidepressant2017"><sup>15</sup></span>;<span class="citation" data-cites="brownAssociationAntenatalExposure2017"><sup>16</sup></span>]</p>
<p>Here we take the reported statistics from the Brown et al.&nbsp;studies in order to run statistical tests of different alternative test hypotheses and use those results to construct various functions.</p>
<p>We calculate the standard errors from the point estimate and the confidence (compatibility) limits.</p>
<hr>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">se <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.997</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.92</span></span>
<span id="cb12-2"></span>
<span id="cb12-3">logUL <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span>)</span>
<span id="cb12-4">logLL <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.997</span>)</span>
<span id="cb12-5"></span>
<span id="cb12-6">logpoint <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>)</span>
<span id="cb12-7"></span>
<span id="cb12-8">logpoint <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> se)</span>
<span id="cb12-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 0.954</span></span>
<span id="cb12-10">logpoint <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> se)</span>
<span id="cb12-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] -0.0011</span></span></code></pre></div>
<hr>
<section id="table-2-p-values-s-values-and-likelihoods-for-targeted-hypotheses-about-hazard-ratios-for-brown-et-al." class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="table-2-p-values-s-values-and-likelihoods-for-targeted-hypotheses-about-hazard-ratios-for-brown-et-al."><span class="header-section-number">1.1</span> Table 2: <img src="https://latex.codecogs.com/png.latex?P">-values, <img src="https://latex.codecogs.com/png.latex?S">-values, and Likelihoods for Targeted Hypotheses About Hazard Ratios for <a href="https://doi.org/10.1001/jama.2017.3415">Brown et al.</a></h2>
<hr>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">testhypothesis <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Halving of hazard"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No effect (null)"</span>,</span>
<span id="cb13-2">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Point estimate"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Doubling of hazard"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tripling of hazard"</span>,</span>
<span id="cb13-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Quintupling of hazard"</span>)</span>
<span id="cb13-4"></span>
<span id="cb13-5">hazardratios <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb13-6">pvals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.6e-06</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.37</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2e-06</span>)</span>
<span id="cb13-7">svals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log2</span>(pvals), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb13-8">mlr2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.77</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.49</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">26.2</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb13-9">lr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>se)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>se)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)),</span>
<span id="cb13-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>se)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>se)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)),</span>
<span id="cb13-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>se)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>se)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))),</span>
<span id="cb13-12">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb13-13"></span>
<span id="cb13-14">LR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">formatC</span>(lr, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"e"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb13-15"></span>
<span id="cb13-16">table2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(testhypothesis, hazardratios, pvals, svals,</span>
<span id="cb13-17">    mlr2, LR)</span>
<span id="cb13-18"></span>
<span id="cb13-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(table2) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test Hypothesis"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HR"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P-values"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S-values"</span>,</span>
<span id="cb13-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MLR"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LR"</span>)</span>
<span id="cb13-21"></span>
<span id="cb13-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kbl</span>(table2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"html"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">padding =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longtable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb13-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_spec</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_spec</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full_width =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">html_font =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cambria"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lightable_options =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"basic"</span>,</span>
<span id="cb13-27">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">font_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixed_thead =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">enabled =</span> F))</span></code></pre></div>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Test Hypothesis</th>
<th style="text-align: right;">HR</th>
<th style="text-align: right;">P-values</th>
<th style="text-align: right;">S-values</th>
<th style="text-align: right;">MLR</th>
<th style="text-align: left;">LR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Halving of hazard</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">19.25</td>
<td style="text-align: right;">1.00e+05</td>
<td style="text-align: left;">1.02e+05</td>
</tr>
<tr class="even">
<td style="text-align: left;">No effect (null)</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">4.32</td>
<td style="text-align: right;">6.77e+00</td>
<td style="text-align: left;">6.77e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Point estimate</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00e+00</td>
<td style="text-align: left;">1.00e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Doubling of hazard</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">1.43</td>
<td style="text-align: right;">1.49e+00</td>
<td style="text-align: left;">1.49e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tripling of hazard</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">6.64</td>
<td style="text-align: right;">2.62e+01</td>
<td style="text-align: left;">2.62e+01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Quintupling of hazard</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">18.25</td>
<td style="text-align: right;">5.00e+04</td>
<td style="text-align: left;">5.03e+04</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="plot-the-point-estimate-and-95-compatibility-interval" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="plot-the-point-estimate-and-95-compatibility-interval"><span class="header-section-number">1.2</span> Plot the point estimate and 95% compatibility interval</h2>
<hr>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brown et al. (2017)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> JAMA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brown et al. (2017)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> J Clin Psychiatry"</span>)</span>
<span id="cb14-2"></span>
<span id="cb14-3">point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.7</span>)</span>
<span id="cb14-4">lower <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.997</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>)</span>
<span id="cb14-5">upper <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.6</span>)</span>
<span id="cb14-6"></span>
<span id="cb14-7">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(label, point, lower, upper)</span></code></pre></div>
<hr>
<p>Here we plot the 95% compatibility interval estimate reported from the high-dimensional propensity score analysis.</p>
<hr>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> label, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> point, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> lower,</span>
<span id="cb15-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> upper, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> label)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_pointrange</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#007C7C"</span>,</span>
<span id="cb15-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb15-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_log10</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pretty_breaks</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb15-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Association Between Serotonergic Antidepressant Exposure </span></span>
<span id="cb15-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">               </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">During Pregnancy and Child Autism Spectrum Disorder"</span>,</span>
<span id="cb15-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reported 95% Compatibility Intervals From Primary Results"</span>,</span>
<span id="cb15-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Study"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio (JAMA) + </span></span>
<span id="cb15-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            Adjusted Pooled Odds Ratio (J Clin Psychiatry)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Null parameter value of 1"</span>,</span>
<span id="cb15-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb15-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Point Estimate = 1.61, </span></span>
<span id="cb15-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">           Lower Limit = 0.997, Upper Limit = 2.59"</span>,</span>
<span id="cb15-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#000000"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb15-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Point Estimate = 1.7, </span></span>
<span id="cb15-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">           Lower Limit = 1.1, Upper Limit = 2.6"</span>,</span>
<span id="cb15-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#000000"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>,</span>
<span id="cb15-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-16-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>Once again, the authors reported that[<span class="citation" data-cites="brownAssociationSerotonergicAntidepressant2017"><sup>15</sup></span>]</p>
<blockquote class="blockquote">
<p>In the 2837 pregnancies (7.9%) exposed to antidepressants, 2.0% (95% CI, 1.6%-2.6%) of children were diagnosed with autism spectrum disorder. Risk of autism spectrum disorder was significantly higher with serotonergic antidepressant exposure (4.51 exposed vs 2.03 unexposed per 1000 person-years; between-group difference, 2.48 95% CI, 2.33-2.62 per 1000 person-years) in crude (HR, 2.16 95% CI, 1.64-2.86) and multivariable-adjusted analyses (HR, 1.59 95% CI, 1.17-2.17) (Table 2). After inverse probability of treatment weighting based on the HDPS, the association was not significant (HR, 1.61 95% CI, 0.997-2.59) (Table 2).</p>
</blockquote>
<p>and concluded with</p>
<blockquote class="blockquote">
<p>In children born to mothers receiving public drug coverage in Ontario, Canada, in utero serotonergic antidepressant exposure compared with no exposure was not associated with autism spectrum disorder in the child. Although a causal relationship cannot be ruled out, the previously observed association may be explained by other factors.</p>
</blockquote>
<p>We will show using the graphical and tabular summaries below, why a more nuanced summary such as,</p>
<blockquote class="blockquote">
<p>“After HDPS adjustment for confounding, a 61% hazard elevation remained; however, under the same model, every hypothesis from no elevation up to a 160% hazard increase had <img src="https://latex.codecogs.com/png.latex?p"> &gt; 0.05; Thus, while quite imprecise, these results are consistent with previous observations of a positive association between serotonergic antidepressant prescriptions and subsequent ASD. Because the association may be partially or wholly due to uncontrolled biases, further evidence will be needed for evaluating what, if any, proportion of it can be attributed to causal effects of prenatal serotonergic antidepressant use on ASD incidence.”</p>
</blockquote>
<p>would have been far more appropriate, as we discuss in our paper.[<span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>1</sup></span>]</p>
<hr>
</section>
<section id="p-value-and-s-value-functions" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="p-value-and-s-value-functions"><span class="header-section-number">1.3</span> <img src="https://latex.codecogs.com/png.latex?P">-value and <img src="https://latex.codecogs.com/png.latex?S">-value Functions</h2>
<hr>
<p>In order to use this information to construct a <img src="https://latex.codecogs.com/png.latex?P">-value function, we can use the <a href="https://data.lesslikely.com/concurve/"><code>concurve</code></a> functions.</p>
<hr>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"concurve"</span>)</span></code></pre></div>
<hr>
<p>We enter the reported point estimates and compatibility limits and produce all possible intervals + <img src="https://latex.codecogs.com/png.latex?P">-values + <img src="https://latex.codecogs.com/png.latex?S">-values. This is calculated assuming normal approximations with the <a href="https://data.lesslikely.com/concurve/reference/curve_rev.html"><code>curve_rev()</code></a> function.</p>
<hr>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">curve1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve_rev</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.997</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">UL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>)</span></code></pre></div>
<hr>
<p>It is stored in the object <code>curve1</code>.</p>
<p>We can generate a table of the relevant statistics from this reanalysis, similar to the table from above, but this time using the <a href="https://data.lesslikely.com/concurve/index.html"><code>concurve</code></a> function, <a href="https://data.lesslikely.com/concurve/reference/curve_table.html"><code>curve_table()</code></a>, but this time it will give us interval estimates of various percentiles (<img src="https://latex.codecogs.com/png.latex?25">%, <img src="https://latex.codecogs.com/png.latex?50">%, <img src="https://latex.codecogs.com/png.latex?75">%, <img src="https://latex.codecogs.com/png.latex?95">%, etc.). These are in turn used to construct the entire confidence (compatibility) distribution or <img src="https://latex.codecogs.com/png.latex?P">-value function.</p>
<hr>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kbl</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve_table</span>(curve1[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"html"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">padding =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>,</span>
<span id="cb18-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longtable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> F, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve_table</span>(curve1[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_spec</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_spec</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full_width =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">html_font =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cambria"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lightable_options =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"basic"</span>,</span>
<span id="cb18-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">font_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixed_thead =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">enabled =</span> F)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">footnote</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">general_title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table of Statistics for Various Interval Estimate Percentiles"</span>),</span>
<span id="cb18-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">general =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span></code></pre></div>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Lower Limit</th>
<th style="text-align: right;">Upper Limit</th>
<th style="text-align: right;">Interval Width</th>
<th style="text-align: right;">Interval Level (%)</th>
<th style="text-align: right;">CDF</th>
<th style="text-align: right;">P-value</th>
<th style="text-align: right;">S-value (bits)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.490</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">25.0</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">0.750</td>
<td style="text-align: right;">0.415</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.366</td>
<td style="text-align: right;">1.90</td>
<td style="text-align: right;">0.531</td>
<td style="text-align: right;">50.0</td>
<td style="text-align: right;">0.750</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.217</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">0.914</td>
<td style="text-align: right;">75.0</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">2.000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.178</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">1.021</td>
<td style="text-align: right;">80.0</td>
<td style="text-align: right;">0.900</td>
<td style="text-align: right;">0.200</td>
<td style="text-align: right;">2.322</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.134</td>
<td style="text-align: right;">2.29</td>
<td style="text-align: right;">1.152</td>
<td style="text-align: right;">85.0</td>
<td style="text-align: right;">0.925</td>
<td style="text-align: right;">0.150</td>
<td style="text-align: right;">2.737</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.079</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">1.325</td>
<td style="text-align: right;">90.0</td>
<td style="text-align: right;">0.950</td>
<td style="text-align: right;">0.100</td>
<td style="text-align: right;">3.322</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.999</td>
<td style="text-align: right;">2.60</td>
<td style="text-align: right;">1.596</td>
<td style="text-align: right;">95.0</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">4.322</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.933</td>
<td style="text-align: right;">2.78</td>
<td style="text-align: right;">1.846</td>
<td style="text-align: right;">97.5</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">5.322</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.860</td>
<td style="text-align: right;">3.02</td>
<td style="text-align: right;">2.155</td>
<td style="text-align: right;">99.0</td>
<td style="text-align: right;">0.995</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">6.644</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span style="font-style: italic;">Table of Statistics for Various Interval Estimate Percentiles</span></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="figure-3-p-value-compatibility-function" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="figure-3-p-value-compatibility-function"><span class="header-section-number">1.4</span> Figure 3: <img src="https://latex.codecogs.com/png.latex?P">-value (Compatibility) Function</h2>
<hr>
<p>Plot the <img src="https://latex.codecogs.com/png.latex?P">-value (Compatibility) function of the <a href="https://doi.org/10.1001/jama.2017.3415">Brown et al.</a> data</p>
<p>Now we plot the <img src="https://latex.codecogs.com/png.latex?P">-value function from the data stored in <code>curve1</code> using the <a href="https://data.lesslikely.com/concurve/reference/ggcurve.html"><code>ggcurve()</code></a> function from <a href="https://data.lesslikely.com/concurve/"><code>concurve</code></a>.</p>
<hr>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggcurve</span>(curve1[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nullvalue =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb19-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">italic</span>(P),</span>
<span id="cb19-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-value (Compatibility) Function"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">italic</span>(P),</span>
<span id="cb19-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-values for a range of hazard ratios (HR)"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio (HR)"</span>,</span>
<span id="cb19-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">italic</span>(P), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-value"</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>,</span>
<span id="cb19-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span>,</span>
<span id="cb19-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb19-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb19-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-20-1.svg" data-fig-align="center" width="672"></p>
<hr>
<p>It is practically the same as the published version from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland, 2020</a><span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>1</sup></span>.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1602038429/Site/confidencecurve.svg" width="750"></p>
<hr>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">curve1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve_rev</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.997</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">UL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>)</span>
<span id="cb20-2"></span>
<span id="cb20-3">curve2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve_rev</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">UL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>)</span></code></pre></div>
<hr>
</section>
<section id="cumulative-confidence-compatibility-distribution" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="cumulative-confidence-compatibility-distribution"><span class="header-section-number">1.5</span> Cumulative Confidence (Compatibility Distribution)</h2>
<hr>
<p>Although we do not cover this figure in our paper, it is easy to construct using <a href="https://data.lesslikely.com/concurve/index.html"><code>concurve's</code></a> <a href="https://data.lesslikely.com/concurve/reference/ggcurve.html"><code>ggcurve()</code></a> function by specifying <code>type</code> as “<code>cdf</code>” to see the median estimate within the confidence distribution. The horizontal line that meets at the curve, is approximately the same as the maximum at the <img src="https://latex.codecogs.com/png.latex?P">-value function/confidence (compatibility) curve.</p>
<hr>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggcurve</span>(curve1[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cdf"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nullvalue =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P-values for a range of hazard ratios (HR)"</span>,</span>
<span id="cb21-3">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Association Between Serotonergic Antidepressant Exposure </span></span>
<span id="cb21-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">       </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">During Pregnancy and Child Autism Spectrum Disorder"</span>,</span>
<span id="cb21-5">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio (HR)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cumulative Compatibility"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>),</span>
<span id="cb21-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb21-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-22-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>We will also calculate the likelihoods so that we can generate the corresponding likelihood functions.</p>
<hr>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">lik2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve_rev</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">UL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l"</span>,</span>
<span id="cb22-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>)</span>
<span id="cb22-3"></span>
<span id="cb22-4">lik1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve_rev</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.997</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">UL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l"</span>,</span>
<span id="cb22-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>)</span></code></pre></div>
<hr>
<p>We can also see how consistent these results are with previous studies conducted by the same research group, given the overlap of the functions, which can be compared using the <a href="https://data.lesslikely.com/concurve/reference/plot_compare.html"><code>plot_compare()</code></a> function. Let’s compare the relative likelihood functions from both studies from this research group to see how consistent the results are.</p>
<hr>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_compare</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data1 =</span> lik1[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data2 =</span> lik2[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l1"</span>,</span>
<span id="cb23-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nullvalue =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brown et al. 2017. J Clin Psychiatry. vs. </span></span>
<span id="cb23-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">              </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Brown et al. 2017. JAMA."</span>,</span>
<span id="cb23-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"J Clin Psychiatry: OR = 1.7, 1/6.83 LI: LL = 1.1, UL = 2.6 </span></span>
<span id="cb23-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                         </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">JAMA: HR = 1.61, 1/6.83 LI: LL = 0.997, UL = 2.59"</span>,</span>
<span id="cb23-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xaxis =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio / Odds Ratio"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb23-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb23-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-24-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>and the <img src="https://latex.codecogs.com/png.latex?P">-value functions.</p>
<hr>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_compare</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data1 =</span> curve1[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data2 =</span> curve2[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c"</span>,</span>
<span id="cb24-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nullvalue =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brown et al. 2017. J Clin Psychiatry. vs. </span></span>
<span id="cb24-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">              </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Brown et al. 2017. JAMA."</span>,</span>
<span id="cb24-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"J Clin Psychiatry: OR = 1.7, 1/6.83 LI: LL = 1.1, UL = 2.6 </span></span>
<span id="cb24-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">              </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">JAMA: HR = 1.61, 1/6.83 LI: LL = 0.997, UL = 2.59"</span>,</span>
<span id="cb24-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xaxis =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio / Odds Ratio"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb24-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb24-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-25-1.svg" data-fig-align="center" width="768"></p>
<hr>
</section>
<section id="figure-4-s-value-suprisal-function" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="figure-4-s-value-suprisal-function"><span class="header-section-number">1.6</span> Figure 4: <img src="https://latex.codecogs.com/png.latex?S">-value (Suprisal) Function</h2>
<hr>
<p>Plot the <img src="https://latex.codecogs.com/png.latex?S">-value (Surprisal) function of the <a href="https://doi.org/10.1001/jama.2017.3415">Brown et al.</a> data with <a href="https://data.lesslikely.com/concurve/reference/ggcurve.html"><code>ggcurve()</code></a></p>
<hr>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggcurve</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> curve1[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nullvalue =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb25-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S-value (Surprisal) Function"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S-Values (surprisals) for a range of hazard ratios (HR)"</span>,</span>
<span id="cb25-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xaxis =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yaxis1 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S-value (bits of information)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>),</span>
<span id="cb25-5">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb25-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-26-1.svg" data-fig-align="center" width="576"></p>
<hr>
<p>which is quite close to the figure from our paper.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1602200052/Site/surprisalcurve.png" width="750"></p>
<hr>
</section>
<section id="likelihood-support-functions" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="likelihood-support-functions"><span class="header-section-number">1.7</span> Likelihood (Support) Functions</h2>
<hr>
<p>Here we provide the code to show how we constructed the likelihood functions from our paper, which are the supplementary figures found <a href="https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM3_ESM.pdf">here (S1)</a> and <a href="https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM4_ESM.pdf">here (S2)</a>.</p>
<hr>
<p>Calculate and Plot Likelihood (Support) Intervals.</p>
<p>Here we use the reported estimates to construct the <img src="https://latex.codecogs.com/png.latex?Z">-scores and standard errors, which are in turn used to compute the likelihoods.</p>
<hr>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">hrvalues <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.65</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.98</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)</span>
<span id="cb26-2"></span>
<span id="cb26-3">se <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.997</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.92</span></span>
<span id="cb26-4"></span>
<span id="cb26-5">zscore <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(hrvalues, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>se))</span></code></pre></div>
<hr>
</section>
<section id="figure-s1-relative-likelihood-function" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="figure-s1-relative-likelihood-function"><span class="header-section-number">1.8</span> Figure S1: Relative Likelihood Function</h2>
<hr>
<p>We then standardize all the likelihoods by their maximum at the likelihood function,<span class="citation" data-cites="jewellStatisticsEpidemiology2003"><sup>17</sup></span> to produce relative likelihoods, likelihood intervals, and their corresponding relative likelihood function.[<span class="citation" data-cites="royallStatisticalEvidenceLikelihood1997"><sup>18</sup></span>]</p>
<hr>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">support <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>zscore<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb27-2"></span>
<span id="cb27-3">likfunction <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(hrvalues, zscore, support)</span>
<span id="cb27-4"></span>
<span id="cb27-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> likfunction, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> hrvalues, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> support)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>,</span>
<span id="cb27-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.83</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb27-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#333333"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> hrvalues,</span>
<span id="cb27-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(support), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> support), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Relative Likelihood Function"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Relative likelihoods for a range of hazard ratios"</span>,</span>
<span id="cb27-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio (HR)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Relative Likelihood </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1/MLR"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.65</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1/6.83 LI = 0.997, 2.59"</span>,</span>
<span id="cb27-13">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#000000"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb27-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb27-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pretty_breaks</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>,</span>
<span id="cb27-17">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0125</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-28-1.svg" data-fig-align="center" width="672"></p>
<hr>
<p>The <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B6.83%7D"> likelihood interval corresponds to the 95% compatibility interval, as shown by the figure from our paper.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1602200052/Site/relativelikelihood.png" width="750"></p>
<hr>
<p>Below we use the calculated <img src="https://latex.codecogs.com/png.latex?Z">-scores to construct the log-likelihood function which is the upward-concave parabola <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7BZ%5E%7B2%7D%7D%7B2%7D"> = <img src="https://latex.codecogs.com/png.latex?-ln(MLR)"></p>
<hr>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">support <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (zscore<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb28-2"></span>
<span id="cb28-3">likfunction <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(hrvalues, zscore, support)</span>
<span id="cb28-4"></span>
<span id="cb28-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> likfunction, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> hrvalues, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> support)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>,</span>
<span id="cb28-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> hrvalues, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> support,</span>
<span id="cb28-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(support)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log-Likelihood Function"</span>,</span>
<span id="cb28-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log-likelihoods for a range of hazard ratios"</span>,</span>
<span id="cb28-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio (HR)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ln(MLR)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>),</span>
<span id="cb28-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pretty_breaks</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0125</span>)),</span>
<span id="cb28-13">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-29-1.svg" data-fig-align="center" width="672"></p>
<hr>
</section>
<section id="figure-s2-deviance-function-2lnmlr" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="figure-s2-deviance-function-2lnmlr"><span class="header-section-number">1.9</span> Figure S2: Deviance Function <img src="https://latex.codecogs.com/png.latex?2ln(MLR)"></h2>
<hr>
<p>Known as the deviance function, it is twice the log-likelihood, which maps to the <img src="https://latex.codecogs.com/png.latex?S">-value function.</p>
<hr>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">support <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (zscore<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb29-2"></span>
<span id="cb29-3">likfunction <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(hrvalues, zscore, support)</span>
<span id="cb29-4"></span>
<span id="cb29-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> likfunction, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> hrvalues, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> support)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>,</span>
<span id="cb29-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.84</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#333333"</span>,</span>
<span id="cb29-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> hrvalues, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> support,</span>
<span id="cb29-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(support)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb29-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.65</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1/6.83 LI = 0.997, 2.59"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb29-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#000000"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb29-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb29-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pretty_breaks</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>,</span>
<span id="cb29-15">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0125</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Deviance Function"</span>,</span>
<span id="cb29-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Deviance statistics for a range of hazard ratios"</span>,</span>
<span id="cb29-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio (HR)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Deviance Statistic </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2ln(MLR)"</span>)</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-30-1.svg" data-fig-align="center" width="672"></p>
<hr>
<p>And the version from our paper can be found <a href="https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM4_ESM.pdf">here</a>.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1602200052/Site/deviancefunction.png" width="750"></p>
<hr>
<p>It is important to note that although we have calculated these likelihood functions manually here, they can also be generated easily using the <a href="https://data.lesslikely.com/concurve/reference/curve_lik.html"><code>curve_lik()</code></a> function which takes inputs from the <a href="https://cran.r-project.org/package=ProfileLikelihood"><code>ProfileLikelihood</code></a> <code>R</code> package. To see a further discussion, please see the <a href="https://data.lesslikely.com/concurve/articles/likelihood.html">following article</a>, which gives several examples for a wide variety of models.</p>
<p>Further, we urge some caution. Although we endorse the construction and presentation of likelihood functions along with <img src="https://latex.codecogs.com/png.latex?P">-value and <img src="https://latex.codecogs.com/png.latex?S">-value functions, along with the tabulations, the use of pure likelihood methods has been highly controversial among some statisticians, with some going as far as to say that <em>likelihood is blind</em> although not all statisticians believe this, and have responded to such criticisms in kind, see discussants.<span class="citation" data-cites="daviesApproximatingDataDiscussion2008"><sup>19</sup></span> Thus, we support providing both <img src="https://latex.codecogs.com/png.latex?P">-value/<img src="https://latex.codecogs.com/png.latex?S">-value and likelihood-based functions for a complete picture.</p>
<p>Indeed, we can see how they all easily map to one another when plotted side by side, with the following script.</p>
<hr>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cowplot"</span>)</span>
<span id="cb30-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_grid</span>(confcurve, surprisalcurve, relsupportfunction, deviancefunction,</span>
<span id="cb30-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<hr>
<p>A clearer plot comparing the four functions is seen below (click on the image to view in full).</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1581988661/Site/Comparisons.png" width="1000" style="cursor: zoom-in"></p>
<hr>
<p>Additional adjustments that were made to the figures from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland, 2020</a><span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>1</sup></span> were done using Adobe Illustrator and Photoshop.</p>
<p>All errors are ours, and we welcome critical feedback and reporting of errors. To report possible errors in our analyses, please post it as a comment below or as a bug <a href="https://github.com/zadrafi/concurve/issues">here</a>. We will compile them onto a public errata, if any errors or flaws are reported to us.</p>
<hr>
</section>
</section>
<section id="statistical-package-citations" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Statistical Package Citations</h1>
<hr>
<p>Please remember to cite the <code>R</code> packages if you use any of the <code>R</code> scripts from above. The citation for our [<span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>1</sup></span>] can be found below in the References section or it can be <a href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/s12874-020-01105-9.ris">downloaded here</a> for a reference manager.</p>
<hr>
<div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"concurve"</span>)</span>
<span id="cb31-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TeachingDemos"</span>)</span>
<span id="cb31-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ProfileLikelihood"</span>)</span>
<span id="cb31-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rstan"</span>)</span>
<span id="cb31-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rstanarm"</span>)</span>
<span id="cb31-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bayesplot"</span>)</span>
<span id="cb31-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"knitr"</span>)</span>
<span id="cb31-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kableExtra"</span>)</span>
<span id="cb31-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggplot2"</span>)</span>
<span id="cb31-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cowplot"</span>)</span>
<span id="cb31-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Statamarkdown"</span>)</span></code></pre></div>
<hr>
</section>
<section id="environment" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Environment</h1>
<hr>
<p>The analyses were run on:</p>
<hr>
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1">si <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sessionInfo</span>()</span>
<span id="cb32-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(si, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">RNG =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locale =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb32-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; R version 4.5.0 (2025-04-11)</span></span>
<span id="cb32-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span id="cb32-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span id="cb32-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb32-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Matrix products: default</span></span>
<span id="cb32-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span id="cb32-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span id="cb32-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb32-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Random number generation:</span></span>
<span id="cb32-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  RNG:     L'Ecuyer-CMRG </span></span>
<span id="cb32-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  Normal:  Inversion </span></span>
<span id="cb32-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  Sample:  Rejection </span></span>
<span id="cb32-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  </span></span>
<span id="cb32-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; locale:</span></span>
<span id="cb32-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span id="cb32-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb32-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; time zone: America/New_York</span></span>
<span id="cb32-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; tzcode source: internal</span></span>
<span id="cb32-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb32-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; attached base packages:</span></span>
<span id="cb32-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [1] splines   grid      stats4    parallel  stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span id="cb32-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb32-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; other attached packages:</span></span>
<span id="cb32-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   [1] TeachingDemos_2.13    plotly_4.10.4         TSstudio_0.1.7        tfautograph_0.3.2     tfdatasets_2.17.0    </span></span>
<span id="cb32-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   [6] keras_2.15.0          tensorflow_2.16.0     timetk_2.9.0          modeltime_1.3.1       workflowsets_1.1.1   </span></span>
<span id="cb32-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [11] workflows_1.2.0       tune_1.3.0            rsample_1.3.0         recipes_1.3.1         parsnip_1.3.2        </span></span>
<span id="cb32-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [16] modeldata_1.4.0       infer_1.0.8           dials_1.4.0           scales_1.4.0          tidymodels_1.3.0     </span></span>
<span id="cb32-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [21] xgboost_1.7.11.1      prophet_1.0           rlang_1.1.6           astsa_2.2             bayesforecast_1.0.5  </span></span>
<span id="cb32-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [26] smooth_4.2.0          greybox_2.0.4         glmnet_4.1-9          forecast_8.24.0       fable_0.4.1          </span></span>
<span id="cb32-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [31] fabletools_0.5.0      tsibbledata_0.4.1     tsibble_1.1.6         rstanarm_2.32.1       texPreview_2.1.0     </span></span>
<span id="cb32-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [36] tinytex_0.57          rmarkdown_2.29        brms_2.22.0           bootImpute_1.2.2      knitr_1.50           </span></span>
<span id="cb32-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [41] boot_1.3-31           JuliaCall_0.17.6      reshape2_1.4.4        ProfileLikelihood_1.3 ImputeRobust_1.3-1   </span></span>
<span id="cb32-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [46] gamlss_5.4-22         gamlss.dist_6.1-1     gamlss.data_6.0-6     mvtnorm_1.3-3         performance_0.14.0   </span></span>
<span id="cb32-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [51] summarytools_1.1.4    tidybayes_3.0.7       htmltools_0.5.8.1     Statamarkdown_0.9.2   car_3.1-3            </span></span>
<span id="cb32-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [56] carData_3.0-5         qqplotr_0.0.6         ggcorrplot_0.1.4.1    mitml_0.4-5           pbmcapply_1.5.1      </span></span>
<span id="cb32-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [61] Amelia_1.8.3          Rcpp_1.0.14           blogdown_1.21         doParallel_1.0.17     iterators_1.0.14     </span></span>
<span id="cb32-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [66] foreach_1.5.2         lattice_0.22-7        bayesplot_1.12.0      wesanderson_0.3.7     VIM_6.2.2            </span></span>
<span id="cb32-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [71] colorspace_2.1-1      here_1.0.1            progress_1.2.3        loo_2.8.0             mi_1.1               </span></span>
<span id="cb32-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [76] Matrix_1.7-3          broom_1.0.8           yardstick_1.3.2       svglite_2.2.1         Cairo_1.6-2          </span></span>
<span id="cb32-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [81] cowplot_1.1.3         mgcv_1.9-3            nlme_3.1-168          xfun_0.52             broom.mixed_0.2.9.6  </span></span>
<span id="cb32-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [86] reticulate_1.42.0     kableExtra_1.4.0      posterior_1.6.1       checkmate_2.3.2       parallelly_1.45.0    </span></span>
<span id="cb32-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [91] miceFast_0.8.5        randomForest_4.7-1.2  missForest_1.5        miceadds_3.17-44      quantreg_6.1         </span></span>
<span id="cb32-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [96] SparseM_1.84-2        MCMCpack_1.7-1        MASS_7.3-65           coda_0.19-4.1         latex2exp_0.9.6      </span></span>
<span id="cb32-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 23 entries ]</span></span>
<span id="cb32-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb32-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; loaded via a namespace (and not attached):</span></span>
<span id="cb32-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   [1] igraph_2.1.4         Formula_1.2-5        rematch2_2.1.2       GPfit_1.0-9          tidyselect_1.2.1    </span></span>
<span id="cb32-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   [6] bridgesampling_1.1-2 rngtools_1.5.2       dichromat_2.0-0.1    png_0.1-8            cli_3.6.5           </span></span>
<span id="cb32-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [11] arrayhelpers_1.1-0   askpass_1.2.1        openssl_2.3.3        textshaping_1.0.1    officer_0.6.10      </span></span>
<span id="cb32-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [16] lhs_1.2.0            curl_6.2.3           mime_0.13            evaluate_1.0.3       V8_6.0.4            </span></span>
<span id="cb32-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [21] stringi_1.8.7        backports_1.5.0      desc_1.4.3           qqconf_1.3.2         httpuv_1.6.16       </span></span>
<span id="cb32-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [26] rappdirs_0.3.3       details_0.4.0        prodlim_2025.04.28   KMsurv_0.1-6         doRNG_1.8.6.2       </span></span>
<span id="cb32-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [31] survminer_0.5.0      DT_0.33              DBI_1.2.3            withr_3.0.2          tfruns_1.5.3        </span></span>
<span id="cb32-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [36] reformulas_0.4.1     tseries_0.10-58      class_7.3-23         systemfonts_1.2.3    rprojroot_2.0.4     </span></span>
<span id="cb32-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [41] lmtest_0.9-40        formatR_1.14         colourpicker_1.3.0   htmlwidgets_1.6.4    fs_1.6.6            </span></span>
<span id="cb32-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [46] labeling_0.4.3       ranger_0.17.0        DEoptimR_1.1-3-1     zoo_1.8-14           itertools_0.1-3     </span></span>
<span id="cb32-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [51] svUnit_1.0.6         timechange_0.3.0     caTools_1.18.3       extremevalues_2.4.1  data.table_1.17.4   </span></span>
<span id="cb32-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [56] timeDate_4041.110    pan_1.9              clipr_0.8.0          ellipsis_0.3.2       lazyeval_0.2.2      </span></span>
<span id="cb32-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [61] yaml_2.3.10          survival_3.8-3       crayon_1.5.3         tensorA_0.36.2.1     RColorBrewer_1.1-3  </span></span>
<span id="cb32-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [66] later_1.4.2          codetools_0.2-20     base64enc_0.1-3      shape_1.4.6.1        estimability_1.5.1  </span></span>
<span id="cb32-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [71] gdtools_0.4.2        DiceDesign_1.10      foreign_0.8-90       pkgconfig_2.0.3      xml2_1.3.8          </span></span>
<span id="cb32-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [76] mathjaxr_1.8-0       ggpubr_0.6.0         viridisLite_0.4.2    xtable_1.8-4         plyr_1.8.9          </span></span>
<span id="cb32-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [81] httr_1.4.7           rbibutils_2.3        tools_4.5.0          globals_0.18.0       hardhat_1.4.1       </span></span>
<span id="cb32-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [86] pkgbuild_1.4.8       htmlTable_2.4.3      survMisc_0.5.6       shinyjs_2.1.0        crosstalk_1.2.1     </span></span>
<span id="cb32-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [91] twosamples_2.0.1     MatrixModels_0.5-4   lme4_1.1-37          digest_0.6.37        numDeriv_2016.8-1.1 </span></span>
<span id="cb32-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [96] furrr_0.3.1          farver_2.1.2         tzdb_0.5.0           rapportools_1.2      rpart_4.1.24        </span></span>
<span id="cb32-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 90 entries ]</span></span></code></pre></div>
<hr>
</section>
<section id="stata" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Stata</h1>
<hr>
<div class="sourceCode" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb33-1">about</span>
<span id="cb33-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">version</span></span>
<span id="cb33-3">#&gt; Stata/BE 17.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> Mac (Apple Silicon)</span>
<span id="cb33-4">#&gt; Revision 21 May 2024</span>
<span id="cb33-5">#&gt; Copyright 1985-2021 StataCorp LLC</span>
<span id="cb33-6">#&gt; </span>
<span id="cb33-7">#&gt; Total physical <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">memory</span>: 24.00 GB</span>
<span id="cb33-8">#&gt; </span>
<span id="cb33-9">#&gt; Stata license: Single-user  perpetual</span>
<span id="cb33-10">#&gt; Serial number: 301706317553</span>
<span id="cb33-11">#&gt;   Licensed to: Zad Rafi</span>
<span id="cb33-12">#&gt;                AMG</span>
<span id="cb33-13">#&gt; </span>
<span id="cb33-14">#&gt; <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">version</span> 17.0</span></code></pre></div>
<section id="section" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="section"><span class="header-section-number">4.1</span> ————————————————————————</h2>
</section>
</section>
<section id="references" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> References</h1>
<hr>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="2" data-line-spacing="2">
<div id="ref-rafiSemanticCognitiveTools2020" class="csl-entry">
1. Rafi Z, Greenland S. (2020). <span>“Semantic and cognitive tools to aid statistical science: Replace confidence and significance by compatibility and surprise.”</span> <em>BMC Medical Research Methodology</em>. <strong>20</strong>:244. doi: <a href="https://doi.org/10.1186/s12874-020-01105-9">10.1186/s12874-020-01105-9</a>.
</div>
<div id="ref-greenlandTechnicalIssuesInterpretation2020" class="csl-entry">
2. Greenland S, Rafi Z. (2020). <span>“Technical <span>Issues</span> in the <span>Interpretation</span> of <span>S</span>-values and <span>Their Relation</span> to <span>Other Information Measures</span>.”</span> <em>arXiv:200812991 [statME]</em>. <a href="https://arxiv.org/abs/2008.12991">https://arxiv.org/abs/2008.12991</a>.
</div>
<div id="ref-greenlandValidPvaluesBehave2019" class="csl-entry">
3. Greenland S. (2019). <span>“Valid <span>P</span>-values behave exactly as they should: <span>Some</span> misleading criticisms of <span>P</span>-values and their resolution with <span>S</span>-values.”</span> <em>The American Statistician</em>. <strong>73</strong>:106–114. doi: <a href="https://doi.org/10.1080/00031305.2018.1529625">10.1080/00031305.2018.1529625</a>.
</div>
<div id="ref-bayarriValuesCompositeNull2000" class="csl-entry">
4. Bayarri MJ, Berger JO. (2000). <span>“P <span>Values</span> for <span>Composite Null Models</span>.”</span> <em>Journal of the American Statistical Association</em>. <strong>95</strong>:1127–1142. doi: <a href="https://doi.org/10/dpvq8c">10/dpvq8c</a>.
</div>
<div id="ref-robinsAsymptoticDistributionValues2000" class="csl-entry">
5. Robins JM, van der Vaart A, Ventura V. (2000). <span>“Asymptotic <span>Distribution</span> of <span>P Values</span> in <span>Composite Null Models</span>.”</span> <em>Journal of the American Statistical Association</em>. <strong>95</strong>:1143–1156. doi: <a href="https://doi.org/10/gg7krv">10/gg7krv</a>.
</div>
<div id="ref-kuffnerWhyArePvalues2019" class="csl-entry">
6. Kuffner TA, Walker SG. (2019). <span>“Why are <span>P</span>-values controversial?”</span> <em>The American Statistician</em>. <strong>73</strong>:1–3. doi: <a href="https://doi.org/10.1080/00031305.2016.1277161">10.1080/00031305.2016.1277161</a>.
</div>
<div id="ref-cousinsJeffreysLindleyParadox2017" class="csl-entry">
7. Cousins RD. (2017). <span>“The <span>Jeffreys</span> paradox and discovery criteria in high energy physics.”</span> <em>Synthese</em>. <strong>194</strong>:395–432. doi: <a href="https://doi.org/10.1007/s11229-014-0525-z">10.1007/s11229-014-0525-z</a>.
</div>
<div id="ref-coxChapterIntervalEstimation1974" class="csl-entry">
8. Cox DR, Hinkley DV. (1974). <span>“Chapter 7, <span>Interval</span> estimation.”</span> In: Theoretical <span>Statistics</span>. <span>Chapman and Hall/CRC</span>. p. 207–249. doi: <a href="https://doi.org/10.1201/b14832">10.1201/b14832</a>.
</div>
<div id="ref-bowleyDiscussionDrNeyman1934" class="csl-entry">
9. Bowley AL. (1934). <span>“Discussion on <span>Dr</span>. <span>Neyman</span>’s <span>Paper</span>. <span>P</span>. 607 in: <span>Neyman J</span>. <span>On</span> the two different aspects of the representative method: <span>The</span> method of stratified sampling and the method of purposive selection (with discussion).”</span> <em>Journal of the Royal Statistical Society</em>. <strong>4</strong>:558–625. doi: <a href="https://doi.org/10.2307/2342192">10.2307/2342192</a>.
</div>
<div id="ref-coxPrinciplesStatisticalInference2006" class="csl-entry">
10. Cox DR. (2006). <span>“Principles of <span>Statistical Inference</span>.”</span> <span>Cambridge University Press</span>.
</div>
<div id="ref-amrheinInferentialStatisticsDescriptive2019" class="csl-entry">
11. Amrhein V, Trafimow D, Greenland S. (2019). <span>“Inferential statistics as descriptive statistics: <span>There</span> is no replication crisis if we don’t expect replication.”</span> <em>The American Statistician</em>. <strong>73</strong>:262–270. doi: <a href="https://doi.org/10.1080/00031305.2018.1543137">10.1080/00031305.2018.1543137</a>.
</div>
<div id="ref-greenlandStatisticalTestsValues2016" class="csl-entry">
12. Greenland S, Senn SJ, Rothman KJ, Carlin JB, Poole C, Goodman SN, et al. (2016). <span>“Statistical tests, <span>P</span> values, confidence intervals, and power: <span>A</span> guide to misinterpretations.”</span> <em>European Journal of Epidemiology</em>. <strong>31</strong>:337–350. doi: <a href="https://doi.org/10.1007/s10654-016-0149-3">10.1007/s10654-016-0149-3</a>.
</div>
<div id="ref-greenlandAreConfidenceIntervals2019" class="csl-entry">
13. Greenland S. (2019). <span>“Are confidence intervals better termed <span>‘uncertainty intervals’</span>? <span>No</span>: <span>Call</span> them compatibility intervals.”</span> <em>BMJ</em>. <strong>366</strong>. doi: <a href="https://doi.org/10.1136/bmj.l5381">10.1136/bmj.l5381</a>.
</div>
<div id="ref-greenlandAidScientificInference2020" class="csl-entry">
14. Greenland S, Rafi Z. (2020). <span>“To <span>Aid Scientific Inference</span>, <span>Emphasize Unconditional Descriptions</span> of <span>Statistics</span>.”</span> <em>arXiv:190908583 [statME]</em>. <a href="https://arxiv.org/abs/1909.08583">https://arxiv.org/abs/1909.08583</a>.
</div>
<div id="ref-brownAssociationSerotonergicAntidepressant2017" class="csl-entry">
15. Brown HK, Ray JG, Wilton AS, Lunsky Y, Gomes T, Vigod SN. (2017). <span>“Association between serotonergic antidepressant use during pregnancy and autism spectrum disorder in children.”</span> <em>Journal of the American Medical Association</em>. <strong>317</strong>:1544–1552. doi: <a href="https://doi.org/10.1001/jama.2017.3415">10.1001/jama.2017.3415</a>.
</div>
<div id="ref-brownAssociationAntenatalExposure2017" class="csl-entry">
16. Brown HK, Hussain-Shamsy N, Lunsky Y, Dennis C-LE, Vigod SN. (2017). <span>“The association between antenatal exposure to selective serotonin reuptake inhibitors and autism: <span>A</span> systematic review and meta-analysis.”</span> <em>The Journal of Clinical Psychiatry</em>. <strong>78</strong>:e48–e58. doi: <a href="https://doi.org/10.4088/JCP.15r10194">10.4088/JCP.15r10194</a>.
</div>
<div id="ref-jewellStatisticsEpidemiology2003" class="csl-entry">
17. Jewell NP. (2003). <span>“Statistics for <span>Epidemiology</span>.”</span> <span>CRC Press</span>.
</div>
<div id="ref-royallStatisticalEvidenceLikelihood1997" class="csl-entry">
18. Royall R. (1997). <span>“Statistical <span>Evidence</span>: <span>A Likelihood Paradigm</span>.”</span> <span>CRC Press</span>.
</div>
<div id="ref-daviesApproximatingDataDiscussion2008" class="csl-entry">
19. Davies PL. (2008). <span>“Approximating data [with discussion and a rejoinder].”</span> <em>Journal of the Korean Statistical Society</em>. <strong>37</strong>:191–211. doi: <a href="https://doi.org/10/bn8cgk">10/bn8cgk</a>.
</div>
</div></section></div> ]]></description>
  <guid>https://lesslikely.com/posts/statistics/RG2020BMC.html</guid>
  <pubDate>Sat, 12 Dec 2020 05:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/v1602038429/Site/confidencecurve.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Tables, Graphs, and Computations from Rafi &amp; Greenland (2020)</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/RG2020BMC.html</link>
  <description><![CDATA[ 





<script src="RG2020BMC_files/libs/kePrint-0.0.1/kePrint.js"></script>
<p><link href="RG2020BMC_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet"></p>
<center>
<img src="https://res.cloudinary.com/less-likely/image/upload/v1602038429/Site/confidencecurve.svg" width="100" style="cursor: zoom-in" align="right">
</center>
<hr>
<p>The following post provides <em>some</em> of the code that was used to construct the figures and tables from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland, 2020</a><span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>1</sup></span>. An enhanced PDF version of the paper can be <a href="https://rdcu.be/b789P">found here</a>. For further discussion of the computations, see the appendix of the <a href="https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM1_ESM.pdf">main paper</a>, along with our <a href="https://arxiv.org/pdf/2008.12991.pdf">technical supplement</a>.<span class="citation" data-cites="greenlandTechnicalIssuesInterpretation2020"><sup>2</sup></span></p>
<hr>
<blockquote class="blockquote">
<p><strong>Disclaimer:</strong> I am responsible for all the code and mistakes below, and none of them can be attributed to my coauthors or my fellow package developers.</p>
</blockquote>
<hr>
<p>In order to recreate the functions, I would recommend installing the latest version of <a href="https://data.lesslikely.com/concurve/"><code>concurve</code></a> from <a href="https://cran.r-project.org/package=concurve">CRAN</a>, as it has patched some issues with graphing when the outcome is binary. Use the script below to get the latest version and load the <code>R</code> package. A number of other <code>R</code> packages are also used in this post, which are listed below.</p>
<hr>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"concurve"</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"concurve"</span>)</span></code></pre></div>
<hr>
<section id="valid-p-values-are-uniform-under-the-null-model" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="valid-p-values-are-uniform-under-the-null-model"><span class="header-section-number">0.1</span> Valid <img src="https://latex.codecogs.com/png.latex?P">-values Are Uniform Under the Null Model</h2>
<hr>
<p>Here we show that valid <img src="https://latex.codecogs.com/png.latex?P">-values have specific properties, when the null model is true. We first generate two variables (<img src="https://latex.codecogs.com/png.latex?Y">, <img src="https://latex.codecogs.com/png.latex?X">) that come from the same normal distribution with a <img src="https://latex.codecogs.com/png.latex?%5Cmu"> of 0 and <img src="https://latex.codecogs.com/png.latex?%5Csigma"> of 1, each with a total of <code>1000</code> observations. We assume that there is no relationship between these two variables. We run a simple t-test between <img src="https://latex.codecogs.com/png.latex?Y"> and <img src="https://latex.codecogs.com/png.latex?X"> and iterate this <code>100000</code> times and compute <code>100000</code> <img src="https://latex.codecogs.com/png.latex?P">-values to see the overall distribution of the <img src="https://latex.codecogs.com/png.latex?P">-values, which we then plot using a histogram./</p>
<hr>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb2-2">set.seed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span></span>
<span id="cb2-3">n.sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb2-4">t.sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n.sim)</span>
<span id="cb2-5">n.samp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n.sim) {</span>
<span id="cb2-8">    X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-9">    Y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-10">    df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(X, Y)</span>
<span id="cb2-11">    t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t.test</span>(X, Y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df)</span>
<span id="cb2-12">    t.sim[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> t[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]]</span>
<span id="cb2-13">}</span>
<span id="cb2-14"></span>
<span id="cb2-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> t.sim)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb2-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#99c7c7"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of P-values Under the Null"</span>,</span>
<span id="cb2-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P-value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-4-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>This can also be shown using the <a href="https://cran.r-project.org/package=TeachingDemos"><code>TeachingDemos</code></a> <code>R</code> package, which has a function dedicated to showing this phenomenon.</p>
<hr>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TeachingDemos"</span>)</span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Attaching package: 'TeachingDemos'</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; The following object is masked from 'package:plotly':</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;     subplot</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; The following objects are masked from 'package:Hmisc':</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;     cnvrt.coords, subplot</span></span>
<span id="cb3-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb3-11">set.seed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span></span>
<span id="cb3-12">obs_p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Pvalue.norm.sim</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mu =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mu0 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma0 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alternative =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"two.sided"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>,</span>
<span id="cb3-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">B =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e+05</span>)</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-5-1.svg" data-fig-align="center" width="768"></p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> obs_p)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb4-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#99c7c7"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of P-values Under the Null"</span>,</span>
<span id="cb4-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P-value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-5-2.svg" data-fig-align="center" width="768"></p>
<hr>
<p>As you can see, when the null model is true, the distribution of <img src="https://latex.codecogs.com/png.latex?P">-values is uniform. Valid <img src="https://latex.codecogs.com/png.latex?P">-values are uniform under the null hypothesis and their corresponding <img src="https://latex.codecogs.com/png.latex?S">-values are exponentially distributed. We run the same simulation as before, but then convert the obtained <img src="https://latex.codecogs.com/png.latex?P">-values into <img src="https://latex.codecogs.com/png.latex?S">-values, to see how they are distributed.</p>
<hr>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb5-2">set.seed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span></span>
<span id="cb5-3">n.sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb5-4">t.sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n.sim)</span>
<span id="cb5-5">n.samp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n.sim) {</span>
<span id="cb5-8">    X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-9">    Y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-10">    df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(X, Y)</span>
<span id="cb5-11">    t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t.test</span>(X, Y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df)</span>
<span id="cb5-12">    t.sim[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> t[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]]</span>
<span id="cb5-13">}</span>
<span id="cb5-14"></span>
<span id="cb5-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log2</span>(t.sim))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,</span>
<span id="cb5-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of S-values Under the Null"</span>,</span>
<span id="cb5-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S-value (Bits of Information)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-6-1.svg" data-fig-align="center" width="768"></p>
<hr>
</section>
<section id="posterior-predictive-p-values" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="posterior-predictive-p-values"><span class="header-section-number">0.2</span> Posterior Predictive <img src="https://latex.codecogs.com/png.latex?P">-values</h2>
<hr>
<p>Despite the name, posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values are not considered valid frequentist <img src="https://latex.codecogs.com/png.latex?P">-values because they do not meet the uniformity criterion, instead they are pulled towards the parameter value <code>0.5</code>. For further discussion, see our <a href="https://arxiv.org/pdf/2008.12991.pdf">technical supplement</a> along with <a href="https://doi.org/10.1080/00031305.2018.1529625">Greenland (2019)</a> for comprehensive theoretical discussions.[<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup>3</sup></span>;<span class="citation" data-cites="greenlandTechnicalIssuesInterpretation2020"><sup>2</sup></span>]</p>
<p>A quick excerpt from our main paper and the technical supplement explains why this is not the case,</p>
<hr>
<blockquote class="blockquote">
<p>As discussed in the Supplement, in Bayesian settings one may see certain <img src="https://latex.codecogs.com/png.latex?P">-values that are not valid frequentist <img src="https://latex.codecogs.com/png.latex?P">-values, the primary example being the posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-value<span class="citation" data-cites="bayarriValuesCompositeNull2000"><sup>4</sup></span>;<span class="citation" data-cites="robinsAsymptoticDistributionValues2000"><sup>5</sup></span>; unfortunately, the negative logs of such invalid <img src="https://latex.codecogs.com/png.latex?P">-values do not measure surprisal at the statistic given the model, and so are not valid <img src="https://latex.codecogs.com/png.latex?S">-values.</p>
<p>The decision rule “reject <strong>H</strong> if <img src="https://latex.codecogs.com/png.latex?p%5Cleq"> <img src="https://latex.codecogs.com/png.latex?%5Calpha">” will reject <strong>H</strong> 100<img src="https://latex.codecogs.com/png.latex?%5Calpha">% of the time under sampling from a model <strong>M</strong> obeying <strong>H</strong> (i.e., the Type-1 error rate of the test will be <img src="https://latex.codecogs.com/png.latex?%5Calpha">) provided the random variable <img src="https://latex.codecogs.com/png.latex?P"> corresponding to <img src="https://latex.codecogs.com/png.latex?p"> is valid (uniform under the model <strong>M</strong> used to compute it), but not necessarily otherwise[<span class="citation" data-cites="kuffnerWhyArePvalues2019"><sup>6</sup></span>]. This is one reason why frequentist writers reject invalid <img src="https://latex.codecogs.com/png.latex?P">-values (such as posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values, which highly concentrate around 0.50) and devote considerable technical coverage to uniform <img src="https://latex.codecogs.com/png.latex?P">-values<span class="citation" data-cites="kuffnerWhyArePvalues2019"><sup>6</sup></span>;<span class="citation" data-cites="robinsAsymptoticDistributionValues2000"><sup>5</sup></span>;<span class="citation" data-cites="bayarriValuesCompositeNull2000"><sup>4</sup></span>. A valid <img src="https://latex.codecogs.com/png.latex?P">-value (“U-value”) translates into an exponentially distributed <img src="https://latex.codecogs.com/png.latex?S">-value with a mean of 1 nat or <img src="https://latex.codecogs.com/png.latex?%5Clog_%7B2%7D(e)=1.443"> bits where <img src="https://latex.codecogs.com/png.latex?e"> is the base of the natural logs.</p>
<p>Uniformity is also central to the “refutational information” interpretation of the <img src="https://latex.codecogs.com/png.latex?S">-value used here, for it is necessary to ensure that the <img src="https://latex.codecogs.com/png.latex?P">-value <img src="https://latex.codecogs.com/png.latex?p"> from which <img src="https://latex.codecogs.com/png.latex?s"> is derived is in fact the percentile of the observed value of the test statistic in the distribution of the statistic under <strong>M</strong>, thus making small <img src="https://latex.codecogs.com/png.latex?p"> surprising under <strong>M</strong> and making <img src="https://latex.codecogs.com/png.latex?s"> the corresponding degree of surprise. Because posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values do not translate into sampling percentiles of the statistic under the hypothesis (in fact, they are pulled toward 0.5 from the correct percentiles)<span class="citation" data-cites="robinsAsymptoticDistributionValues2000"><sup>5</sup></span>;<span class="citation" data-cites="bayarriValuesCompositeNull2000"><sup>4</sup></span>, the resulting negative log does not measure surprisal at the statistic given <strong>M</strong>, and so is not a valid <img src="https://latex.codecogs.com/png.latex?S">-value in our terms.</p>
</blockquote>
<hr>
<p>And indeed, we can show this phenomenon below with simulations. Here we fit a simple Bayesian regression model with a weakly informative prior <code>normal(0, 10)</code> using <a href="https://mc-stan.org/rstanarm"><code>rstanarm</code></a>, where both the predictor and response variable come from the same distribution and have the same location and scale parameters (<img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%200">, <img src="https://latex.codecogs.com/png.latex?%5Csigma%20=%201">. We then calculate the observed test statistics, along with their distributions, and convert them into posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values and plot them using <a href="https://mc-stan.org/bayesplot"><code>Bayesplot</code></a> functions. Then, we iterate this <code>1000</code> times to examine the distribution of posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values and compare them to standard <img src="https://latex.codecogs.com/png.latex?P">-values that are known to be uniform.</p>
<p>But first, we’ll generate the distribution of the test statistic from one model.</p>
<hr>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bayesplot"</span>)</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rstan"</span>)</span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rstanarm"</span>)</span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rstan_options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">auto_write =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb6-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mc.cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb6-6">teal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#99c7c7"</span>)</span>
<span id="cb6-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">color_scheme_set</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"teal"</span>)</span>
<span id="cb6-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb6-9">n.samp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb6-10">X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-11">Y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-12">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(X, Y)</span>
<span id="cb6-13">mod1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stan_glm</span>(Y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> X, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chains =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">refresh =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb6-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in if (!prior_dist_name %in% unlist(ok_dists)) {: argument is of length zero</span></span>
<span id="cb6-16">yrep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">posterior_predict</span>(mod1)</span>
<span id="cb6-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error: object 'mod1' not found</span></span>
<span id="cb6-18"></span>
<span id="cb6-19">h <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ppc_stat</span>(Y, yrep, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"median"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Posterior Test Statistic"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">yaxis_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">on =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb6-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error: object 'yrep' not found</span></span>
<span id="cb6-23"></span>
<span id="cb6-24">values_all <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> h[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_env"</span>]][[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T_yrep"</span>]]</span>
<span id="cb6-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error: object 'h' not found</span></span>
<span id="cb6-26">prob_to_find <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> h[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_env"</span>]][[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T_y"</span>]]</span>
<span id="cb6-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error: object 'h' not found</span></span>
<span id="cb6-28">quantInv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(distr, value) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ecdf</span>(distr)(value)</span>
<span id="cb6-29">posterior_p_value <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantInv</span>(values_all, prob_to_find)</span>
<span id="cb6-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error: object 'values_all' not found</span></span>
<span id="cb6-31"></span>
<span id="cb6-32">l <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ppc_stat_2d</span>(Y, yrep) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Posterior Test Statistic"</span>)</span>
<span id="cb6-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error: object 'yrep' not found</span></span>
<span id="cb6-34"></span>
<span id="cb6-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(h)</span>
<span id="cb6-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'h' not found</span></span>
<span id="cb6-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(l)</span>
<span id="cb6-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'l' not found</span></span></code></pre></div>
<hr>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(prob_to_find)</span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'print': object 'prob_to_find' not found</span></span></code></pre></div>
<hr>
<p>The above is the posterior predictive test statistic for one model, along with it’s distribution. Now let’s iterate this process, convert them into posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values, and generate their distribution.</p>
<hr>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rstan_options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">auto_write =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mc.cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb8-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb8-4">set.seed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span></span>
<span id="cb8-5">n.sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb8-6">ppp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n.sim)</span>
<span id="cb8-7">n.samp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb8-8"></span>
<span id="cb8-9">quantInv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(distr, value) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ecdf</span>(distr)(value)</span>
<span id="cb8-10"></span>
<span id="cb8-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(ppp)) {</span>
<span id="cb8-12">    X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb8-13">    Y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb8-14">    df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(X, Y)</span>
<span id="cb8-15">    mod1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stan_glm</span>(Y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> X, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chains =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb8-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">refresh =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb8-17">    yrep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">posterior_predict</span>(mod1)</span>
<span id="cb8-18">    h <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ppc_stat</span>(Y, yrep, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"median"</span>)</span>
<span id="cb8-19">    values_all <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> h[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_env"</span>]][[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T_yrep"</span>]]</span>
<span id="cb8-20">    prob_to_find <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> h[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_env"</span>]][[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T_y"</span>]]</span>
<span id="cb8-21">    posterior_p_value <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantInv</span>(values_all, prob_to_find)</span>
<span id="cb8-22">    ppp[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> posterior_p_value</span>
<span id="cb8-23">}</span>
<span id="cb8-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in if (!prior_dist_name %in% unlist(ok_dists)) {: argument is of length zero</span></span>
<span id="cb8-25"></span>
<span id="cb8-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ppp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb8-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#99c7c7"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Posterior Predictive P-values"</span>,</span>
<span id="cb8-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"From Simulation of 1000 Simple Linear Regressions"</span>,</span>
<span id="cb8-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Posterior Predictive P-value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb8-30">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-8-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>We can also show this in <code>Stata 16.1</code>, using their new <code>bayesstats ppvalues</code> command which generates posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values.</p>
<hr>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb9-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">version</span> 16.1</span>
<span id="cb9-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">set</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">obs</span> 100</span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">Generate variables from a normal distribution like before</span></span>
<span id="cb9-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*/</span></span>
<span id="cb9-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">generate</span> x = rnormal(0, 1)</span>
<span id="cb9-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">generate</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span> = rnormal(0, 1)</span>
<span id="cb9-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">We set up our model here </span></span>
<span id="cb9-10"></span>
<span id="cb9-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*/</span></span>
<span id="cb9-12">parallel initialize 8, f</span>
<span id="cb9-13">bayesmh <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span> x, likelihood(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>({<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>})) prior({<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>}, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(0, 10)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">///</span></span>
<span id="cb9-14">prior({<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>:}, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(0, 10)) rseed(1031) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">saving</span>(coutput_pred, <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">replace</span>) mcmcsize(1000)</span>
<span id="cb9-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">We use the bayespredict command to make predictions from the model</span></span>
<span id="cb9-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*/</span></span>
<span id="cb9-18">bayespredict (<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">mean</span>:@mean({_resid})) (<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>:@variance({_resid})), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">///</span></span>
<span id="cb9-19">rseed(1031) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">saving</span>(coutput_pred, <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">replace</span>) </span>
<span id="cb9-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">Then we calculate the posterior predictive P-values</span></span>
<span id="cb9-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*/</span></span>
<span id="cb9-23">bayesstats ppvalues {<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">mean</span>} <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">using</span> coutput_pred</span>
<span id="cb9-24">#&gt; . <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">version</span> 16.1</span>
<span id="cb9-25">#&gt; </span>
<span id="cb9-26">#&gt; . <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">set</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">obs</span> 100</span>
<span id="cb9-27">#&gt; Number <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">of</span> observations (_N) was 0, now 100.</span>
<span id="cb9-28">#&gt; </span>
<span id="cb9-29">#&gt; . <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; Generate variables from a normal distribution like before</span></span>
<span id="cb9-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; */</span></span>
<span id="cb9-32">#&gt; . <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">generate</span> x = rnormal(0, 1)</span>
<span id="cb9-33">#&gt; </span>
<span id="cb9-34">#&gt; . <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">generate</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span> = rnormal(0, 1)</span>
<span id="cb9-35">#&gt; </span>
<span id="cb9-36">#&gt; . <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; We set up our model here </span></span>
<span id="cb9-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; </span></span>
<span id="cb9-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; */</span></span>
<span id="cb9-40">#&gt; . parallel initialize 8, f</span>
<span id="cb9-41">#&gt; <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">N</span> Child processes: 8</span>
<span id="cb9-42">#&gt; Stata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">dir</span>:  /Applications/Stata/StataBE.app/Contents/MacOS/stata-<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">be</span></span>
<span id="cb9-43">#&gt; </span>
<span id="cb9-44">#&gt; . bayesmh <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span> x, likelihood(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>({<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>})) prior({<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>}, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(0, 10)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">///</span></span>
<span id="cb9-45">#&gt; &gt; prior({<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>:}, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(0, 10)) rseed(1031) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">saving</span>(coutput_pred, <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">replace</span>) mcmcsize(1000)</span>
<span id="cb9-46">#&gt;   </span>
<span id="cb9-47">#&gt; Burn-<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ...</span>
<span id="cb9-48">#&gt; Simulation ...</span>
<span id="cb9-49">#&gt; </span>
<span id="cb9-50">#&gt; Model summary</span>
<span id="cb9-51">#&gt; ------------------------------------------------------------------------------</span>
<span id="cb9-52">#&gt; Likelihood: </span>
<span id="cb9-53">#&gt;   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span> ~ <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(xb_y,{<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>})</span>
<span id="cb9-54">#&gt; </span>
<span id="cb9-55">#&gt; Priors: </span>
<span id="cb9-56">#&gt;   {<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>:x <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">_cons</span>} ~ <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(0,10)                                               (1)</span>
<span id="cb9-57">#&gt;         {<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>} ~ <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(0,10)</span>
<span id="cb9-58">#&gt; ------------------------------------------------------------------------------</span>
<span id="cb9-59">#&gt; (1) Parameters are elements <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">of</span> the linear form xb_y.</span>
<span id="cb9-60">#&gt; </span>
<span id="cb9-61">#&gt; Bayesian <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span> regression                       MCMC iterations  =      3,500</span>
<span id="cb9-62">#&gt; Random-walk Metropolis–Hastings sampling         Burn-<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span>          =      2,500</span>
<span id="cb9-63">#&gt;                                                  MCMC <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">sample</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">size</span> =      1,000</span>
<span id="cb9-64">#&gt;                                                  Number <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">of</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">obs</span>    =        100</span>
<span id="cb9-65">#&gt;                                                  Acceptance rate  =      .2068</span>
<span id="cb9-66">#&gt;                                                  Efficiency:  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span> =     .03878</span>
<span id="cb9-67">#&gt;                                                               avg =     .07757</span>
<span id="cb9-68">#&gt; Log marginal-likelihood = -149.68351                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span> =      .1317</span>
<span id="cb9-69">#&gt;  </span>
<span id="cb9-70">#&gt; ------------------------------------------------------------------------------</span>
<span id="cb9-71">#&gt;              |                                                Equal-tailed</span>
<span id="cb9-72">#&gt;              |      Mean   Std. <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">dev</span>.     MCSE     Median  [95% cred. interval]</span>
<span id="cb9-73">#&gt; -------------+----------------------------------------------------------------</span>
<span id="cb9-74">#&gt; <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>            |</span>
<span id="cb9-75">#&gt;            x | -.0758396    .097915   .008532  -.0704775  -.2600037   .1054718</span>
<span id="cb9-76">#&gt;        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">_cons</span> |  .0238076   .1107038   .014035   .0326669  -.1793756   .2293247</span>
<span id="cb9-77">#&gt; -------------+----------------------------------------------------------------</span>
<span id="cb9-78">#&gt;          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span> |  .9773565   .1313659   .021096   .9384637   .7882847   1.323255</span>
<span id="cb9-79">#&gt; ------------------------------------------------------------------------------</span>
<span id="cb9-80">#&gt; </span>
<span id="cb9-81">#&gt; file coutput_pred.dta saved.</span>
<span id="cb9-82">#&gt; </span>
<span id="cb9-83">#&gt; . <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; We use the bayespredict command to make predictions from the model</span></span>
<span id="cb9-85"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; */</span></span>
<span id="cb9-86">#&gt; . bayespredict (<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">mean</span>:@mean({_resid})) (<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">var</span>:@variance({_resid})), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">///</span></span>
<span id="cb9-87">#&gt; &gt; rseed(1031) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">saving</span>(coutput_pred, <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">replace</span>) </span>
<span id="cb9-88">#&gt; </span>
<span id="cb9-89">#&gt; Computing predictions ...</span>
<span id="cb9-90">#&gt; </span>
<span id="cb9-91">#&gt; file coutput_pred.dta saved.</span>
<span id="cb9-92">#&gt; file coutput_pred.ster saved.</span>
<span id="cb9-93">#&gt; </span>
<span id="cb9-94">#&gt; . <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/**</span></span>
<span id="cb9-95"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; Then we calculate the posterior predictive P-values</span></span>
<span id="cb9-96"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; &gt; */</span></span>
<span id="cb9-97">#&gt; . bayesstats ppvalues {<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">mean</span>} <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">using</span> coutput_pred</span>
<span id="cb9-98">#&gt; </span>
<span id="cb9-99">#&gt; Posterior predictive summary   MCMC <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">sample</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">size</span> =     1,000</span>
<span id="cb9-100">#&gt; </span>
<span id="cb9-101">#&gt; -----------------------------------------------------------</span>
<span id="cb9-102">#&gt;            T |      Mean   Std. <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">dev</span>.  E(T_obs)  P(T&gt;=T_obs)</span>
<span id="cb9-103">#&gt; -------------+---------------------------------------------</span>
<span id="cb9-104">#&gt;         <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">mean</span> |  .0004223   .0957513    .008651         .495</span>
<span id="cb9-105">#&gt; -----------------------------------------------------------</span>
<span id="cb9-106">#&gt; Note: P(T&gt;=T_obs) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">close</span> to 0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> 1 indicates lack <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">of</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fit</span>.</span>
<span id="cb9-107">#&gt; </span>
<span id="cb9-108">#&gt; .</span></code></pre></div>
<hr>
<p>As we can see from the <code>R</code> plot above, the test statistics are are generally concentrated around <code>0.5</code> and the distribution (as shown above via the <code>R</code> code) hardly resembles the uniform distribution of <img src="https://latex.codecogs.com/png.latex?P">-value under the null model. Further, the base-2 log transformation of posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-values is not exponentially distributed, making them invalid <img src="https://latex.codecogs.com/png.latex?S">-values in our terms.</p>
<hr>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log2</span>(ppp)))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,</span>
<span id="cb10-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of -log2(Posterior Predictive P-values)"</span>,</span>
<span id="cb10-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S-values Produced From Posterior Predictive P-values"</span>,</span>
<span id="cb10-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-log2(Posterior Predictive P-value)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span>
<span id="cb10-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Warning: Removed 100 rows containing non-finite outside the scale range (`stat_bin()`).</span></span>
<span id="cb10-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Warning in max(f): no non-missing arguments to max; returning -Inf</span></span>
<span id="cb10-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in `geom_histogram()`:</span></span>
<span id="cb10-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; ! Problem while computing stat.</span></span>
<span id="cb10-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; ℹ Error occurred in the 1st layer.</span></span>
<span id="cb10-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Caused by error in `seq_len()`:</span></span>
<span id="cb10-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; ! argument must be coercible to non-negative integer</span></span></code></pre></div>
<hr>
</section>
<section id="table-1-some-p-values-s-values-maximum-likelihood-ratios-and-likelihood-ratio-statistics" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="table-1-some-p-values-s-values-maximum-likelihood-ratios-and-likelihood-ratio-statistics"><span class="header-section-number">0.3</span> Table 1: Some <img src="https://latex.codecogs.com/png.latex?P">-values, <img src="https://latex.codecogs.com/png.latex?S">-values, Maximum Likelihood Ratios, and Likelihood Ratio Statistics</h2>
<hr>
<p>Here, we look at some common <img src="https://latex.codecogs.com/png.latex?P">-values, and how they correspond to other information statistics and likelihood measures.</p>
<hr>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">pvalue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>,</span>
<span id="cb11-2">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-04</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"5 sigma (~ 2.9 in 10 million)"</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1 in 100 million (GWAS)"</span>),</span>
<span id="cb11-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6 sigma (~ 1 in a billion)"</span>))</span>
<span id="cb11-4"></span>
<span id="cb11-5">svalue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log2</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>,</span>
<span id="cb11-6">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-04</span>)), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">21.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">26.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">29.9</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb11-7"></span>
<span id="cb11-8">pvalue[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">formatC</span>(pvalue[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"e"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb11-9"></span>
<span id="cb11-10">mlr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.26</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.94</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.87</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.83</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">27.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">51.4</span>,</span>
<span id="cb11-11">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1935</span>, (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)), (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)), (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb11-12"></span>
<span id="cb11-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># likelihood ratio statistic</span></span>
<span id="cb11-14"></span>
<span id="cb11-15">lr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00016</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.016</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.45</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.32</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.71</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.84</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.02</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.63</span>,</span>
<span id="cb11-16">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.88</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">26.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">32.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.4</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb11-17"></span>
<span id="cb11-18">table1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(pvalue, svalue, mlr, lr)</span>
<span id="cb11-19"></span>
<span id="cb11-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(table1) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P-value (compatibility)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S-value (bits)"</span>,</span>
<span id="cb11-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Maximum Likelihood Ratio"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Deviance Statistic 2ln(MLR)"</span>)</span>
<span id="cb11-22"></span>
<span id="cb11-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kbl</span>(table1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"html"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">padding =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longtable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb11-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_spec</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_spec</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full_width =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">html_font =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cambria"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lightable_options =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"basic"</span>,</span>
<span id="cb11-28">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">font_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixed_thead =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">enabled =</span> F)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">footnote</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">general_title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Abbreviations: "</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title_format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"underline"</span>,</span>
<span id="cb11-30">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">general =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table 1 $P$-values                  and binary $S$-values, with corresponding maximum-likelihood ratios (MLR) and deviance (likelihood-ratio) statistics for a simple test hypothesis H under background assumptions A"</span>))</span></code></pre></div>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">P-value (compatibility)</th>
<th style="text-align: right;">S-value (bits)</th>
<th style="text-align: right;">Maximum Likelihood Ratio</th>
<th style="text-align: right;">Deviance Statistic 2ln(MLR)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.99</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1.00e+00</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.9</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">1.01e+00</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.5</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.26e+00</td>
<td style="text-align: right;">0.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.25</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">1.94e+00</td>
<td style="text-align: right;">1.32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.1</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">3.87e+00</td>
<td style="text-align: right;">2.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.05</td>
<td style="text-align: right;">4.32</td>
<td style="text-align: right;">6.83e+00</td>
<td style="text-align: right;">3.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.025</td>
<td style="text-align: right;">5.32</td>
<td style="text-align: right;">1.23e+01</td>
<td style="text-align: right;">5.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.01</td>
<td style="text-align: right;">6.64</td>
<td style="text-align: right;">2.76e+01</td>
<td style="text-align: right;">6.63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.005</td>
<td style="text-align: right;">7.64</td>
<td style="text-align: right;">5.14e+01</td>
<td style="text-align: right;">7.88</td>
</tr>
<tr class="even">
<td style="text-align: left;">1e-04</td>
<td style="text-align: right;">13.29</td>
<td style="text-align: right;">1.94e+03</td>
<td style="text-align: right;">15.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5 sigma (~ 2.9 in 10 million)</td>
<td style="text-align: right;">21.70</td>
<td style="text-align: right;">5.20e+05</td>
<td style="text-align: right;">26.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">1 in 100 million (GWAS)</td>
<td style="text-align: right;">26.60</td>
<td style="text-align: right;">1.40e+07</td>
<td style="text-align: right;">32.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6 sigma (~ 1 in a billion)</td>
<td style="text-align: right;">29.90</td>
<td style="text-align: right;">1.30e+08</td>
<td style="text-align: right;">37.40</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style="text-decoration: underline;">Abbreviations: </span></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Table 1 $P$-values and binary $S$-values, with corresponding maximum-likelihood ratios (MLR) and deviance (likelihood-ratio) statistics for a simple test hypothesis H under background assumptions A</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<hr>
<p>For further discussion of 5 and 6 sigma cutoffs, see<span class="citation" data-cites="cousinsJeffreysLindleyParadox2017"><sup>7</sup></span>.</p>
<hr>
</section>
<section id="frequentist-interval-estimate-percentiles" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="frequentist-interval-estimate-percentiles"><span class="header-section-number">0.4</span> Frequentist Interval Estimate Percentiles</h2>
</section>
<section id="refer-to-long-run-coverage" class="level2" data-number="0.5">
<h2 data-number="0.5" class="anchored" data-anchor-id="refer-to-long-run-coverage"><span class="header-section-number">0.5</span> Refer to Long-Run Coverage</h2>
<hr>
<p>Here we simulate a study where one group with 100 participants has an <img src="https://latex.codecogs.com/png.latex?%5Cmu"> of <code>100</code> with a <img src="https://latex.codecogs.com/png.latex?%5Csigma"> of <code>20</code> and the second group has the same number of participants but an average of <code>80</code> and a standard deviation of <code>20.</code> We compare them using a Welch’s <img src="https://latex.codecogs.com/png.latex?t">-test and generate 95% compatibility intervals several times, specifically <code>100</code> times, and then plot them. Since we know the mean difference is <code>20</code>, we wish to see how often the interval estimates cover this true parameter value.</p>
<hr>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-12-1.svg" data-fig-align="center" width="1056"></p>
<hr>
<p>This shows that the intervals tend to vary simply as a result of randomness, and that the proper interpretation of the attached percentile is about long run coverage of the true parameter. However, this does not preclude interpretation of a single interval estimate from a study.[<span class="citation" data-cites="coxChapterIntervalEstimation1974"><sup>8</sup></span>] As we write in the <em>Replace unrealistic “confidence” claims with compatibility measures</em> section of our paper.[<span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>1</sup></span>]</p>
<hr>
<blockquote class="blockquote">
<p>The fact that “confidence” refers to the procedure behavior, not the reported interval, seems to be lost on most researchers. Remarking on this subtlety, when Jerzy Neyman discussed his confidence concept in 1934 at a meeting of the Royal Statistical Society, Arthur Bowley replied, “I am not at all sure that the ‘confidence’ is not a confidence trick.”<span class="citation" data-cites="bowleyDiscussionDrNeyman1934"><sup>9</sup></span>. And indeed, 40 years later, Cox and Hinkley warned, “interval estimates cannot be taken as probability statements about parameters, and foremost is the interpretation ‘such and such parameter values are consistent with the data.’”<span class="citation" data-cites="coxChapterIntervalEstimation1974"><sup>8</sup></span>. Unfortunately, the word “consistency” is used for several other concepts in statistics, while in logic it refers to an absolute condition (of noncontradiction); thus, its use in place of “confidence” would risk further confusion.</p>
<p>To address the problems above, we exploit the fact that a 95% CI summarizes the results of varying the test hypothesis H over a range of parameter values, displaying all values for which <img src="https://latex.codecogs.com/png.latex?p"> &gt; 0.05<span class="citation" data-cites="coxPrinciplesStatisticalInference2006"><sup>10</sup></span> and hence <img src="https://latex.codecogs.com/png.latex?s"> &lt; 4.32 bits<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup>3</sup></span>;<span class="citation" data-cites="amrheinInferentialStatisticsDescriptive2019"><sup>11</sup></span>. Thus the CI contains a range of parameter values that are more compatible with the data than are values outside the interval, under the background assumptions<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup>3</sup></span>;<span class="citation" data-cites="greenlandStatisticalTestsValues2016"><sup>12</sup></span>. Unconditionally (and thus even if the background assumptions are uncertain), the interval shows the values of the parameter which, when combined with the background assumptions, produce a test model that is “highly compatible” with the data in the sense of having less than 4.32 bits of information against it. We thus refer to CI as compatibility intervals rather than confidence intervals<span class="citation" data-cites="greenlandAreConfidenceIntervals2019"><sup>13</sup></span>;<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup>3</sup></span>;<span class="citation" data-cites="amrheinInferentialStatisticsDescriptive2019"><sup>11</sup></span>; their abbreviation remains “CI.” We reject calling these intervals “uncertainty intervals,” because they do not capture uncertainty about background assumptions<span class="citation" data-cites="greenlandAreConfidenceIntervals2019"><sup>13</sup></span>.</p>
</blockquote>
<hr>
<p>Indeed, this also has to do with our paper on deemphasizing the model assumptions that are often behind common statistical outputs, and why it is necessary to treat them as uncertain, rather than given.[<span class="citation" data-cites="greenlandAidScientificInference2020"><sup>14</sup></span>] For example, a 95% interval estimate is assumed to be free of bias in its construction, however, it’s coverage claims are no longer so, once there are systematic errors in play. Many of these common, classical statistical procedures are designed to deal with random variation, and less so with bias (a relatively new field, with shiny new methods).</p>
<hr>
</section>
<section id="brown-et-al.-2017-reanalysis" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Brown et al.&nbsp;(2017) Reanalysis</h1>
<hr>
<p>Taken from the <a href="https://doi.org/10.1001/jama.2017.3415">Brown et al. data.</a>[<span class="citation" data-cites="brownAssociationSerotonergicAntidepressant2017"><sup>15</sup></span>;<span class="citation" data-cites="brownAssociationAntenatalExposure2017"><sup>16</sup></span>]</p>
<p>Here we take the reported statistics from the Brown et al.&nbsp;studies in order to run statistical tests of different alternative test hypotheses and use those results to construct various functions.</p>
<p>We calculate the standard errors from the point estimate and the confidence (compatibility) limits.</p>
<hr>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">se <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.997</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.92</span></span>
<span id="cb12-2"></span>
<span id="cb12-3">logUL <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span>)</span>
<span id="cb12-4">logLL <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.997</span>)</span>
<span id="cb12-5"></span>
<span id="cb12-6">logpoint <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>)</span>
<span id="cb12-7"></span>
<span id="cb12-8">logpoint <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> se)</span>
<span id="cb12-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 0.954</span></span>
<span id="cb12-10">logpoint <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> se)</span>
<span id="cb12-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] -0.0011</span></span></code></pre></div>
<hr>
<section id="table-2-p-values-s-values-and-likelihoods-for-targeted-hypotheses-about-hazard-ratios-for-brown-et-al." class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="table-2-p-values-s-values-and-likelihoods-for-targeted-hypotheses-about-hazard-ratios-for-brown-et-al."><span class="header-section-number">1.1</span> Table 2: <img src="https://latex.codecogs.com/png.latex?P">-values, <img src="https://latex.codecogs.com/png.latex?S">-values, and Likelihoods for Targeted Hypotheses About Hazard Ratios for <a href="https://doi.org/10.1001/jama.2017.3415">Brown et al.</a></h2>
<hr>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">testhypothesis <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Halving of hazard"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No effect (null)"</span>,</span>
<span id="cb13-2">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Point estimate"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Doubling of hazard"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tripling of hazard"</span>,</span>
<span id="cb13-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Quintupling of hazard"</span>)</span>
<span id="cb13-4"></span>
<span id="cb13-5">hazardratios <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb13-6">pvals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.6e-06</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.37</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2e-06</span>)</span>
<span id="cb13-7">svals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log2</span>(pvals), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb13-8">mlr2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.77</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.49</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">26.2</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb13-9">lr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>se)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>se)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)),</span>
<span id="cb13-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>se)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>se)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)),</span>
<span id="cb13-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>se)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>se)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))),</span>
<span id="cb13-12">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb13-13"></span>
<span id="cb13-14">LR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">formatC</span>(lr, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"e"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb13-15"></span>
<span id="cb13-16">table2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(testhypothesis, hazardratios, pvals, svals,</span>
<span id="cb13-17">    mlr2, LR)</span>
<span id="cb13-18"></span>
<span id="cb13-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(table2) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test Hypothesis"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HR"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P-values"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S-values"</span>,</span>
<span id="cb13-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MLR"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LR"</span>)</span>
<span id="cb13-21"></span>
<span id="cb13-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kbl</span>(table2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"html"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">padding =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longtable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb13-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_spec</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_spec</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full_width =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">html_font =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cambria"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lightable_options =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"basic"</span>,</span>
<span id="cb13-27">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">font_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixed_thead =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">enabled =</span> F))</span></code></pre></div>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Test Hypothesis</th>
<th style="text-align: right;">HR</th>
<th style="text-align: right;">P-values</th>
<th style="text-align: right;">S-values</th>
<th style="text-align: right;">MLR</th>
<th style="text-align: left;">LR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Halving of hazard</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">19.25</td>
<td style="text-align: right;">1.00e+05</td>
<td style="text-align: left;">1.02e+05</td>
</tr>
<tr class="even">
<td style="text-align: left;">No effect (null)</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">4.32</td>
<td style="text-align: right;">6.77e+00</td>
<td style="text-align: left;">6.77e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Point estimate</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00e+00</td>
<td style="text-align: left;">1.00e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Doubling of hazard</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">1.43</td>
<td style="text-align: right;">1.49e+00</td>
<td style="text-align: left;">1.49e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tripling of hazard</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">6.64</td>
<td style="text-align: right;">2.62e+01</td>
<td style="text-align: left;">2.62e+01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Quintupling of hazard</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">18.25</td>
<td style="text-align: right;">5.00e+04</td>
<td style="text-align: left;">5.03e+04</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="plot-the-point-estimate-and-95-compatibility-interval" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="plot-the-point-estimate-and-95-compatibility-interval"><span class="header-section-number">1.2</span> Plot the point estimate and 95% compatibility interval</h2>
<hr>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brown et al. (2017)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> JAMA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brown et al. (2017)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> J Clin Psychiatry"</span>)</span>
<span id="cb14-2"></span>
<span id="cb14-3">point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.7</span>)</span>
<span id="cb14-4">lower <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.997</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>)</span>
<span id="cb14-5">upper <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.6</span>)</span>
<span id="cb14-6"></span>
<span id="cb14-7">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(label, point, lower, upper)</span></code></pre></div>
<hr>
<p>Here we plot the 95% compatibility interval estimate reported from the high-dimensional propensity score analysis.</p>
<hr>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> label, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> point, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> lower,</span>
<span id="cb15-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> upper, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> label)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_pointrange</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#007C7C"</span>,</span>
<span id="cb15-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb15-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_log10</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pretty_breaks</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb15-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Association Between Serotonergic Antidepressant Exposure </span></span>
<span id="cb15-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">               </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">During Pregnancy and Child Autism Spectrum Disorder"</span>,</span>
<span id="cb15-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reported 95% Compatibility Intervals From Primary Results"</span>,</span>
<span id="cb15-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Study"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio (JAMA) + </span></span>
<span id="cb15-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            Adjusted Pooled Odds Ratio (J Clin Psychiatry)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Null parameter value of 1"</span>,</span>
<span id="cb15-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb15-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Point Estimate = 1.61, </span></span>
<span id="cb15-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">           Lower Limit = 0.997, Upper Limit = 2.59"</span>,</span>
<span id="cb15-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#000000"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb15-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Point Estimate = 1.7, </span></span>
<span id="cb15-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">           Lower Limit = 1.1, Upper Limit = 2.6"</span>,</span>
<span id="cb15-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#000000"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>,</span>
<span id="cb15-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-16-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>Once again, the authors reported that[<span class="citation" data-cites="brownAssociationSerotonergicAntidepressant2017"><sup>15</sup></span>]</p>
<blockquote class="blockquote">
<p>In the 2837 pregnancies (7.9%) exposed to antidepressants, 2.0% (95% CI, 1.6%-2.6%) of children were diagnosed with autism spectrum disorder. Risk of autism spectrum disorder was significantly higher with serotonergic antidepressant exposure (4.51 exposed vs 2.03 unexposed per 1000 person-years; between-group difference, 2.48 95% CI, 2.33-2.62 per 1000 person-years) in crude (HR, 2.16 95% CI, 1.64-2.86) and multivariable-adjusted analyses (HR, 1.59 95% CI, 1.17-2.17) (Table 2). After inverse probability of treatment weighting based on the HDPS, the association was not significant (HR, 1.61 95% CI, 0.997-2.59) (Table 2).</p>
</blockquote>
<p>and concluded with</p>
<blockquote class="blockquote">
<p>In children born to mothers receiving public drug coverage in Ontario, Canada, in utero serotonergic antidepressant exposure compared with no exposure was not associated with autism spectrum disorder in the child. Although a causal relationship cannot be ruled out, the previously observed association may be explained by other factors.</p>
</blockquote>
<p>We will show using the graphical and tabular summaries below, why a more nuanced summary such as,</p>
<blockquote class="blockquote">
<p>“After HDPS adjustment for confounding, a 61% hazard elevation remained; however, under the same model, every hypothesis from no elevation up to a 160% hazard increase had <img src="https://latex.codecogs.com/png.latex?p"> &gt; 0.05; Thus, while quite imprecise, these results are consistent with previous observations of a positive association between serotonergic antidepressant prescriptions and subsequent ASD. Because the association may be partially or wholly due to uncontrolled biases, further evidence will be needed for evaluating what, if any, proportion of it can be attributed to causal effects of prenatal serotonergic antidepressant use on ASD incidence.”</p>
</blockquote>
<p>would have been far more appropriate, as we discuss in our paper.[<span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>1</sup></span>]</p>
<hr>
</section>
<section id="p-value-and-s-value-functions" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="p-value-and-s-value-functions"><span class="header-section-number">1.3</span> <img src="https://latex.codecogs.com/png.latex?P">-value and <img src="https://latex.codecogs.com/png.latex?S">-value Functions</h2>
<hr>
<p>In order to use this information to construct a <img src="https://latex.codecogs.com/png.latex?P">-value function, we can use the <a href="https://data.lesslikely.com/concurve/"><code>concurve</code></a> functions.</p>
<hr>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"concurve"</span>)</span></code></pre></div>
<hr>
<p>We enter the reported point estimates and compatibility limits and produce all possible intervals + <img src="https://latex.codecogs.com/png.latex?P">-values + <img src="https://latex.codecogs.com/png.latex?S">-values. This is calculated assuming normal approximations with the <a href="https://data.lesslikely.com/concurve/reference/curve_rev.html"><code>curve_rev()</code></a> function.</p>
<hr>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">curve1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve_rev</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.997</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">UL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>)</span></code></pre></div>
<hr>
<p>It is stored in the object <code>curve1</code>.</p>
<p>We can generate a table of the relevant statistics from this reanalysis, similar to the table from above, but this time using the <a href="https://data.lesslikely.com/concurve/index.html"><code>concurve</code></a> function, <a href="https://data.lesslikely.com/concurve/reference/curve_table.html"><code>curve_table()</code></a>, but this time it will give us interval estimates of various percentiles (<img src="https://latex.codecogs.com/png.latex?25">%, <img src="https://latex.codecogs.com/png.latex?50">%, <img src="https://latex.codecogs.com/png.latex?75">%, <img src="https://latex.codecogs.com/png.latex?95">%, etc.). These are in turn used to construct the entire confidence (compatibility) distribution or <img src="https://latex.codecogs.com/png.latex?P">-value function.</p>
<hr>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kbl</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve_table</span>(curve1[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"html"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">padding =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>,</span>
<span id="cb18-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longtable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> F, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve_table</span>(curve1[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_spec</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_spec</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#777"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full_width =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">html_font =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cambria"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lightable_options =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"basic"</span>,</span>
<span id="cb18-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">font_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixed_thead =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">enabled =</span> F)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">footnote</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">general_title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table of Statistics for Various Interval Estimate Percentiles"</span>),</span>
<span id="cb18-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">general =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span></code></pre></div>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Lower Limit</th>
<th style="text-align: right;">Upper Limit</th>
<th style="text-align: right;">Interval Width</th>
<th style="text-align: right;">Interval Level (%)</th>
<th style="text-align: right;">CDF</th>
<th style="text-align: right;">P-value</th>
<th style="text-align: right;">S-value (bits)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.490</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">25.0</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">0.750</td>
<td style="text-align: right;">0.415</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.366</td>
<td style="text-align: right;">1.90</td>
<td style="text-align: right;">0.531</td>
<td style="text-align: right;">50.0</td>
<td style="text-align: right;">0.750</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.217</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">0.914</td>
<td style="text-align: right;">75.0</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">2.000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.178</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">1.021</td>
<td style="text-align: right;">80.0</td>
<td style="text-align: right;">0.900</td>
<td style="text-align: right;">0.200</td>
<td style="text-align: right;">2.322</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.134</td>
<td style="text-align: right;">2.29</td>
<td style="text-align: right;">1.152</td>
<td style="text-align: right;">85.0</td>
<td style="text-align: right;">0.925</td>
<td style="text-align: right;">0.150</td>
<td style="text-align: right;">2.737</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.079</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">1.325</td>
<td style="text-align: right;">90.0</td>
<td style="text-align: right;">0.950</td>
<td style="text-align: right;">0.100</td>
<td style="text-align: right;">3.322</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.999</td>
<td style="text-align: right;">2.60</td>
<td style="text-align: right;">1.596</td>
<td style="text-align: right;">95.0</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">4.322</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.933</td>
<td style="text-align: right;">2.78</td>
<td style="text-align: right;">1.846</td>
<td style="text-align: right;">97.5</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">5.322</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.860</td>
<td style="text-align: right;">3.02</td>
<td style="text-align: right;">2.155</td>
<td style="text-align: right;">99.0</td>
<td style="text-align: right;">0.995</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">6.644</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span style="font-style: italic;">Table of Statistics for Various Interval Estimate Percentiles</span></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="figure-3-p-value-compatibility-function" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="figure-3-p-value-compatibility-function"><span class="header-section-number">1.4</span> Figure 3: <img src="https://latex.codecogs.com/png.latex?P">-value (Compatibility) Function</h2>
<hr>
<p>Plot the <img src="https://latex.codecogs.com/png.latex?P">-value (Compatibility) function of the <a href="https://doi.org/10.1001/jama.2017.3415">Brown et al.</a> data</p>
<p>Now we plot the <img src="https://latex.codecogs.com/png.latex?P">-value function from the data stored in <code>curve1</code> using the <a href="https://data.lesslikely.com/concurve/reference/ggcurve.html"><code>ggcurve()</code></a> function from <a href="https://data.lesslikely.com/concurve/"><code>concurve</code></a>.</p>
<hr>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggcurve</span>(curve1[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nullvalue =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb19-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">italic</span>(P),</span>
<span id="cb19-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-value (Compatibility) Function"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">italic</span>(P),</span>
<span id="cb19-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-values for a range of hazard ratios (HR)"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio (HR)"</span>,</span>
<span id="cb19-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">italic</span>(P), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-value"</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>,</span>
<span id="cb19-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span>,</span>
<span id="cb19-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb19-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb19-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-20-1.svg" data-fig-align="center" width="672"></p>
<hr>
<p>It is practically the same as the published version from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland, 2020</a><span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>1</sup></span>.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1602038429/Site/confidencecurve.svg" width="750"></p>
<hr>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">curve1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve_rev</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.997</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">UL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>)</span>
<span id="cb20-2"></span>
<span id="cb20-3">curve2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve_rev</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">UL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>)</span></code></pre></div>
<hr>
</section>
<section id="cumulative-confidence-compatibility-distribution" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="cumulative-confidence-compatibility-distribution"><span class="header-section-number">1.5</span> Cumulative Confidence (Compatibility Distribution)</h2>
<hr>
<p>Although we do not cover this figure in our paper, it is easy to construct using <a href="https://data.lesslikely.com/concurve/index.html"><code>concurve's</code></a> <a href="https://data.lesslikely.com/concurve/reference/ggcurve.html"><code>ggcurve()</code></a> function by specifying <code>type</code> as “<code>cdf</code>” to see the median estimate within the confidence distribution. The horizontal line that meets at the curve, is approximately the same as the maximum at the <img src="https://latex.codecogs.com/png.latex?P">-value function/confidence (compatibility) curve.</p>
<hr>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggcurve</span>(curve1[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cdf"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nullvalue =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P-values for a range of hazard ratios (HR)"</span>,</span>
<span id="cb21-3">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Association Between Serotonergic Antidepressant Exposure </span></span>
<span id="cb21-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">       </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">During Pregnancy and Child Autism Spectrum Disorder"</span>,</span>
<span id="cb21-5">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio (HR)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cumulative Compatibility"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>),</span>
<span id="cb21-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb21-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-22-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>We will also calculate the likelihoods so that we can generate the corresponding likelihood functions.</p>
<hr>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">lik2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve_rev</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">UL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l"</span>,</span>
<span id="cb22-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>)</span>
<span id="cb22-3"></span>
<span id="cb22-4">lik1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve_rev</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.997</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">UL =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l"</span>,</span>
<span id="cb22-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>)</span></code></pre></div>
<hr>
<p>We can also see how consistent these results are with previous studies conducted by the same research group, given the overlap of the functions, which can be compared using the <a href="https://data.lesslikely.com/concurve/reference/plot_compare.html"><code>plot_compare()</code></a> function. Let’s compare the relative likelihood functions from both studies from this research group to see how consistent the results are.</p>
<hr>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_compare</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data1 =</span> lik1[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data2 =</span> lik2[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l1"</span>,</span>
<span id="cb23-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nullvalue =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brown et al. 2017. J Clin Psychiatry. vs. </span></span>
<span id="cb23-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">              </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Brown et al. 2017. JAMA."</span>,</span>
<span id="cb23-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"J Clin Psychiatry: OR = 1.7, 1/6.83 LI: LL = 1.1, UL = 2.6 </span></span>
<span id="cb23-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                         </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">JAMA: HR = 1.61, 1/6.83 LI: LL = 0.997, UL = 2.59"</span>,</span>
<span id="cb23-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xaxis =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio / Odds Ratio"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb23-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb23-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-24-1.svg" data-fig-align="center" width="768"></p>
<hr>
<p>and the <img src="https://latex.codecogs.com/png.latex?P">-value functions.</p>
<hr>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_compare</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data1 =</span> curve1[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data2 =</span> curve2[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c"</span>,</span>
<span id="cb24-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nullvalue =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brown et al. 2017. J Clin Psychiatry. vs. </span></span>
<span id="cb24-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">              </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Brown et al. 2017. JAMA."</span>,</span>
<span id="cb24-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"J Clin Psychiatry: OR = 1.7, 1/6.83 LI: LL = 1.1, UL = 2.6 </span></span>
<span id="cb24-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">              </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">JAMA: HR = 1.61, 1/6.83 LI: LL = 0.997, UL = 2.59"</span>,</span>
<span id="cb24-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xaxis =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio / Odds Ratio"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb24-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb24-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-25-1.svg" data-fig-align="center" width="768"></p>
<hr>
</section>
<section id="figure-4-s-value-suprisal-function" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="figure-4-s-value-suprisal-function"><span class="header-section-number">1.6</span> Figure 4: <img src="https://latex.codecogs.com/png.latex?S">-value (Suprisal) Function</h2>
<hr>
<p>Plot the <img src="https://latex.codecogs.com/png.latex?S">-value (Surprisal) function of the <a href="https://doi.org/10.1001/jama.2017.3415">Brown et al.</a> data with <a href="https://data.lesslikely.com/concurve/reference/ggcurve.html"><code>ggcurve()</code></a></p>
<hr>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggcurve</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> curve1[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ratio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nullvalue =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb25-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S-value (Surprisal) Function"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S-Values (surprisals) for a range of hazard ratios (HR)"</span>,</span>
<span id="cb25-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xaxis =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yaxis1 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S-value (bits of information)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>),</span>
<span id="cb25-5">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb25-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-26-1.svg" data-fig-align="center" width="576"></p>
<hr>
<p>which is quite close to the figure from our paper.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1602200052/Site/surprisalcurve.png" width="750"></p>
<hr>
</section>
<section id="likelihood-support-functions" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="likelihood-support-functions"><span class="header-section-number">1.7</span> Likelihood (Support) Functions</h2>
<hr>
<p>Here we provide the code to show how we constructed the likelihood functions from our paper, which are the supplementary figures found <a href="https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM3_ESM.pdf">here (S1)</a> and <a href="https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM4_ESM.pdf">here (S2)</a>.</p>
<hr>
<p>Calculate and Plot Likelihood (Support) Intervals.</p>
<p>Here we use the reported estimates to construct the <img src="https://latex.codecogs.com/png.latex?Z">-scores and standard errors, which are in turn used to compute the likelihoods.</p>
<hr>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">hrvalues <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.65</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.98</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)</span>
<span id="cb26-2"></span>
<span id="cb26-3">se <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.59</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.997</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.92</span></span>
<span id="cb26-4"></span>
<span id="cb26-5">zscore <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(hrvalues, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.61</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>se))</span></code></pre></div>
<hr>
</section>
<section id="figure-s1-relative-likelihood-function" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="figure-s1-relative-likelihood-function"><span class="header-section-number">1.8</span> Figure S1: Relative Likelihood Function</h2>
<hr>
<p>We then standardize all the likelihoods by their maximum at the likelihood function,<span class="citation" data-cites="jewellStatisticsEpidemiology2003"><sup>17</sup></span> to produce relative likelihoods, likelihood intervals, and their corresponding relative likelihood function.[<span class="citation" data-cites="royallStatisticalEvidenceLikelihood1997"><sup>18</sup></span>]</p>
<hr>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">support <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>zscore<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb27-2"></span>
<span id="cb27-3">likfunction <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(hrvalues, zscore, support)</span>
<span id="cb27-4"></span>
<span id="cb27-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> likfunction, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> hrvalues, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> support)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>,</span>
<span id="cb27-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.83</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb27-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#333333"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> hrvalues,</span>
<span id="cb27-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(support), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> support), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Relative Likelihood Function"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Relative likelihoods for a range of hazard ratios"</span>,</span>
<span id="cb27-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio (HR)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Relative Likelihood </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1/MLR"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.65</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1/6.83 LI = 0.997, 2.59"</span>,</span>
<span id="cb27-13">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#000000"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb27-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb27-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pretty_breaks</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>,</span>
<span id="cb27-17">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0125</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-28-1.svg" data-fig-align="center" width="672"></p>
<hr>
<p>The <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B6.83%7D"> likelihood interval corresponds to the 95% compatibility interval, as shown by the figure from our paper.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1602200052/Site/relativelikelihood.png" width="750"></p>
<hr>
<p>Below we use the calculated <img src="https://latex.codecogs.com/png.latex?Z">-scores to construct the log-likelihood function which is the upward-concave parabola <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7BZ%5E%7B2%7D%7D%7B2%7D"> = <img src="https://latex.codecogs.com/png.latex?-ln(MLR)"></p>
<hr>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">support <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (zscore<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb28-2"></span>
<span id="cb28-3">likfunction <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(hrvalues, zscore, support)</span>
<span id="cb28-4"></span>
<span id="cb28-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> likfunction, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> hrvalues, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> support)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>,</span>
<span id="cb28-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> hrvalues, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> support,</span>
<span id="cb28-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(support)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log-Likelihood Function"</span>,</span>
<span id="cb28-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log-likelihoods for a range of hazard ratios"</span>,</span>
<span id="cb28-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio (HR)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ln(MLR)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>),</span>
<span id="cb28-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pretty_breaks</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0125</span>)),</span>
<span id="cb28-13">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-29-1.svg" data-fig-align="center" width="672"></p>
<hr>
</section>
<section id="figure-s2-deviance-function-2lnmlr" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="figure-s2-deviance-function-2lnmlr"><span class="header-section-number">1.9</span> Figure S2: Deviance Function <img src="https://latex.codecogs.com/png.latex?2ln(MLR)"></h2>
<hr>
<p>Known as the deviance function, it is twice the log-likelihood, which maps to the <img src="https://latex.codecogs.com/png.latex?S">-value function.</p>
<hr>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">support <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (zscore<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb29-2"></span>
<span id="cb29-3">likfunction <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(hrvalues, zscore, support)</span>
<span id="cb29-4"></span>
<span id="cb29-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> likfunction, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> hrvalues, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> support)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>,</span>
<span id="cb29-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.84</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#333333"</span>,</span>
<span id="cb29-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> hrvalues, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> support,</span>
<span id="cb29-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(support)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d46c5b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb29-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.65</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1/6.83 LI = 0.997, 2.59"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb29-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#000000"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb29-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb29-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pretty_breaks</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>,</span>
<span id="cb29-15">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0125</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Deviance Function"</span>,</span>
<span id="cb29-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Deviance statistics for a range of hazard ratios"</span>,</span>
<span id="cb29-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hazard Ratio (HR)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Deviance Statistic </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2ln(MLR)"</span>)</span></code></pre></div>
<p><img src="https://lesslikely.com/posts/statistics/RG2020BMC.markdown_strict_files/figure-markdown_strict/unnamed-chunk-30-1.svg" data-fig-align="center" width="672"></p>
<hr>
<p>And the version from our paper can be found <a href="https://static-content.springer.com/esm/art%3A10.1186%2Fs12874-020-01105-9/MediaObjects/12874_2020_1105_MOESM4_ESM.pdf">here</a>.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1602200052/Site/deviancefunction.png" width="750"></p>
<hr>
<p>It is important to note that although we have calculated these likelihood functions manually here, they can also be generated easily using the <a href="https://data.lesslikely.com/concurve/reference/curve_lik.html"><code>curve_lik()</code></a> function which takes inputs from the <a href="https://cran.r-project.org/package=ProfileLikelihood"><code>ProfileLikelihood</code></a> <code>R</code> package. To see a further discussion, please see the <a href="https://data.lesslikely.com/concurve/articles/likelihood.html">following article</a>, which gives several examples for a wide variety of models.</p>
<p>Further, we urge some caution. Although we endorse the construction and presentation of likelihood functions along with <img src="https://latex.codecogs.com/png.latex?P">-value and <img src="https://latex.codecogs.com/png.latex?S">-value functions, along with the tabulations, the use of pure likelihood methods has been highly controversial among some statisticians, with some going as far as to say that <em>likelihood is blind</em> although not all statisticians believe this, and have responded to such criticisms in kind, see discussants.<span class="citation" data-cites="daviesApproximatingDataDiscussion2008"><sup>19</sup></span> Thus, we support providing both <img src="https://latex.codecogs.com/png.latex?P">-value/<img src="https://latex.codecogs.com/png.latex?S">-value and likelihood-based functions for a complete picture.</p>
<p>Indeed, we can see how they all easily map to one another when plotted side by side, with the following script.</p>
<hr>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cowplot"</span>)</span>
<span id="cb30-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_grid</span>(confcurve, surprisalcurve, relsupportfunction, deviancefunction,</span>
<span id="cb30-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<hr>
<p>A clearer plot comparing the four functions is seen below (click on the image to view in full).</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1581988661/Site/Comparisons.png" width="1000" style="cursor: zoom-in"></p>
<hr>
<p>Additional adjustments that were made to the figures from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland, 2020</a><span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>1</sup></span> were done using Adobe Illustrator and Photoshop.</p>
<p>All errors are ours, and we welcome critical feedback and reporting of errors. To report possible errors in our analyses, please post it as a comment below or as a bug <a href="https://github.com/zadrafi/concurve/issues">here</a>. We will compile them onto a public errata, if any errors or flaws are reported to us.</p>
<hr>
</section>
</section>
<section id="statistical-package-citations" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Statistical Package Citations</h1>
<hr>
<p>Please remember to cite the <code>R</code> packages if you use any of the <code>R</code> scripts from above. The citation for our [<span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>1</sup></span>] can be found below in the References section or it can be <a href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/s12874-020-01105-9.ris">downloaded here</a> for a reference manager.</p>
<hr>
<div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"concurve"</span>)</span>
<span id="cb31-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TeachingDemos"</span>)</span>
<span id="cb31-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ProfileLikelihood"</span>)</span>
<span id="cb31-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rstan"</span>)</span>
<span id="cb31-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rstanarm"</span>)</span>
<span id="cb31-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bayesplot"</span>)</span>
<span id="cb31-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"knitr"</span>)</span>
<span id="cb31-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kableExtra"</span>)</span>
<span id="cb31-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggplot2"</span>)</span>
<span id="cb31-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cowplot"</span>)</span>
<span id="cb31-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citation</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Statamarkdown"</span>)</span></code></pre></div>
<hr>
</section>
<section id="environment" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Environment</h1>
<hr>
<p>The analyses were run on:</p>
<hr>
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1">si <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sessionInfo</span>()</span>
<span id="cb32-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(si, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">RNG =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locale =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb32-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; R version 4.5.0 (2025-04-11)</span></span>
<span id="cb32-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span id="cb32-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span id="cb32-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb32-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Matrix products: default</span></span>
<span id="cb32-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span id="cb32-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span id="cb32-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb32-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Random number generation:</span></span>
<span id="cb32-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  RNG:     L'Ecuyer-CMRG </span></span>
<span id="cb32-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  Normal:  Inversion </span></span>
<span id="cb32-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  Sample:  Rejection </span></span>
<span id="cb32-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  </span></span>
<span id="cb32-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; locale:</span></span>
<span id="cb32-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span id="cb32-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb32-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; time zone: America/New_York</span></span>
<span id="cb32-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; tzcode source: internal</span></span>
<span id="cb32-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb32-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; attached base packages:</span></span>
<span id="cb32-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [1] splines   grid      stats4    parallel  stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span id="cb32-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb32-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; other attached packages:</span></span>
<span id="cb32-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   [1] TeachingDemos_2.13    plotly_4.10.4         TSstudio_0.1.7        tfautograph_0.3.2     tfdatasets_2.17.0    </span></span>
<span id="cb32-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   [6] keras_2.15.0          tensorflow_2.16.0     timetk_2.9.0          modeltime_1.3.1       workflowsets_1.1.1   </span></span>
<span id="cb32-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [11] workflows_1.2.0       tune_1.3.0            rsample_1.3.0         recipes_1.3.1         parsnip_1.3.2        </span></span>
<span id="cb32-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [16] modeldata_1.4.0       infer_1.0.8           dials_1.4.0           scales_1.4.0          tidymodels_1.3.0     </span></span>
<span id="cb32-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [21] xgboost_1.7.11.1      prophet_1.0           rlang_1.1.6           astsa_2.2             bayesforecast_1.0.5  </span></span>
<span id="cb32-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [26] smooth_4.2.0          greybox_2.0.4         glmnet_4.1-9          forecast_8.24.0       fable_0.4.1          </span></span>
<span id="cb32-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [31] fabletools_0.5.0      tsibbledata_0.4.1     tsibble_1.1.6         rstanarm_2.32.1       texPreview_2.1.0     </span></span>
<span id="cb32-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [36] tinytex_0.57          rmarkdown_2.29        brms_2.22.0           bootImpute_1.2.2      knitr_1.50           </span></span>
<span id="cb32-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [41] boot_1.3-31           JuliaCall_0.17.6      reshape2_1.4.4        ProfileLikelihood_1.3 ImputeRobust_1.3-1   </span></span>
<span id="cb32-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [46] gamlss_5.4-22         gamlss.dist_6.1-1     gamlss.data_6.0-6     mvtnorm_1.3-3         performance_0.14.0   </span></span>
<span id="cb32-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [51] summarytools_1.1.4    tidybayes_3.0.7       htmltools_0.5.8.1     Statamarkdown_0.9.2   car_3.1-3            </span></span>
<span id="cb32-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [56] carData_3.0-5         qqplotr_0.0.6         ggcorrplot_0.1.4.1    mitml_0.4-5           pbmcapply_1.5.1      </span></span>
<span id="cb32-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [61] Amelia_1.8.3          Rcpp_1.0.14           blogdown_1.21         doParallel_1.0.17     iterators_1.0.14     </span></span>
<span id="cb32-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [66] foreach_1.5.2         lattice_0.22-7        bayesplot_1.12.0      wesanderson_0.3.7     VIM_6.2.2            </span></span>
<span id="cb32-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [71] colorspace_2.1-1      here_1.0.1            progress_1.2.3        loo_2.8.0             mi_1.1               </span></span>
<span id="cb32-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [76] Matrix_1.7-3          broom_1.0.8           yardstick_1.3.2       svglite_2.2.1         Cairo_1.6-2          </span></span>
<span id="cb32-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [81] cowplot_1.1.3         mgcv_1.9-3            nlme_3.1-168          xfun_0.52             broom.mixed_0.2.9.6  </span></span>
<span id="cb32-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [86] reticulate_1.42.0     kableExtra_1.4.0      posterior_1.6.1       checkmate_2.3.2       parallelly_1.45.0    </span></span>
<span id="cb32-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [91] miceFast_0.8.5        randomForest_4.7-1.2  missForest_1.5        miceadds_3.17-44      quantreg_6.1         </span></span>
<span id="cb32-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [96] SparseM_1.84-2        MCMCpack_1.7-1        MASS_7.3-65           coda_0.19-4.1         latex2exp_0.9.6      </span></span>
<span id="cb32-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 23 entries ]</span></span>
<span id="cb32-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb32-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; loaded via a namespace (and not attached):</span></span>
<span id="cb32-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   [1] igraph_2.1.4         Formula_1.2-5        rematch2_2.1.2       GPfit_1.0-9          tidyselect_1.2.1    </span></span>
<span id="cb32-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   [6] bridgesampling_1.1-2 rngtools_1.5.2       dichromat_2.0-0.1    png_0.1-8            cli_3.6.5           </span></span>
<span id="cb32-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [11] arrayhelpers_1.1-0   askpass_1.2.1        openssl_2.3.3        textshaping_1.0.1    officer_0.6.10      </span></span>
<span id="cb32-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [16] lhs_1.2.0            curl_6.2.3           mime_0.13            evaluate_1.0.3       V8_6.0.4            </span></span>
<span id="cb32-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [21] stringi_1.8.7        backports_1.5.0      desc_1.4.3           qqconf_1.3.2         httpuv_1.6.16       </span></span>
<span id="cb32-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [26] rappdirs_0.3.3       details_0.4.0        prodlim_2025.04.28   KMsurv_0.1-6         doRNG_1.8.6.2       </span></span>
<span id="cb32-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [31] survminer_0.5.0      DT_0.33              DBI_1.2.3            withr_3.0.2          tfruns_1.5.3        </span></span>
<span id="cb32-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [36] reformulas_0.4.1     tseries_0.10-58      class_7.3-23         systemfonts_1.2.3    rprojroot_2.0.4     </span></span>
<span id="cb32-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [41] lmtest_0.9-40        formatR_1.14         colourpicker_1.3.0   htmlwidgets_1.6.4    fs_1.6.6            </span></span>
<span id="cb32-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [46] labeling_0.4.3       ranger_0.17.0        DEoptimR_1.1-3-1     zoo_1.8-14           itertools_0.1-3     </span></span>
<span id="cb32-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [51] svUnit_1.0.6         timechange_0.3.0     caTools_1.18.3       extremevalues_2.4.1  data.table_1.17.4   </span></span>
<span id="cb32-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [56] timeDate_4041.110    pan_1.9              clipr_0.8.0          ellipsis_0.3.2       lazyeval_0.2.2      </span></span>
<span id="cb32-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [61] yaml_2.3.10          survival_3.8-3       crayon_1.5.3         tensorA_0.36.2.1     RColorBrewer_1.1-3  </span></span>
<span id="cb32-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [66] later_1.4.2          codetools_0.2-20     base64enc_0.1-3      shape_1.4.6.1        estimability_1.5.1  </span></span>
<span id="cb32-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [71] gdtools_0.4.2        DiceDesign_1.10      foreign_0.8-90       pkgconfig_2.0.3      xml2_1.3.8          </span></span>
<span id="cb32-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [76] mathjaxr_1.8-0       ggpubr_0.6.0         viridisLite_0.4.2    xtable_1.8-4         plyr_1.8.9          </span></span>
<span id="cb32-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [81] httr_1.4.7           rbibutils_2.3        tools_4.5.0          globals_0.18.0       hardhat_1.4.1       </span></span>
<span id="cb32-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [86] pkgbuild_1.4.8       htmlTable_2.4.3      survMisc_0.5.6       shinyjs_2.1.0        crosstalk_1.2.1     </span></span>
<span id="cb32-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [91] twosamples_2.0.1     MatrixModels_0.5-4   lme4_1.1-37          digest_0.6.37        numDeriv_2016.8-1.1 </span></span>
<span id="cb32-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [96] furrr_0.3.1          farver_2.1.2         tzdb_0.5.0           rapportools_1.2      rpart_4.1.24        </span></span>
<span id="cb32-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 90 entries ]</span></span></code></pre></div>
<hr>
</section>
<section id="stata" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Stata</h1>
<hr>
<div class="sourceCode" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb33-1">about</span>
<span id="cb33-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">version</span></span>
<span id="cb33-3">#&gt; Stata/BE 17.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> Mac (Apple Silicon)</span>
<span id="cb33-4">#&gt; Revision 21 May 2024</span>
<span id="cb33-5">#&gt; Copyright 1985-2021 StataCorp LLC</span>
<span id="cb33-6">#&gt; </span>
<span id="cb33-7">#&gt; Total physical <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">memory</span>: 24.00 GB</span>
<span id="cb33-8">#&gt; </span>
<span id="cb33-9">#&gt; Stata license: Single-user  perpetual</span>
<span id="cb33-10">#&gt; Serial number: 301706317553</span>
<span id="cb33-11">#&gt;   Licensed to: Zad Rafi</span>
<span id="cb33-12">#&gt;                AMG</span>
<span id="cb33-13">#&gt; </span>
<span id="cb33-14">#&gt; <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">version</span> 17.0</span></code></pre></div>
<section id="section" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="section"><span class="header-section-number">4.1</span> ————————————————————————</h2>
</section>
</section>
<section id="references" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> References</h1>
<hr>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="2" data-line-spacing="2">
<div id="ref-rafiSemanticCognitiveTools2020" class="csl-entry">
1. Rafi Z, Greenland S. (2020). <span>“Semantic and cognitive tools to aid statistical science: Replace confidence and significance by compatibility and surprise.”</span> <em>BMC Medical Research Methodology</em>. <strong>20</strong>:244. doi: <a href="https://doi.org/10.1186/s12874-020-01105-9">10.1186/s12874-020-01105-9</a>.
</div>
<div id="ref-greenlandTechnicalIssuesInterpretation2020" class="csl-entry">
2. Greenland S, Rafi Z. (2020). <span>“Technical <span>Issues</span> in the <span>Interpretation</span> of <span>S</span>-values and <span>Their Relation</span> to <span>Other Information Measures</span>.”</span> <em>arXiv:200812991 [statME]</em>. <a href="https://arxiv.org/abs/2008.12991">https://arxiv.org/abs/2008.12991</a>.
</div>
<div id="ref-greenlandValidPvaluesBehave2019" class="csl-entry">
3. Greenland S. (2019). <span>“Valid <span>P</span>-values behave exactly as they should: <span>Some</span> misleading criticisms of <span>P</span>-values and their resolution with <span>S</span>-values.”</span> <em>The American Statistician</em>. <strong>73</strong>:106–114. doi: <a href="https://doi.org/10.1080/00031305.2018.1529625">10.1080/00031305.2018.1529625</a>.
</div>
<div id="ref-bayarriValuesCompositeNull2000" class="csl-entry">
4. Bayarri MJ, Berger JO. (2000). <span>“P <span>Values</span> for <span>Composite Null Models</span>.”</span> <em>Journal of the American Statistical Association</em>. <strong>95</strong>:1127–1142. doi: <a href="https://doi.org/10/dpvq8c">10/dpvq8c</a>.
</div>
<div id="ref-robinsAsymptoticDistributionValues2000" class="csl-entry">
5. Robins JM, van der Vaart A, Ventura V. (2000). <span>“Asymptotic <span>Distribution</span> of <span>P Values</span> in <span>Composite Null Models</span>.”</span> <em>Journal of the American Statistical Association</em>. <strong>95</strong>:1143–1156. doi: <a href="https://doi.org/10/gg7krv">10/gg7krv</a>.
</div>
<div id="ref-kuffnerWhyArePvalues2019" class="csl-entry">
6. Kuffner TA, Walker SG. (2019). <span>“Why are <span>P</span>-values controversial?”</span> <em>The American Statistician</em>. <strong>73</strong>:1–3. doi: <a href="https://doi.org/10.1080/00031305.2016.1277161">10.1080/00031305.2016.1277161</a>.
</div>
<div id="ref-cousinsJeffreysLindleyParadox2017" class="csl-entry">
7. Cousins RD. (2017). <span>“The <span>Jeffreys</span> paradox and discovery criteria in high energy physics.”</span> <em>Synthese</em>. <strong>194</strong>:395–432. doi: <a href="https://doi.org/10.1007/s11229-014-0525-z">10.1007/s11229-014-0525-z</a>.
</div>
<div id="ref-coxChapterIntervalEstimation1974" class="csl-entry">
8. Cox DR, Hinkley DV. (1974). <span>“Chapter 7, <span>Interval</span> estimation.”</span> In: Theoretical <span>Statistics</span>. <span>Chapman and Hall/CRC</span>. p. 207–249. doi: <a href="https://doi.org/10.1201/b14832">10.1201/b14832</a>.
</div>
<div id="ref-bowleyDiscussionDrNeyman1934" class="csl-entry">
9. Bowley AL. (1934). <span>“Discussion on <span>Dr</span>. <span>Neyman</span>’s <span>Paper</span>. <span>P</span>. 607 in: <span>Neyman J</span>. <span>On</span> the two different aspects of the representative method: <span>The</span> method of stratified sampling and the method of purposive selection (with discussion).”</span> <em>Journal of the Royal Statistical Society</em>. <strong>4</strong>:558–625. doi: <a href="https://doi.org/10.2307/2342192">10.2307/2342192</a>.
</div>
<div id="ref-coxPrinciplesStatisticalInference2006" class="csl-entry">
10. Cox DR. (2006). <span>“Principles of <span>Statistical Inference</span>.”</span> <span>Cambridge University Press</span>.
</div>
<div id="ref-amrheinInferentialStatisticsDescriptive2019" class="csl-entry">
11. Amrhein V, Trafimow D, Greenland S. (2019). <span>“Inferential statistics as descriptive statistics: <span>There</span> is no replication crisis if we don’t expect replication.”</span> <em>The American Statistician</em>. <strong>73</strong>:262–270. doi: <a href="https://doi.org/10.1080/00031305.2018.1543137">10.1080/00031305.2018.1543137</a>.
</div>
<div id="ref-greenlandStatisticalTestsValues2016" class="csl-entry">
12. Greenland S, Senn SJ, Rothman KJ, Carlin JB, Poole C, Goodman SN, et al. (2016). <span>“Statistical tests, <span>P</span> values, confidence intervals, and power: <span>A</span> guide to misinterpretations.”</span> <em>European Journal of Epidemiology</em>. <strong>31</strong>:337–350. doi: <a href="https://doi.org/10.1007/s10654-016-0149-3">10.1007/s10654-016-0149-3</a>.
</div>
<div id="ref-greenlandAreConfidenceIntervals2019" class="csl-entry">
13. Greenland S. (2019). <span>“Are confidence intervals better termed <span>‘uncertainty intervals’</span>? <span>No</span>: <span>Call</span> them compatibility intervals.”</span> <em>BMJ</em>. <strong>366</strong>. doi: <a href="https://doi.org/10.1136/bmj.l5381">10.1136/bmj.l5381</a>.
</div>
<div id="ref-greenlandAidScientificInference2020" class="csl-entry">
14. Greenland S, Rafi Z. (2020). <span>“To <span>Aid Scientific Inference</span>, <span>Emphasize Unconditional Descriptions</span> of <span>Statistics</span>.”</span> <em>arXiv:190908583 [statME]</em>. <a href="https://arxiv.org/abs/1909.08583">https://arxiv.org/abs/1909.08583</a>.
</div>
<div id="ref-brownAssociationSerotonergicAntidepressant2017" class="csl-entry">
15. Brown HK, Ray JG, Wilton AS, Lunsky Y, Gomes T, Vigod SN. (2017). <span>“Association between serotonergic antidepressant use during pregnancy and autism spectrum disorder in children.”</span> <em>Journal of the American Medical Association</em>. <strong>317</strong>:1544–1552. doi: <a href="https://doi.org/10.1001/jama.2017.3415">10.1001/jama.2017.3415</a>.
</div>
<div id="ref-brownAssociationAntenatalExposure2017" class="csl-entry">
16. Brown HK, Hussain-Shamsy N, Lunsky Y, Dennis C-LE, Vigod SN. (2017). <span>“The association between antenatal exposure to selective serotonin reuptake inhibitors and autism: <span>A</span> systematic review and meta-analysis.”</span> <em>The Journal of Clinical Psychiatry</em>. <strong>78</strong>:e48–e58. doi: <a href="https://doi.org/10.4088/JCP.15r10194">10.4088/JCP.15r10194</a>.
</div>
<div id="ref-jewellStatisticsEpidemiology2003" class="csl-entry">
17. Jewell NP. (2003). <span>“Statistics for <span>Epidemiology</span>.”</span> <span>CRC Press</span>.
</div>
<div id="ref-royallStatisticalEvidenceLikelihood1997" class="csl-entry">
18. Royall R. (1997). <span>“Statistical <span>Evidence</span>: <span>A Likelihood Paradigm</span>.”</span> <span>CRC Press</span>.
</div>
<div id="ref-daviesApproximatingDataDiscussion2008" class="csl-entry">
19. Davies PL. (2008). <span>“Approximating data [with discussion and a rejoinder].”</span> <em>Journal of the Korean Statistical Society</em>. <strong>37</strong>:191–211. doi: <a href="https://doi.org/10/bn8cgk">10/bn8cgk</a>.
</div>
</div></section></div> ]]></description>
  <guid>https://lesslikely.com/posts/statistics/RG2020BMC.html</guid>
  <pubDate>Sat, 12 Dec 2020 00:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/v1602038429/Site/confidencecurve.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Quality Control in Statistical Analyses</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/statistical-quality-control.html</link>
  <description><![CDATA[ 





<hr>
<p>Experienced statisticians and data analysts are familiar with stories where a coding error has led to an entire conclusion changing, <a href="https://jamanetwork.com/journals/jama/fullarticle/2752474">or even a retraction</a>.[@aboumatarNoticeRetractionAboumatar2019] It’s the sort of stuff that keeps people up at night. Unfortunately, not many of us think about these sorts of scenarios until we realize it’s very possible that it could happen to any of us.</p>
<p>To me, it seems that many of these issues could be avoided by having a principled data management and statistical workflow, and making it as transparent, open, and reproducible as possible. I’d like to quickly go over a few things that I’ve found helpful over the years, and I’ll first start with data management and data entry and then move onto analysis workflows. I largely consider this to be a living document, and I’m sure many people who will read this will have far better suggestions, so please leave them down below in the comments!</p>
<p>Before I go on, I want to emphasize that backing up your data, scripts, and <a href="https://happygitwithr.com/">using version control</a> is extremely important. There is no debate about this. It’s necessary so that other collaborators/colleagues can inspect your work and catch potential mistakes or see overall progress, but more importantly, it will prevent you from losing your data in a disaster, and it’ll help you catch your own mistakes, since you’ll be the most familiar with the data and scripts.</p>
<hr>
<section id="data-entry-management" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Data Entry &amp; Management</h1>
<hr>
<p>A nice paper that I’d like to review is the one by <a href="https://doi.org/10.1080/00031305.2017.1375989">Broman &amp; Woo, 2018</a> on how to manage your data when working with spreadsheets.[@bromanDataOrganizationSpreadsheets2018] The sad reality is that even though spreadsheets like Microsoft Excel or Google Sheets are available everywhere, and easy to use, there are many risks when working with spreadsheets, just ask any <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-1044-7?fbclid=IwAR06eQ5LTg2LX5byJBWfC6rJdAbAGXKvy3PUOhzPsVjUGqb7KqB1V_x36M0">statistician who works in genetics</a> or any bioinformatician.[@ziemannGeneNameErrors2016]</p>
<p>One of the most fatal errors <a href="https://theconversation.com/why-you-should-never-use-microsoft-excel-to-count-coronavirus-cases-147681">occurred recently</a> when a group of researchers lost thousands of documented COVID cases because they entered data for each case as a column instead of a row, and Excel has a limit on how many columns and rows it can handle (<strong>1,048,576 rows</strong> and <strong>16,384 columns</strong>, <a href="https://support.microsoft.com/en-us/office/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3">according to Microsoft</a>), as a result, most of these cases were lost, resulting in an enormous waste of resources due to a careless and ignorant mistake, highlighting the dangers of recklessly inputting data and conducting statistical analyses. There is no doubt that reviewing principles of good data management and workflow are essential to any data analyst. I’d like to touch on some of the most important points of <a href="https://doi.org/10.1080/00031305.2017.1375989">Broman &amp; Woo, 2018</a> paper before moving onto some other “principles” I’d like to share:</p>
<hr>
<section id="general-principle-be-consistent-with-everything" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="general-principle-be-consistent-with-everything"><span class="header-section-number">1.1</span> General Principle: Be Consistent With Everything</h2>
<hr>

<ul>
<li>When labeling missing values (<code>NA</code>, <code>N/A</code>, etc.):
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Choose one method (<code>NA</code>, <code>N/A</code>, etc.) and stick with it.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: Leaving cells empty to indicate missingness.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When labeling response variables:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: If you label a response variable consistently, for example, <code>fat-free-mass</code> in every instance to refer to the same variable.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: If you label a response variable <code>fat-free-mass</code> in one script/sheet, and <code>ffm</code>/<code>fat_free_mass</code> in another.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When formatting variable predictor names:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: <code>predictor_1_week12</code>, <code>predictor_2_week12</code>, <code>response_variable_week12</code>. This is consistent, with the order of the names, and dates/weeks, so it is easier to organize, inspect, and clean. Same thing applies to labeling response variables and pretty much all variables.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: When you label one variable <code>week12_predictor_1</code>, the next <code>predictor_2_week12</code>, and the last, <code>12_week_response</code>. Just <em>no</em>.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When formatting dates:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Use one format, <code>YYYY-MM-DD</code>, consistently.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: Everything else.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When filling out cells:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: One cell = one thing. No more, no less.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: One cell = multiple entries or no entries at all.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When keeping track of the data:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Create a comprehensive data dictionary so anyone can look at it and understand the spreadsheets/dataframes/variables.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: Expecting yourself and others to figure it out based on the variable names that you thought were brilliant.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When using Excel or Google Sheet’s shiny features:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Avoid using any of them, any formulas, highlighting, <em>italicizing</em>, <span style="font-weight:700;">bolding</span>, etc.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: If you’re the type of person to create charts in Excel.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>Planning for disasters:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Always, always, backup your files, save them in .txt files. Keep backups of those. And most importantly, <a href="https://happygitwithr.com/"><strong>use version control!</strong></a>
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: You don’t really plan for disasters and go with the flow.
</p></li>
</ul></li>
</ul>

<hr>
<ul>
<li>Last but not least, when entering cases:
<ul>
<li><p>
</p><p><span style="color:#7aa864; font-weight: 700;">Good</span>: Rows are for cases and observations, and columns are for variables and characteristics. Please do not switch these up!</p></li>
<li><p>
</p><p><span style="color:#CD5C5C; font-weight: 700;">Bad</span>: Using them interchangeably.</p></li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="setting-up-a-principled-statistical-workflow" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Setting Up a Principled Statistical Workflow</h1>
<hr>
<p>Here’s what I’ve been doing for many years and what seems to work for me (none of these ideas are originally mine, and I actually picked them up over the years from others’ advice, which will be linked below).</p>
<hr>
<section id="setting-up-the-project-folder" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="setting-up-the-project-folder"><span class="header-section-number">2.1</span> Setting up the Project Folder</h2>
<hr>
<p>When setting up a folder specific for a project (if you’re not doing this, you absolutely need to), first, I will create a folder with the title of my project, and usually have an <a href="https://rstudio.com/"><code>RStudio</code></a> project set up in there.</p>
<hr>
<blockquote class="blockquote">
<p>Disclaimer: while much of this advice will be familiar and easy to understand for those who use <code>R</code>, I think the general principles are widely applicable, especially for those who use scripts in their statistical software).</p>
</blockquote>
<hr>
<p>This folder will contain many other folders (more on that below), so the structure will end up being a bit complex.</p>
<hr>
<p><img data-enlargeable="" style="cursor: zoom-in" src="https://res.cloudinary.com/less-likely/image/upload/v1613136545/Site/diagram.png" alt="workflow"></p>
<hr>
<blockquote class="blockquote">
<p>It may be a bit difficult to read the words within the circles, but clicking on the diagram should enlargen it and allow you to zoom in, giving you a sense of how I organize all these scripts and files.</p>
</blockquote>
<hr>
<p>If this ends up confusing you, you can just scroll all the way down to see an image of what the folder structure looks like.</p>
<p>Instead of constantly changing the working directory to each subfolder when I need to do something inside that subfolder for a particular project or analysis, I set the project folder as the working directory only once, and then run the following:</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Very seriously consider installing the `here` package</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://cran.r-project.org/package=here</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"here"</span>) </span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This and the scripts below take</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the directory used and set it as the top</span></span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_here</span>() </span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>()</span></code></pre></div>
</details>
</div>
<hr>
<p>This not only sets the working directory, but gives you far more control over how you can save your files from any place within the hierarchical folder structure. It will create a file called <code>.here</code> inside the <code>Main Project</code> folder, which will indicate that this is the top level of the hierarchy.</p>
<p>Then, I will usually have created a <code>README.Rmd</code> file in the <code>Main Project</code> folder with updates on what I’ve done and what I still need to work on, so I will remember and so my collaborators can see it too (when it has been pushed to GitHub or other <a href="https://happygitwithr.com/">version control</a> repos).</p>
<p>Next, I’ll set up a <code>Data</code> folder inside the <code>Main Project</code> folder. This is where all my data/spreadsheets/.txt files and data dictionaries will go. The original data files will stay inside this folder, while I create two other subsubfolders inside this <code>Data</code> folder called <code>Transformed</code> and <code>Models</code>. In <code>Transformed</code>, I will typically save <code>.rds</code> files that were a result of cleaning and transforming the data, including imputing missing data. I will touch more on exactly how I do that later below. A <code>Models</code> subfolder will obviously store fitted models and any validation/sensitivity analyses of those models.[@morrisChoosingSensitivityAnalyses2014]</p>
<p>Now, back to the <code>Main Project</code> folder, I’ll set up another folder within it called <code>R</code>. This will be where all of my <code>.R</code> scripts/files live. I will number them sequentially along with a title for a specific purpose, like so</p>
<hr>
<ul>
<li><p><code>main.R</code></p></li>
<li><p><code>01-functions.R</code></p></li>
<li><p><code>02-cleaning.R</code></p></li>
<li><p><code>03-inspection.R</code></p></li>
<li><p><code>04-analysis.R</code></p></li>
<li><p><code>04.5-validation.R</code></p></li>
<li><p><code>05-sensitivity.R</code></p></li>
<li><p><code>06-tables.R</code></p></li>
</ul>
<hr>
</section>
<section id="setting-up-the-functions-script" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="setting-up-the-functions-script"><span class="header-section-number">2.2</span> Setting up the Functions Script</h2>
<hr>
<p>All potential <code>R</code> packages and custom functions that I need will belong in <code>01-functions.R</code>. This <code>.R</code> file will only serve this purpose and nothing else. As you’ve guessed by now, the other <code>.R</code> files will be doing the same, they have very specific purposes and are organized to reflect this.</p>
<p>An example of the first script can be found below.</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Necessary Packages ------------------------------------</span></span>
<span id="cb2-2"></span>
<span id="cb2-3">req_packs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rms"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"concurve"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mice"</span>, </span>
<span id="cb2-4">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"parallel"</span>, </span>
<span id="cb2-5">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bayesplot"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"projpred"</span>, </span>
<span id="cb2-6">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hmisc"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rstan"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"here"</span>,</span>
<span id="cb2-7">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tryCatchLog"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"futile.logger"</span>, </span>
<span id="cb2-8">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"patchwork"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"corrplot"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"beepr"</span>, </span>
<span id="cb2-9">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"summarytools"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"broom"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wakefield"</span>, </span>
<span id="cb2-10">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"boot"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mfp"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"knitr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"flextable"</span>, </span>
<span id="cb2-11">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MASS"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lme4"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"brms"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"miceMNAR"</span>)</span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load all packages at once</span></span>
<span id="cb2-14"></span>
<span id="cb2-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(req_packs, library, </span>
<span id="cb2-16">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">character.only =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loggings messages </span></span>
<span id="cb2-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keep.source =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)        </span>
<span id="cb2-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tryCatchLog.write.error.dump.file"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) </span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set seed for random number generator</span></span>
<span id="cb2-23"></span>
<span id="cb2-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb2-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># My birthday</span></span>
<span id="cb2-26"></span>
<span id="cb2-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RStan Settings  -------------------------------------</span></span>
<span id="cb2-28"></span>
<span id="cb2-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>())</span>
<span id="cb2-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">color_scheme_set</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb2-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rstan_options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">auto_write =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb2-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mc.cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb2-33"></span>
<span id="cb2-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">has_build_tools</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">debug =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb2-35"></span>
<span id="cb2-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Stan Settings  ---------------------------------------</span></span>
<span id="cb2-37"></span>
<span id="cb2-38">dotR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.getenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HOME"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".R"</span>)</span>
<span id="cb2-39"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.exists</span>(dotR)) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dir.create</span>(dotR)</span>
<span id="cb2-40">M <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(dotR, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Makevars"</span>)</span>
<span id="cb2-41"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.exists</span>(M)) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.create</span>(M)</span>
<span id="cb2-42"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">CXX14FLAGS=-O3 -march=native -mtune=native -fPIC"</span>,</span>
<span id="cb2-43">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CXX14=g++"</span>, </span>
<span id="cb2-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> M, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">append =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</details>
</div>
<hr>
<p>The script above loads all the necessary <code>R</code> packages each time it is called, along with the specified functions, so most of the other <code>.R</code> files will depend upon this one.</p>
<p>However, I will not be running each of these <code>.R</code> files/scripts individually, line by line, or by selecting all the lines in an <code>.R</code> file and running the script.</p>
<p>Instead, after I’ve created all these files (figuring out what I need to do carefully and writing it down and annotating it), every single <code>.R</code> file except for <code>main.R</code> will have the following script, which I will explain later below (or some iteration of this script to match the name of the file) at the beginning:</p>
<hr>
</section>
<section id="setting-up-the-error-catching-script" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="setting-up-the-error-catching-script"><span class="header-section-number">2.3</span> Setting up the Error Catching Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"here"</span>)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_here</span>()</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>))</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(futile.logger)</span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tryCatchLog)</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Keeps source code file name and line number tracking</span></span>
<span id="cb3-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keep.source =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)        </span>
<span id="cb3-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tryCatchLog.write.error.dump.file"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) </span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Logs messages into a file </span></span>
<span id="cb3-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"my_app.log"</span>))  </span>
<span id="cb3-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.threshold</span>(INFO)   </span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function that catches any messages</span></span>
<span id="cb3-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"script.R"</span>))</span></code></pre></div>
</details>
</div>
<hr>
<p>You’ll notice several things. First, I’m once again calling the <a href="https://cran.r-project.org/package=here"><code>here</code></a> package and telling it that I’m working within this folder (<code>R</code>), and then I’m calling the <code>01-functions.R</code> file by using the <code>source()</code> function, but also notice how the <code>source()</code> function is followed by a <code>here()</code> function/argument. This <code>here()</code> function allows you to fully control files in a specific folder from anywhere else, without having to actually be in that folder. So, suppose I was in the <code>Main Project</code> -&gt; <code>Data</code> -&gt; <code>Models</code> folder and I was saving my work there (in the <code>Models</code> folder), which is pretty far from the <code>R</code> folder, I can still, using functions like <code>source()</code>, <code>save()</code>, etc., call or manipulate files from a totally different folder by specifying the hierarchy using <code>here()</code>. This can also be done in other ways, but those are far more cumbersome, and not flexible.</p>
<p>This is how I always call the necessary packages and functions I need from every <code>.R</code> script, simply by using the <code>source()</code> function and using <code>here()</code> to direct it to the <code>01-functions.R</code> file in the <code>R</code> folder. Now let’s look at the next few lines.</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"script.log"</span>))</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.threshold</span>(INFO)    </span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"script.R"</span>))</span></code></pre></div>
</details>
</div>
<hr>
<p>This script is designed to catch any warnings that occur inside the <code>.R</code> script and save them to a .log file in another subfolder within the <code>R</code> folder called <code>Errors</code>. So here’s an example of a full script for a mix of data generation and inspection, so that you can see it in action.</p>
<hr>
</section>
<section id="example-of-data-loading-inspection" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="example-of-data-loading-inspection"><span class="header-section-number">2.4</span> Example of Data Loading &amp; Inspection</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"here"</span>)</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_here</span>()</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loads all R functions</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># First we need some data</span></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb5-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># My birthday</span></span>
<span id="cb5-11"></span>
<span id="cb5-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Suppose you wanted to simulate a clinical trial</span></span>
<span id="cb5-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"simstudy"</span>)  </span>
<span id="cb5-14"></span>
<span id="cb5-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulating a Clinical Trial --------------------------</span></span>
<span id="cb5-16"></span>
<span id="cb5-17">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"male"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binary"</span>, </span>
<span id="cb5-18">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cid"</span>)</span>
<span id="cb5-19">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"over65"</span>, </span>
<span id="cb5-20">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binary"</span>,</span>
<span id="cb5-21">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-1.7 + .8 * male"</span>, </span>
<span id="cb5-22">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logit"</span>)</span>
<span id="cb5-23">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baseDBP"</span>, </span>
<span id="cb5-24">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>,</span>
<span id="cb5-25">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>)</span>
<span id="cb5-26">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age"</span>, </span>
<span id="cb5-27">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>, </span>
<span id="cb5-28">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, </span>
<span id="cb5-29">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-30">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"visits"</span>, </span>
<span id="cb5-31">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>, </span>
<span id="cb5-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.5 - 0.2 * age + 0.5 * male"</span>, </span>
<span id="cb5-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb5-34">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight"</span>, </span>
<span id="cb5-35">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>,</span>
<span id="cb5-36">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb5-37">dtstudy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">genData</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, def)</span>
<span id="cb5-38">study <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trtAssign</span>(dtstudy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nTrt =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb5-39">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">balanced =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">grpName =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rxGrp"</span>)</span>
<span id="cb5-40">study <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(study)</span>
<span id="cb5-41">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>iq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> iq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wakefield<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">iq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>)</span>
<span id="cb5-42">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wakefield<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">height</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>)</span>
<span id="cb5-43">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>income <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> income <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wakefield<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">income</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, </span>
<span id="cb5-44">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Income"</span>)</span>
<span id="cb5-45">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>SAT_score <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wakefield<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sat</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500</span>, </span>
<span id="cb5-46">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span>, </span>
<span id="cb5-47">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SAT"</span>)</span>
<span id="cb5-48">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>visits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>visits)</span>
<span id="cb5-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add noisy predictors</span></span>
<span id="cb5-50">study[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) </span>
<span id="cb5-51">                         (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, </span>
<span id="cb5-52">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)))</span>
<span id="cb5-53">varname <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x%d"</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>))</span>
<span id="cb5-54"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(study)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> varname</span>
<span id="cb5-55"></span>
<span id="cb5-56">study1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trtAssign</span>(dtstudy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">balanced =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb5-57">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strata =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"male"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"over65"</span>), </span>
<span id="cb5-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">grpName =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rxGrp"</span>)</span>
<span id="cb5-59"></span>
<span id="cb5-60">study1</span>
<span id="cb5-61"></span>
<span id="cb5-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspecting Data  -------------------------------------</span></span>
<span id="cb5-63"></span>
<span id="cb5-64">summarytools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">view</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dfSummary</span>(study))</span>
<span id="cb5-65"></span>
<span id="cb5-66">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>over65 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>over65)</span>
<span id="cb5-67">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>male <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>male)</span>
<span id="cb5-68">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rxGrp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rxGrp)</span>
<span id="cb5-69"></span>
<span id="cb5-70">study_formula <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.formula</span>(baseDBP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> .)</span>
<span id="cb5-71"></span>
<span id="cb5-72"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spearman2</span>(study_formula, study))</span>
<span id="cb5-73"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb5-74"></span>
<span id="cb5-75">x_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model.matrix</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> study)[, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb5-76"></span>
<span id="cb5-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial Data Analysis  ------------------------------</span></span>
<span id="cb5-78"></span>
<span id="cb5-79">(cormatrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor</span>(x_1)))</span>
<span id="cb5-80"></span>
<span id="cb5-81">col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colorRampPalette</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#BB4444"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#EE9988"</span>, </span>
<span id="cb5-82">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#FFFFFF"</span>, </span>
<span id="cb5-83">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#77AADD"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4477AA"</span>))</span>
<span id="cb5-84"></span>
<span id="cb5-85"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">corrplot</span>(cormatrix, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"color"</span>, </span>
<span id="cb5-86">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">col</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>), </span>
<span id="cb5-87">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tl.col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tl.cex =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.40</span>,</span>
<span id="cb5-88">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">addCoef.col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">number.cex =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>)</span>
<span id="cb5-89"></span>
<span id="cb5-90"></span>
<span id="cb5-91">clus1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">varclus</span>(x_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">similarity =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"h"</span>)</span>
<span id="cb5-92">clus2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">varclus</span>(x_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">similarity =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s"</span>)</span>
<span id="cb5-93">clus3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">varclus</span>(x_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">similarity =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p"</span>)</span>
<span id="cb5-94"></span>
<span id="cb5-95"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(clus1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hoeffing's D statistic"</span>, </span>
<span id="cb5-96">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)</span>
<span id="cb5-97"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hierarchical Cluster Analysis"</span>)</span>
<span id="cb5-98"></span>
<span id="cb5-99"></span>
<span id="cb5-100"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(clus2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)</span>
<span id="cb5-101"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(clus3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)</span>
<span id="cb5-102"></span>
<span id="cb5-103">Pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(study)</span>
<span id="cb5-104">(fmla <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.formula</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~"</span>, </span>
<span id="cb5-105">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(Pre, </span>
<span id="cb5-106">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"+"</span>))))</span>
<span id="cb5-107"></span>
<span id="cb5-108"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Redundancy analysis </span></span>
<span id="cb5-109"></span>
<span id="cb5-110">redun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redun</span>(fmla,</span>
<span id="cb5-111">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> study,</span>
<span id="cb5-112">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r2 =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.90</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ordinary"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">allcat =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb5-113">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tlinear =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iterms =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pr =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</details>
</div>
<hr>
<p>The above script simulated some fake data for a hypothetical clinical trial (usually we use this first script to load data from a .csv or .txt file) and then we used several functions to inspect the dataframe for the structure and distributions of the variables and missing data, etc. We also attempted to properly code the variables. Now, in order to capture any possible errors, we will have to run this entire script from another <code>R</code> script instead of running it line by line or selecting all the code and running it.</p>
<p>We will do this from a Main source script, which will allow us to use the <code>tryCatchLog()</code> function.</p>
<hr>
</section>
<section id="example-of-the-main-source-script" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="example-of-the-main-source-script"><span class="header-section-number">2.5</span> Example of the Main Source Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"here"</span>) </span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tryCatchLog"</span>)</span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"futile.logger"</span>)</span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_here</span>() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load and set here</span></span>
<span id="cb6-6"></span>
<span id="cb6-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Call here</span></span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keep.source =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)        </span>
<span id="cb6-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tryCatchLog.write.error.dump.file"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) </span>
<span id="cb6-11"></span>
<span id="cb6-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Script loads all necessary functions</span></span>
<span id="cb6-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.log"</span>)))</span>
<span id="cb6-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>))) </span>
<span id="cb6-16"></span>
<span id="cb6-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Line script to clean the data</span></span>
<span id="cb6-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"02-cleaning.log"</span>)))</span>
<span id="cb6-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"02-cleaning.R"</span>))) </span>
<span id="cb6-21"></span>
<span id="cb6-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Line script below to inspect the data</span></span>
<span id="cb6-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"03-inspection.log"</span>)))</span>
<span id="cb6-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"03-inspection.R"</span>)))  </span>
<span id="cb6-26"></span>
<span id="cb6-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load saved objects from cleanings</span></span>
<span id="cb6-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"03.5-load_data.log"</span>)))</span>
<span id="cb6-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"03.5-load_data.R"</span>))) </span>
<span id="cb6-31"></span>
<span id="cb6-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Main analysis script</span></span>
<span id="cb6-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"04-analysis.log"</span>)))</span>
<span id="cb6-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"04-analysis.R"</span>)))  </span>
<span id="cb6-36"></span>
<span id="cb6-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Below is the validation of main analysis results </span></span>
<span id="cb6-38"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"04.5-validation.log"</span>)))</span>
<span id="cb6-40"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"04.5-validation.R"</span>))) </span>
<span id="cb6-41"></span>
<span id="cb6-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test the sensitivity of the results by</span></span>
<span id="cb6-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># varying assumptions/multiple parameters</span></span>
<span id="cb6-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"05-sensitivity.log"</span>)))</span>
<span id="cb6-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"05-sensitivity.R"</span>))) </span>
<span id="cb6-47"></span>
<span id="cb6-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate tables and figures of all your results </span></span>
<span id="cb6-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"06-tables.log"</span>)))</span>
<span id="cb6-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"06-tables.R"</span>))) </span>
<span id="cb6-52"></span>
<span id="cb6-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Export these into actual files that can be</span></span>
<span id="cb6-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># inserted into papers, reports, etc.</span></span>
<span id="cb6-55"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"07-export.log"</span>)))</span>
<span id="cb6-57"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"07-export.R"</span>))) </span></code></pre></div>
</details>
</div>
<hr>
<p>If anything went wrong during the simulations and their inspections in the first script from above, it would have been captured by the error-catching scripts that we have set up, which would be placed within a .log file in the <code>Errors</code> folder, which is inside the <code>R</code> folder.</p>
<hr>
</section>
<section id="setting-the-seed" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="setting-the-seed"><span class="header-section-number">2.6</span> Setting the Seed</h2>
<hr>
<blockquote class="blockquote">
<p>Also, note that we have set the seed using a specific random number generator algorithm. This is not that important, however, it is important to correctly set the seed for reproducing any random numbers generated. This requires even more careful thought when running a simulation study, in which the states of the simulation need to be saved for a particular repetition, and so that streams do not overlap.[@morrisUsingSimulationStudies2019]</p>
</blockquote>
<hr>
<p>I will admit that the error script is not <em>perfect</em> at capturing warnings, but for most things, if something wrong occurs when a script is run, the function <code>tryCatchLog()</code> and its .log file usually catches the warning, so I would know that something went wrong and what specifically.</p>
<p>However, some may be skeptical of this approach and ask why I need to catch these errors and save them if I ran the scripts? Why not just scroll up and look at the console to see the errors or warnings?</p>
<p>Many reasons:</p>
<hr>
<ul>
<li>Suppose the analyses take a very long time, and are computationally intensive, and <code>R</code>/<a href="https://rstudio.com/"><code>RStudio</code></a> crashes, you may not be able to figure out what went wrong.</li>
<li>Suppose the analysis completed but because there was so much occurring in the console (for example, sampling from a posterior) that you missed the warnings/errors and got results that you don’t know have issues.</li>
</ul>
<hr>
<p>Thus, having this system set up to catch errors in every script also helps us automate the entire workflow once we’ve carefully set it up. After each <code>.R</code> script has one of these message-catching scripts, we can run our entire analysis from start to finish from <code>main.R</code> with one command. This not only makes your workspace organized, but also makes it easier for others to reproduce your work if you share your files and folders via a repository.</p>
<hr>
<p>So, now the <code>Error</code> folder will contain .txt files with any warning messages or errors.</p>
<p>Typically, when I’m setting up a new project, I will also add a few other folders such as an <code>Outputs</code> folder, where I will save tables and graphs, and a <code>Report</code> folder, where I might be working on a manuscript.</p>
<p>Now that I’ve mentioned my hierarchy and how I catch errors, I can mention some other things that I believe are absolutely heinous practices.</p>
<p>Many people often will run an entire analysis and have several objects/vectors stored in their Global Environment in <code>R</code> and <code>RStudio</code>. Suppose they’re taking a break, finished with the analysis, turning off the computer, or stepping away for whatever reason, what they’ll typically do is click the save button on the top right pane and “Save the workspace image”. Indeed, if they don’t do that themselves, the IDE <code>RStudio</code> will explicitly ask them if they wish to save their workspace image.</p>
<p>This is a horrific practice and you should never do this because it can lead to several problems such as:</p>
<ul>
<li><p>having several saved objects and packages conflict with one another once they’re all loaded together at once</p></li>
<li><p>having giant workspace images, that will probably cause <code>R</code>, and especially <code>RStudio</code> to constantly crash</p></li>
<li><p>not allowing you to load very specific objects that you need at a time while leaving everything else</p></li>
</ul>
<p>I would say that it is a good idea to never save the workspace image, ever. It is also quite easy to turn off. Simply go the <code>RStudio</code> menu and click <em>Preferences</em>, and in the <em>General</em> section, you will see the following options:</p>
<hr>
<p><img data-enlargeable="" width="500" style="cursor: zoom-in" src="https://res.cloudinary.com/less-likely/image/upload/v1604649526/Site/RStudio_Default_Save_Options.png"></p>
<hr>
<p>It is essential to uncheck everything under <em>R Sessions</em>, <em>Workspace</em>, and <em>History</em>, so that you do not set your self up for a future disaster.</p>
<p>Instead of using these convenient but highly problematic options, always use the <code>saveRDS()</code> base <code>R</code> function, where the first argument is the object in your environment that you want to save, and the second argument is the path where you want to save it, which of course should be using the <code>here()</code> function.</p>
<p>Now suppose I decided to use multiple imputation because I had a dataset with many missing values, and suppose I had a grasp of the missing data mechanism, and so I used something like the not-at-random fully conditional specification approach (<strong>NARFCS</strong>)[@tompsettUseNotatrandomFully2018] to attempt to handle data that I believe to be missing not at random (<strong>MNAR</strong>), and I wanted to save the imputed dataset, and only load the imputed dataset next time. This is how I would do it (in the vaguest way possible). First, I’ll start with the dataset that we generated above and generate missing values via different missing data mechanisms using the <code>ampute()</code> function from the <code>mice</code> package.[@buurenMiceMultivariateImputation2011]</p>
<hr>
<blockquote class="blockquote">
<p><strong>Important</strong>: This is all assuming that one has carefully constructed an imputation model, and that multiple imputation is the most appropriate solution. As many others have pointed out, simply running a script like <code>mice(data)</code> in <code>R</code> without careful thought to the imputation model, is a very, very bad idea. Missing data is an extremely complex topic and I recommend everyone carefully read the works[@buurenFlexibleImputationMissing2018] of missing data researchers such as:</p>
</blockquote>
<ul>
<li><p><a href="https://stefvanbuuren.name/fimd/">Stef van Buuren</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://twitter.com/tmorris_mrc">Tim Morris</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://www.ctu.mrc.ac.uk/about-us/senior-staff/ian-white/">Ian White</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://scholar.google.com/citations?user=5q4fhUoAAAAJ&amp;hl=en">Donald Rubin</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://thestatsgeek.com/">Jonathan Bartlett</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://www.paulgstf.com/">Paul Gustafson</a></p>
<blockquote class="blockquote">

</blockquote></li>
</ul>
<hr>
</section>
<section id="example-of-a-multiple-imputation-script" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="example-of-a-multiple-imputation-script"><span class="header-section-number">2.7</span> Example of a Multiple Imputation Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>))</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"beepr"</span>)</span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Package that uses multiple imputation</span></span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># by chained equations</span></span>
<span id="cb7-7"></span>
<span id="cb7-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mice"</span>) </span>
<span id="cb7-9">     </span>
<span id="cb7-10"></span>
<span id="cb7-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate Missing Data  --------------------------------</span></span>
<span id="cb7-12"></span>
<span id="cb7-13">study_mnar <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ampute</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> study[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>], </span>
<span id="cb7-14">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.65</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mech =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MNAR"</span>)</span>
<span id="cb7-15">mnar_patterns <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> study_mnar<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>patterns</span>
<span id="cb7-16">mnar_weight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> study_mnar<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>weight</span>
<span id="cb7-17">study_mnar_rerun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ampute</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> study[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>], </span>
<span id="cb7-18">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb7-19">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mech =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MNAR"</span>, </span>
<span id="cb7-20">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">patterns =</span> mnar_patterns,</span>
<span id="cb7-21">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weights =</span> mnar_weight)</span>
<span id="cb7-22">study_mar <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ampute</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> study[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb7-23">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mech =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MAR"</span>)</span>
<span id="cb7-24">mar_patterns <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> study_mar<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>patterns</span>
<span id="cb7-25">mar_weight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> study_mar<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>weight</span>
<span id="cb7-26">study_mar_rerun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ampute</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> study[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>], </span>
<span id="cb7-27">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb7-28">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mech =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MAR"</span>, </span>
<span id="cb7-29">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">patterns =</span> mar_patterns,</span>
<span id="cb7-30">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weights =</span> mar_weight)</span>
<span id="cb7-31"></span>
<span id="cb7-32">study_mar_rerun[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>over65 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>()</span>
<span id="cb7-34">study_mar_rerun[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>()</span>
<span id="cb7-36">study_mar_rerun[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rxGrp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>()</span>
<span id="cb7-38"></span>
<span id="cb7-39">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> study_mnar_rerun<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>amp</span>
<span id="cb7-40">df2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> study_mar_rerun<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>amp</span>
<span id="cb7-41"></span>
<span id="cb7-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspect Data</span></span>
<span id="cb7-43"></span>
<span id="cb7-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(df) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspect data frame</span></span>
<span id="cb7-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(df) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># High level summary of dataframe</span></span>
<span id="cb7-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(df)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Look at missing values etc.</span></span>
<span id="cb7-47"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colSums</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(df))</span>
<span id="cb7-48">summarytools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">view</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dfSummary</span>(df)) </span>
<span id="cb7-49"></span>
<span id="cb7-50"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(df2) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspect data frame</span></span>
<span id="cb7-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(df2) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># High level summary of dataframe</span></span>
<span id="cb7-52"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(df2)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Look at missing values etc.</span></span>
<span id="cb7-53"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colSums</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(df2))</span>
<span id="cb7-54">summarytools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">view</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dfSummary</span>(df2)) </span>
<span id="cb7-55"></span>
<span id="cb7-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prepare Data for Imputation -------------------------</span></span>
<span id="cb7-57"></span>
<span id="cb7-58">temp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df</span>
<span id="cb7-59">temp2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df2</span>
<span id="cb7-60"></span>
<span id="cb7-61"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">missing_plot</span>(temp)</span>
<span id="cb7-62"></span>
<span id="cb7-63"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">missing_plot</span>(temp2)</span>
<span id="cb7-64"></span>
<span id="cb7-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set-up predictor matrix</span></span>
<span id="cb7-66"></span>
<span id="cb7-67">predMatrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make.predictorMatrix</span>(temp)</span>
<span id="cb7-68">predMatrix2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make.predictorMatrix</span>(temp2)</span>
<span id="cb7-69"></span>
<span id="cb7-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set-up predictor matrix for unidentifiable part:</span></span>
<span id="cb7-71">predSens <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb7-72"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(predSens) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(temp), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb7-73"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(predSens) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(temp)</span>
<span id="cb7-74"></span>
<span id="cb7-75"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set-up list with sensitivity parameter values</span></span>
<span id="cb7-76"></span>
<span id="cb7-77">pSens <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(temp))</span>
<span id="cb7-78"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(pSens) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(temp)</span>
<span id="cb7-79">pSens[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rxGrp"</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb7-80">pSens[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baseDBP"</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb7-81">pSens[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"male"</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb7-82">pSens[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"over65"</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-83"></span>
<span id="cb7-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MICE RI Imputation  ----------------------------------</span></span>
<span id="cb7-85"></span>
<span id="cb7-86">z1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parlmice</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ri"</span>,</span>
<span id="cb7-87">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">predictorMatrix =</span> predMatrix,</span>
<span id="cb7-88">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maxit =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb7-89">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster.seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb7-90">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.imp.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cl.type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FORK"</span>, </span>
<span id="cb7-91">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ridge =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-04</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">remove.collinear =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb7-92">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">remove.constant =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">allow.na =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) </span>
<span id="cb7-93"></span>
<span id="cb7-94">z2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parlmice</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pmm"</span>,</span>
<span id="cb7-95">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">predictorMatrix =</span> predMatrix2,</span>
<span id="cb7-96">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maxit =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb7-97">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster.seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb7-98">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ridge =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-04</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">remove.collinear =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb7-99">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.imp.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cl.type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FORK"</span>) </span>
<span id="cb7-100"></span>
<span id="cb7-101">zfinal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(z1, z2)</span>
<span id="cb7-102"></span>
<span id="cb7-103"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Heckman Imputation  ----------------------------------</span></span>
<span id="cb7-104"></span>
<span id="cb7-105">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>baseDBP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> temp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>baseDBP</span>
<span id="cb7-106">JointModelEq<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">generate_JointModelEq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>temp, </span>
<span id="cb7-107">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varMNAR=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baseDBP"</span>)</span>
<span id="cb7-108">JointModelEq[,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baseDBP_var_sel"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-109">JointModelEq[,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baseDBP_var_out"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-110"></span>
<span id="cb7-111">arg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">MNARargument</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varMNAR =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baseDBP"</span>, </span>
<span id="cb7-112">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">JointModelEq =</span> JointModelEq)</span>
<span id="cb7-113"></span>
<span id="cb7-114">arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>method[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ri"</span></span>
<span id="cb7-115">arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>method[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"visits"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ri"</span></span>
<span id="cb7-116">arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>method[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ri"</span></span>
<span id="cb7-117">arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>method[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iq"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ri"</span></span>
<span id="cb7-118">arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>method[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"height"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ri"</span></span>
<span id="cb7-119"></span>
<span id="cb7-120">imp1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parlmice</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data_mod,</span>
<span id="cb7-121">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>method,</span>
<span id="cb7-122">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">predictorMatrix =</span> arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>predictorMatrix,</span>
<span id="cb7-123">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">JointModelEq =</span> arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>JointModelEq,</span>
<span id="cb7-124">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>control,</span>
<span id="cb7-125">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maxit =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb7-126">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster.seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb7-127">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.imp.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cl.type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FORK"</span>)</span>
<span id="cb7-128"></span>
<span id="cb7-129">analysis1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(zfinal, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(baseDBP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> visits <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> iq <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rxGrp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> over65))</span>
<span id="cb7-130">result1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pool</span>(analysis1)</span>
<span id="cb7-131"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(result1)</span>
<span id="cb7-132"></span>
<span id="cb7-133">z2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parlmice</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pmm"</span>,</span>
<span id="cb7-134">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">predictorMatrix =</span> predMatrix2,</span>
<span id="cb7-135">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maxit =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb7-136">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster.seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb7-137">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.imp.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cl.type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FORK"</span>) </span>
<span id="cb7-138"></span>
<span id="cb7-139">heckman <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(imp1, z2)</span>
<span id="cb7-140"></span>
<span id="cb7-141"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">beep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I will touch on this function below.</span></span>
<span id="cb7-142"></span>
<span id="cb7-143"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">saveRDS</span>(zfinal, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, </span>
<span id="cb7-144">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zfinal.rds"</span>))</span></code></pre></div>
</details>
</div>
<hr>
<p>Here is the workflow truly showing its advantages, <code>saveRDS()</code> is saving a very specific object (<code>zfinal</code>, the imputed dataset) into the <code>Data</code> folder by using the hierarchical structure of the folder which can easily be navigated using <code>here()</code>. Notice how to save something and use <code>here()</code> to specify the location, the first argument is <code>Main Project</code>, followed by <code>Data</code>, and then comes the object name (<code>zfinal.rds</code>).</p>
<p>Now I have saved my imputed dataset as an object called <code>zfinal.rds</code> and it is saved in the <code>Data</code> folder even though I am hypothetically working from the <code>R</code> folder.</p>
<p>Also notice that I use the <code>beep()</code> function from the <a href="https://cran.r-project.org/package=beepr">beepr</a> <code>R</code> package, which can be quite handy in letting you know if a particular script or analysis is done.</p>
<p>Next time, if I cleared my entire global environment and wanted to only load the imputed dataset, I would simply have to just click on the <code>zfinal.rds</code> file in the <code>Data</code> folder and it would load into the environment or I could use the following command,</p>
<hr>
</section>
<section id="saving-and-reading-data-carefully" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="saving-and-reading-data-carefully"><span class="header-section-number">2.8</span> Saving and Reading Data Carefully</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The function readRDS() and saveRDS()</span></span>
<span id="cb8-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># are possibly the most important base R functions</span></span>
<span id="cb8-3"></span>
<span id="cb8-4">zfinal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zfinal.rds"</span>, </span>
<span id="cb8-5">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, </span>
<span id="cb8-6">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zfinal.rds"</span>))</span></code></pre></div>
</details>
</div>
<hr>
<p>This gives us full control over the environment, and it’s also why I encourage people to turn off the automatic prompt to save the workspace that <a href="https://rstudio.com/"><code>RStudio</code></a> gives you by default (I am certain even Hadley Wickham has said the same on multiple occasions).</p>
<p>So if I now wanted to include the imputed dataset into one of my <code>.R</code> scripts that I am trying to automate with one command, whether for reproducibility, or speed, etc., I could do it with absolute control.</p>
<p>This is also how I save my models and how I validate them, which is especially handy because running those can also take an excruciatingly long time.</p>
<p>Here’s an example of a script that would be in the <code>04-analysis.R</code> script, I’m leaving out the warning-catching script now to avoid making this too long. I don’t need to load the <a href="https://cran.r-project.org/package=brms"><code>brms</code></a> package because I’m already calling it from the first <code>.R</code> script, <code>01-functions.R</code> (but I’m just showing it for now to avoid confusion), and then I am saving it in the <code>Models</code> folder which is found in the <code>Data</code> folder. And again, the <code>beep()</code> function would let me know when the script is over, and scripts like this can often take very long, due to the computational intensity.</p>
<p>The script below is an analysis script whose results we plan on saving once completed. Due to the arguments I have set (iterations, warmups, chains, and using an imputed dataset), it can often take a long time before it is finished, and if I did happen to do other tasks while I was waiting on that, the output would automatically save to the <code>Models</code> folder via <code>saveRDS()</code>, and I would also receive a notification via the <code>beep()</code> function, preventing me from wasting any time.</p>
<hr>
</section>
<section id="example-modeling-script" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="example-modeling-script"><span class="header-section-number">2.9</span> Example Modeling Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calling all packages, please report for duty</span></span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>)) </span>
<span id="cb9-4"></span>
<span id="cb9-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"brms"</span>) </span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This is a script I used previously</span></span>
<span id="cb9-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># where I used Bayes for regularization  </span></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Although these are all generic options </span></span>
<span id="cb9-10"></span>
<span id="cb9-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prior Information  --------------------------------</span></span>
<span id="cb9-12"></span>
<span id="cb9-13">sample_z <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">complete</span>(zfinal, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb9-14"></span>
<span id="cb9-15">n_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(sample_z) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># of observations</span></span>
<span id="cb9-16"></span>
<span id="cb9-17">k_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(sample_z) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># of predictors</span></span>
<span id="cb9-18"></span>
<span id="cb9-19">p0_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prior for the number of relevant variables</span></span>
<span id="cb9-20"></span>
<span id="cb9-21">tau0_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p0_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (k_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> p0_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_1) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tau scale</span></span>
<span id="cb9-22"></span>
<span id="cb9-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Regularized horseshoe prior</span></span>
<span id="cb9-24">hs_prior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_prior</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"horseshoe(scale_global = tau0_1, </span></span>
<span id="cb9-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                      scale_slab = 1)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">class =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>)</span>
<span id="cb9-26"></span>
<span id="cb9-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"future"</span>)</span>
<span id="cb9-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plan</span>(multiprocess)</span>
<span id="cb9-29"></span>
<span id="cb9-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Regularized Bayesian quantile</span></span>
<span id="cb9-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># regression using regularized horseshoe prior</span></span>
<span id="cb9-32">brms<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brm_multiple</span>(</span>
<span id="cb9-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bf</span>(baseDBP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> visits <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> iq <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rxGrp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> over65, </span>
<span id="cb9-34">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quantile =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>),</span>
<span id="cb9-35">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zfinal, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior =</span> hs_prior, </span>
<span id="cb9-36">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">asym_laplace</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sample_prior =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb9-37">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">future =</span> F,</span>
<span id="cb9-38">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warmup =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chains =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb9-39">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">thin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">combine =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb9-40">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_treedepth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, </span>
<span id="cb9-41">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">adapt_delta =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.80</span>)) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> pen_model_1</span>
<span id="cb9-42"></span>
<span id="cb9-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Principled way of saving results</span></span>
<span id="cb9-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">saveRDS</span>(pen_model_1,   </span>
<span id="cb9-45">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>, </span>
<span id="cb9-46">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pen_model_1.rds"</span>)) </span>
<span id="cb9-47"></span>
<span id="cb9-48"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">beep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
</details>
</div>
<hr>
<p>So I’ve saved the full contents of the fitted model (<code>pen_model_1</code>), which are usually several gigabytes large in size, within the <code>Models</code> folder. Once again, notice how the <code>here()</code> function allows you to work from a subfolder like <code>R</code>, which is inside the <code>Main Project</code> folder, and allows you to specify the hierarchy, and where you are within it, and save to whichever folder you wish, in this case <code>Models</code>, which is inside of <code>Data</code>. Now, I will typically conduct model checks and make sure it is performing well, and not misspecified,</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>)) </span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspect RHat values ---------------------------</span></span>
<span id="cb10-4"> </span>
<span id="cb10-5">rhats_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pen_model_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rhats</span>
<span id="cb10-6"></span>
<span id="cb10-7">rhats_1_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (rhats_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>)</span>
<span id="cb10-8">((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(rhats_1_df)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> </span>
<span id="cb10-9">    (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(rhats_1_df) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(rhats_1_df)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>))</span>
<span id="cb10-10"></span>
<span id="cb10-11">rhats_1_vec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb10-12">  rhats_1[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(rhats_1)])))</span>
<span id="cb10-13"></span>
<span id="cb10-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pdf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figures"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diagnostics"</span>, </span>
<span id="cb10-15">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_COMP_rhat.pdf"</span>))</span>
<span id="cb10-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_rhat_hist</span>(rhats_1_vec) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model 1 Chain Convergence"</span>)</span>
<span id="cb10-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dev.off</span>()</span>
<span id="cb10-19"></span>
<span id="cb10-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspect Effective Sample Size ----------------------</span></span>
<span id="cb10-21"></span>
<span id="cb10-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_neff_hist</span>(rhats_1_vec) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effective Sample Size"</span>)</span>
<span id="cb10-24"></span>
<span id="cb10-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspect Divergences ---------------------------</span></span>
<span id="cb10-26"></span>
<span id="cb10-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pdf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figures"</span>, </span>
<span id="cb10-28">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diagnostics"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_1.pdf"</span>))</span>
<span id="cb10-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_nuts_divergence</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nuts_params</span>(pen_model_1), </span>
<span id="cb10-30">                     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log_posterior</span>(pen_model_1))</span>
<span id="cb10-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dev.off</span>()</span>
<span id="cb10-32"></span>
<span id="cb10-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Examine Residual Plots ----------------------------</span></span>
<span id="cb10-34"></span>
<span id="cb10-35">df_resid_stan_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fitted</span>(pen_model_1)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb10-36">                              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">residuals</span>(pen_model_1)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb10-37"></span>
<span id="cb10-38"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pdf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figures"</span>, </span>
<span id="cb10-39">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diagnostics"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_1.pdf"</span>))</span>
<span id="cb10-40"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df_resid_stan_1, </span>
<span id="cb10-41">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sample =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">residuals</span>(pen_model_1)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_qq</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_qq_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model 1 Residuals"</span>)</span>
<span id="cb10-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dev.off</span>()</span>
<span id="cb10-46"></span>
<span id="cb10-47">(sum1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">posterior_summary</span>(pen_model_1))[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, ])</span>
<span id="cb10-48"></span>
<span id="cb10-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_intervals</span>(pen_model_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"median"</span>, </span>
<span id="cb10-50">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob_outer =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb10-51">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parnames</span>(pen_model_1)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-52">  ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_discrete</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>),</span>
<span id="cb10-54">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>),</span>
<span id="cb10-55">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, </span>
<span id="cb10-56">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rect"</span>,</span>
<span id="cb10-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb10-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.075</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>,</span>
<span id="cb10-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb10-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#990000"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb10-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>,</span>
<span id="cb10-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb10-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#990000"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb10-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change in Outcome 1"</span>)</span>
<span id="cb10-69"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dev.off</span>()</span>
<span id="cb10-70"></span>
<span id="cb10-71"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pdf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figures"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_1.pdf"</span>))</span>
<span id="cb10-72"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_hist</span>(pen_model_1)</span>
<span id="cb10-73"></span>
<span id="cb10-74"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Posterior Predictive Checks</span></span>
<span id="cb10-75"> </span>
<span id="cb10-76"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pdf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figures"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diagnostics"</span>, </span>
<span id="cb10-77">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_1check.pdf"</span>))</span>
<span id="cb10-78"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pp_check</span>(pen_model_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nsamples =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Posterior Predictive Check: Model 1"</span>)</span>
<span id="cb10-80"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dev.off</span>()</span>
<span id="cb10-81"></span>
<span id="cb10-82"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Shows dens_overlay plot by default</span></span>
<span id="cb10-83"></span>
<span id="cb10-84">bayes_rsq1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bayes_R2</span>(pen_model_1)</span>
<span id="cb10-85"></span>
<span id="cb10-86">bayes_rsq1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(bayes_rsq1))</span>
<span id="cb10-87"></span>
<span id="cb10-88"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(sum1, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tables"</span>, </span>
<span id="cb10-89">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_1.csv"</span>))</span></code></pre></div>
</details>
</div>
<hr>
<p>Once I have fit my model and done some initial checks, I usually conduct some more thorough checks using k-fold cross-validation or nested cross-validation, or bootstrap optimism.</p>
<p>A script of this can be found below.</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>))</span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 10-Fold Cross-Validations -------------------------</span></span>
<span id="cb11-4"></span>
<span id="cb11-5">kfold_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kfold</span>(pen_model_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">K =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, </span>
<span id="cb11-6">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">save_fits =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb11-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">saveRDS</span>(kfold_1, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>, </span>
<span id="cb11-8">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Validation"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfold_1.rds"</span>))</span>
<span id="cb11-9">kfp_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kfold_predict</span>(kfold_1)</span>
<span id="cb11-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">saveRDS</span>(kfp_1, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>, </span>
<span id="cb11-11">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Validation"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfp_1.rds"</span>))</span>
<span id="cb11-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kfold_rmse</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> kfp_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, </span>
<span id="cb11-13">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yrep =</span> kfp_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>yrep, </span>
<span id="cb11-14">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rmse"</span>, </span>
<span id="cb11-15">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reps =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>, </span>
<span id="cb11-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]][[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>]]<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> kfold_rmse_1</span>
<span id="cb11-17"></span>
<span id="cb11-18">kfold_rmse_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(kfold_rmse_1)</span>
<span id="cb11-19"></span>
<span id="cb11-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">saveRDS</span>(kfold_rmse_1, </span>
<span id="cb11-21">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>, </span>
<span id="cb11-22">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Validation"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfold_rmse_1.rds"</span>))</span></code></pre></div>
</details>
</div>
<hr>
<p>Once I’ve written all my analysis and validation scripts, I’ll typically create a subfolder in the <code>Outputs</code> folder called <code>Figures</code> and <code>Tables</code> and save them appropriately with the help <code>here()</code>.</p>
<hr>
</section>
<section id="example-table-script" class="level2" data-number="2.10">
<h2 data-number="2.10" class="anchored" data-anchor-id="example-table-script"><span class="header-section-number">2.10</span> Example Table Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>))</span>
<span id="cb12-2"></span>
<span id="cb12-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read in Validation Objects ------------------------</span></span>
<span id="cb12-4"></span>
<span id="cb12-5">kfold_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfold_1.rds"</span>, </span>
<span id="cb12-6">                   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, </span>
<span id="cb12-7">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Validation"</span>, </span>
<span id="cb12-8">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfold_1.rds"</span>))</span>
<span id="cb12-9">kfold_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfold_1.rds"</span>, </span>
<span id="cb12-10">                   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, </span>
<span id="cb12-11">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Validation"</span>, </span>
<span id="cb12-12">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfold_2.rds"</span>))</span>
<span id="cb12-13">kfp_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfp_1.rds"</span>, </span>
<span id="cb12-14">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, </span>
<span id="cb12-15">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Validation"</span>, </span>
<span id="cb12-16">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfp_1.rds"</span>))</span>
<span id="cb12-17">kfp_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfp_1.rds"</span>, </span>
<span id="cb12-18">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, </span>
<span id="cb12-19">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Validation"</span>, </span>
<span id="cb12-20">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfp_2.rds"</span>))</span>
<span id="cb12-21"></span>
<span id="cb12-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract Estimates from Objects ---------------------</span></span>
<span id="cb12-23"> </span>
<span id="cb12-24">KFOLDIC_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(kfold_1[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], </span>
<span id="cb12-25">                     kfold_2[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>])</span>
<span id="cb12-26">KFOLDIC_SE_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(kfold_1[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], </span>
<span id="cb12-27">                        kfold_2[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb12-28">BAYES_R2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(bayes_rsq1, bayes_rsq2), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb12-29">KFOLD_ELPD_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(kfold_1[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb12-30">                        kfold_2[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb12-31">KFOLD_ELPD_SE_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(kfold_1[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], </span>
<span id="cb12-32">                           kfold_2[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb12-33"></span>
<span id="cb12-34">Outcome <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_2"</span>)</span>
<span id="cb12-35"></span>
<span id="cb12-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Construct Data Frames ------------------------------</span></span>
<span id="cb12-37"></span>
<span id="cb12-38">table4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(Outcome, BAYES_R2, KFOLD_ELPD_1, </span>
<span id="cb12-39">                     KFOLD_ELPD_SE_1, KFOLDIC_1, </span>
<span id="cb12-40">                     KFOLDIC_SE_1)</span>
<span id="cb12-41"></span>
<span id="cb12-42"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(table4) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outcome"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bayes R^2"</span>, </span>
<span id="cb12-43">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV ELPD"</span>, </span>
<span id="cb12-44">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV ELPD SE"</span>,</span>
<span id="cb12-45">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV IC"</span>, </span>
<span id="cb12-46">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV IC SE"</span>)</span>
<span id="cb12-47"></span>
<span id="cb12-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Export as Tables ----------------------------------</span></span>
<span id="cb12-49"></span>
<span id="cb12-50"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(table4, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, </span>
<span id="cb12-51">                       <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tables"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table4.csv"</span>))</span>
<span id="cb12-52"></span>
<span id="cb12-53">table5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(Outcome, KFOLD_ELPD_1, </span>
<span id="cb12-54">                     KFOLD_ELPD_SE_1, </span>
<span id="cb12-55">                     KFOLDIC_1, KFOLDIC_SE_1)</span>
<span id="cb12-56"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(table5) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outcome"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV ELPD"</span>, </span>
<span id="cb12-57">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV ELPD SE"</span>,</span>
<span id="cb12-58">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV IC"</span>, </span>
<span id="cb12-59">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV IC SE"</span>)</span>
<span id="cb12-60"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(table5, </span>
<span id="cb12-61">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tables"</span>, </span>
<span id="cb12-62">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table5.csv"</span>))</span>
<span id="cb12-63"></span>
<span id="cb12-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save Tables From Sensitivity Analyses --------------</span></span>
<span id="cb12-65"></span>
<span id="cb12-66"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(sens_table_OUTCOME_1, </span>
<span id="cb12-67">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tables"</span>, </span>
<span id="cb12-68">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table7_OUTCOME_1.csv"</span>))</span>
<span id="cb12-69"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(sens_table_OUTCOME_2, </span>
<span id="cb12-70">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tables"</span>, </span>
<span id="cb12-71">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table7_OUTCOME_2.csv"</span>))</span></code></pre></div>
</details>
</div>
<hr>
<p>Then, I’ll go back to the <code>README.Rmd</code> file, make notes of the hierarchy of the entire folder and subfolders, and what’s been completed, and what still needs to be done.</p>
<p>Now, suppose I deleted all of my saved models, imputed data, graphs, and tables, (which would be a devastating blow!) and only had the original dataset and organized scripts. Anyone could go into my project and simply highlight the entire <code>main.R</code> file and run it, and they would get all the same outputs and models, assuming a seed was set in advance, which is essential. Although, it might take them a long time to get the same outputs (if computationally intensive)… they would likely be able to get all the exact same results.</p>
<hr>
</section>
</section>
<section id="possible-drawbacks-of-this-approach" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Possible Drawbacks of this Approach</h1>
<hr>
<p>Every proposal tends to have drawbacks or limitations, and those who do not explicitly tell you about them are misleading you. In the approach I have outlined above, one major drawback is that it takes a somewhat long time to set up and therefore could deter many statisticians and data analysts. The other drawback is that by loading all your functions and libraries in the first <code>01_functions.R</code> script, there is potential for conflict between functions, therefore you’ll have to be mindful of what packages you need and when. Indeed, I ran into this issue when loading the <code>brms</code> package, which had several functions that conflicted with the base <code>R</code> functions. So please be mindful of this.</p>
<p>Further, and most importantly, I have no evidence that this approach can truly prevent errors, it is simply a belief I have as a result of my own experiences and suggesting them to others, and hearing positive comments. So please, take that into account, although I would be grateful if you were able to share your positive or even negative experiences using this approach below.</p>
<hr>
<p>Please, please annotate your scripts, as I have done so several times above to explain some of the functions. This is not only helpful for others who are trying to go through your code and understand it, but also for yourself. If you end up forgetting what function does what, and what steps you were taking, you will be in for a really frustrating time, and possibly prone to making serious mistakes.</p>
<p>Here’s what my project folders tend to look like (figure below). And here is a <a href="https://github.com/zadrafi/statworkflow">template GitHub repo</a> to show what the structure typically looks like.</p>
<hr>
<p><img data-enlargeable="" width="400" style="cursor: zoom-in" src="https://res.cloudinary.com/less-likely/image/upload/v1592068111/Site/Screen_Shot_2020-06-13_at_11.38.26_AM.png"></p>
<hr>
<p>It should go without saying that sharing your data (if possible) and code will help you and your collaborators catch errors before it’s too late, but also, sharing them with others/the public after a project is done will <em>also</em> help catch possible errors that you/your collaborators/reviewers didn’t catch, which may mislead other researchers and also result in a much more stressful situation for you.</p>
<p>And last but not least, it is also essential to give extensive details on which version of <code>R</code> you used and which packages you used and their versions. This is because many scripts that once worked on previous versions of the software may no longer give the same results or may not even work at all. In order for someone to reproduce your results, they’ll need to know the environment on which you ran your analyses on. You can provide these details easily simply by running the script <code>sessionInfo()</code>, which should be at the end of every <code>R</code> script you run.</p>
<hr>
</section>
<section id="helpful-resources" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Helpful Resources</h1>
<hr>
<ul>
<li><a href="https://stackoverflow.com/questions/1429907/workflow-for-statistical-analysis-and-report-writing">Workflow for Statistical Analysis and Report Writing</a></li>
</ul>
<hr>
<ul>
<li><a href="https://stackoverflow.com/questions/19967478/how-to-save-data-file-into-rdata">How to Save Data File into .RData?</a></li>
</ul>
<hr>
<ul>
<li><a href="https://www.youtube.com/watch?v=Ry2xjTBtNFE">Basic Data Entry Using Excel</a></li>
</ul>
<hr>
<ul>
<li><a href="https://www.kristianbrock.com/post/send-me-data/">Sending Me Data in Excel</a></li>
</ul>
<hr>
<ul>
<li><a href="https://happygitwithr.com/">Happy Git and GitHub for the useR</a></li>
</ul>
<hr>
</section>
<section id="environment" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Environment</h1>
<hr>
<p>The analyses were run on:</p>
<hr>
<div class="cell">
<pre><code>#&gt; R version 4.5.0 (2025-04-11)
#&gt; Platform: aarch64-apple-darwin20
#&gt; Running under: macOS Sequoia 15.6.1
#&gt; 
#&gt; Matrix products: default
#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib 
#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1
#&gt; 
#&gt; Random number generation:
#&gt;  RNG:     Mersenne-Twister 
#&gt;  Normal:  Inversion 
#&gt;  Sample:  Rejection 
#&gt;  
#&gt; locale:
#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
#&gt; 
#&gt; time zone: America/New_York
#&gt; tzcode source: internal
#&gt; 
#&gt; attached base packages:
#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;  [1] htmlwidgets_1.6.4 compiler_4.5.0    fastmap_1.2.0     cli_3.6.5        
#&gt;  [5] tools_4.5.0       htmltools_0.5.8.1 rstudioapi_0.17.1 yaml_2.3.10      
#&gt;  [9] rmarkdown_2.29    knitr_1.50        jsonlite_2.0.0    xfun_0.53        
#&gt; [13] digest_0.6.37     rlang_1.1.6       evaluate_1.0.5</code></pre>
</div>
<hr>
</section>
<section id="references" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> References</h1>
<hr>


<!-- -->

</section>

 ]]></description>
  <category>statistics</category>
  <guid>https://lesslikely.com/posts/statistics/statistical-quality-control.html</guid>
  <pubDate>Sat, 13 Jun 2020 04:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/v1613136545/Site/diagram.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Quality Control in Statistical Analyses</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/statistical-quality-control.html</link>
  <description><![CDATA[ 





<hr>
<p>Experienced statisticians and data analysts are familiar with stories where a coding error has led to an entire conclusion changing, <a href="https://jamanetwork.com/journals/jama/fullarticle/2752474">or even a retraction</a>.[@aboumatarNoticeRetractionAboumatar2019] It’s the sort of stuff that keeps people up at night. Unfortunately, not many of us think about these sorts of scenarios until we realize it’s very possible that it could happen to any of us.</p>
<p>To me, it seems that many of these issues could be avoided by having a principled data management and statistical workflow, and making it as transparent, open, and reproducible as possible. I’d like to quickly go over a few things that I’ve found helpful over the years, and I’ll first start with data management and data entry and then move onto analysis workflows. I largely consider this to be a living document, and I’m sure many people who will read this will have far better suggestions, so please leave them down below in the comments!</p>
<p>Before I go on, I want to emphasize that backing up your data, scripts, and <a href="https://happygitwithr.com/">using version control</a> is extremely important. There is no debate about this. It’s necessary so that other collaborators/colleagues can inspect your work and catch potential mistakes or see overall progress, but more importantly, it will prevent you from losing your data in a disaster, and it’ll help you catch your own mistakes, since you’ll be the most familiar with the data and scripts.</p>
<hr>
<section id="data-entry-management" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Data Entry &amp; Management</h1>
<hr>
<p>A nice paper that I’d like to review is the one by <a href="https://doi.org/10.1080/00031305.2017.1375989">Broman &amp; Woo, 2018</a> on how to manage your data when working with spreadsheets.[@bromanDataOrganizationSpreadsheets2018] The sad reality is that even though spreadsheets like Microsoft Excel or Google Sheets are available everywhere, and easy to use, there are many risks when working with spreadsheets, just ask any <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-1044-7?fbclid=IwAR06eQ5LTg2LX5byJBWfC6rJdAbAGXKvy3PUOhzPsVjUGqb7KqB1V_x36M0">statistician who works in genetics</a> or any bioinformatician.[@ziemannGeneNameErrors2016]</p>
<p>One of the most fatal errors <a href="https://theconversation.com/why-you-should-never-use-microsoft-excel-to-count-coronavirus-cases-147681">occurred recently</a> when a group of researchers lost thousands of documented COVID cases because they entered data for each case as a column instead of a row, and Excel has a limit on how many columns and rows it can handle (<strong>1,048,576 rows</strong> and <strong>16,384 columns</strong>, <a href="https://support.microsoft.com/en-us/office/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3">according to Microsoft</a>), as a result, most of these cases were lost, resulting in an enormous waste of resources due to a careless and ignorant mistake, highlighting the dangers of recklessly inputting data and conducting statistical analyses. There is no doubt that reviewing principles of good data management and workflow are essential to any data analyst. I’d like to touch on some of the most important points of <a href="https://doi.org/10.1080/00031305.2017.1375989">Broman &amp; Woo, 2018</a> paper before moving onto some other “principles” I’d like to share:</p>
<hr>
<section id="general-principle-be-consistent-with-everything" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="general-principle-be-consistent-with-everything"><span class="header-section-number">1.1</span> General Principle: Be Consistent With Everything</h2>
<hr>

<ul>
<li>When labeling missing values (<code>NA</code>, <code>N/A</code>, etc.):
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Choose one method (<code>NA</code>, <code>N/A</code>, etc.) and stick with it.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: Leaving cells empty to indicate missingness.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When labeling response variables:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: If you label a response variable consistently, for example, <code>fat-free-mass</code> in every instance to refer to the same variable.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: If you label a response variable <code>fat-free-mass</code> in one script/sheet, and <code>ffm</code>/<code>fat_free_mass</code> in another.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When formatting variable predictor names:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: <code>predictor_1_week12</code>, <code>predictor_2_week12</code>, <code>response_variable_week12</code>. This is consistent, with the order of the names, and dates/weeks, so it is easier to organize, inspect, and clean. Same thing applies to labeling response variables and pretty much all variables.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: When you label one variable <code>week12_predictor_1</code>, the next <code>predictor_2_week12</code>, and the last, <code>12_week_response</code>. Just <em>no</em>.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When formatting dates:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Use one format, <code>YYYY-MM-DD</code>, consistently.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: Everything else.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When filling out cells:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: One cell = one thing. No more, no less.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: One cell = multiple entries or no entries at all.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When keeping track of the data:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Create a comprehensive data dictionary so anyone can look at it and understand the spreadsheets/dataframes/variables.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: Expecting yourself and others to figure it out based on the variable names that you thought were brilliant.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>When using Excel or Google Sheet’s shiny features:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Avoid using any of them, any formulas, highlighting, <em>italicizing</em>, <span style="font-weight:700;">bolding</span>, etc.
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: If you’re the type of person to create charts in Excel.
</p></li>
</ul></li>
</ul>
<hr>
<ul>
<li>Planning for disasters:
<ul>
<li><p>
<span style="color:#7aa864; font-weight: 700;">Good</span>: Always, always, backup your files, save them in .txt files. Keep backups of those. And most importantly, <a href="https://happygitwithr.com/"><strong>use version control!</strong></a>
</p></li>
<li><p>
<span style="color:#CD5C5C; font-weight: 700;">Bad</span>: You don’t really plan for disasters and go with the flow.
</p></li>
</ul></li>
</ul>

<hr>
<ul>
<li>Last but not least, when entering cases:
<ul>
<li><p>
</p><p><span style="color:#7aa864; font-weight: 700;">Good</span>: Rows are for cases and observations, and columns are for variables and characteristics. Please do not switch these up!</p></li>
<li><p>
</p><p><span style="color:#CD5C5C; font-weight: 700;">Bad</span>: Using them interchangeably.</p></li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="setting-up-a-principled-statistical-workflow" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Setting Up a Principled Statistical Workflow</h1>
<hr>
<p>Here’s what I’ve been doing for many years and what seems to work for me (none of these ideas are originally mine, and I actually picked them up over the years from others’ advice, which will be linked below).</p>
<hr>
<section id="setting-up-the-project-folder" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="setting-up-the-project-folder"><span class="header-section-number">2.1</span> Setting up the Project Folder</h2>
<hr>
<p>When setting up a folder specific for a project (if you’re not doing this, you absolutely need to), first, I will create a folder with the title of my project, and usually have an <a href="https://rstudio.com/"><code>RStudio</code></a> project set up in there.</p>
<hr>
<blockquote class="blockquote">
<p>Disclaimer: while much of this advice will be familiar and easy to understand for those who use <code>R</code>, I think the general principles are widely applicable, especially for those who use scripts in their statistical software).</p>
</blockquote>
<hr>
<p>This folder will contain many other folders (more on that below), so the structure will end up being a bit complex.</p>
<hr>
<p><img data-enlargeable="" style="cursor: zoom-in" src="https://res.cloudinary.com/less-likely/image/upload/v1613136545/Site/diagram.png" alt="workflow"></p>
<hr>
<blockquote class="blockquote">
<p>It may be a bit difficult to read the words within the circles, but clicking on the diagram should enlargen it and allow you to zoom in, giving you a sense of how I organize all these scripts and files.</p>
</blockquote>
<hr>
<p>If this ends up confusing you, you can just scroll all the way down to see an image of what the folder structure looks like.</p>
<p>Instead of constantly changing the working directory to each subfolder when I need to do something inside that subfolder for a particular project or analysis, I set the project folder as the working directory only once, and then run the following:</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Very seriously consider installing the `here` package</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://cran.r-project.org/package=here</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"here"</span>) </span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This and the scripts below take</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the directory used and set it as the top</span></span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_here</span>() </span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>()</span></code></pre></div>
</details>
</div>
<hr>
<p>This not only sets the working directory, but gives you far more control over how you can save your files from any place within the hierarchical folder structure. It will create a file called <code>.here</code> inside the <code>Main Project</code> folder, which will indicate that this is the top level of the hierarchy.</p>
<p>Then, I will usually have created a <code>README.Rmd</code> file in the <code>Main Project</code> folder with updates on what I’ve done and what I still need to work on, so I will remember and so my collaborators can see it too (when it has been pushed to GitHub or other <a href="https://happygitwithr.com/">version control</a> repos).</p>
<p>Next, I’ll set up a <code>Data</code> folder inside the <code>Main Project</code> folder. This is where all my data/spreadsheets/.txt files and data dictionaries will go. The original data files will stay inside this folder, while I create two other subsubfolders inside this <code>Data</code> folder called <code>Transformed</code> and <code>Models</code>. In <code>Transformed</code>, I will typically save <code>.rds</code> files that were a result of cleaning and transforming the data, including imputing missing data. I will touch more on exactly how I do that later below. A <code>Models</code> subfolder will obviously store fitted models and any validation/sensitivity analyses of those models.[@morrisChoosingSensitivityAnalyses2014]</p>
<p>Now, back to the <code>Main Project</code> folder, I’ll set up another folder within it called <code>R</code>. This will be where all of my <code>.R</code> scripts/files live. I will number them sequentially along with a title for a specific purpose, like so</p>
<hr>
<ul>
<li><p><code>main.R</code></p></li>
<li><p><code>01-functions.R</code></p></li>
<li><p><code>02-cleaning.R</code></p></li>
<li><p><code>03-inspection.R</code></p></li>
<li><p><code>04-analysis.R</code></p></li>
<li><p><code>04.5-validation.R</code></p></li>
<li><p><code>05-sensitivity.R</code></p></li>
<li><p><code>06-tables.R</code></p></li>
</ul>
<hr>
</section>
<section id="setting-up-the-functions-script" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="setting-up-the-functions-script"><span class="header-section-number">2.2</span> Setting up the Functions Script</h2>
<hr>
<p>All potential <code>R</code> packages and custom functions that I need will belong in <code>01-functions.R</code>. This <code>.R</code> file will only serve this purpose and nothing else. As you’ve guessed by now, the other <code>.R</code> files will be doing the same, they have very specific purposes and are organized to reflect this.</p>
<p>An example of the first script can be found below.</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Necessary Packages ------------------------------------</span></span>
<span id="cb2-2"></span>
<span id="cb2-3">req_packs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rms"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"concurve"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mice"</span>, </span>
<span id="cb2-4">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"parallel"</span>, </span>
<span id="cb2-5">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bayesplot"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"projpred"</span>, </span>
<span id="cb2-6">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hmisc"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rstan"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"here"</span>,</span>
<span id="cb2-7">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tryCatchLog"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"futile.logger"</span>, </span>
<span id="cb2-8">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"patchwork"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"corrplot"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"beepr"</span>, </span>
<span id="cb2-9">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"summarytools"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"broom"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wakefield"</span>, </span>
<span id="cb2-10">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"boot"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mfp"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"knitr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"flextable"</span>, </span>
<span id="cb2-11">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MASS"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lme4"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"brms"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"miceMNAR"</span>)</span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load all packages at once</span></span>
<span id="cb2-14"></span>
<span id="cb2-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(req_packs, library, </span>
<span id="cb2-16">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">character.only =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loggings messages </span></span>
<span id="cb2-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keep.source =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)        </span>
<span id="cb2-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tryCatchLog.write.error.dump.file"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) </span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set seed for random number generator</span></span>
<span id="cb2-23"></span>
<span id="cb2-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb2-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># My birthday</span></span>
<span id="cb2-26"></span>
<span id="cb2-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RStan Settings  -------------------------------------</span></span>
<span id="cb2-28"></span>
<span id="cb2-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>())</span>
<span id="cb2-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">color_scheme_set</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb2-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rstan_options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">auto_write =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb2-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mc.cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb2-33"></span>
<span id="cb2-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">has_build_tools</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">debug =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb2-35"></span>
<span id="cb2-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Stan Settings  ---------------------------------------</span></span>
<span id="cb2-37"></span>
<span id="cb2-38">dotR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.getenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HOME"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".R"</span>)</span>
<span id="cb2-39"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.exists</span>(dotR)) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dir.create</span>(dotR)</span>
<span id="cb2-40">M <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(dotR, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Makevars"</span>)</span>
<span id="cb2-41"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.exists</span>(M)) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.create</span>(M)</span>
<span id="cb2-42"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">CXX14FLAGS=-O3 -march=native -mtune=native -fPIC"</span>,</span>
<span id="cb2-43">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CXX14=g++"</span>, </span>
<span id="cb2-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> M, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">append =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</details>
</div>
<hr>
<p>The script above loads all the necessary <code>R</code> packages each time it is called, along with the specified functions, so most of the other <code>.R</code> files will depend upon this one.</p>
<p>However, I will not be running each of these <code>.R</code> files/scripts individually, line by line, or by selecting all the lines in an <code>.R</code> file and running the script.</p>
<p>Instead, after I’ve created all these files (figuring out what I need to do carefully and writing it down and annotating it), every single <code>.R</code> file except for <code>main.R</code> will have the following script, which I will explain later below (or some iteration of this script to match the name of the file) at the beginning:</p>
<hr>
</section>
<section id="setting-up-the-error-catching-script" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="setting-up-the-error-catching-script"><span class="header-section-number">2.3</span> Setting up the Error Catching Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"here"</span>)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_here</span>()</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>))</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(futile.logger)</span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tryCatchLog)</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Keeps source code file name and line number tracking</span></span>
<span id="cb3-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keep.source =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)        </span>
<span id="cb3-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tryCatchLog.write.error.dump.file"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) </span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Logs messages into a file </span></span>
<span id="cb3-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"my_app.log"</span>))  </span>
<span id="cb3-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.threshold</span>(INFO)   </span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function that catches any messages</span></span>
<span id="cb3-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"script.R"</span>))</span></code></pre></div>
</details>
</div>
<hr>
<p>You’ll notice several things. First, I’m once again calling the <a href="https://cran.r-project.org/package=here"><code>here</code></a> package and telling it that I’m working within this folder (<code>R</code>), and then I’m calling the <code>01-functions.R</code> file by using the <code>source()</code> function, but also notice how the <code>source()</code> function is followed by a <code>here()</code> function/argument. This <code>here()</code> function allows you to fully control files in a specific folder from anywhere else, without having to actually be in that folder. So, suppose I was in the <code>Main Project</code> -&gt; <code>Data</code> -&gt; <code>Models</code> folder and I was saving my work there (in the <code>Models</code> folder), which is pretty far from the <code>R</code> folder, I can still, using functions like <code>source()</code>, <code>save()</code>, etc., call or manipulate files from a totally different folder by specifying the hierarchy using <code>here()</code>. This can also be done in other ways, but those are far more cumbersome, and not flexible.</p>
<p>This is how I always call the necessary packages and functions I need from every <code>.R</code> script, simply by using the <code>source()</code> function and using <code>here()</code> to direct it to the <code>01-functions.R</code> file in the <code>R</code> folder. Now let’s look at the next few lines.</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"script.log"</span>))</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.threshold</span>(INFO)    </span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"script.R"</span>))</span></code></pre></div>
</details>
</div>
<hr>
<p>This script is designed to catch any warnings that occur inside the <code>.R</code> script and save them to a .log file in another subfolder within the <code>R</code> folder called <code>Errors</code>. So here’s an example of a full script for a mix of data generation and inspection, so that you can see it in action.</p>
<hr>
</section>
<section id="example-of-data-loading-inspection" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="example-of-data-loading-inspection"><span class="header-section-number">2.4</span> Example of Data Loading &amp; Inspection</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"here"</span>)</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_here</span>()</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loads all R functions</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># First we need some data</span></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RNGkind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb5-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># My birthday</span></span>
<span id="cb5-11"></span>
<span id="cb5-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Suppose you wanted to simulate a clinical trial</span></span>
<span id="cb5-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"simstudy"</span>)  </span>
<span id="cb5-14"></span>
<span id="cb5-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulating a Clinical Trial --------------------------</span></span>
<span id="cb5-16"></span>
<span id="cb5-17">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"male"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binary"</span>, </span>
<span id="cb5-18">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cid"</span>)</span>
<span id="cb5-19">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"over65"</span>, </span>
<span id="cb5-20">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binary"</span>,</span>
<span id="cb5-21">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-1.7 + .8 * male"</span>, </span>
<span id="cb5-22">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logit"</span>)</span>
<span id="cb5-23">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baseDBP"</span>, </span>
<span id="cb5-24">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>,</span>
<span id="cb5-25">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>)</span>
<span id="cb5-26">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age"</span>, </span>
<span id="cb5-27">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>, </span>
<span id="cb5-28">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, </span>
<span id="cb5-29">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-30">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"visits"</span>, </span>
<span id="cb5-31">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>, </span>
<span id="cb5-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.5 - 0.2 * age + 0.5 * male"</span>, </span>
<span id="cb5-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb5-34">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight"</span>, </span>
<span id="cb5-35">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>,</span>
<span id="cb5-36">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb5-37">dtstudy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">genData</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, def)</span>
<span id="cb5-38">study <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trtAssign</span>(dtstudy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nTrt =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb5-39">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">balanced =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">grpName =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rxGrp"</span>)</span>
<span id="cb5-40">study <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(study)</span>
<span id="cb5-41">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>iq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> iq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wakefield<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">iq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>)</span>
<span id="cb5-42">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wakefield<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">height</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>)</span>
<span id="cb5-43">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>income <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> income <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wakefield<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">income</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, </span>
<span id="cb5-44">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Income"</span>)</span>
<span id="cb5-45">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>SAT_score <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wakefield<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sat</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500</span>, </span>
<span id="cb5-46">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span>, </span>
<span id="cb5-47">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SAT"</span>)</span>
<span id="cb5-48">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>visits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>visits)</span>
<span id="cb5-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add noisy predictors</span></span>
<span id="cb5-50">study[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) </span>
<span id="cb5-51">                         (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, </span>
<span id="cb5-52">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)))</span>
<span id="cb5-53">varname <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x%d"</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>))</span>
<span id="cb5-54"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(study)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> varname</span>
<span id="cb5-55"></span>
<span id="cb5-56">study1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trtAssign</span>(dtstudy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">balanced =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb5-57">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strata =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"male"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"over65"</span>), </span>
<span id="cb5-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">grpName =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rxGrp"</span>)</span>
<span id="cb5-59"></span>
<span id="cb5-60">study1</span>
<span id="cb5-61"></span>
<span id="cb5-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspecting Data  -------------------------------------</span></span>
<span id="cb5-63"></span>
<span id="cb5-64">summarytools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">view</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dfSummary</span>(study))</span>
<span id="cb5-65"></span>
<span id="cb5-66">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>over65 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>over65)</span>
<span id="cb5-67">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>male <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>male)</span>
<span id="cb5-68">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rxGrp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rxGrp)</span>
<span id="cb5-69"></span>
<span id="cb5-70">study_formula <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.formula</span>(baseDBP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> .)</span>
<span id="cb5-71"></span>
<span id="cb5-72"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spearman2</span>(study_formula, study))</span>
<span id="cb5-73"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb5-74"></span>
<span id="cb5-75">x_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model.matrix</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> study)[, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb5-76"></span>
<span id="cb5-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial Data Analysis  ------------------------------</span></span>
<span id="cb5-78"></span>
<span id="cb5-79">(cormatrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor</span>(x_1)))</span>
<span id="cb5-80"></span>
<span id="cb5-81">col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colorRampPalette</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#BB4444"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#EE9988"</span>, </span>
<span id="cb5-82">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#FFFFFF"</span>, </span>
<span id="cb5-83">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#77AADD"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4477AA"</span>))</span>
<span id="cb5-84"></span>
<span id="cb5-85"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">corrplot</span>(cormatrix, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"color"</span>, </span>
<span id="cb5-86">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">col</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>), </span>
<span id="cb5-87">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tl.col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tl.cex =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.40</span>,</span>
<span id="cb5-88">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">addCoef.col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">number.cex =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>)</span>
<span id="cb5-89"></span>
<span id="cb5-90"></span>
<span id="cb5-91">clus1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">varclus</span>(x_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">similarity =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"h"</span>)</span>
<span id="cb5-92">clus2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">varclus</span>(x_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">similarity =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s"</span>)</span>
<span id="cb5-93">clus3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">varclus</span>(x_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">similarity =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p"</span>)</span>
<span id="cb5-94"></span>
<span id="cb5-95"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(clus1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hoeffing's D statistic"</span>, </span>
<span id="cb5-96">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)</span>
<span id="cb5-97"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hierarchical Cluster Analysis"</span>)</span>
<span id="cb5-98"></span>
<span id="cb5-99"></span>
<span id="cb5-100"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(clus2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)</span>
<span id="cb5-101"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(clus3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)</span>
<span id="cb5-102"></span>
<span id="cb5-103">Pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(study)</span>
<span id="cb5-104">(fmla <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.formula</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~"</span>, </span>
<span id="cb5-105">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(Pre, </span>
<span id="cb5-106">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"+"</span>))))</span>
<span id="cb5-107"></span>
<span id="cb5-108"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Redundancy analysis </span></span>
<span id="cb5-109"></span>
<span id="cb5-110">redun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redun</span>(fmla,</span>
<span id="cb5-111">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> study,</span>
<span id="cb5-112">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r2 =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.90</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ordinary"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">allcat =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb5-113">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tlinear =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iterms =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pr =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</details>
</div>
<hr>
<p>The above script simulated some fake data for a hypothetical clinical trial (usually we use this first script to load data from a .csv or .txt file) and then we used several functions to inspect the dataframe for the structure and distributions of the variables and missing data, etc. We also attempted to properly code the variables. Now, in order to capture any possible errors, we will have to run this entire script from another <code>R</code> script instead of running it line by line or selecting all the code and running it.</p>
<p>We will do this from a Main source script, which will allow us to use the <code>tryCatchLog()</code> function.</p>
<hr>
</section>
<section id="example-of-the-main-source-script" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="example-of-the-main-source-script"><span class="header-section-number">2.5</span> Example of the Main Source Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"here"</span>) </span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tryCatchLog"</span>)</span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"futile.logger"</span>)</span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_here</span>() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load and set here</span></span>
<span id="cb6-6"></span>
<span id="cb6-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Call here</span></span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keep.source =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)        </span>
<span id="cb6-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tryCatchLog.write.error.dump.file"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) </span>
<span id="cb6-11"></span>
<span id="cb6-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Script loads all necessary functions</span></span>
<span id="cb6-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.log"</span>)))</span>
<span id="cb6-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>))) </span>
<span id="cb6-16"></span>
<span id="cb6-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Line script to clean the data</span></span>
<span id="cb6-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"02-cleaning.log"</span>)))</span>
<span id="cb6-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"02-cleaning.R"</span>))) </span>
<span id="cb6-21"></span>
<span id="cb6-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Line script below to inspect the data</span></span>
<span id="cb6-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"03-inspection.log"</span>)))</span>
<span id="cb6-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"03-inspection.R"</span>)))  </span>
<span id="cb6-26"></span>
<span id="cb6-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load saved objects from cleanings</span></span>
<span id="cb6-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"03.5-load_data.log"</span>)))</span>
<span id="cb6-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"03.5-load_data.R"</span>))) </span>
<span id="cb6-31"></span>
<span id="cb6-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Main analysis script</span></span>
<span id="cb6-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"04-analysis.log"</span>)))</span>
<span id="cb6-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"04-analysis.R"</span>)))  </span>
<span id="cb6-36"></span>
<span id="cb6-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Below is the validation of main analysis results </span></span>
<span id="cb6-38"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"04.5-validation.log"</span>)))</span>
<span id="cb6-40"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"04.5-validation.R"</span>))) </span>
<span id="cb6-41"></span>
<span id="cb6-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test the sensitivity of the results by</span></span>
<span id="cb6-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># varying assumptions/multiple parameters</span></span>
<span id="cb6-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"05-sensitivity.log"</span>)))</span>
<span id="cb6-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"05-sensitivity.R"</span>))) </span>
<span id="cb6-47"></span>
<span id="cb6-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate tables and figures of all your results </span></span>
<span id="cb6-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"06-tables.log"</span>)))</span>
<span id="cb6-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"06-tables.R"</span>))) </span>
<span id="cb6-52"></span>
<span id="cb6-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Export these into actual files that can be</span></span>
<span id="cb6-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># inserted into papers, reports, etc.</span></span>
<span id="cb6-55"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flog.appender</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">appender.file</span>(</span>
<span id="cb6-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Errors"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"07-export.log"</span>)))</span>
<span id="cb6-57"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatchLog</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"07-export.R"</span>))) </span></code></pre></div>
</details>
</div>
<hr>
<p>If anything went wrong during the simulations and their inspections in the first script from above, it would have been captured by the error-catching scripts that we have set up, which would be placed within a .log file in the <code>Errors</code> folder, which is inside the <code>R</code> folder.</p>
<hr>
</section>
<section id="setting-the-seed" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="setting-the-seed"><span class="header-section-number">2.6</span> Setting the Seed</h2>
<hr>
<blockquote class="blockquote">
<p>Also, note that we have set the seed using a specific random number generator algorithm. This is not that important, however, it is important to correctly set the seed for reproducing any random numbers generated. This requires even more careful thought when running a simulation study, in which the states of the simulation need to be saved for a particular repetition, and so that streams do not overlap.[@morrisUsingSimulationStudies2019]</p>
</blockquote>
<hr>
<p>I will admit that the error script is not <em>perfect</em> at capturing warnings, but for most things, if something wrong occurs when a script is run, the function <code>tryCatchLog()</code> and its .log file usually catches the warning, so I would know that something went wrong and what specifically.</p>
<p>However, some may be skeptical of this approach and ask why I need to catch these errors and save them if I ran the scripts? Why not just scroll up and look at the console to see the errors or warnings?</p>
<p>Many reasons:</p>
<hr>
<ul>
<li>Suppose the analyses take a very long time, and are computationally intensive, and <code>R</code>/<a href="https://rstudio.com/"><code>RStudio</code></a> crashes, you may not be able to figure out what went wrong.</li>
<li>Suppose the analysis completed but because there was so much occurring in the console (for example, sampling from a posterior) that you missed the warnings/errors and got results that you don’t know have issues.</li>
</ul>
<hr>
<p>Thus, having this system set up to catch errors in every script also helps us automate the entire workflow once we’ve carefully set it up. After each <code>.R</code> script has one of these message-catching scripts, we can run our entire analysis from start to finish from <code>main.R</code> with one command. This not only makes your workspace organized, but also makes it easier for others to reproduce your work if you share your files and folders via a repository.</p>
<hr>
<p>So, now the <code>Error</code> folder will contain .txt files with any warning messages or errors.</p>
<p>Typically, when I’m setting up a new project, I will also add a few other folders such as an <code>Outputs</code> folder, where I will save tables and graphs, and a <code>Report</code> folder, where I might be working on a manuscript.</p>
<p>Now that I’ve mentioned my hierarchy and how I catch errors, I can mention some other things that I believe are absolutely heinous practices.</p>
<p>Many people often will run an entire analysis and have several objects/vectors stored in their Global Environment in <code>R</code> and <code>RStudio</code>. Suppose they’re taking a break, finished with the analysis, turning off the computer, or stepping away for whatever reason, what they’ll typically do is click the save button on the top right pane and “Save the workspace image”. Indeed, if they don’t do that themselves, the IDE <code>RStudio</code> will explicitly ask them if they wish to save their workspace image.</p>
<p>This is a horrific practice and you should never do this because it can lead to several problems such as:</p>
<ul>
<li><p>having several saved objects and packages conflict with one another once they’re all loaded together at once</p></li>
<li><p>having giant workspace images, that will probably cause <code>R</code>, and especially <code>RStudio</code> to constantly crash</p></li>
<li><p>not allowing you to load very specific objects that you need at a time while leaving everything else</p></li>
</ul>
<p>I would say that it is a good idea to never save the workspace image, ever. It is also quite easy to turn off. Simply go the <code>RStudio</code> menu and click <em>Preferences</em>, and in the <em>General</em> section, you will see the following options:</p>
<hr>
<p><img data-enlargeable="" width="500" style="cursor: zoom-in" src="https://res.cloudinary.com/less-likely/image/upload/v1604649526/Site/RStudio_Default_Save_Options.png"></p>
<hr>
<p>It is essential to uncheck everything under <em>R Sessions</em>, <em>Workspace</em>, and <em>History</em>, so that you do not set your self up for a future disaster.</p>
<p>Instead of using these convenient but highly problematic options, always use the <code>saveRDS()</code> base <code>R</code> function, where the first argument is the object in your environment that you want to save, and the second argument is the path where you want to save it, which of course should be using the <code>here()</code> function.</p>
<p>Now suppose I decided to use multiple imputation because I had a dataset with many missing values, and suppose I had a grasp of the missing data mechanism, and so I used something like the not-at-random fully conditional specification approach (<strong>NARFCS</strong>)[@tompsettUseNotatrandomFully2018] to attempt to handle data that I believe to be missing not at random (<strong>MNAR</strong>), and I wanted to save the imputed dataset, and only load the imputed dataset next time. This is how I would do it (in the vaguest way possible). First, I’ll start with the dataset that we generated above and generate missing values via different missing data mechanisms using the <code>ampute()</code> function from the <code>mice</code> package.[@buurenMiceMultivariateImputation2011]</p>
<hr>
<blockquote class="blockquote">
<p><strong>Important</strong>: This is all assuming that one has carefully constructed an imputation model, and that multiple imputation is the most appropriate solution. As many others have pointed out, simply running a script like <code>mice(data)</code> in <code>R</code> without careful thought to the imputation model, is a very, very bad idea. Missing data is an extremely complex topic and I recommend everyone carefully read the works[@buurenFlexibleImputationMissing2018] of missing data researchers such as:</p>
</blockquote>
<ul>
<li><p><a href="https://stefvanbuuren.name/fimd/">Stef van Buuren</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://twitter.com/tmorris_mrc">Tim Morris</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://www.ctu.mrc.ac.uk/about-us/senior-staff/ian-white/">Ian White</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://scholar.google.com/citations?user=5q4fhUoAAAAJ&amp;hl=en">Donald Rubin</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://thestatsgeek.com/">Jonathan Bartlett</a></p>
<blockquote class="blockquote">

</blockquote></li>
<li><p><a href="https://www.paulgstf.com/">Paul Gustafson</a></p>
<blockquote class="blockquote">

</blockquote></li>
</ul>
<hr>
</section>
<section id="example-of-a-multiple-imputation-script" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="example-of-a-multiple-imputation-script"><span class="header-section-number">2.7</span> Example of a Multiple Imputation Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>))</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"beepr"</span>)</span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Package that uses multiple imputation</span></span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># by chained equations</span></span>
<span id="cb7-7"></span>
<span id="cb7-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mice"</span>) </span>
<span id="cb7-9">     </span>
<span id="cb7-10"></span>
<span id="cb7-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate Missing Data  --------------------------------</span></span>
<span id="cb7-12"></span>
<span id="cb7-13">study_mnar <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ampute</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> study[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>], </span>
<span id="cb7-14">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.65</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mech =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MNAR"</span>)</span>
<span id="cb7-15">mnar_patterns <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> study_mnar<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>patterns</span>
<span id="cb7-16">mnar_weight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> study_mnar<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>weight</span>
<span id="cb7-17">study_mnar_rerun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ampute</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> study[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>], </span>
<span id="cb7-18">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb7-19">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mech =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MNAR"</span>, </span>
<span id="cb7-20">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">patterns =</span> mnar_patterns,</span>
<span id="cb7-21">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weights =</span> mnar_weight)</span>
<span id="cb7-22">study_mar <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ampute</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> study[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb7-23">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mech =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MAR"</span>)</span>
<span id="cb7-24">mar_patterns <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> study_mar<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>patterns</span>
<span id="cb7-25">mar_weight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> study_mar<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>weight</span>
<span id="cb7-26">study_mar_rerun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ampute</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> study[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>], </span>
<span id="cb7-27">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb7-28">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mech =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MAR"</span>, </span>
<span id="cb7-29">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">patterns =</span> mar_patterns,</span>
<span id="cb7-30">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weights =</span> mar_weight)</span>
<span id="cb7-31"></span>
<span id="cb7-32">study_mar_rerun[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>over65 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>()</span>
<span id="cb7-34">study_mar_rerun[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>()</span>
<span id="cb7-36">study_mar_rerun[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rxGrp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>()</span>
<span id="cb7-38"></span>
<span id="cb7-39">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> study_mnar_rerun<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>amp</span>
<span id="cb7-40">df2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> study_mar_rerun<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>amp</span>
<span id="cb7-41"></span>
<span id="cb7-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspect Data</span></span>
<span id="cb7-43"></span>
<span id="cb7-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(df) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspect data frame</span></span>
<span id="cb7-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(df) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># High level summary of dataframe</span></span>
<span id="cb7-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(df)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Look at missing values etc.</span></span>
<span id="cb7-47"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colSums</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(df))</span>
<span id="cb7-48">summarytools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">view</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dfSummary</span>(df)) </span>
<span id="cb7-49"></span>
<span id="cb7-50"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(df2) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspect data frame</span></span>
<span id="cb7-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(df2) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># High level summary of dataframe</span></span>
<span id="cb7-52"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(df2)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Look at missing values etc.</span></span>
<span id="cb7-53"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colSums</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(df2))</span>
<span id="cb7-54">summarytools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">view</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dfSummary</span>(df2)) </span>
<span id="cb7-55"></span>
<span id="cb7-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prepare Data for Imputation -------------------------</span></span>
<span id="cb7-57"></span>
<span id="cb7-58">temp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df</span>
<span id="cb7-59">temp2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df2</span>
<span id="cb7-60"></span>
<span id="cb7-61"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">missing_plot</span>(temp)</span>
<span id="cb7-62"></span>
<span id="cb7-63"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">missing_plot</span>(temp2)</span>
<span id="cb7-64"></span>
<span id="cb7-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set-up predictor matrix</span></span>
<span id="cb7-66"></span>
<span id="cb7-67">predMatrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make.predictorMatrix</span>(temp)</span>
<span id="cb7-68">predMatrix2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make.predictorMatrix</span>(temp2)</span>
<span id="cb7-69"></span>
<span id="cb7-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set-up predictor matrix for unidentifiable part:</span></span>
<span id="cb7-71">predSens <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb7-72"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(predSens) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(temp), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb7-73"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(predSens) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(temp)</span>
<span id="cb7-74"></span>
<span id="cb7-75"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set-up list with sensitivity parameter values</span></span>
<span id="cb7-76"></span>
<span id="cb7-77">pSens <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(temp))</span>
<span id="cb7-78"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(pSens) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(temp)</span>
<span id="cb7-79">pSens[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rxGrp"</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb7-80">pSens[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baseDBP"</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb7-81">pSens[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"male"</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb7-82">pSens[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"over65"</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-83"></span>
<span id="cb7-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MICE RI Imputation  ----------------------------------</span></span>
<span id="cb7-85"></span>
<span id="cb7-86">z1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parlmice</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ri"</span>,</span>
<span id="cb7-87">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">predictorMatrix =</span> predMatrix,</span>
<span id="cb7-88">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maxit =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb7-89">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster.seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb7-90">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.imp.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cl.type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FORK"</span>, </span>
<span id="cb7-91">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ridge =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-04</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">remove.collinear =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb7-92">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">remove.constant =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">allow.na =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) </span>
<span id="cb7-93"></span>
<span id="cb7-94">z2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parlmice</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pmm"</span>,</span>
<span id="cb7-95">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">predictorMatrix =</span> predMatrix2,</span>
<span id="cb7-96">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maxit =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb7-97">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster.seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb7-98">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ridge =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-04</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">remove.collinear =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb7-99">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.imp.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cl.type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FORK"</span>) </span>
<span id="cb7-100"></span>
<span id="cb7-101">zfinal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(z1, z2)</span>
<span id="cb7-102"></span>
<span id="cb7-103"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Heckman Imputation  ----------------------------------</span></span>
<span id="cb7-104"></span>
<span id="cb7-105">study<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>baseDBP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> temp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>baseDBP</span>
<span id="cb7-106">JointModelEq<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">generate_JointModelEq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>temp, </span>
<span id="cb7-107">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varMNAR=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baseDBP"</span>)</span>
<span id="cb7-108">JointModelEq[,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baseDBP_var_sel"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-109">JointModelEq[,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baseDBP_var_out"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-110"></span>
<span id="cb7-111">arg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">MNARargument</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varMNAR =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"baseDBP"</span>, </span>
<span id="cb7-112">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">JointModelEq =</span> JointModelEq)</span>
<span id="cb7-113"></span>
<span id="cb7-114">arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>method[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ri"</span></span>
<span id="cb7-115">arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>method[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"visits"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ri"</span></span>
<span id="cb7-116">arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>method[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ri"</span></span>
<span id="cb7-117">arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>method[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iq"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ri"</span></span>
<span id="cb7-118">arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>method[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"height"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ri"</span></span>
<span id="cb7-119"></span>
<span id="cb7-120">imp1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parlmice</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data_mod,</span>
<span id="cb7-121">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>method,</span>
<span id="cb7-122">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">predictorMatrix =</span> arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>predictorMatrix,</span>
<span id="cb7-123">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">JointModelEq =</span> arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>JointModelEq,</span>
<span id="cb7-124">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> arg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>control,</span>
<span id="cb7-125">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maxit =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb7-126">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster.seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb7-127">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.imp.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cl.type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FORK"</span>)</span>
<span id="cb7-128"></span>
<span id="cb7-129">analysis1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(zfinal, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(baseDBP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> visits <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> iq <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rxGrp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> over65))</span>
<span id="cb7-130">result1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pool</span>(analysis1)</span>
<span id="cb7-131"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(result1)</span>
<span id="cb7-132"></span>
<span id="cb7-133">z2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parlmice</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pmm"</span>,</span>
<span id="cb7-134">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">predictorMatrix =</span> predMatrix2,</span>
<span id="cb7-135">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maxit =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb7-136">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster.seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb7-137">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.imp.core =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cl.type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FORK"</span>) </span>
<span id="cb7-138"></span>
<span id="cb7-139">heckman <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(imp1, z2)</span>
<span id="cb7-140"></span>
<span id="cb7-141"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">beep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I will touch on this function below.</span></span>
<span id="cb7-142"></span>
<span id="cb7-143"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">saveRDS</span>(zfinal, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, </span>
<span id="cb7-144">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zfinal.rds"</span>))</span></code></pre></div>
</details>
</div>
<hr>
<p>Here is the workflow truly showing its advantages, <code>saveRDS()</code> is saving a very specific object (<code>zfinal</code>, the imputed dataset) into the <code>Data</code> folder by using the hierarchical structure of the folder which can easily be navigated using <code>here()</code>. Notice how to save something and use <code>here()</code> to specify the location, the first argument is <code>Main Project</code>, followed by <code>Data</code>, and then comes the object name (<code>zfinal.rds</code>).</p>
<p>Now I have saved my imputed dataset as an object called <code>zfinal.rds</code> and it is saved in the <code>Data</code> folder even though I am hypothetically working from the <code>R</code> folder.</p>
<p>Also notice that I use the <code>beep()</code> function from the <a href="https://cran.r-project.org/package=beepr">beepr</a> <code>R</code> package, which can be quite handy in letting you know if a particular script or analysis is done.</p>
<p>Next time, if I cleared my entire global environment and wanted to only load the imputed dataset, I would simply have to just click on the <code>zfinal.rds</code> file in the <code>Data</code> folder and it would load into the environment or I could use the following command,</p>
<hr>
</section>
<section id="saving-and-reading-data-carefully" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="saving-and-reading-data-carefully"><span class="header-section-number">2.8</span> Saving and Reading Data Carefully</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The function readRDS() and saveRDS()</span></span>
<span id="cb8-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># are possibly the most important base R functions</span></span>
<span id="cb8-3"></span>
<span id="cb8-4">zfinal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zfinal.rds"</span>, </span>
<span id="cb8-5">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, </span>
<span id="cb8-6">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zfinal.rds"</span>))</span></code></pre></div>
</details>
</div>
<hr>
<p>This gives us full control over the environment, and it’s also why I encourage people to turn off the automatic prompt to save the workspace that <a href="https://rstudio.com/"><code>RStudio</code></a> gives you by default (I am certain even Hadley Wickham has said the same on multiple occasions).</p>
<p>So if I now wanted to include the imputed dataset into one of my <code>.R</code> scripts that I am trying to automate with one command, whether for reproducibility, or speed, etc., I could do it with absolute control.</p>
<p>This is also how I save my models and how I validate them, which is especially handy because running those can also take an excruciatingly long time.</p>
<p>Here’s an example of a script that would be in the <code>04-analysis.R</code> script, I’m leaving out the warning-catching script now to avoid making this too long. I don’t need to load the <a href="https://cran.r-project.org/package=brms"><code>brms</code></a> package because I’m already calling it from the first <code>.R</code> script, <code>01-functions.R</code> (but I’m just showing it for now to avoid confusion), and then I am saving it in the <code>Models</code> folder which is found in the <code>Data</code> folder. And again, the <code>beep()</code> function would let me know when the script is over, and scripts like this can often take very long, due to the computational intensity.</p>
<p>The script below is an analysis script whose results we plan on saving once completed. Due to the arguments I have set (iterations, warmups, chains, and using an imputed dataset), it can often take a long time before it is finished, and if I did happen to do other tasks while I was waiting on that, the output would automatically save to the <code>Models</code> folder via <code>saveRDS()</code>, and I would also receive a notification via the <code>beep()</code> function, preventing me from wasting any time.</p>
<hr>
</section>
<section id="example-modeling-script" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="example-modeling-script"><span class="header-section-number">2.9</span> Example Modeling Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calling all packages, please report for duty</span></span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>)) </span>
<span id="cb9-4"></span>
<span id="cb9-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"brms"</span>) </span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This is a script I used previously</span></span>
<span id="cb9-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># where I used Bayes for regularization  </span></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Although these are all generic options </span></span>
<span id="cb9-10"></span>
<span id="cb9-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prior Information  --------------------------------</span></span>
<span id="cb9-12"></span>
<span id="cb9-13">sample_z <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">complete</span>(zfinal, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb9-14"></span>
<span id="cb9-15">n_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(sample_z) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># of observations</span></span>
<span id="cb9-16"></span>
<span id="cb9-17">k_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(sample_z) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># of predictors</span></span>
<span id="cb9-18"></span>
<span id="cb9-19">p0_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prior for the number of relevant variables</span></span>
<span id="cb9-20"></span>
<span id="cb9-21">tau0_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p0_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (k_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> p0_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_1) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tau scale</span></span>
<span id="cb9-22"></span>
<span id="cb9-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Regularized horseshoe prior</span></span>
<span id="cb9-24">hs_prior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_prior</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"horseshoe(scale_global = tau0_1, </span></span>
<span id="cb9-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                      scale_slab = 1)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">class =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>)</span>
<span id="cb9-26"></span>
<span id="cb9-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"future"</span>)</span>
<span id="cb9-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plan</span>(multiprocess)</span>
<span id="cb9-29"></span>
<span id="cb9-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Regularized Bayesian quantile</span></span>
<span id="cb9-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># regression using regularized horseshoe prior</span></span>
<span id="cb9-32">brms<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brm_multiple</span>(</span>
<span id="cb9-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bf</span>(baseDBP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> visits <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> iq <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rxGrp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> over65, </span>
<span id="cb9-34">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quantile =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>),</span>
<span id="cb9-35">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zfinal, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior =</span> hs_prior, </span>
<span id="cb9-36">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">asym_laplace</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sample_prior =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb9-37">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1031</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">future =</span> F,</span>
<span id="cb9-38">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warmup =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chains =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb9-39">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">thin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">combine =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb9-40">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_treedepth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, </span>
<span id="cb9-41">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">adapt_delta =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.80</span>)) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> pen_model_1</span>
<span id="cb9-42"></span>
<span id="cb9-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Principled way of saving results</span></span>
<span id="cb9-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">saveRDS</span>(pen_model_1,   </span>
<span id="cb9-45">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>, </span>
<span id="cb9-46">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pen_model_1.rds"</span>)) </span>
<span id="cb9-47"></span>
<span id="cb9-48"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">beep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
</details>
</div>
<hr>
<p>So I’ve saved the full contents of the fitted model (<code>pen_model_1</code>), which are usually several gigabytes large in size, within the <code>Models</code> folder. Once again, notice how the <code>here()</code> function allows you to work from a subfolder like <code>R</code>, which is inside the <code>Main Project</code> folder, and allows you to specify the hierarchy, and where you are within it, and save to whichever folder you wish, in this case <code>Models</code>, which is inside of <code>Data</code>. Now, I will typically conduct model checks and make sure it is performing well, and not misspecified,</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>)) </span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspect RHat values ---------------------------</span></span>
<span id="cb10-4"> </span>
<span id="cb10-5">rhats_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pen_model_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rhats</span>
<span id="cb10-6"></span>
<span id="cb10-7">rhats_1_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (rhats_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>)</span>
<span id="cb10-8">((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(rhats_1_df)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> </span>
<span id="cb10-9">    (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(rhats_1_df) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(rhats_1_df)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>))</span>
<span id="cb10-10"></span>
<span id="cb10-11">rhats_1_vec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb10-12">  rhats_1[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(rhats_1)])))</span>
<span id="cb10-13"></span>
<span id="cb10-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pdf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figures"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diagnostics"</span>, </span>
<span id="cb10-15">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_COMP_rhat.pdf"</span>))</span>
<span id="cb10-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_rhat_hist</span>(rhats_1_vec) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model 1 Chain Convergence"</span>)</span>
<span id="cb10-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dev.off</span>()</span>
<span id="cb10-19"></span>
<span id="cb10-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspect Effective Sample Size ----------------------</span></span>
<span id="cb10-21"></span>
<span id="cb10-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_neff_hist</span>(rhats_1_vec) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effective Sample Size"</span>)</span>
<span id="cb10-24"></span>
<span id="cb10-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspect Divergences ---------------------------</span></span>
<span id="cb10-26"></span>
<span id="cb10-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pdf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figures"</span>, </span>
<span id="cb10-28">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diagnostics"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_1.pdf"</span>))</span>
<span id="cb10-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_nuts_divergence</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nuts_params</span>(pen_model_1), </span>
<span id="cb10-30">                     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log_posterior</span>(pen_model_1))</span>
<span id="cb10-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dev.off</span>()</span>
<span id="cb10-32"></span>
<span id="cb10-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Examine Residual Plots ----------------------------</span></span>
<span id="cb10-34"></span>
<span id="cb10-35">df_resid_stan_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fitted</span>(pen_model_1)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb10-36">                              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">residuals</span>(pen_model_1)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb10-37"></span>
<span id="cb10-38"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pdf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figures"</span>, </span>
<span id="cb10-39">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diagnostics"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_1.pdf"</span>))</span>
<span id="cb10-40"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df_resid_stan_1, </span>
<span id="cb10-41">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sample =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">residuals</span>(pen_model_1)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_qq</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_qq_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model 1 Residuals"</span>)</span>
<span id="cb10-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dev.off</span>()</span>
<span id="cb10-46"></span>
<span id="cb10-47">(sum1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">posterior_summary</span>(pen_model_1))[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, ])</span>
<span id="cb10-48"></span>
<span id="cb10-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_intervals</span>(pen_model_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"median"</span>, </span>
<span id="cb10-50">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob_outer =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb10-51">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parnames</span>(pen_model_1)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-52">  ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_discrete</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>),</span>
<span id="cb10-54">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>),</span>
<span id="cb10-55">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, </span>
<span id="cb10-56">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rect"</span>,</span>
<span id="cb10-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb10-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.075</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>,</span>
<span id="cb10-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb10-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#990000"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb10-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>,</span>
<span id="cb10-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb10-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#990000"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb10-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change in Outcome 1"</span>)</span>
<span id="cb10-69"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dev.off</span>()</span>
<span id="cb10-70"></span>
<span id="cb10-71"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pdf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figures"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_1.pdf"</span>))</span>
<span id="cb10-72"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_hist</span>(pen_model_1)</span>
<span id="cb10-73"></span>
<span id="cb10-74"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Posterior Predictive Checks</span></span>
<span id="cb10-75"> </span>
<span id="cb10-76"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pdf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figures"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diagnostics"</span>, </span>
<span id="cb10-77">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_1check.pdf"</span>))</span>
<span id="cb10-78"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pp_check</span>(pen_model_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nsamples =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Posterior Predictive Check: Model 1"</span>)</span>
<span id="cb10-80"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dev.off</span>()</span>
<span id="cb10-81"></span>
<span id="cb10-82"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Shows dens_overlay plot by default</span></span>
<span id="cb10-83"></span>
<span id="cb10-84">bayes_rsq1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bayes_R2</span>(pen_model_1)</span>
<span id="cb10-85"></span>
<span id="cb10-86">bayes_rsq1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(bayes_rsq1))</span>
<span id="cb10-87"></span>
<span id="cb10-88"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(sum1, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tables"</span>, </span>
<span id="cb10-89">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_1.csv"</span>))</span></code></pre></div>
</details>
</div>
<hr>
<p>Once I have fit my model and done some initial checks, I usually conduct some more thorough checks using k-fold cross-validation or nested cross-validation, or bootstrap optimism.</p>
<p>A script of this can be found below.</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>))</span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 10-Fold Cross-Validations -------------------------</span></span>
<span id="cb11-4"></span>
<span id="cb11-5">kfold_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kfold</span>(pen_model_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">K =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, </span>
<span id="cb11-6">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">save_fits =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb11-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">saveRDS</span>(kfold_1, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>, </span>
<span id="cb11-8">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Validation"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfold_1.rds"</span>))</span>
<span id="cb11-9">kfp_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kfold_predict</span>(kfold_1)</span>
<span id="cb11-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">saveRDS</span>(kfp_1, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>, </span>
<span id="cb11-11">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Validation"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfp_1.rds"</span>))</span>
<span id="cb11-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kfold_rmse</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> kfp_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, </span>
<span id="cb11-13">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yrep =</span> kfp_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>yrep, </span>
<span id="cb11-14">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rmse"</span>, </span>
<span id="cb11-15">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reps =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>, </span>
<span id="cb11-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]][[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>]]<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> kfold_rmse_1</span>
<span id="cb11-17"></span>
<span id="cb11-18">kfold_rmse_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(kfold_rmse_1)</span>
<span id="cb11-19"></span>
<span id="cb11-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">saveRDS</span>(kfold_rmse_1, </span>
<span id="cb11-21">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>, </span>
<span id="cb11-22">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Validation"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfold_rmse_1.rds"</span>))</span></code></pre></div>
</details>
</div>
<hr>
<p>Once I’ve written all my analysis and validation scripts, I’ll typically create a subfolder in the <code>Outputs</code> folder called <code>Figures</code> and <code>Tables</code> and save them appropriately with the help <code>here()</code>.</p>
<hr>
</section>
<section id="example-table-script" class="level2" data-number="2.10">
<h2 data-number="2.10" class="anchored" data-anchor-id="example-table-script"><span class="header-section-number">2.10</span> Example Table Script</h2>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"01-functions.R"</span>))</span>
<span id="cb12-2"></span>
<span id="cb12-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read in Validation Objects ------------------------</span></span>
<span id="cb12-4"></span>
<span id="cb12-5">kfold_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfold_1.rds"</span>, </span>
<span id="cb12-6">                   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, </span>
<span id="cb12-7">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Validation"</span>, </span>
<span id="cb12-8">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfold_1.rds"</span>))</span>
<span id="cb12-9">kfold_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfold_1.rds"</span>, </span>
<span id="cb12-10">                   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, </span>
<span id="cb12-11">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Validation"</span>, </span>
<span id="cb12-12">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfold_2.rds"</span>))</span>
<span id="cb12-13">kfp_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfp_1.rds"</span>, </span>
<span id="cb12-14">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, </span>
<span id="cb12-15">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Validation"</span>, </span>
<span id="cb12-16">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfp_1.rds"</span>))</span>
<span id="cb12-17">kfp_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfp_1.rds"</span>, </span>
<span id="cb12-18">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>, </span>
<span id="cb12-19">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Models"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Validation"</span>, </span>
<span id="cb12-20">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kfp_2.rds"</span>))</span>
<span id="cb12-21"></span>
<span id="cb12-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract Estimates from Objects ---------------------</span></span>
<span id="cb12-23"> </span>
<span id="cb12-24">KFOLDIC_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(kfold_1[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], </span>
<span id="cb12-25">                     kfold_2[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>])</span>
<span id="cb12-26">KFOLDIC_SE_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(kfold_1[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], </span>
<span id="cb12-27">                        kfold_2[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb12-28">BAYES_R2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(bayes_rsq1, bayes_rsq2), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb12-29">KFOLD_ELPD_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(kfold_1[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb12-30">                        kfold_2[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb12-31">KFOLD_ELPD_SE_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(kfold_1[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], </span>
<span id="cb12-32">                           kfold_2[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimates"</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb12-33"></span>
<span id="cb12-34">Outcome <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTCOME_2"</span>)</span>
<span id="cb12-35"></span>
<span id="cb12-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Construct Data Frames ------------------------------</span></span>
<span id="cb12-37"></span>
<span id="cb12-38">table4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(Outcome, BAYES_R2, KFOLD_ELPD_1, </span>
<span id="cb12-39">                     KFOLD_ELPD_SE_1, KFOLDIC_1, </span>
<span id="cb12-40">                     KFOLDIC_SE_1)</span>
<span id="cb12-41"></span>
<span id="cb12-42"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(table4) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outcome"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bayes R^2"</span>, </span>
<span id="cb12-43">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV ELPD"</span>, </span>
<span id="cb12-44">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV ELPD SE"</span>,</span>
<span id="cb12-45">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV IC"</span>, </span>
<span id="cb12-46">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV IC SE"</span>)</span>
<span id="cb12-47"></span>
<span id="cb12-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Export as Tables ----------------------------------</span></span>
<span id="cb12-49"></span>
<span id="cb12-50"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(table4, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, </span>
<span id="cb12-51">                       <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tables"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table4.csv"</span>))</span>
<span id="cb12-52"></span>
<span id="cb12-53">table5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(Outcome, KFOLD_ELPD_1, </span>
<span id="cb12-54">                     KFOLD_ELPD_SE_1, </span>
<span id="cb12-55">                     KFOLDIC_1, KFOLDIC_SE_1)</span>
<span id="cb12-56"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(table5) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outcome"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV ELPD"</span>, </span>
<span id="cb12-57">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV ELPD SE"</span>,</span>
<span id="cb12-58">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV IC"</span>, </span>
<span id="cb12-59">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-fold CV IC SE"</span>)</span>
<span id="cb12-60"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(table5, </span>
<span id="cb12-61">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tables"</span>, </span>
<span id="cb12-62">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table5.csv"</span>))</span>
<span id="cb12-63"></span>
<span id="cb12-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save Tables From Sensitivity Analyses --------------</span></span>
<span id="cb12-65"></span>
<span id="cb12-66"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(sens_table_OUTCOME_1, </span>
<span id="cb12-67">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tables"</span>, </span>
<span id="cb12-68">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table7_OUTCOME_1.csv"</span>))</span>
<span id="cb12-69"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(sens_table_OUTCOME_2, </span>
<span id="cb12-70">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Main Project"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outputs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tables"</span>, </span>
<span id="cb12-71">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Table7_OUTCOME_2.csv"</span>))</span></code></pre></div>
</details>
</div>
<hr>
<p>Then, I’ll go back to the <code>README.Rmd</code> file, make notes of the hierarchy of the entire folder and subfolders, and what’s been completed, and what still needs to be done.</p>
<p>Now, suppose I deleted all of my saved models, imputed data, graphs, and tables, (which would be a devastating blow!) and only had the original dataset and organized scripts. Anyone could go into my project and simply highlight the entire <code>main.R</code> file and run it, and they would get all the same outputs and models, assuming a seed was set in advance, which is essential. Although, it might take them a long time to get the same outputs (if computationally intensive)… they would likely be able to get all the exact same results.</p>
<hr>
</section>
</section>
<section id="possible-drawbacks-of-this-approach" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Possible Drawbacks of this Approach</h1>
<hr>
<p>Every proposal tends to have drawbacks or limitations, and those who do not explicitly tell you about them are misleading you. In the approach I have outlined above, one major drawback is that it takes a somewhat long time to set up and therefore could deter many statisticians and data analysts. The other drawback is that by loading all your functions and libraries in the first <code>01_functions.R</code> script, there is potential for conflict between functions, therefore you’ll have to be mindful of what packages you need and when. Indeed, I ran into this issue when loading the <code>brms</code> package, which had several functions that conflicted with the base <code>R</code> functions. So please be mindful of this.</p>
<p>Further, and most importantly, I have no evidence that this approach can truly prevent errors, it is simply a belief I have as a result of my own experiences and suggesting them to others, and hearing positive comments. So please, take that into account, although I would be grateful if you were able to share your positive or even negative experiences using this approach below.</p>
<hr>
<p>Please, please annotate your scripts, as I have done so several times above to explain some of the functions. This is not only helpful for others who are trying to go through your code and understand it, but also for yourself. If you end up forgetting what function does what, and what steps you were taking, you will be in for a really frustrating time, and possibly prone to making serious mistakes.</p>
<p>Here’s what my project folders tend to look like (figure below). And here is a <a href="https://github.com/zadrafi/statworkflow">template GitHub repo</a> to show what the structure typically looks like.</p>
<hr>
<p><img data-enlargeable="" width="400" style="cursor: zoom-in" src="https://res.cloudinary.com/less-likely/image/upload/v1592068111/Site/Screen_Shot_2020-06-13_at_11.38.26_AM.png"></p>
<hr>
<p>It should go without saying that sharing your data (if possible) and code will help you and your collaborators catch errors before it’s too late, but also, sharing them with others/the public after a project is done will <em>also</em> help catch possible errors that you/your collaborators/reviewers didn’t catch, which may mislead other researchers and also result in a much more stressful situation for you.</p>
<p>And last but not least, it is also essential to give extensive details on which version of <code>R</code> you used and which packages you used and their versions. This is because many scripts that once worked on previous versions of the software may no longer give the same results or may not even work at all. In order for someone to reproduce your results, they’ll need to know the environment on which you ran your analyses on. You can provide these details easily simply by running the script <code>sessionInfo()</code>, which should be at the end of every <code>R</code> script you run.</p>
<hr>
</section>
<section id="helpful-resources" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Helpful Resources</h1>
<hr>
<ul>
<li><a href="https://stackoverflow.com/questions/1429907/workflow-for-statistical-analysis-and-report-writing">Workflow for Statistical Analysis and Report Writing</a></li>
</ul>
<hr>
<ul>
<li><a href="https://stackoverflow.com/questions/19967478/how-to-save-data-file-into-rdata">How to Save Data File into .RData?</a></li>
</ul>
<hr>
<ul>
<li><a href="https://www.youtube.com/watch?v=Ry2xjTBtNFE">Basic Data Entry Using Excel</a></li>
</ul>
<hr>
<ul>
<li><a href="https://www.kristianbrock.com/post/send-me-data/">Sending Me Data in Excel</a></li>
</ul>
<hr>
<ul>
<li><a href="https://happygitwithr.com/">Happy Git and GitHub for the useR</a></li>
</ul>
<hr>
</section>
<section id="environment" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Environment</h1>
<hr>
<p>The analyses were run on:</p>
<hr>
<div class="cell">
<pre><code>#&gt; R version 4.5.0 (2025-04-11)
#&gt; Platform: aarch64-apple-darwin20
#&gt; Running under: macOS Sequoia 15.6.1
#&gt; 
#&gt; Matrix products: default
#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib 
#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1
#&gt; 
#&gt; Random number generation:
#&gt;  RNG:     Mersenne-Twister 
#&gt;  Normal:  Inversion 
#&gt;  Sample:  Rejection 
#&gt;  
#&gt; locale:
#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
#&gt; 
#&gt; time zone: America/New_York
#&gt; tzcode source: internal
#&gt; 
#&gt; attached base packages:
#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;  [1] htmlwidgets_1.6.4 compiler_4.5.0    fastmap_1.2.0     cli_3.6.5        
#&gt;  [5] tools_4.5.0       htmltools_0.5.8.1 rstudioapi_0.17.1 yaml_2.3.10      
#&gt;  [9] rmarkdown_2.29    knitr_1.50        jsonlite_2.0.0    xfun_0.53        
#&gt; [13] digest_0.6.37     rlang_1.1.6       evaluate_1.0.5</code></pre>
</div>
<hr>
</section>
<section id="references" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> References</h1>
<hr>


<!-- -->

</section>

 ]]></description>
  <category>statistics</category>
  <guid>https://lesslikely.com/posts/statistics/statistical-quality-control.html</guid>
  <pubDate>Sat, 13 Jun 2020 00:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/v1613136545/Site/diagram.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Book Review: Regression and Other Stories by Gelman, Hill, and Vehtari</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/regression-stories.html</link>
  <description><![CDATA[ 





<hr>
<p>Over a decade ago, <a href="https://statmodeling.stat.columbia.edu/">Andrew Gelman</a> and <a href="https://steinhardt.nyu.edu/faculty/Jennifer_L_Hill">Jennifer Hill</a> gave applied researchers a comprehensive book <em>(<a href="https://www.amazon.com/Analysis-Regression-Multilevel-Hierarchical-Models/dp/052168689X">Data Analysis Using Regression and Multilevel/Hierarchical Models</a>)</em> on fitting simple and complex statistical models in <code>R</code> both from a classical framework and a Bayesian one. Now they’re back with an updated version and a new author (<a href="https://users.aalto.fi/~ave/">Aki Vehtari</a>).</p>
<p>Much has changed in applied statistics since 2006 (when the book was first released). The primary software used at the time and in the book to fit Bayesian models was <code>BUGS</code> (Bayesian inference Using Gibbs Sampling).</p>
<p>However, both <code>BUGS</code> and some of the <code>R</code> code in the first edition are now outdated. The new edition updates the <code>R</code> code and contains intuitive instructions on how to fit simple and complex models using the probabilistic programming language, <a href="https://mc-stan.org/"><code>Stan</code></a> (also developed by Gelman and <a href="https://mc-stan.org/about/team/">colleagues</a>), which is now used in several fields (even for <a href="https://statmodeling.stat.columbia.edu/2019/04/24/postdoctoral-position-in-vancouver-using-stan-working-on-wine-for-reals/">studying wine!</a>).</p>
<p>Indeed, running a Bayesian regression model in <code>R</code> is now as simple as</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I use the sample PlantGrowth dataset in R</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rstanarm"</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bayesplot"</span>)</span>
<span id="cb1-4">pg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> PlantGrowth</span>
<span id="cb1-5">model1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stan_glm</span>(weight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> group, </span>
<span id="cb1-6">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> pg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">refresh =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(model1)</span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Model Info:</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  function:     stan_glm</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  family:       gaussian [identity]</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  formula:      weight ~ group</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  algorithm:    sampling</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  sample:       4000 (posterior sample size)</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  priors:       see help('prior_summary')</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  observations: 30</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  predictors:   3</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Estimates:</span></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;               mean   sd   10%   50%   90%</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; (Intercept)  5.0    0.2  4.8   5.0   5.3 </span></span>
<span id="cb1-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; grouptrt1   -0.4    0.3 -0.7  -0.4   0.0 </span></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; grouptrt2    0.5    0.3  0.1   0.5   0.9 </span></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; sigma        0.6    0.1  0.5   0.6   0.8 </span></span>
<span id="cb1-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Fit Diagnostics:</span></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;            mean   sd   10%   50%   90%</span></span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; mean_PPD 5.1    0.2  4.9   5.1   5.3  </span></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb1-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).</span></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb1-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; MCMC diagnostics</span></span>
<span id="cb1-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;               mcse Rhat n_eff</span></span>
<span id="cb1-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; (Intercept)   0.0  1.0  2534 </span></span>
<span id="cb1-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; grouptrt1     0.0  1.0  2503 </span></span>
<span id="cb1-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; grouptrt2     0.0  1.0  2719 </span></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; sigma         0.0  1.0  3035 </span></span>
<span id="cb1-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; mean_PPD      0.0  1.0  3484 </span></span>
<span id="cb1-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; log-posterior 0.0  1.0  1681 </span></span>
<span id="cb1-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb1-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</span></span>
<span id="cb1-42"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(model1)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lesslikely.com/posts/statistics/regression-stories_files/figure-html/unnamed-chunk-2-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p>Another key difference between the first edition and the new edition is that the 2006 book attempted to cover several topics at once. It contained instructions on how to fit simple models in a classical framework all the way up to multilevel models in a Bayesian framework. The new edition attempts to reduce this information overload by splitting itself into two volumes.</p>
<p>The first volume <em>(Regression and Other Stories)</em> covers fitting simple and complex models using <code>R</code> and <code>Stan</code>, and is oriented towards the applied researcher or statistician, who wants a smooth introduction to fitting Bayesian models using <code>Stan</code> without diving into much theory or math.</p>
<p>A draft copy of the table of contents in the new edition can be <a href="../../uploads/regressiontoc.pdf">found here</a>, though it’s very likely that the published edition will have some changes.</p>
<p>The book does not cover much of multilevel modeling, which is reserved for the second volume, <em>Advanced Regression and Multilevel Models</em> (planned to be released in the next year or two).</p>
<p>Make no mistake, although both of these books are unlikely to touch on a serious amount of theory or math, they are not books that can be read without serious engagement and practice. Every chapter contains enough math for the reader to understand the concepts being discussed with exercises at the end to solidify these concepts.</p>
<p>The chapter exercises are incredibly similar to these exam questions that Gelman created for his Applied Regression class.</p>
<p>Question: <a href="https://statmodeling.stat.columbia.edu/2019/06/01/question-1-of-our-applied-regression-final-exam/">1</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/02/question-2-of-our-applied-regression-final-exam-and-solution-to-question-1/">2</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/03/question-3-of-our-applied-regression-final-exam-and-solution-to-question-2/">3</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/04/question-4-of-our-applied-regression-final-exam-and-solution-to-question-3/">4</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/05/question-5-of-our-applied-regression-final-exam-and-solution-to-question-4/">5</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/06/question-6-of-our-applied-regression-final-exam-and-solution-to-question-5/">6</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/07/question-7-of-our-applied-regression-final-exam-and-solution-to-question-6/">7</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/08/question-8-of-our-applied-regression-final-exam-and-solution-to-question-7/">8</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/09/question-9-of-our-applied-regression-final-exam-and-solution-to-question-8/">9</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/10/question-10-of-our-applied-regression-final-exam-and-solution-to-question-9/">10</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/11/question-11-of-our-applied-regression-final-exam-and-solution-to-question-10/">11</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/12/question-12-of-our-applied-regression-final-exam-and-solution-to-question-11/">12</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/13/question-13-of-our-applied-regression-final-exam-and-solution-to-question-12/">13</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/14/question-14-of-our-applied-regression-final-exam-and-solution-to-question-13/">14</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/15/question-15-of-our-applied-regression-final-exam-and-solution-to-question-14/">15</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/16/were-done-with-our-applied-regression-final-exam-and-solution-to-question-15/">solution to 15</a>.</p>
<p>I suspect that many of the commenters of the blog who had some difficulty with these questions would have had an easier time had they had the opportunity to read the book.</p>
<p>The new edition also covers several news stories from the past few years (some of which long-time blog readers will be familiar with) and gives readers a set of tools to think critically about these stories and how proper statistical thinking could’ve prevented mishaps. In addition, it incorporates concepts that Gelman and colleagues have developed and solidified over the years, since the first edition was published, such as the concept of <a href="https://doi.org/10.1177%2F1745691614551642">Type-M and Type-S errors</a>.</p>
<p>Overall, the book is quite comprehensive and will leave the reader with a rich set of tools to think critically about statistics and to fit models in the real world. I look forward to grabbing a hard copy once the book is out, which seems to be in the <a href="https://twitter.com/avehtari/status/1251188631487774720">summer to fall of 2020</a>.</p>
<hr>
<blockquote class="blockquote">
<p>Update: Looks like the <a href="https://www.amazon.com/Regression-Stories-Analytical-Methods-Research/dp/110702398X">book is out!</a></p>
</blockquote>


<!-- -->


 ]]></description>
  <guid>https://lesslikely.com/posts/statistics/regression-stories.html</guid>
  <pubDate>Tue, 11 Jun 2019 04:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1587793393/Site/gelman_raos_2020.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Book Review: Regression and Other Stories by Gelman, Hill, and Vehtari</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/regression-stories.html</link>
  <description><![CDATA[ 





<hr>
<p>Over a decade ago, <a href="https://statmodeling.stat.columbia.edu/">Andrew Gelman</a> and <a href="https://steinhardt.nyu.edu/faculty/Jennifer_L_Hill">Jennifer Hill</a> gave applied researchers a comprehensive book <em>(<a href="https://www.amazon.com/Analysis-Regression-Multilevel-Hierarchical-Models/dp/052168689X">Data Analysis Using Regression and Multilevel/Hierarchical Models</a>)</em> on fitting simple and complex statistical models in <code>R</code> both from a classical framework and a Bayesian one. Now they’re back with an updated version and a new author (<a href="https://users.aalto.fi/~ave/">Aki Vehtari</a>).</p>
<p>Much has changed in applied statistics since 2006 (when the book was first released). The primary software used at the time and in the book to fit Bayesian models was <code>BUGS</code> (Bayesian inference Using Gibbs Sampling).</p>
<p>However, both <code>BUGS</code> and some of the <code>R</code> code in the first edition are now outdated. The new edition updates the <code>R</code> code and contains intuitive instructions on how to fit simple and complex models using the probabilistic programming language, <a href="https://mc-stan.org/"><code>Stan</code></a> (also developed by Gelman and <a href="https://mc-stan.org/about/team/">colleagues</a>), which is now used in several fields (even for <a href="https://statmodeling.stat.columbia.edu/2019/04/24/postdoctoral-position-in-vancouver-using-stan-working-on-wine-for-reals/">studying wine!</a>).</p>
<p>Indeed, running a Bayesian regression model in <code>R</code> is now as simple as</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I use the sample PlantGrowth dataset in R</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rstanarm"</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bayesplot"</span>)</span>
<span id="cb1-4">pg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> PlantGrowth</span>
<span id="cb1-5">model1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stan_glm</span>(weight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> group, </span>
<span id="cb1-6">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> pg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">refresh =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(model1)</span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Model Info:</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  function:     stan_glm</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  family:       gaussian [identity]</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  formula:      weight ~ group</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  algorithm:    sampling</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  sample:       4000 (posterior sample size)</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  priors:       see help('prior_summary')</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  observations: 30</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  predictors:   3</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Estimates:</span></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;               mean   sd   10%   50%   90%</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; (Intercept)  5.0    0.2  4.8   5.0   5.3 </span></span>
<span id="cb1-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; grouptrt1   -0.4    0.3 -0.7  -0.4   0.0 </span></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; grouptrt2    0.5    0.3  0.1   0.5   0.9 </span></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; sigma        0.6    0.1  0.5   0.6   0.8 </span></span>
<span id="cb1-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Fit Diagnostics:</span></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;            mean   sd   10%   50%   90%</span></span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; mean_PPD 5.1    0.2  4.9   5.1   5.3  </span></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb1-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).</span></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb1-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; MCMC diagnostics</span></span>
<span id="cb1-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;               mcse Rhat n_eff</span></span>
<span id="cb1-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; (Intercept)   0.0  1.0  2534 </span></span>
<span id="cb1-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; grouptrt1     0.0  1.0  2503 </span></span>
<span id="cb1-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; grouptrt2     0.0  1.0  2719 </span></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; sigma         0.0  1.0  3035 </span></span>
<span id="cb1-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; mean_PPD      0.0  1.0  3484 </span></span>
<span id="cb1-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; log-posterior 0.0  1.0  1681 </span></span>
<span id="cb1-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb1-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</span></span>
<span id="cb1-42"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(model1)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lesslikely.com/posts/statistics/regression-stories_files/figure-html/unnamed-chunk-2-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p>Another key difference between the first edition and the new edition is that the 2006 book attempted to cover several topics at once. It contained instructions on how to fit simple models in a classical framework all the way up to multilevel models in a Bayesian framework. The new edition attempts to reduce this information overload by splitting itself into two volumes.</p>
<p>The first volume <em>(Regression and Other Stories)</em> covers fitting simple and complex models using <code>R</code> and <code>Stan</code>, and is oriented towards the applied researcher or statistician, who wants a smooth introduction to fitting Bayesian models using <code>Stan</code> without diving into much theory or math.</p>
<p>A draft copy of the table of contents in the new edition can be <a href="../../uploads/regressiontoc.pdf">found here</a>, though it’s very likely that the published edition will have some changes.</p>
<p>The book does not cover much of multilevel modeling, which is reserved for the second volume, <em>Advanced Regression and Multilevel Models</em> (planned to be released in the next year or two).</p>
<p>Make no mistake, although both of these books are unlikely to touch on a serious amount of theory or math, they are not books that can be read without serious engagement and practice. Every chapter contains enough math for the reader to understand the concepts being discussed with exercises at the end to solidify these concepts.</p>
<p>The chapter exercises are incredibly similar to these exam questions that Gelman created for his Applied Regression class.</p>
<p>Question: <a href="https://statmodeling.stat.columbia.edu/2019/06/01/question-1-of-our-applied-regression-final-exam/">1</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/02/question-2-of-our-applied-regression-final-exam-and-solution-to-question-1/">2</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/03/question-3-of-our-applied-regression-final-exam-and-solution-to-question-2/">3</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/04/question-4-of-our-applied-regression-final-exam-and-solution-to-question-3/">4</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/05/question-5-of-our-applied-regression-final-exam-and-solution-to-question-4/">5</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/06/question-6-of-our-applied-regression-final-exam-and-solution-to-question-5/">6</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/07/question-7-of-our-applied-regression-final-exam-and-solution-to-question-6/">7</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/08/question-8-of-our-applied-regression-final-exam-and-solution-to-question-7/">8</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/09/question-9-of-our-applied-regression-final-exam-and-solution-to-question-8/">9</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/10/question-10-of-our-applied-regression-final-exam-and-solution-to-question-9/">10</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/11/question-11-of-our-applied-regression-final-exam-and-solution-to-question-10/">11</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/12/question-12-of-our-applied-regression-final-exam-and-solution-to-question-11/">12</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/13/question-13-of-our-applied-regression-final-exam-and-solution-to-question-12/">13</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/14/question-14-of-our-applied-regression-final-exam-and-solution-to-question-13/">14</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/15/question-15-of-our-applied-regression-final-exam-and-solution-to-question-14/">15</a>, <a href="https://statmodeling.stat.columbia.edu/2019/06/16/were-done-with-our-applied-regression-final-exam-and-solution-to-question-15/">solution to 15</a>.</p>
<p>I suspect that many of the commenters of the blog who had some difficulty with these questions would have had an easier time had they had the opportunity to read the book.</p>
<p>The new edition also covers several news stories from the past few years (some of which long-time blog readers will be familiar with) and gives readers a set of tools to think critically about these stories and how proper statistical thinking could’ve prevented mishaps. In addition, it incorporates concepts that Gelman and colleagues have developed and solidified over the years, since the first edition was published, such as the concept of <a href="https://doi.org/10.1177%2F1745691614551642">Type-M and Type-S errors</a>.</p>
<p>Overall, the book is quite comprehensive and will leave the reader with a rich set of tools to think critically about statistics and to fit models in the real world. I look forward to grabbing a hard copy once the book is out, which seems to be in the <a href="https://twitter.com/avehtari/status/1251188631487774720">summer to fall of 2020</a>.</p>
<hr>
<blockquote class="blockquote">
<p>Update: Looks like the <a href="https://www.amazon.com/Regression-Stories-Analytical-Methods-Research/dp/110702398X">book is out!</a></p>
</blockquote>


<!-- -->


 ]]></description>
  <guid>https://lesslikely.com/posts/statistics/regression-stories.html</guid>
  <pubDate>Tue, 11 Jun 2019 00:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1587793393/Site/gelman_raos_2020.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Book Review: Fisher, Neyman, and the Creation of Classical Statistics</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/classical-lehmann.html</link>
  <description><![CDATA[ 





<hr>
<p>Erich Lehmann’s <a href="https://www.springer.com/us/book/9781441994998">last book</a>,[<span class="citation" data-cites="Lehmann2011-vs"><sup>1</sup></span>] which was published after his death, is on the history of classical statistics and its creators. Specifically, how his mentor Jerzy Neyman and his adversary Ronald Fisher helped lay the foundations for the methods that are used today in several fields.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700110/Site/classicalgiants.png" alt="Picture of the giants who founded frequentist statistics such as Egon Pearson, Ronald Fisher, and Jerzy Neyman" style="width:80%"></p>
<hr>
<section id="a-very-brief-history-of-classical-statistics" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> A Very Brief History of Classical Statistics</h1>
<hr>
<p>This post is intended to be a general review/summary of the book, which I recommend to everyone and anyone who is interested in statistics and science. The book clears up several misconceptions people have about how frequentist statistics came to be the dominant school of statistics. Thus, I want to go over four topics from Lehmann’s book that I believe people should know more about:</p>
<hr>
<ul>
<li><p>How the founders of classical statistics viewed Bayesian inference</p></li>
<li><p>What they each developed</p></li>
<li><p>How they came to become so conflicted</p></li>
<li><p>And how their views changed over time</p></li>
</ul>
<hr>
</section>
<section id="where-are-the-bayesians" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Where Are The Bayesians?</h1>
<hr>
<p>As Stephen Senn points out in his <a href="https://www.youtube.com/watch?v=vJIc_9wzh6Y">Fisher Memorial Lecture</a> at the Royal Statistical Society, there is a common myth that everyone who practiced applied statistics before the early 20th century was using Bayesian inference and doing everything correctly, but then Fisher came in and created significance testing, thus giving researchers a powerful tool to easily hack their data and produce publishable results, and now we have several replication crises because of this.</p>
<p>Of course, this is far from the truth and any thorough investigation into the history of statistics will clear up this up amongst many other misconceptions.</p>
<p>As several individuals may know, it was Thomas Bayes who came up with Bayes theorem and it was Richard Price who disseminated most of his writings after Bayes’s death. However, as many self-identified Bayesians will attest, using Bayes’ theorem does not make one a Bayesian. It is actually quite hard to know how Bayes would react to modern Bayesian inference. The Bayesian inference that we are familiar with today can be attributed to Pierre-Simon Laplace, who popularized what is now known as “objective Bayes.”</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700141/Site/Pierre-Simon-Laplace_1749-1827.jpg" alt="Portrait of Pierre Simon Laplace" style="width:40%"></p>
<hr>
<p>Back then, it was not called “Bayesian inference” but was referred to as “inverse probability” and it was a method used by many before the dominance of classical statistics. So this is one part that common myths get right. Inverse probability did indeed have a moment in history before the dominance of frequentist statistics.</p>
<p>Laplace, and several others popularized such methods, but around the end of the 19th century, the tides began to shift. Several mathematicians and statisticians began to discourage the use of inverse probability because they saw it as a nonrigorous method of data analysis.</p>
<p>This can be seen in the following passages about Fisher.</p>
<hr>
<blockquote class="blockquote">
<p>“His first publication on this new approach to inference was a 1930 paper”Inverse probability.” The paper begins with a critique of the inverse (Bayesian) method. This section ends with Fisher’s asking:</p>
<p><strong>If, then, we follow writers like Boole, Venn and Chrystal in rejecting the inverse argument as devoid of foundation and incapable even of consistent application</strong>, how are we to avoid the staggering falsity of saying that however extensive our knowledge of the values of x may be, yet we know nothing and can know nothing about the values of <img src="https://latex.codecogs.com/png.latex?%5Ctheta"> ?” (78)</p>
</blockquote>
<hr>
<p>Thus, Fisher was not the first to reject inverse probability, he was building on arguments from proto frequentists who already began to condemn inverse probability. Neyman was also a serious critic of inverse probability. In fact, he was probably more of a critic of it at a later point in time then Fisher (much on that later)!</p>
<hr>
<blockquote class="blockquote">
<p>“On one subject, Fisher and Neyman agreed. Fisher, after 1922, and Neyman, after 1937, were <strong>united in their strong opposition to the use of prior distributions</strong> (unless they were <strong>based on substantial empirical evidence</strong>).” (90)</p>
</blockquote>
<hr>
<p>Although the two giants of classical statistics both condemned inverse probability, it withstood their influential criticisms.</p>
<hr>
<blockquote class="blockquote">
<p>“It seems ironic that one of the most significant developments after Fisher and Neyman had established their foundations was to rejuvenate an approach they both had strongly opposed and thought to have vanquished: inverse probability…</p>
<p>The nineteenth century approach to inverse probability, championed particularly by Laplace, considered the prior distribution to represent complete ignorance. This concept, now called objective Bayes, was taken up and improved by the Cambridge geophysicist Harold Jeffreys, culminating in his 1939 book, “<em>Theory of Probability</em>.”</p>
<p>A different Bayesian approach, called subjective, was proposed by Ramsey (1926) and Bruno de Finetti in the 1930s. It considered probability as a measure of a person’s subjective degree of uncertainty about a situation. This view came into its own with the publication in 1954 of L. J. Savage’s book, “<em>Foundations of Statistics</em>,” in which he derives the existence of such subjective probabilities from a few, quite plausible, axioms.” (91)</p>
</blockquote>
<hr>
<p>Now that we have looked at how the founders of classical statistics viewed and attempted to discourage the use of inverse probability, we can move onto a brief summary of each of their individual contributions.</p>
<hr>
</section>
<section id="fishers-contributions" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Fisher’s Contributions</h1>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1559517576/Site/fisher_old.jpg" alt="Picture of Ronald Fisher sitting and smoking" style="width:50%"></p>
<hr>
<p>Much of Fisher’s early work was a result of two individuals, Karl Pearson and William Gosset. Pearson’s work on the method of moments to estimate parameters led to Fisher developing his superior estimation method, maximum likelihood, which he presented in his 1922 foundations paper, “<em>On the mathematical foundations of theoretical statistics</em>.”</p>
<hr>
<blockquote class="blockquote">
<p>“Having defined the problem of statistics to be the estimation of parameters, Fisher states the properties that he desires for his estimators. They are consistency, efficiency, and sufficiency…</p>
<p>He then proposes what he had already suggested earlier in the section on <strong>the solution of the estimation problem, the method of maximum likelihood</strong>, which “consists, then, simply of choosing such values of these parameters as have the maximum likelihood.” Fisher believes that this method satisfies his three criteria, in particular that it satisfied the criterion of sufficiency, although he states that he “is not satisfied as to the mathematical rigor of any proof which I can put forward to that effect.” He also claims that sufficiency implies efficiency…</p>
<p>Thus, in this paper Fisher has not only <strong>formulated the general problem of optimal estimation, but he has also provided a solution</strong>. It is a stunning achievement.” (10)</p>
</blockquote>
<hr>
<p>Gosset’s initial work on test statistics, his inability derive proofs for small sample methods, and constant prodding led to Fisher developing several statistical tests which ended up being published in his highly influential book, <em>Statistical Methods For Research Workers</em>,</p>
<hr>
<blockquote class="blockquote">
<p>“For testing the value of a population mean, it had been customary to use a statistic equivalent to what today is called Student’s t, and to refer to the normal distribution. For large samples, this provided a good approximation.</p>
<p>However, Gosset soon realized that for <strong>the small samples with which he had to work, the approximation was inadequate</strong>. He then had the crucial insight that exact results could be obtained by making an additional assumption, namely that the form of the distribution of the observations is known. Gosset undertook to determine it for the case that the underlying distribution is normal, and he obtained the correct result, although he was not able to give a rigorous proof.</p>
<p>The first proof was obtained (although not published) by Fisher in 1912. His proof was finally published in 1915 [4], together with the corresponding proof for the correlation coefficient that Student had conjectured in a second paper of 1908(b). Fisher followed this in 1921 [14] with a derivation of the distribution of the intraclass correlation coefficient. And then, as a result of constant prodding and urging by Gosset, he found a number of additional small-sample distributions, and in 1925 presented the totality of these results in his book, <em>“Statistical Methods for Research Workers.”</em> (6)</p>
</blockquote>
<hr>
<p>In the book, Fisher’s main focus was on statistical testing and not estimation, and he made this clear,</p>
<hr>
<blockquote class="blockquote">
<p>“…the prime object of this book is to put into the hands of research workers… <strong>the means of applying statistical tests accurately to numerical data accumulated in their own laboratories</strong> … and later refers to the exact distributions with the use of which this book is chiefly concerned… Thus, the book does not primarily deal with estimation but with significance testing. In fact, estimation is never again mentioned.” (16)</p>
</blockquote>
<hr>
<p>His section about chi-squared tests and significance testing became highly influential,</p>
<hr>
<blockquote class="blockquote">
<p>“<strong>In preparing this table we have borne in mind that in practice we do not want to know the exact value of P for any observed</strong> <img src="https://latex.codecogs.com/png.latex?%5Cchi%7B2%7D">, but, in the first place, whether or not the observed value is open to suspicion. If P is between .1 and .9 there is certainly no reason to suspect the hypothesis tested. If it is below .02 it is strongly indicated that the hypothesis fails to account for the whole of the facts. <strong>We shall not often be astray if we draw a conventional line at .05 and consider that higher values of</strong> <img src="https://latex.codecogs.com/png.latex?%5Cchi%7B2%7D"> indicate a real discrepancy.” (17)</p>
</blockquote>
<hr>
<p>He also presents examples,</p>
<hr>
<blockquote class="blockquote">
<p>“In the first of these, in particular, he finds a p-value between 0.01 and 0.02 and concludes:”If we take P = 0.05 as the limit of significant deviation, <strong>we shall say that in this case the deviations from expectation are significant</strong>.” (17)</p>
</blockquote>
<hr>
<p>And he expanded on significance testing with analysis of variance, which he had derived while working at Rothamsted analyzing crop data. The book was a large success,</p>
<hr>
<blockquote class="blockquote">
<p>“The first edition of 1,050 copies was sold out after three years, and the second edition of 1,250 copies in another two. Every two to three years necessitated a new edition, which usually contained some improvements and often additions. The size of the editions steadily increased and the eleventh edition of 1950 ran to 7,500 copies. The last edition, the fourteenth, was published posthumously in 1970 from notes Fisher had prepared before his death in 1962.” (25)</p>
</blockquote>
<hr>
<p>And set the groundwork for his next task, discussing experimental methods, which would be published in his second book, <em>The Design of Experiments</em>. In it, he discusses how techniques like randomization were necessary for the validity of statistical tests and how they perform amongst a wide variety of distributions,</p>
<hr>
<blockquote class="blockquote">
<p>“Randomisation properly carried out … ensures that the estimates of error will take proper care of all such causes of different growth rates, and <strong>relieves the experimenter from the anxiety of considering and estimating the magnitude of the innumerable causes by which his data may be disturbed.</strong> The one flaw in Darwin’s procedure was the absence of randomisation…</p>
<p>It seems to have escaped recognition that the physical act of randomisation which, as has been shown, is necessary for the validity of any test of significance, affords the means, in respect of any particular body of data, of examining the wider hypothesis <strong>in which no normality of distribution is implied</strong>.” (66)</p>
</blockquote>
<hr>
<p>Although he had proposed randomization tests as a way of dealing with nonnormal distributions, due to their tedious calculations, they never became popular at the time. The book also touched on several other concepts such as randomized blocks, Latin squares, and factorial designs. He also made his position very clear on significance tests and the null hypothesis,</p>
<hr>
<blockquote class="blockquote">
<p>“By increasing the size of the experiment, we can render it more sensitive, meaning by this that it will allow of the detection of a lower degree of sensory discrimination… . <strong>Since in every case the experiment is capable of disproving, but never of proving this hypothesis</strong>, we may say that the value of the experiment is increased whenever it permits the null hypothesis to be more readily disproved.” (64)</p>
</blockquote>
<hr>
<p>Here we can see Fisher’s concept of statistical power, though “sensitivity” was never a quantified concept. He also clearly states his position on the null hypothesis, that we can never accept it, <a href="../../../statistics/evidence-of-absence">a mistake that many researchers continue to make today</a>.</p>
<p>Now that we have discussed some of Fisher’s contributions to classical statistics, we can discuss the contributions of Jerzy Neyman.</p>
<hr>
</section>
<section id="neymans-contributions" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Neyman’s Contributions</h1>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700127/Site/Jerzy_Neyman.jpg" alt="Photo of Jerzy Neyman and his colleagues" style="width:40%"></p>
<hr>
<p>Just like Fisher, Neyman was also impacted by Gosset. However, the influence was indirect. In the 1920s, Egon Pearson, had come across the small-sample tests that both Fisher and Gosset had popularized and had the realization that he must make a name for himself if he ever wished to be free of his father’s influence.</p>
<hr>
<blockquote class="blockquote">
<p>“In 1925-6, I was in a state of puzzlement, and realized that, <strong>if I was to continue an academic career as a mathematical statistician</strong>, <strong>I must construct for myself what might be termed a statistical philosophy</strong>, which would have to combine what I accepted from K. P.’s large- sample tradition with the newer ideas of Fisher.” (7)</p>
</blockquote>
<hr>
<p>Thus, he contacted Gosset about practical usage of the t-test, to which Gosset replied,</p>
<hr>
<blockquote class="blockquote">
<p>“Even if the chance is very small, say .00001, that doesn’t in itself necessarily prove that the sample is not drawn randomly from the population [specified by the hypothesis]; <strong>what it does is to show that if there is any alternative hypothesis</strong> which will explain the occurrence of the sample with a more reasonable probability, say .05 (such as that it belongs to a different population or that the sample wasn’t random or whatever will do the trick), you will be very much more inclined to consider that the original hypothesis is not true.” (E. S. Pearson, 1939.)</p>
<p>“In his obituary of Gosset, Pearson continues, Gosset’s reply had a tremendous influence on the direction of my subsequent work, for the first paragraph contains the germ of that idea which has formed the basis of all the later joint researches of Neyman and myself. It is the simple suggestion that the only valid reason for rejecting a statistical hypothesis is that <strong>some alternative explains the observed events with a greater degree of probability</strong>.” (7)</p>
</blockquote>
<hr>
<p>As a result, Pearson decided to collaborate with someone who was not taught by his father, but who also had the mathematical abilities to create a generalizable theorem that he had in mind. Thus, began the collaboration between Neyman and Pearson.</p>
<p>In 1928, they published a paper in <em>Biometrika</em> titled, <em>“On the use and interpretation of certain test criteria,”</em> where they introduced two kinds of errors,</p>
<hr>
<blockquote class="blockquote">
<ol type="1">
<li><p>Sometimes,when hypothesis A is rejected, <img src="https://latex.codecogs.com/png.latex?%5CSigma"> will in fact have been drawn from <img src="https://latex.codecogs.com/png.latex?%5CPi">.</p></li>
<li><p>More often, in accepting hypothesis A, <img src="https://latex.codecogs.com/png.latex?%5CSigma"> will really have been drawn from [some alternative population] <img src="https://latex.codecogs.com/png.latex?%5CPi">. (31)</p></li>
</ol>
</blockquote>
<hr>
<p>As Lehmann notes, the paper was a great achievement,</p>
<hr>
<blockquote class="blockquote">
<p>“It introduces the consideration of alternatives, the two kinds of error, and the distinction between simple and composite hypotheses. In addition, of course, it proposes the likelihood ratio test. This test is intuitively appealing, and Neyman and Pearson show that in a number of important cases it leads to very satisfactory solutions. It has become the standard approach to new testing problems.” (34)</p>
<p>But the Neyman-Pearson lemma was still incomplete. It was between the years of 1930 and 1933 that Neyman had several insights into how to improve the theory, which Pearson already had felt satisfied with.</p>
<p>“In the next letter, dated March 8, Neyman suggests that he and Egon must”fix a certain plan, as we have lot of problems already started and then left in the wood.” He lists several such problems, among them: to finish what I have started to do with the variation calculus. You will understand it in a moment.</p>
<p>To reduce for a given level the errors of rejecting a true hypothesis, we may use any test. Now we want to find a test which would 1) <strong>reduce the probability of rejecting a true hypothesis to the level</strong> <img src="https://latex.codecogs.com/png.latex?%5Cleq%20%5Cvarepsilon"> and 2) <strong>such that the probability of accepting a false hypothesis should be minimum</strong>. – We find that if such a test exists, then <strong>it is the</strong> <img src="https://latex.codecogs.com/png.latex?%5Clambda">-test. I am now shure [sic] that in a few days I shall be ready. This will show that the “<img src="https://latex.codecogs.com/png.latex?%5Clambda"> principle” is not only a principle but that <strong>there are arguments to prove that it is really “the best test</strong>.”” (35)</p>
</blockquote>
<hr>
<p>These correspondences led to their 1933 paper,</p>
<p><em>“On the Problem of the Most Efficient Tests of Statistical Hypotheses.”</em> in which both authors introduce the novel idea of behavioral guidance,</p>
<hr>
<blockquote class="blockquote">
<p>“Without hoping to know whether each separate hypothesis is true or false, <strong>we may search for rules to govern our behavior</strong> with regard to them, in following which we insure that, in the long run of experience, <strong>we shall not be too often wrong</strong>.” (36)</p>
</blockquote>
<hr>
<p>As Lehmann notes,</p>
<hr>
<blockquote class="blockquote">
<p>“After outlining the general theory, the paper in the next section deals with the case of simple hypotheses and brings the statement and proof of the basic result, now known as the <strong>Neyman-Pearson Fundamental Lemma</strong>. It states that for testing a simple hypothesis against a simple alternative, <strong>the test that at a given level maximizes the probability of rejection is the likelihood ratio test at that level</strong>.” (36)</p>
</blockquote>
<hr>
<p>Lehmann summarizes much of the collaboration with the following,</p>
<hr>
<blockquote class="blockquote">
<p>“The collaboration falls into two quite distinct parts. In the early stages, the important ideas, including in particular that of the likelihood ratio principle, all come from Pearson. In fact, Neyman frequency misunderstands them, and continually tries to interpret them in terms of inverse probability.</p>
<p>On the other hand, Pearson is sold on the likelihood ratio principle, which is intuitively appealing and which seems to give reasonable solutions in the cases on which they try it out. But for Neyman, as he is gradually catching on, intuitive appeal is not enough. If the principle is really as good as it appears to be, there ought to be logical justification.</p>
<p>And then one day in early 1930, he sees the light. Since there are two sources of error, one of which is being controlled, the best test is the one minimizing the other one. And from then on, it is Neyman who has the new ideas and Pearson is the reluctant follower. Neyman formulates, and shortly thereafter proves, the Fundamental Lemma and realizes that in some special cases there exist what they later call uniformly most powerful tests. These turn out to coincide with the likelihood ratio tests.” (39)</p>
</blockquote>
<hr>
</section>
<section id="the-fallout-between-the-creators-of-classical-statistics" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> The Fallout Between The Creators Of Classical Statistics</h1>
<hr>
<p>The conflict between Neyman and Fisher is well known, however, very few are able to accurately point out what lead to each individual strongly detesting the other.</p>
<p>In fact, early correspondences between Neyman and Fisher showed that they were incredibly friendly towards one another. In 1932, Neyman asked Fisher to review their 1933 paper before they submitted it, to which Fisher replied,</p>
<hr>
<blockquote class="blockquote">
<p>“I should be very much interested to see your paper on”the best tests,” as the whole question of tests of significance seems to me to be of immense philosophical importance, and the work you showed me was surely of great promise. It is quite probable that if the work is submitted to the Royal Society, I might be asked to act as referee, and in that case I shall certainly not refuse.” (45)</p>
</blockquote>
<hr>
<p>Fisher not only read the paper, but read it so carefully that he was able to catch a mathematical error and point it out to Neyman and Pearson before it was published,</p>
<hr>
<blockquote class="blockquote">
<p>“When the paper appeared in 1933, the omission was corrected, and a footnote acknowledged that,”We are indebted to Dr.&nbsp;R. A. Fisher – for kindly calling our attention to the fact that we had originally omitted to refer to this restriction.” (46)</p>
</blockquote>
<hr>
<p>Neyman thanked Fisher for his help,</p>
<hr>
<blockquote class="blockquote">
<p>Neyman: “Pearson writes that you have recommended our paper for publication. Although it maybe considered ridiculous to thank a judge, I have intense feeling of gratefulness, which I hope you will kindly accept…” (57)</p>
<p>Fisher replies, “It was a great pleasure to hear from you again.” (57)</p>
<p>Neyman: “I am often thinking that it would be very useful for me to work with you. Unfortunately, this requires considerable amount of money – without speaking of your consent – of course…” (57)</p>
<p>Fisher answers, “You may be sure of my consent,” and in the next letter, “I like hearing from Poland. Best wishes for a Merry Christmas.” (58)</p>
</blockquote>
<hr>
<p>Unfortunately, their relationship began to degrade after the retirement of Karl Pearson. The department of applied statistics that he was the head of was split into the department of statistics, which would be led by his son Egon, and the department of genetics, where Fisher was appointed as Galton professor. Thus, Fisher, one of the creators of classical statistics, was not allowed to teach statistics, while in the floor downstairs, Egon Pearson (a man that he was surely not fond of) was leading the new statistics department.</p>
<p>This change in tone could be seen by the correspondence between Neyman and Fisher following Fisher’s appointment as Galton professor,</p>
<hr>
<blockquote class="blockquote">
<p>“Dr.&nbsp;Pearson writes me that soon you will be Galton Professor at the University College, London. Very probably <strong>this means a general reorganization of the Department of Applied Statistics and possibly new people will be needed</strong>. I know that there are many statisticians in England and that many of them would be willing to work under you. But improbable things do happen sometimes and you may have a vacant position in your laboratory. In that case please consider whether I can be of any use.” (58)</p>
</blockquote>
<hr>
<p>Fisher replies,</p>
<hr>
<blockquote class="blockquote">
<p>“Many thanks for your letter of congratulation. You will be interested to hear that the <strong>Dept. of Statistics has now been separated officially from the Galton Laboratory</strong>. I think Egon Pearson is designated as Reader in Statistics. This arrangement will be much laughed at, but it will be rather a poor joke, I fancy, for both Pearson and myself. I think, however, we will make the best of it.</p>
<p><strong>I shall not lecture on statistics, but probably on “the logic of experimentation,</strong>” so that my lectures will not be troubled by students who cannot see through a wire fence. I wish I had a fine place for you, but it will be long before my new department can be given any sort of unity and coherence, and you will be head of a faculty before I shall be able to get much done. <strong>If in England, do not fail to see me at University College</strong>.” (58)</p>
</blockquote>
<hr>
<p>Of course, there is little doubt that both Karl and Egon Pearson contributed to the fallout between Neyman and Fisher. In 1929, Egon Pearson had submitted a critical review of the second edition of <em>Statistical Methods For Research Workers</em> to <em>Nature</em>,</p>
<hr>
<blockquote class="blockquote">
<p>“There is one criticism, however, which must be made from the statistical point of view. A large number of the tests developed are based…on the assumption that the population sampled is of the”normal” form. That this is the case may be gathered from a careful reading of the text, but the point is not sufficiently emphasized.</p>
<p>It does not appear reasonable to lay stress on the “exactness” of the tests when no means whatever are given of appreciating how rapidly they become inexact as the population sampled diverges from normality. That the tests, for example, connected with the analysis of variance are far more dependent on normality than those involving Student’s z (or t) distribution is almost certain, but no clear indication of the need for caution in their application is given.” (22)</p>
</blockquote>
<hr>
<p>As Lehmann points out, Fisher was deeply offended by this review. Nearly six years later (1935), Neyman encountered a similar reaction when he submitted a paper titled, “Statistical problems in agricultural experimentation” pointing out problems with some of the concepts that Fisher had introduced in his book, <em>The Design of Experiments</em>. Fisher was furious,</p>
<hr>
<blockquote class="blockquote">
<p>“I had hoped that Dr.&nbsp;Neyman’s paper would be on a subject with which the author was fully acquainted, and on which he could speak with authority, as in the case of his address to the Society delivered last summer. Since seeing the paper, <strong>I have come to the conclusion that Dr.&nbsp;Neyman had been somewhat unwise in his choice of topics</strong>… (59)</p>
<p>Were it not for the persistent effort which Dr.&nbsp;Neyman and Dr.&nbsp;Pearson had made to treat what they speak of as problems of estimation, by means merely of tests of significance, I have no doubt that Dr.&nbsp;Neyman would not have been in any danger of falling into the series of misunderstandings which his paper revealed.” (59)</p>
</blockquote>
<hr>
<p>Correspondences from there on out had become hostile,</p>
<hr>
<blockquote class="blockquote">
<p>“Neyman later (Reid 1982, p.&nbsp;126) recalls that a week after this meeting, Fisher stopped by his room at University College:</p>
<p>And he said to me that he and I are in the same building… . That, as I know, he had published a book – and that’s Statistical Methods for Research Workers – and he is upstairs from me so he knows something about my lectures – that from time to time I mention his ideas, this and that – and that this would be quite appropriate if I were not here in the College but, say, in California – but if I am going to be at University College, then this is not acceptable to him.</p>
<p><strong>And then I said, “<em>Do you mean that if I am here, I should just lecture using your book</em>?” And then he gave an affirmative answer. And I said, “<em>Sorry, no. I cannot promise that</em>.” And then he said, “<em>Well, if so, then from now on I shall oppose you in all my capacities</em>.”</strong></p>
<p>Reid also reports (p.&nbsp;124) that, After the Royal Statistical Society meeting of March 28, relations between workers on the two floors of K. P.’s old preserve became openly hostile. One evening, late that spring, Neyman and Pearson returned to their department after dinner to do some work.</p>
<p>Entering, they were startled to find <strong>strewn on the floor the wooden models which Neyman had used to illustrate his talk on the relative advantages of randomized blocks and Latin squares</strong>. They were regularly kept in a cupboard in the laboratory. Both Neyman and Pearson always believed that the models were removed by Fisher in a fit of anger.” (59)</p>
</blockquote>
<hr>
</section>
<section id="there-is-no-one-neyman-nor-one-fisher" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> There Is No One Neyman Nor One Fisher</h1>
<hr>
<p>When Fisher released his first edition of <em>Statistical Methods For Research Workers</em> (SMRW), he recommended 5% or 1% as good choices for significance levels, with the latter being used when a “more stringent requirement was necessary.” Fisher was also not interested in exact P-values as pointed out in the section discussing his contributions.</p>
<p>Many of these views changed as he released later editions of his SMRW and his new book, <em>Statistical Methods for Scientific Inference</em> (SMSI). For example, he no longer recommended a particular level of significance,</p>
<hr>
<blockquote class="blockquote">
<p>“In his late, 1956, book SMSI, Fisher protested that”<strong>no scientific worker has a fixed level of significance at which from year to year, and in all circumstances, he rejects hypotheses; he rather gives his mind to each particular case, and his ideas</strong>” (52)</p>
</blockquote>
<hr>
<p>In the 13th edition of SMRW he stated,</p>
<hr>
<blockquote class="blockquote">
<p>“<strong>The actual value of P obtainable from the table by interpolation indicates the strength of the evidence against the hypothesis</strong>. A value of <img src="https://latex.codecogs.com/png.latex?%5Cchi%7B2%7D"> exceeding the 5 per cent. point is seldom to be disregarded.” (52)</p>
</blockquote>
<hr>
<p>Thus, Fisher had changed his mind on the topic.</p>
<p>Neyman too had a significant change of mind during the course of his collaboration with Pearson. At first, he constantly defaulted to inverse probability methods, as noted by Pearson’s letter to him in 1978,</p>
<hr>
<blockquote class="blockquote">
<p>“I have eight letters which you wrote to me during February and March 1929, trying to persuade me to put my name as a joint author. But you had introduced an a priori law of probability…, and I was not willing to start from this basis. True we had given the inverse probability as an alternative approach in our 1928 Part I paper, but I must in 1927-28 still have been ready to concede to your line of thought.</p>
<p>However, <strong>by 1929 I had come down firmly to agree with Fisher that prior distributions should not be used</strong>, except in cases where they were based on real knowledge, e.g., in some Mendelian problems. <strong>You were disappointed, but accepted my decision</strong>; after all, the whole mathematical development in the paper was yours.” (42)</p>
</blockquote>
<hr>
<p>Though eventually Neyman abandoned his interest in inverse probability and became a serious critic,</p>
<hr>
<blockquote class="blockquote">
<p>“His conviction of the inapplicability of the inverse method had by then become a fundamental part of his statistical philosophy, <strong>from which he never wavered</strong>.” (42)</p>
</blockquote>
<hr>
<p>Although this post is mainly fixated on the book by Lehmann, I would like to at least paste this one relevant passage from <a href="https://www.jstor.org/stable/23736900">Hulbert &amp; Lombardi, 2009</a>,[<span class="citation" data-cites="Hurlbert2009-ks"><sup>2</sup></span>]</p>
<hr>
<blockquote class="blockquote">
<p>“In a later philosophical essay, Neyman (1977: 112) recounted their cloud-seeding studies, and labeled P values of 0.09, 0.03, and &lt; 0.01 reported in their earlier paper (Lovasich et al.&nbsp;1971), as”approximately significant,” “significant,” and “highly significant,” respectively. The dichotomies of the paleoFisherian and Neyman-Pearsonian frameworks were quietly admitted to be less appropriate than more nebulous interpretations — at least in cloud work!</p>
<p>Indeed, Cox (2006a: 43, 195) has noted that “the differences between Fisher and Neyman … were not nearly as great as the asperity of the arguments between them might suggest … [and in] actual practice … Neyman … often reported p-values whereas some of Fisher’s use of tests … was much more dichotomous”!</p>
</blockquote>
<hr>
<p>As we can see from a summary of Lehmann’s book, the individuals who founded classical statistics were skilled and talented individuals who were also complex and had various reasons for doing what they did. I hope this blog post encourages readers to fully dive into Lehmann’s book where he gives a far more detailed account of Fisher and Neyman’s contributions to classical statistics.</p>
<hr>
</section>
<section id="references" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> References</h1>
<hr>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="2" data-line-spacing="2">
<div id="ref-Lehmann2011-vs" class="csl-entry">
1. Lehmann EL. (2011). <span>“Fisher, <span>Neyman</span>, and the <span>Creation</span> of <span>Classical Statistics</span>.”</span> <span>Springer New York</span>. doi: <a href="https://doi.org/10.1007/978-1-4419-9500-1">10.1007/978-1-4419-9500-1</a>.
</div>
<div id="ref-Hurlbert2009-ks" class="csl-entry">
2. Hurlbert SH, Lombardi CM. (2009). <span>“Final collapse of the <span>Neyman</span>-<span>Pearson</span> decision theoretic framework and rise of the <span class="nocase">neoFisherian</span>.”</span> <em>Ann Zool Fennici</em>. <strong>46</strong>:311–349. doi: <a href="https://doi.org/10.5735/086.046.0501">10.5735/086.046.0501</a>.
</div>
</div></section></div> ]]></description>
  <guid>https://lesslikely.com/posts/statistics/classical-lehmann.html</guid>
  <pubDate>Sun, 30 Dec 2018 05:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1559517576/Site/fisher_old.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Book Review: Fisher, Neyman, and the Creation of Classical Statistics</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/classical-lehmann.html</link>
  <description><![CDATA[ 





<hr>
<p>Erich Lehmann’s <a href="https://www.springer.com/us/book/9781441994998">last book</a>,[<span class="citation" data-cites="Lehmann2011-vs"><sup>1</sup></span>] which was published after his death, is on the history of classical statistics and its creators. Specifically, how his mentor Jerzy Neyman and his adversary Ronald Fisher helped lay the foundations for the methods that are used today in several fields.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700110/Site/classicalgiants.png" alt="Picture of the giants who founded frequentist statistics such as Egon Pearson, Ronald Fisher, and Jerzy Neyman" style="width:80%"></p>
<hr>
<section id="a-very-brief-history-of-classical-statistics" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> A Very Brief History of Classical Statistics</h1>
<hr>
<p>This post is intended to be a general review/summary of the book, which I recommend to everyone and anyone who is interested in statistics and science. The book clears up several misconceptions people have about how frequentist statistics came to be the dominant school of statistics. Thus, I want to go over four topics from Lehmann’s book that I believe people should know more about:</p>
<hr>
<ul>
<li><p>How the founders of classical statistics viewed Bayesian inference</p></li>
<li><p>What they each developed</p></li>
<li><p>How they came to become so conflicted</p></li>
<li><p>And how their views changed over time</p></li>
</ul>
<hr>
</section>
<section id="where-are-the-bayesians" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Where Are The Bayesians?</h1>
<hr>
<p>As Stephen Senn points out in his <a href="https://www.youtube.com/watch?v=vJIc_9wzh6Y">Fisher Memorial Lecture</a> at the Royal Statistical Society, there is a common myth that everyone who practiced applied statistics before the early 20th century was using Bayesian inference and doing everything correctly, but then Fisher came in and created significance testing, thus giving researchers a powerful tool to easily hack their data and produce publishable results, and now we have several replication crises because of this.</p>
<p>Of course, this is far from the truth and any thorough investigation into the history of statistics will clear up this up amongst many other misconceptions.</p>
<p>As several individuals may know, it was Thomas Bayes who came up with Bayes theorem and it was Richard Price who disseminated most of his writings after Bayes’s death. However, as many self-identified Bayesians will attest, using Bayes’ theorem does not make one a Bayesian. It is actually quite hard to know how Bayes would react to modern Bayesian inference. The Bayesian inference that we are familiar with today can be attributed to Pierre-Simon Laplace, who popularized what is now known as “objective Bayes.”</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700141/Site/Pierre-Simon-Laplace_1749-1827.jpg" alt="Portrait of Pierre Simon Laplace" style="width:40%"></p>
<hr>
<p>Back then, it was not called “Bayesian inference” but was referred to as “inverse probability” and it was a method used by many before the dominance of classical statistics. So this is one part that common myths get right. Inverse probability did indeed have a moment in history before the dominance of frequentist statistics.</p>
<p>Laplace, and several others popularized such methods, but around the end of the 19th century, the tides began to shift. Several mathematicians and statisticians began to discourage the use of inverse probability because they saw it as a nonrigorous method of data analysis.</p>
<p>This can be seen in the following passages about Fisher.</p>
<hr>
<blockquote class="blockquote">
<p>“His first publication on this new approach to inference was a 1930 paper”Inverse probability.” The paper begins with a critique of the inverse (Bayesian) method. This section ends with Fisher’s asking:</p>
<p><strong>If, then, we follow writers like Boole, Venn and Chrystal in rejecting the inverse argument as devoid of foundation and incapable even of consistent application</strong>, how are we to avoid the staggering falsity of saying that however extensive our knowledge of the values of x may be, yet we know nothing and can know nothing about the values of <img src="https://latex.codecogs.com/png.latex?%5Ctheta"> ?” (78)</p>
</blockquote>
<hr>
<p>Thus, Fisher was not the first to reject inverse probability, he was building on arguments from proto frequentists who already began to condemn inverse probability. Neyman was also a serious critic of inverse probability. In fact, he was probably more of a critic of it at a later point in time then Fisher (much on that later)!</p>
<hr>
<blockquote class="blockquote">
<p>“On one subject, Fisher and Neyman agreed. Fisher, after 1922, and Neyman, after 1937, were <strong>united in their strong opposition to the use of prior distributions</strong> (unless they were <strong>based on substantial empirical evidence</strong>).” (90)</p>
</blockquote>
<hr>
<p>Although the two giants of classical statistics both condemned inverse probability, it withstood their influential criticisms.</p>
<hr>
<blockquote class="blockquote">
<p>“It seems ironic that one of the most significant developments after Fisher and Neyman had established their foundations was to rejuvenate an approach they both had strongly opposed and thought to have vanquished: inverse probability…</p>
<p>The nineteenth century approach to inverse probability, championed particularly by Laplace, considered the prior distribution to represent complete ignorance. This concept, now called objective Bayes, was taken up and improved by the Cambridge geophysicist Harold Jeffreys, culminating in his 1939 book, “<em>Theory of Probability</em>.”</p>
<p>A different Bayesian approach, called subjective, was proposed by Ramsey (1926) and Bruno de Finetti in the 1930s. It considered probability as a measure of a person’s subjective degree of uncertainty about a situation. This view came into its own with the publication in 1954 of L. J. Savage’s book, “<em>Foundations of Statistics</em>,” in which he derives the existence of such subjective probabilities from a few, quite plausible, axioms.” (91)</p>
</blockquote>
<hr>
<p>Now that we have looked at how the founders of classical statistics viewed and attempted to discourage the use of inverse probability, we can move onto a brief summary of each of their individual contributions.</p>
<hr>
</section>
<section id="fishers-contributions" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Fisher’s Contributions</h1>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1559517576/Site/fisher_old.jpg" alt="Picture of Ronald Fisher sitting and smoking" style="width:50%"></p>
<hr>
<p>Much of Fisher’s early work was a result of two individuals, Karl Pearson and William Gosset. Pearson’s work on the method of moments to estimate parameters led to Fisher developing his superior estimation method, maximum likelihood, which he presented in his 1922 foundations paper, “<em>On the mathematical foundations of theoretical statistics</em>.”</p>
<hr>
<blockquote class="blockquote">
<p>“Having defined the problem of statistics to be the estimation of parameters, Fisher states the properties that he desires for his estimators. They are consistency, efficiency, and sufficiency…</p>
<p>He then proposes what he had already suggested earlier in the section on <strong>the solution of the estimation problem, the method of maximum likelihood</strong>, which “consists, then, simply of choosing such values of these parameters as have the maximum likelihood.” Fisher believes that this method satisfies his three criteria, in particular that it satisfied the criterion of sufficiency, although he states that he “is not satisfied as to the mathematical rigor of any proof which I can put forward to that effect.” He also claims that sufficiency implies efficiency…</p>
<p>Thus, in this paper Fisher has not only <strong>formulated the general problem of optimal estimation, but he has also provided a solution</strong>. It is a stunning achievement.” (10)</p>
</blockquote>
<hr>
<p>Gosset’s initial work on test statistics, his inability derive proofs for small sample methods, and constant prodding led to Fisher developing several statistical tests which ended up being published in his highly influential book, <em>Statistical Methods For Research Workers</em>,</p>
<hr>
<blockquote class="blockquote">
<p>“For testing the value of a population mean, it had been customary to use a statistic equivalent to what today is called Student’s t, and to refer to the normal distribution. For large samples, this provided a good approximation.</p>
<p>However, Gosset soon realized that for <strong>the small samples with which he had to work, the approximation was inadequate</strong>. He then had the crucial insight that exact results could be obtained by making an additional assumption, namely that the form of the distribution of the observations is known. Gosset undertook to determine it for the case that the underlying distribution is normal, and he obtained the correct result, although he was not able to give a rigorous proof.</p>
<p>The first proof was obtained (although not published) by Fisher in 1912. His proof was finally published in 1915 [4], together with the corresponding proof for the correlation coefficient that Student had conjectured in a second paper of 1908(b). Fisher followed this in 1921 [14] with a derivation of the distribution of the intraclass correlation coefficient. And then, as a result of constant prodding and urging by Gosset, he found a number of additional small-sample distributions, and in 1925 presented the totality of these results in his book, <em>“Statistical Methods for Research Workers.”</em> (6)</p>
</blockquote>
<hr>
<p>In the book, Fisher’s main focus was on statistical testing and not estimation, and he made this clear,</p>
<hr>
<blockquote class="blockquote">
<p>“…the prime object of this book is to put into the hands of research workers… <strong>the means of applying statistical tests accurately to numerical data accumulated in their own laboratories</strong> … and later refers to the exact distributions with the use of which this book is chiefly concerned… Thus, the book does not primarily deal with estimation but with significance testing. In fact, estimation is never again mentioned.” (16)</p>
</blockquote>
<hr>
<p>His section about chi-squared tests and significance testing became highly influential,</p>
<hr>
<blockquote class="blockquote">
<p>“<strong>In preparing this table we have borne in mind that in practice we do not want to know the exact value of P for any observed</strong> <img src="https://latex.codecogs.com/png.latex?%5Cchi%7B2%7D">, but, in the first place, whether or not the observed value is open to suspicion. If P is between .1 and .9 there is certainly no reason to suspect the hypothesis tested. If it is below .02 it is strongly indicated that the hypothesis fails to account for the whole of the facts. <strong>We shall not often be astray if we draw a conventional line at .05 and consider that higher values of</strong> <img src="https://latex.codecogs.com/png.latex?%5Cchi%7B2%7D"> indicate a real discrepancy.” (17)</p>
</blockquote>
<hr>
<p>He also presents examples,</p>
<hr>
<blockquote class="blockquote">
<p>“In the first of these, in particular, he finds a p-value between 0.01 and 0.02 and concludes:”If we take P = 0.05 as the limit of significant deviation, <strong>we shall say that in this case the deviations from expectation are significant</strong>.” (17)</p>
</blockquote>
<hr>
<p>And he expanded on significance testing with analysis of variance, which he had derived while working at Rothamsted analyzing crop data. The book was a large success,</p>
<hr>
<blockquote class="blockquote">
<p>“The first edition of 1,050 copies was sold out after three years, and the second edition of 1,250 copies in another two. Every two to three years necessitated a new edition, which usually contained some improvements and often additions. The size of the editions steadily increased and the eleventh edition of 1950 ran to 7,500 copies. The last edition, the fourteenth, was published posthumously in 1970 from notes Fisher had prepared before his death in 1962.” (25)</p>
</blockquote>
<hr>
<p>And set the groundwork for his next task, discussing experimental methods, which would be published in his second book, <em>The Design of Experiments</em>. In it, he discusses how techniques like randomization were necessary for the validity of statistical tests and how they perform amongst a wide variety of distributions,</p>
<hr>
<blockquote class="blockquote">
<p>“Randomisation properly carried out … ensures that the estimates of error will take proper care of all such causes of different growth rates, and <strong>relieves the experimenter from the anxiety of considering and estimating the magnitude of the innumerable causes by which his data may be disturbed.</strong> The one flaw in Darwin’s procedure was the absence of randomisation…</p>
<p>It seems to have escaped recognition that the physical act of randomisation which, as has been shown, is necessary for the validity of any test of significance, affords the means, in respect of any particular body of data, of examining the wider hypothesis <strong>in which no normality of distribution is implied</strong>.” (66)</p>
</blockquote>
<hr>
<p>Although he had proposed randomization tests as a way of dealing with nonnormal distributions, due to their tedious calculations, they never became popular at the time. The book also touched on several other concepts such as randomized blocks, Latin squares, and factorial designs. He also made his position very clear on significance tests and the null hypothesis,</p>
<hr>
<blockquote class="blockquote">
<p>“By increasing the size of the experiment, we can render it more sensitive, meaning by this that it will allow of the detection of a lower degree of sensory discrimination… . <strong>Since in every case the experiment is capable of disproving, but never of proving this hypothesis</strong>, we may say that the value of the experiment is increased whenever it permits the null hypothesis to be more readily disproved.” (64)</p>
</blockquote>
<hr>
<p>Here we can see Fisher’s concept of statistical power, though “sensitivity” was never a quantified concept. He also clearly states his position on the null hypothesis, that we can never accept it, <a href="../../../statistics/evidence-of-absence">a mistake that many researchers continue to make today</a>.</p>
<p>Now that we have discussed some of Fisher’s contributions to classical statistics, we can discuss the contributions of Jerzy Neyman.</p>
<hr>
</section>
<section id="neymans-contributions" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Neyman’s Contributions</h1>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700127/Site/Jerzy_Neyman.jpg" alt="Photo of Jerzy Neyman and his colleagues" style="width:40%"></p>
<hr>
<p>Just like Fisher, Neyman was also impacted by Gosset. However, the influence was indirect. In the 1920s, Egon Pearson, had come across the small-sample tests that both Fisher and Gosset had popularized and had the realization that he must make a name for himself if he ever wished to be free of his father’s influence.</p>
<hr>
<blockquote class="blockquote">
<p>“In 1925-6, I was in a state of puzzlement, and realized that, <strong>if I was to continue an academic career as a mathematical statistician</strong>, <strong>I must construct for myself what might be termed a statistical philosophy</strong>, which would have to combine what I accepted from K. P.’s large- sample tradition with the newer ideas of Fisher.” (7)</p>
</blockquote>
<hr>
<p>Thus, he contacted Gosset about practical usage of the t-test, to which Gosset replied,</p>
<hr>
<blockquote class="blockquote">
<p>“Even if the chance is very small, say .00001, that doesn’t in itself necessarily prove that the sample is not drawn randomly from the population [specified by the hypothesis]; <strong>what it does is to show that if there is any alternative hypothesis</strong> which will explain the occurrence of the sample with a more reasonable probability, say .05 (such as that it belongs to a different population or that the sample wasn’t random or whatever will do the trick), you will be very much more inclined to consider that the original hypothesis is not true.” (E. S. Pearson, 1939.)</p>
<p>“In his obituary of Gosset, Pearson continues, Gosset’s reply had a tremendous influence on the direction of my subsequent work, for the first paragraph contains the germ of that idea which has formed the basis of all the later joint researches of Neyman and myself. It is the simple suggestion that the only valid reason for rejecting a statistical hypothesis is that <strong>some alternative explains the observed events with a greater degree of probability</strong>.” (7)</p>
</blockquote>
<hr>
<p>As a result, Pearson decided to collaborate with someone who was not taught by his father, but who also had the mathematical abilities to create a generalizable theorem that he had in mind. Thus, began the collaboration between Neyman and Pearson.</p>
<p>In 1928, they published a paper in <em>Biometrika</em> titled, <em>“On the use and interpretation of certain test criteria,”</em> where they introduced two kinds of errors,</p>
<hr>
<blockquote class="blockquote">
<ol type="1">
<li><p>Sometimes,when hypothesis A is rejected, <img src="https://latex.codecogs.com/png.latex?%5CSigma"> will in fact have been drawn from <img src="https://latex.codecogs.com/png.latex?%5CPi">.</p></li>
<li><p>More often, in accepting hypothesis A, <img src="https://latex.codecogs.com/png.latex?%5CSigma"> will really have been drawn from [some alternative population] <img src="https://latex.codecogs.com/png.latex?%5CPi">. (31)</p></li>
</ol>
</blockquote>
<hr>
<p>As Lehmann notes, the paper was a great achievement,</p>
<hr>
<blockquote class="blockquote">
<p>“It introduces the consideration of alternatives, the two kinds of error, and the distinction between simple and composite hypotheses. In addition, of course, it proposes the likelihood ratio test. This test is intuitively appealing, and Neyman and Pearson show that in a number of important cases it leads to very satisfactory solutions. It has become the standard approach to new testing problems.” (34)</p>
<p>But the Neyman-Pearson lemma was still incomplete. It was between the years of 1930 and 1933 that Neyman had several insights into how to improve the theory, which Pearson already had felt satisfied with.</p>
<p>“In the next letter, dated March 8, Neyman suggests that he and Egon must”fix a certain plan, as we have lot of problems already started and then left in the wood.” He lists several such problems, among them: to finish what I have started to do with the variation calculus. You will understand it in a moment.</p>
<p>To reduce for a given level the errors of rejecting a true hypothesis, we may use any test. Now we want to find a test which would 1) <strong>reduce the probability of rejecting a true hypothesis to the level</strong> <img src="https://latex.codecogs.com/png.latex?%5Cleq%20%5Cvarepsilon"> and 2) <strong>such that the probability of accepting a false hypothesis should be minimum</strong>. – We find that if such a test exists, then <strong>it is the</strong> <img src="https://latex.codecogs.com/png.latex?%5Clambda">-test. I am now shure [sic] that in a few days I shall be ready. This will show that the “<img src="https://latex.codecogs.com/png.latex?%5Clambda"> principle” is not only a principle but that <strong>there are arguments to prove that it is really “the best test</strong>.”” (35)</p>
</blockquote>
<hr>
<p>These correspondences led to their 1933 paper,</p>
<p><em>“On the Problem of the Most Efficient Tests of Statistical Hypotheses.”</em> in which both authors introduce the novel idea of behavioral guidance,</p>
<hr>
<blockquote class="blockquote">
<p>“Without hoping to know whether each separate hypothesis is true or false, <strong>we may search for rules to govern our behavior</strong> with regard to them, in following which we insure that, in the long run of experience, <strong>we shall not be too often wrong</strong>.” (36)</p>
</blockquote>
<hr>
<p>As Lehmann notes,</p>
<hr>
<blockquote class="blockquote">
<p>“After outlining the general theory, the paper in the next section deals with the case of simple hypotheses and brings the statement and proof of the basic result, now known as the <strong>Neyman-Pearson Fundamental Lemma</strong>. It states that for testing a simple hypothesis against a simple alternative, <strong>the test that at a given level maximizes the probability of rejection is the likelihood ratio test at that level</strong>.” (36)</p>
</blockquote>
<hr>
<p>Lehmann summarizes much of the collaboration with the following,</p>
<hr>
<blockquote class="blockquote">
<p>“The collaboration falls into two quite distinct parts. In the early stages, the important ideas, including in particular that of the likelihood ratio principle, all come from Pearson. In fact, Neyman frequency misunderstands them, and continually tries to interpret them in terms of inverse probability.</p>
<p>On the other hand, Pearson is sold on the likelihood ratio principle, which is intuitively appealing and which seems to give reasonable solutions in the cases on which they try it out. But for Neyman, as he is gradually catching on, intuitive appeal is not enough. If the principle is really as good as it appears to be, there ought to be logical justification.</p>
<p>And then one day in early 1930, he sees the light. Since there are two sources of error, one of which is being controlled, the best test is the one minimizing the other one. And from then on, it is Neyman who has the new ideas and Pearson is the reluctant follower. Neyman formulates, and shortly thereafter proves, the Fundamental Lemma and realizes that in some special cases there exist what they later call uniformly most powerful tests. These turn out to coincide with the likelihood ratio tests.” (39)</p>
</blockquote>
<hr>
</section>
<section id="the-fallout-between-the-creators-of-classical-statistics" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> The Fallout Between The Creators Of Classical Statistics</h1>
<hr>
<p>The conflict between Neyman and Fisher is well known, however, very few are able to accurately point out what lead to each individual strongly detesting the other.</p>
<p>In fact, early correspondences between Neyman and Fisher showed that they were incredibly friendly towards one another. In 1932, Neyman asked Fisher to review their 1933 paper before they submitted it, to which Fisher replied,</p>
<hr>
<blockquote class="blockquote">
<p>“I should be very much interested to see your paper on”the best tests,” as the whole question of tests of significance seems to me to be of immense philosophical importance, and the work you showed me was surely of great promise. It is quite probable that if the work is submitted to the Royal Society, I might be asked to act as referee, and in that case I shall certainly not refuse.” (45)</p>
</blockquote>
<hr>
<p>Fisher not only read the paper, but read it so carefully that he was able to catch a mathematical error and point it out to Neyman and Pearson before it was published,</p>
<hr>
<blockquote class="blockquote">
<p>“When the paper appeared in 1933, the omission was corrected, and a footnote acknowledged that,”We are indebted to Dr.&nbsp;R. A. Fisher – for kindly calling our attention to the fact that we had originally omitted to refer to this restriction.” (46)</p>
</blockquote>
<hr>
<p>Neyman thanked Fisher for his help,</p>
<hr>
<blockquote class="blockquote">
<p>Neyman: “Pearson writes that you have recommended our paper for publication. Although it maybe considered ridiculous to thank a judge, I have intense feeling of gratefulness, which I hope you will kindly accept…” (57)</p>
<p>Fisher replies, “It was a great pleasure to hear from you again.” (57)</p>
<p>Neyman: “I am often thinking that it would be very useful for me to work with you. Unfortunately, this requires considerable amount of money – without speaking of your consent – of course…” (57)</p>
<p>Fisher answers, “You may be sure of my consent,” and in the next letter, “I like hearing from Poland. Best wishes for a Merry Christmas.” (58)</p>
</blockquote>
<hr>
<p>Unfortunately, their relationship began to degrade after the retirement of Karl Pearson. The department of applied statistics that he was the head of was split into the department of statistics, which would be led by his son Egon, and the department of genetics, where Fisher was appointed as Galton professor. Thus, Fisher, one of the creators of classical statistics, was not allowed to teach statistics, while in the floor downstairs, Egon Pearson (a man that he was surely not fond of) was leading the new statistics department.</p>
<p>This change in tone could be seen by the correspondence between Neyman and Fisher following Fisher’s appointment as Galton professor,</p>
<hr>
<blockquote class="blockquote">
<p>“Dr.&nbsp;Pearson writes me that soon you will be Galton Professor at the University College, London. Very probably <strong>this means a general reorganization of the Department of Applied Statistics and possibly new people will be needed</strong>. I know that there are many statisticians in England and that many of them would be willing to work under you. But improbable things do happen sometimes and you may have a vacant position in your laboratory. In that case please consider whether I can be of any use.” (58)</p>
</blockquote>
<hr>
<p>Fisher replies,</p>
<hr>
<blockquote class="blockquote">
<p>“Many thanks for your letter of congratulation. You will be interested to hear that the <strong>Dept. of Statistics has now been separated officially from the Galton Laboratory</strong>. I think Egon Pearson is designated as Reader in Statistics. This arrangement will be much laughed at, but it will be rather a poor joke, I fancy, for both Pearson and myself. I think, however, we will make the best of it.</p>
<p><strong>I shall not lecture on statistics, but probably on “the logic of experimentation,</strong>” so that my lectures will not be troubled by students who cannot see through a wire fence. I wish I had a fine place for you, but it will be long before my new department can be given any sort of unity and coherence, and you will be head of a faculty before I shall be able to get much done. <strong>If in England, do not fail to see me at University College</strong>.” (58)</p>
</blockquote>
<hr>
<p>Of course, there is little doubt that both Karl and Egon Pearson contributed to the fallout between Neyman and Fisher. In 1929, Egon Pearson had submitted a critical review of the second edition of <em>Statistical Methods For Research Workers</em> to <em>Nature</em>,</p>
<hr>
<blockquote class="blockquote">
<p>“There is one criticism, however, which must be made from the statistical point of view. A large number of the tests developed are based…on the assumption that the population sampled is of the”normal” form. That this is the case may be gathered from a careful reading of the text, but the point is not sufficiently emphasized.</p>
<p>It does not appear reasonable to lay stress on the “exactness” of the tests when no means whatever are given of appreciating how rapidly they become inexact as the population sampled diverges from normality. That the tests, for example, connected with the analysis of variance are far more dependent on normality than those involving Student’s z (or t) distribution is almost certain, but no clear indication of the need for caution in their application is given.” (22)</p>
</blockquote>
<hr>
<p>As Lehmann points out, Fisher was deeply offended by this review. Nearly six years later (1935), Neyman encountered a similar reaction when he submitted a paper titled, “Statistical problems in agricultural experimentation” pointing out problems with some of the concepts that Fisher had introduced in his book, <em>The Design of Experiments</em>. Fisher was furious,</p>
<hr>
<blockquote class="blockquote">
<p>“I had hoped that Dr.&nbsp;Neyman’s paper would be on a subject with which the author was fully acquainted, and on which he could speak with authority, as in the case of his address to the Society delivered last summer. Since seeing the paper, <strong>I have come to the conclusion that Dr.&nbsp;Neyman had been somewhat unwise in his choice of topics</strong>… (59)</p>
<p>Were it not for the persistent effort which Dr.&nbsp;Neyman and Dr.&nbsp;Pearson had made to treat what they speak of as problems of estimation, by means merely of tests of significance, I have no doubt that Dr.&nbsp;Neyman would not have been in any danger of falling into the series of misunderstandings which his paper revealed.” (59)</p>
</blockquote>
<hr>
<p>Correspondences from there on out had become hostile,</p>
<hr>
<blockquote class="blockquote">
<p>“Neyman later (Reid 1982, p.&nbsp;126) recalls that a week after this meeting, Fisher stopped by his room at University College:</p>
<p>And he said to me that he and I are in the same building… . That, as I know, he had published a book – and that’s Statistical Methods for Research Workers – and he is upstairs from me so he knows something about my lectures – that from time to time I mention his ideas, this and that – and that this would be quite appropriate if I were not here in the College but, say, in California – but if I am going to be at University College, then this is not acceptable to him.</p>
<p><strong>And then I said, “<em>Do you mean that if I am here, I should just lecture using your book</em>?” And then he gave an affirmative answer. And I said, “<em>Sorry, no. I cannot promise that</em>.” And then he said, “<em>Well, if so, then from now on I shall oppose you in all my capacities</em>.”</strong></p>
<p>Reid also reports (p.&nbsp;124) that, After the Royal Statistical Society meeting of March 28, relations between workers on the two floors of K. P.’s old preserve became openly hostile. One evening, late that spring, Neyman and Pearson returned to their department after dinner to do some work.</p>
<p>Entering, they were startled to find <strong>strewn on the floor the wooden models which Neyman had used to illustrate his talk on the relative advantages of randomized blocks and Latin squares</strong>. They were regularly kept in a cupboard in the laboratory. Both Neyman and Pearson always believed that the models were removed by Fisher in a fit of anger.” (59)</p>
</blockquote>
<hr>
</section>
<section id="there-is-no-one-neyman-nor-one-fisher" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> There Is No One Neyman Nor One Fisher</h1>
<hr>
<p>When Fisher released his first edition of <em>Statistical Methods For Research Workers</em> (SMRW), he recommended 5% or 1% as good choices for significance levels, with the latter being used when a “more stringent requirement was necessary.” Fisher was also not interested in exact P-values as pointed out in the section discussing his contributions.</p>
<p>Many of these views changed as he released later editions of his SMRW and his new book, <em>Statistical Methods for Scientific Inference</em> (SMSI). For example, he no longer recommended a particular level of significance,</p>
<hr>
<blockquote class="blockquote">
<p>“In his late, 1956, book SMSI, Fisher protested that”<strong>no scientific worker has a fixed level of significance at which from year to year, and in all circumstances, he rejects hypotheses; he rather gives his mind to each particular case, and his ideas</strong>” (52)</p>
</blockquote>
<hr>
<p>In the 13th edition of SMRW he stated,</p>
<hr>
<blockquote class="blockquote">
<p>“<strong>The actual value of P obtainable from the table by interpolation indicates the strength of the evidence against the hypothesis</strong>. A value of <img src="https://latex.codecogs.com/png.latex?%5Cchi%7B2%7D"> exceeding the 5 per cent. point is seldom to be disregarded.” (52)</p>
</blockquote>
<hr>
<p>Thus, Fisher had changed his mind on the topic.</p>
<p>Neyman too had a significant change of mind during the course of his collaboration with Pearson. At first, he constantly defaulted to inverse probability methods, as noted by Pearson’s letter to him in 1978,</p>
<hr>
<blockquote class="blockquote">
<p>“I have eight letters which you wrote to me during February and March 1929, trying to persuade me to put my name as a joint author. But you had introduced an a priori law of probability…, and I was not willing to start from this basis. True we had given the inverse probability as an alternative approach in our 1928 Part I paper, but I must in 1927-28 still have been ready to concede to your line of thought.</p>
<p>However, <strong>by 1929 I had come down firmly to agree with Fisher that prior distributions should not be used</strong>, except in cases where they were based on real knowledge, e.g., in some Mendelian problems. <strong>You were disappointed, but accepted my decision</strong>; after all, the whole mathematical development in the paper was yours.” (42)</p>
</blockquote>
<hr>
<p>Though eventually Neyman abandoned his interest in inverse probability and became a serious critic,</p>
<hr>
<blockquote class="blockquote">
<p>“His conviction of the inapplicability of the inverse method had by then become a fundamental part of his statistical philosophy, <strong>from which he never wavered</strong>.” (42)</p>
</blockquote>
<hr>
<p>Although this post is mainly fixated on the book by Lehmann, I would like to at least paste this one relevant passage from <a href="https://www.jstor.org/stable/23736900">Hulbert &amp; Lombardi, 2009</a>,[<span class="citation" data-cites="Hurlbert2009-ks"><sup>2</sup></span>]</p>
<hr>
<blockquote class="blockquote">
<p>“In a later philosophical essay, Neyman (1977: 112) recounted their cloud-seeding studies, and labeled P values of 0.09, 0.03, and &lt; 0.01 reported in their earlier paper (Lovasich et al.&nbsp;1971), as”approximately significant,” “significant,” and “highly significant,” respectively. The dichotomies of the paleoFisherian and Neyman-Pearsonian frameworks were quietly admitted to be less appropriate than more nebulous interpretations — at least in cloud work!</p>
<p>Indeed, Cox (2006a: 43, 195) has noted that “the differences between Fisher and Neyman … were not nearly as great as the asperity of the arguments between them might suggest … [and in] actual practice … Neyman … often reported p-values whereas some of Fisher’s use of tests … was much more dichotomous”!</p>
</blockquote>
<hr>
<p>As we can see from a summary of Lehmann’s book, the individuals who founded classical statistics were skilled and talented individuals who were also complex and had various reasons for doing what they did. I hope this blog post encourages readers to fully dive into Lehmann’s book where he gives a far more detailed account of Fisher and Neyman’s contributions to classical statistics.</p>
<hr>
</section>
<section id="references" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> References</h1>
<hr>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="2" data-line-spacing="2">
<div id="ref-Lehmann2011-vs" class="csl-entry">
1. Lehmann EL. (2011). <span>“Fisher, <span>Neyman</span>, and the <span>Creation</span> of <span>Classical Statistics</span>.”</span> <span>Springer New York</span>. doi: <a href="https://doi.org/10.1007/978-1-4419-9500-1">10.1007/978-1-4419-9500-1</a>.
</div>
<div id="ref-Hurlbert2009-ks" class="csl-entry">
2. Hurlbert SH, Lombardi CM. (2009). <span>“Final collapse of the <span>Neyman</span>-<span>Pearson</span> decision theoretic framework and rise of the <span class="nocase">neoFisherian</span>.”</span> <em>Ann Zool Fennici</em>. <strong>46</strong>:311–349. doi: <a href="https://doi.org/10.5735/086.046.0501">10.5735/086.046.0501</a>.
</div>
</div></section></div> ]]></description>
  <guid>https://lesslikely.com/posts/statistics/classical-lehmann.html</guid>
  <pubDate>Sun, 30 Dec 2018 00:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1559517576/Site/fisher_old.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>P-values Are Tough And S-values Can Help</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/s-values.html</link>
  <description><![CDATA[ 





<script src="s-values_files/libs/kePrint-0.0.1/kePrint.js"></script>
<p><link href="s-values_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet"></p>
<hr>
<p>The <img src="https://latex.codecogs.com/png.latex?P">-value doesn’t have many fans. There are those who don’t understand it, often treating it as a measure it’s not, whether that’s a posterior probability, the probability of getting results due to chance alone, or some other bizarre/incorrect interpretation. [<span class="citation" data-cites="gigerenzerStatisticalRitualsReplication2018"><sup>1</sup></span>;<span class="citation" data-cites="goodmanDirtyDozenTwelve2008"><sup>2</sup></span>;<span class="citation" data-cites="greenlandStatisticalTestsValues2016"><sup>3</sup></span>] Then there are those who dislike it because they think the concept is too difficult to understand or because they see it as a noisy statistic we’re not interested in.</p>
<p>However, the groups of people mentioned above aren’t mutually exclusive. Many who dislike and criticize the <img src="https://latex.codecogs.com/png.latex?P">-value also do not understand its properties and behavior. This is unfortunate, given how important and widely used they are. In this article, which could also have been titled, <img src="https://latex.codecogs.com/png.latex?P">-values: More Than You Ever Wanted to Know, I take on the task of explaining:</p>
<hr>
<ul>
<li>what <img src="https://latex.codecogs.com/png.latex?P">-values are</li>
</ul>
<hr>
<ul>
<li>the assumptions behind them</li>
</ul>
<hr>
<ul>
<li>their properties and behavior</li>
</ul>
<hr>
<ul>
<li>different schools of interpretation</li>
</ul>
<hr>
<ul>
<li>misleading criticisms of <img src="https://latex.codecogs.com/png.latex?P">-values</li>
</ul>
<hr>
<ul>
<li>some valid issues in interpretation</li>
</ul>
<hr>
<ul>
<li>how these issues can be resolved</li>
</ul>
<hr>
<section id="what-is-a-p-value-anyway" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> What is a <em>P</em>-value Anyway?</h1>
<hr>
<section id="some-definitions-descriptions" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="some-definitions-descriptions"><span class="header-section-number">1.1</span> Some Definitions &amp; Descriptions</h2>
<hr>
<p>The <img src="https://latex.codecogs.com/png.latex?P">-value is the probability of getting a result (specifically, a test statistic) at least as extreme as what was observed if <strong>every model assumption</strong>, in addition to the targeted test hypothesis (usually a null hypothesis), used to compute it <strong>were correct</strong>. [<span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>4</sup></span>;<span class="citation" data-cites="greenlandStatisticalTestsValues2016"><sup>3</sup></span>;<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup>5</sup></span>]</p>
<p>A simple, mathematically rigorous definition of a <img src="https://latex.codecogs.com/png.latex?P">-value (for those interested) is given by <a href="https://www.stat.berkeley.edu/~stark/Preprints/pValues.pdf">Stark (2015)</a>.</p>
<hr>
<blockquote class="blockquote">
<p>Let <img src="https://latex.codecogs.com/png.latex?P"> be the probability distribution of the data <img src="https://latex.codecogs.com/png.latex?X">, which takes values in the measurable space <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BX%7D">. Let <img src="https://latex.codecogs.com/png.latex?%5Cleft%5C%7BR_%7B%5Calpha%7D%5Cright%5C%7D_%7B%5Calpha%20%5Cin%5B0,1%5D%7D"> be a collection of <img src="https://latex.codecogs.com/png.latex?P"> -measurable subsets of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BX%7D"> such that (1) <img src="https://latex.codecogs.com/png.latex?P%5Cleft(R_%7B%5Calpha%7D%5Cright)=%5Calpha"> and (2) If <img src="https://latex.codecogs.com/png.latex?%5Calpha%5E%7B%5Cprime%7D%3C%5Calpha"> then <img src="https://latex.codecogs.com/png.latex?R_%7B%5Calpha%5E%7B%5Cprime%7D%7D%20%5Csubset%20R_%7B%5Calpha%7D">. Then the <img src="https://latex.codecogs.com/png.latex?P">-value of <img src="https://latex.codecogs.com/png.latex?H_%7B0%7D"> for data <img src="https://latex.codecogs.com/png.latex?X=x"> is inf <img src="https://latex.codecogs.com/png.latex?_%7B%5Calpha%20%5Cin%5B0,1%5D%7D%5Cleft%5C%7B%5Calpha:%20x%20%5Cin%20R_%7B%5Calpha%7D%5Cright%5C%7D">.</p>
</blockquote>
<hr>
<p>A descriptive but technical definition is given by Sander Greenland below. The description can seem dense, so feel free to skip over it for now and revisit it after reading the rest of the post.</p>
<hr>
<blockquote class="blockquote">
<p>A single <img src="https://latex.codecogs.com/png.latex?P">-value <img src="https://latex.codecogs.com/png.latex?p"> is the quantile location of a directional measure of divergence <img src="https://latex.codecogs.com/png.latex?t"> = <img src="https://latex.codecogs.com/png.latex?t(y;M)"> of the data point <img src="https://latex.codecogs.com/png.latex?y"> (usually, the vector in <img src="https://latex.codecogs.com/png.latex?n">-space formed by <img src="https://latex.codecogs.com/png.latex?n"> individual observations) from a test model manifold <img src="https://latex.codecogs.com/png.latex?M"> in the <img src="https://latex.codecogs.com/png.latex?n">-dimensional expectation space defined the logical structure of the data generator (“experiment” or causal structure) that produced the data <img src="https://latex.codecogs.com/png.latex?y">. <img src="https://latex.codecogs.com/png.latex?M"> is the subset of the <img src="https://latex.codecogs.com/png.latex?Y">-space into which the conjunction of the model constraints (assumptions) force the data expectation or predict where y would be were there no ‘random’ variability. I also use <img src="https://latex.codecogs.com/png.latex?M"> to denote the set of all the model constraints, as well as their conjunction.</p>
<p>With this logical set-up, the observed <img src="https://latex.codecogs.com/png.latex?P">-value is the quantile <img src="https://latex.codecogs.com/png.latex?p"> for the observed value <img src="https://latex.codecogs.com/png.latex?t"> of <img src="https://latex.codecogs.com/png.latex?T"> = <img src="https://latex.codecogs.com/png.latex?t(Y;M)">. This <img src="https://latex.codecogs.com/png.latex?p"> is read off a reference distribution <img src="https://latex.codecogs.com/png.latex?F%20=%20F(t;M)"> for <img src="https://latex.codecogs.com/png.latex?T"> derived from <img src="https://latex.codecogs.com/png.latex?M">. This formulation is essentially that of the “value of P” appearing in Pearson’s seminal 1900 paper on goodness-of-fit tests. Notably, his famed chi-squared statistic is the squared Euclidean distance from <img src="https://latex.codecogs.com/png.latex?y"> to <img src="https://latex.codecogs.com/png.latex?M">, with coordinates expressed in standard-deviation units derived from <img src="https://latex.codecogs.com/png.latex?M">.</p>
<p>More broadly, the statistic <img src="https://latex.codecogs.com/png.latex?T"> can be taken as a measure of divergence of a more general embedding or background model manifold <img src="https://latex.codecogs.com/png.latex?A"> (which includes all ‘auxiliary’ assumptions) from a more restrictive model <img src="https://latex.codecogs.com/png.latex?M">, with the goodness-of-fit case taking <img src="https://latex.codecogs.com/png.latex?A"> as a saturated model covering the entire observation space, and the more common “hypothesis testing” case taking M as the conjunction of an unsaturated <img src="https://latex.codecogs.com/png.latex?A"> with a targeted ‘test’ constraint (or set of constraints) <img src="https://latex.codecogs.com/png.latex?H">. This <img src="https://latex.codecogs.com/png.latex?H"> is logically independent of <img src="https://latex.codecogs.com/png.latex?A"> and consistent with <img src="https://latex.codecogs.com/png.latex?A">, with <img src="https://latex.codecogs.com/png.latex?M"> = <img src="https://latex.codecogs.com/png.latex?H"> &amp; <img src="https://latex.codecogs.com/png.latex?A"> in logical terms, or <img src="https://latex.codecogs.com/png.latex?M"> = <img src="https://latex.codecogs.com/png.latex?H"> + <img src="https://latex.codecogs.com/png.latex?A"> in set-theoretic terms with + being union (in particular, we assume no element in <img src="https://latex.codecogs.com/png.latex?H"> is entailed or contradicted by <img src="https://latex.codecogs.com/png.latex?A"> and no element in <img src="https://latex.codecogs.com/png.latex?A"> is entailed or contradicted by <img src="https://latex.codecogs.com/png.latex?H">).</p>
</blockquote>
<hr>
</section>
<section id="misleading-definitions" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="misleading-definitions"><span class="header-section-number">1.2</span> Misleading Definitions</h2>
<hr>
<p>It is very common to see the <img src="https://latex.codecogs.com/png.latex?P">-value defined as</p>
<hr>
<blockquote class="blockquote">
<p><strong>The probability of obtaining test results at least as extreme as the results actually observed, under the assumption that the null hypothesis is correct.</strong></p>
</blockquote>
<hr>
<p>Indeed, this is the actual definition currently given on the <a href="https://en.wikipedia.org/wiki/P-value">Wikipedia page for the topic</a>, however, it is inadequate and misleading because it hides and reifies the other assumptions used to compute the <img src="https://latex.codecogs.com/png.latex?P">-value and exclusively focuses on the null hypothesis.</p>
<p>The test hypothesis (often the null hypothesis) is only one component of the entire model that is being tested. This is reflected in the first definition I gave above, which explicitly emphasizes that every model assumption must be true. Thus, the <img src="https://latex.codecogs.com/png.latex?P">-value is sensitive to all these assumptions and their violation(s).</p>
<hr>
</section>
<section id="auxilliary-assumptions" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="auxilliary-assumptions"><span class="header-section-number">1.3</span> Auxilliary Assumptions</h2>
<hr>
<p>Some of these key <strong>assumptions</strong> behind the computation of a <img src="https://latex.codecogs.com/png.latex?P">-value are that some sort of <strong>random process was employed</strong> (random sampling, random assignment, etc.), that there are <strong>no uncontrolled sources of bias</strong> (confounding, programming errors, equipment defects, sparse-data bias)[<span class="citation" data-cites="greenlandSparseDataBias2016"><sup>6</sup></span>] in the results, and that <strong>the test hypothesis</strong> (often the null hypothesis) <strong>is correct</strong>. Some of these assumptions can be seen in the figure below from [<span class="citation" data-cites="greenlandAidScientificInference2020"><sup>7</sup></span>], which will be discussed later on. This entire set of assumptions is generally referred to as the <em>test model</em>, and that is because the entire assumed model is being tested.</p>
<hr>
<figure class="figure">
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1605000180/Site/pvalueassumptions.svg" alt="P-value assumptions" width="500" style="cursor: zoom-in" class="figure-img"></p>
<figcaption>
Conditional versus unconditional interpretations of P-values, S-values, and compatibility intervals (CIs). (A) Conditional interpretation, in which background model assumptions, such as no systematic error, are assumed to be correct; thus,the information provided by the P-value and S-value is targeted towards the test hypothesis. (B)Unconditional interpretation, in which no aspect of the statistical model is assumed to be correct; thus,the information provided by the P-value and S-value is targeted toward the entire test model.
</figcaption>
</figure>
<hr>
<p>We often start from the position that all those assumptions are correct (hence, we “condition” on them, even though they are often not correct)[<span class="citation" data-cites="greenlandAidScientificInference2020"><sup>7</sup></span>] when calculating the <img src="https://latex.codecogs.com/png.latex?P">-value, so that any deviation of the data from what was expected under those assumptions would be <strong>purely random error</strong>. But in reality such deviations could also be the result of <strong>any</strong> assumptions being false, including <em>but not limited to</em> the test hypothesis.</p>
<hr>
<blockquote class="blockquote">
<p>Note: “Conditioning” here refers to taking the assumptions in the model as given, and should not be confused with conditional probability.</p>
</blockquote>
<hr>
<p>For example, in high-energy physics, neutrinos were found in one study to be faster than light due to the resulting large test statistic and corresponding small <img src="https://latex.codecogs.com/png.latex?P">-value, but this result was later found to be a result of a defect in the fiber-optic timing system for that experiment.[<span class="citation" data-cites="moskowitzFasterthanlightNeutrinosAren2012"><sup>8</sup></span>] Thus, the low <img src="https://latex.codecogs.com/png.latex?P">-value was not because the assumed null hypothesis was false, but instead due to a bias in the procedure.</p>
<p>So the <img src="https://latex.codecogs.com/png.latex?P">-value <strong>cannot</strong> be the probability of one of these assumptions, such as <em>“the probability of getting results due to chance alone.”</em> A statement like this is <strong>backwards</strong> because it’s quantifying one of the assumptions behind the computation of a <img src="https://latex.codecogs.com/png.latex?P">-value.</p>
<p>This assumption of chance causing the results is assumed to be true (aka 100%) along with several other things, when calculating the <img src="https://latex.codecogs.com/png.latex?P">-value, but this does not mean it is actually correct and the calculation of the <img src="https://latex.codecogs.com/png.latex?P">-value <em>cannot</em> be the <em>probability</em> of one of those <strong>assumptions</strong>.</p>
<hr>
</section>
<section id="probability-of-what" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="probability-of-what"><span class="header-section-number">1.4</span> Probability of What?</h2>
<hr>
<p>It is also important to clarify that <img src="https://latex.codecogs.com/png.latex?P">-values are not <em>probabilities of data</em> or parameter values, which many like to say to differentiate from probabilities of hypotheses. Rather, <img src="https://latex.codecogs.com/png.latex?P">-values are probabilities of “data features”, such as test statistics (i.e.&nbsp;a z-score or <img src="https://latex.codecogs.com/png.latex?%5Cchi%5E%7B2%7D"> statistic) or can be interpreted as the percentile at which the observed test statistic falls within the expected distribution for the test statistic, assuming all the model assumptions are true.[<span class="citation" data-cites="perezgonzalezPvaluesPercentilesCommentary2015"><sup>9</sup></span>;<span class="citation" data-cites="fraserPvalueFunctionStatistical2019"><sup>10</sup></span>]</p>
<hr>
</section>
<section id="properties-uniformity" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="properties-uniformity"><span class="header-section-number">1.5</span> Properties (Uniformity)</h2>
<hr>
<p>A <img src="https://latex.codecogs.com/png.latex?P">-value is considered to be valid if over repeated trials it would be uniform when the tested hypothesis and all other assumptions used to compute the <img src="https://latex.codecogs.com/png.latex?P">-value are correct (see the histogram below to see what this looks like). Typically, this test hypothesis is a null hypothesis where the tested parameter value is usually 0 or 1, but this property applies to any test hypothesis for any parameter value. Thus, there is the random variable <img src="https://latex.codecogs.com/png.latex?P">, which (when valid) follows this uniform distribution, and the realization of this random variable, <img src="https://latex.codecogs.com/png.latex?p">, which is the observed <img src="https://latex.codecogs.com/png.latex?P">-value. The latter is what most researchers are interpreting from studies.</p>
<p>Thus, if we were to simulate two variables that are practically the same (meaning there’s no difference between them) and then compare them, say, using a t-test, and we were to iterate this process 10000 times and plot the distribution of the observed P-values, it would be uniform, indicating that any P-value within the interval from 0-1 is just as likely as any other to be observed.</p>
<hr>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @title Simulation of valid P-values where test hypothesis is true</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param X The first variable we are simulating </span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param Y The second variable we are simulating </span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param n.sim # The number of simulations</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param t The object storing the t-test results</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param t.sim # Empty numeric vector to contain values</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param n.samp # Sample size in each group</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @NOTE The null hypothesis does not have to be 0, it can be any value.</span></span>
<span id="cb1-9"></span>
<span id="cb1-10">n.sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span></span>
<span id="cb1-11">t.sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n.sim)</span>
<span id="cb1-12">n.samp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n.sim) {</span>
<span id="cb1-15">  X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-16">  Y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-17">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(X, Y)</span>
<span id="cb1-18">  t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t.test</span>(X, Y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mu =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">paired =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb1-19">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var.equal =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df)</span>
<span id="cb1-20">  t.sim[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> t[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]]</span>
<span id="cb1-21">}</span></code></pre></div>
<pre><code>#&gt; Error in theme_less(): could not find function "theme_less"</code></pre>
<hr>
<p>Many frequentist statisticians do not consider <img src="https://latex.codecogs.com/png.latex?P">-values to be valid/useful if they fail to meet this validity criterion of being uniform, hence they do not recognize variants such as the posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-value (which concentrates around values such as 0.5, rather than being uniform) to be valid.</p>
<p>Indeed, there have been great efforts to calibrate the <img src="https://latex.codecogs.com/png.latex?P">-value which ranges from mathematical solutions such as taking the <img src="https://latex.codecogs.com/png.latex?(1%20+%20%5B-e*p*%5Clog(p)%5D%5E%7B-1%7D)%5E%7B-1%7D"> which gives the lower bound on the conditional type I error,[<span class="citation" data-cites="sellkeCalibrationValuesTesting2001"><sup>11</sup></span>;<span class="citation" data-cites="greenlandTechnicalIssuesInterpretation2020"><sup>12</sup></span>] to taking the <img src="https://latex.codecogs.com/png.latex?C_%7B1%7D(K):=%5Csqrt%7BK%7D-1"> of the <img src="https://latex.codecogs.com/png.latex?P">-value (the square-root calibrator), yielding a test martingale,[<span class="citation" data-cites="shaferTestMartingalesBayes2011"><sup>13</sup></span>] or even empirically attempting to recalibrate the <img src="https://latex.codecogs.com/png.latex?P">-value by collecting observed <img src="https://latex.codecogs.com/png.latex?P">-values from observational studies with negative controls (“test-hypotheses where the exposure is not believed to cause the outcome”) and using them to calculate the empirical null distribution.[<span class="citation" data-cites="schuemieRobustEmpiricalCalibration2016"><sup>14</sup></span>]</p>
<p>The latter is done since observational studies are prone to several more biases than controlled, randomized experiments, thus the observed <img src="https://latex.codecogs.com/png.latex?P">-values and estimated effect sizes are used to calculate the systematic errors within the sampling distribution and are used for recalibration of the <img src="https://latex.codecogs.com/png.latex?P">-value. Whether or not this approach is effective, however, is a different matter.[<span class="citation" data-cites="gruberLimitationsEmpiricalCalibration2016"><sup>15</sup></span>] In short, calibration is an often sought-out property of <img src="https://latex.codecogs.com/png.latex?P">-values.</p>
<p>Many frequentist statisticians do not consider <img src="https://latex.codecogs.com/png.latex?P">-values to be valid/useful if they fail to meet this validity criterion of being uniform, hence they do not recognize variants such as the posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-value (which concentrates around values such as 0.5, rather than being uniform) to be valid.</p>
<p>Indeed, there have been great efforts to calibrate the <img src="https://latex.codecogs.com/png.latex?P">-value which ranges from mathematical solutions such as taking the <img src="https://latex.codecogs.com/png.latex?(1%20+%20%5B-e*p*%5Clog(p)%5D%5E%7B-1%7D)%5E%7B-1%7D"> which gives the lower bound on the conditional type I error,[<span class="citation" data-cites="sellkeCalibrationValuesTesting2001"><sup>11</sup></span>;<span class="citation" data-cites="greenlandTechnicalIssuesInterpretation2020"><sup>12</sup></span>] to taking the <img src="https://latex.codecogs.com/png.latex?C_%7B1%7D(K):=%5Csqrt%7BK%7D-1"> of the <img src="https://latex.codecogs.com/png.latex?P">-value (the square-root calibrator), yielding a test martingale,[<span class="citation" data-cites="shaferTestMartingalesBayes2011"><sup>13</sup></span>] or even empirically attempting to recalibrate the <img src="https://latex.codecogs.com/png.latex?P">-value by collecting observed <img src="https://latex.codecogs.com/png.latex?P">-values from observational studies with negative controls (“test-hypotheses where the exposure is not believed to cause the outcome”) and using them to calculate the empirical null distribution.[<span class="citation" data-cites="schuemieRobustEmpiricalCalibration2016"><sup>14</sup></span>]</p>
<p>The latter is done since observational studies are prone to several more biases than controlled, randomized experiments, thus the observed <img src="https://latex.codecogs.com/png.latex?P">-values and estimated effect sizes are used to calculate the systematic errors within the sampling distribution and are used for recalibration of the <img src="https://latex.codecogs.com/png.latex?P">-value. Whether or not this approach is effective, however, is a different matter.[<span class="citation" data-cites="gruberLimitationsEmpiricalCalibration2016"><sup>15</sup></span>] In short, calibration is an often sought-out property of <img src="https://latex.codecogs.com/png.latex?P">-values.</p>
<hr>
</section>
</section>
<section id="the-different-interpretations" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> The Different Interpretations</h1>
<hr>
<section id="the-decision-theoretic-approach" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="the-decision-theoretic-approach"><span class="header-section-number">2.1</span> The Decision-Theoretic Approach</h2>
<hr>
<p>Many researchers interpret the <img src="https://latex.codecogs.com/png.latex?P">-value in a behavioral, decision-guiding way such as being statistically significant or not (defined below) depending on whether observed <em>p</em> from a study (the realization of the random variable <img src="https://latex.codecogs.com/png.latex?P">) falls below a fixed cutoff level (<img src="https://latex.codecogs.com/png.latex?%5Calpha">, which is the maximum tolerable type I error rate).[<span class="citation" data-cites="neymanProblemMostEfficient1933"><sup>16</sup></span>]</p>
<hr>
</section>
<section id="statistical-significance" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="statistical-significance"><span class="header-section-number">2.2</span> Statistical Significance</h2>
<hr>
<p>Thus, in this approach, users do not care how small or large the observed <img src="https://latex.codecogs.com/png.latex?P">-value <img src="https://latex.codecogs.com/png.latex?p"> is, but simply, whether or not it fell beneath the pre-specified <img src="https://latex.codecogs.com/png.latex?%5Calpha"> level (often 0.05). If it falls below <img src="https://latex.codecogs.com/png.latex?%5Calpha"> they behave inline with the rejection of this test hypothesis, and if it fails to fall below <img src="https://latex.codecogs.com/png.latex?%5Calpha">, then they must behave in a manner where they accept this test hypothesis. The phrase <em>statistical significance</em>, simply indicates that the observed <img src="https://latex.codecogs.com/png.latex?P">-value <img src="https://latex.codecogs.com/png.latex?p"> fell below this pre-specified <img src="https://latex.codecogs.com/png.latex?%5Calpha"> level, and nothing else. It does not indicate any meaningful significance on its own.</p>
<p>The pioneers of this approach, Jerzy Neyman and Egon Pearson, define this behavioral guidance in their 1933 paper, “On the Problem of the Most Efficient Tests of Statistical Hypotheses”[<span class="citation" data-cites="neymanProblemMostEfficient1933"><sup>16</sup></span>]</p>
<hr>
<blockquote class="blockquote">
<p>Without hoping to know whether each separate hypothesis is true or false, we may search for rules to govern our behavior with regard to them, in following which we insure that, in the long run of experience, we shall not be too often wrong.</p>
</blockquote>
<hr>
<p>This decision-making framework may be useful in certain scenarios,[<span class="citation" data-cites="whiteheadCaseFrequentismClinical1993"><sup>17</sup></span>] where some sort of randomization is possible, where experiments can be repeated, and where there is large control over the experimental conditions, with one of the most notable historical examples being Egon Pearson (son of Karl Pearson and coauthor of Jerzy Neyman) using it to <a href="https://www.ams.org/journals/bull/1936-42-09/S0002-9904-1936-06365-2/S0002-9904-1936-06365-2.pdf">improve quality control</a> in industrial settings.</p>
<p>Contrary to some claims,[<span class="citation" data-cites="rubinWhatTypeType2019"><sup>18</sup></span>] this approach does <strong>NOT</strong> require exact replications of the experiments, instead, it requires that a valid <img src="https://latex.codecogs.com/png.latex?%5Calpha"> level is used consistently.[<span class="citation" data-cites="neymanProblemMostEfficient1933"><sup>16</sup></span>;<span class="citation" data-cites="Lehmann2011-vs"><sup>19</sup></span>] In this approach, the exact, observed <img src="https://latex.codecogs.com/png.latex?P">-value from a study is not as relevant and cannot validly be interpreted without an entire set of studies that are compared to the fixed error rate (<img src="https://latex.codecogs.com/png.latex?%5Calpha">).</p>
<hr>
<figure class="figure">
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700110/Site/classicalgiants.png" alt="Picture of the giants who founded frequentist statistics such as Egon Pearson, Ronald Fisher, and Jerzy Neyman" width="800" style="cursor: zoom-in" class="figure-img"></p>
<figcaption>
From left to right: Ronald A. Fisher, Jerzy Neyman, and Egon Pearson.
</figcaption>
</figure>
<hr>
</section>
<section id="the-inductive-approach" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="the-inductive-approach"><span class="header-section-number">2.3</span> The Inductive Approach</h2>
<hr>
<p>Others interpret the <img src="https://latex.codecogs.com/png.latex?P">-value <img src="https://latex.codecogs.com/png.latex?p"> in an inductive inferential/evidential (<strong>Fisherian</strong>) way,[<span class="citation" data-cites="fisherDesignExperiments1935"><sup>20</sup></span>;<span class="citation" data-cites="fisherStatisticalMethodsScientific1955"><sup>21</sup></span>] as a <strong>continuous</strong> measure of evidence against the very test hypothesis and entire model (all assumptions) used to compute it (let’s go with this for now, even though there are some problems with this interpretation, more on that below).</p>
<p>This interpretation as a continuous measure of evidence <strong>against</strong> the test hypothesis and the entire model used to compute it can be seen in the figure below from[<span class="citation" data-cites="greenlandAidScientificInference2020"><sup>7</sup></span>]. In one framework (left panel), we may assume certain assumptions to be true (“conditioning” on them, i.e, use of random assignment), and in the other (right panel), we question all assumptions, hence the “unconditional” interpretation. Unlike the <strong>Neyman-Pearson</strong> approach, this inferential approach allows interpretation of <img src="https://latex.codecogs.com/png.latex?P">-values from single studies, and indeed, lower values of it are taken as more evidence against the tested hypothesis.</p>
<hr>
</section>
<section id="null-hypothesis-significance-testing" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="null-hypothesis-significance-testing"><span class="header-section-number">2.4</span> Null-Hypothesis Significance Testing</h2>
<hr>
<p>However, it is also worth pointing out that most individuals do not interpret <img src="https://latex.codecogs.com/png.latex?P">-values from a <strong>Neyman-Pearson</strong> or <strong>Fisherian</strong> standpoint, rather, they fuse both approaches together, which is what we commonly know today as “null-hypothesis significance testing.” This approach is regarded by most as being a incompatible hybrid given that it often confuses error rates (<img src="https://latex.codecogs.com/png.latex?%5Calpha">, <img src="https://latex.codecogs.com/png.latex?%5Cbeta">), which are fixed before a study, with the <img src="https://latex.codecogs.com/png.latex?P">-value, which is not a fixed error-rate, and the fusion of these approaches often has been blamed for the replication crisis in science by many statisticians. Though some believe these approaches can be reconciled and are useful.[<span class="citation" data-cites="bickelNullHypothesisSignificance2019"><sup>22</sup></span>]</p>
<hr>
<figure class="figure">
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1605000180/Site/pvalueassumptions.svg" alt="P-value assumptions" width="500" style="cursor: zoom-in" class="figure-img"></p>
<figcaption>
Conditional versus unconditional interpretations of P-values, S-values, and compatibility intervals (CIs). (A) Conditional interpretation, in which background model assumptions, such as no systematic error, are assumed to be correct; thus,the information provided by the P-value and S-value is targeted towards the test hypothesis. (B)Unconditional interpretation, in which no aspect of the statistical model is assumed to be correct; thus,the information provided by the P-value and S-value is targeted toward the entire test model.
</figcaption>
</figure>
<hr>
<p>Back to the <strong>Fisherian</strong> approach, the interpretation of the <img src="https://latex.codecogs.com/png.latex?P">-value as a continuous measure of evidence against the test model that produced it shouldn’t be confused with other statistics that serve as support measures. Likelihood ratios and Bayes factors are <strong>absolute</strong> measures of evidence <strong>for</strong> a model compared to another model, whereas the <img src="https://latex.codecogs.com/png.latex?P">-value is a <strong>relative</strong> measure of “evidence” (more on that below) that can be tricky to interpret.[<span class="citation" data-cites="jeffreysTestsSignificanceTreated1935"><sup>23</sup></span>;<span class="citation" data-cites="jeffreysTheoryProbability1998"><sup>24</sup></span>;<span class="citation" data-cites="royallStatisticalEvidenceLikelihood1997"><sup>25</sup></span>] Indeed, this is why the <img src="https://latex.codecogs.com/png.latex?P">-value is converted by some Bayesians to a lower bound of the Bayes factor by taking <img src="https://latex.codecogs.com/png.latex?-e*p*%5Clog(p)">.[<span class="citation" data-cites="sellkeCalibrationValuesTesting2001"><sup>11</sup></span>;<span class="citation" data-cites="greenlandTechnicalIssuesInterpretation2020"><sup>12</sup></span>]</p>
<hr>
</section>
<section id="measure-of-compatibility" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="measure-of-compatibility"><span class="header-section-number">2.5</span> Measure of Compatibility</h2>
<hr>
<p>The <img src="https://latex.codecogs.com/png.latex?P">-value is not an absolute measure of evidence for a model (such as the null/alternative model), it is a continuous <strong>measure of the compatibility</strong> of the <strong>observed data</strong> with the <strong>model</strong> used to compute it.[<span class="citation" data-cites="greenlandStatisticalTestsValues2016"><sup>3</sup></span>]</p>
<p>If it’s high, it means the observed data are <strong>very compatible</strong> with the model used to compute it. If it’s very low, then it indicates that the data are <strong>not as compatible</strong> with the model used to calculate it, and this low compatibility may be due to random variation and/or it may be due to a violation of assumptions (such as the null model not being true, not using randomization, a programming error or equipment defect such as that <a href="https://www.washingtonpost.com/blogs/compost/post/faster-than-light-neutrinos-arent/2012/02/23/gIQA5MmjVR_blog.html">seen with neutrinos</a>, etc.).</p>
<p>Low compatibility of the data with the model can be implied as evidence against the test hypothesis, if we accept the rest of the model used to compute the <img src="https://latex.codecogs.com/png.latex?P">-value. Thus, lower <img src="https://latex.codecogs.com/png.latex?P">-values from a <strong>Fisherian</strong> perspective are seen as stronger evidence against the test hypothesis given the rest of the model.</p>
<hr>
</section>
</section>
<section id="common-misleading-criticisms" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Common, Misleading Criticisms</h1>
<hr>
<section id="estimation-and-intervals" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="estimation-and-intervals"><span class="header-section-number">3.1</span> Estimation and Intervals</h2>
<hr>
<p>A common criticism put forth by many is that <img src="https://latex.codecogs.com/png.latex?P">-values are useless, given that they cannot tell you the size of the effect and because they are confounded by sample size and effect size, and that researchers should instead give compatibility (confidence) intervals. However, this criticism is nonsensical as they can both be given and serve different purposes.</p>
<p>A <img src="https://latex.codecogs.com/png.latex?P">-value for a particular parameter value gives the compatibility between the test model in question, which will vary from one parameter value to the next, and the data. An interval estimate such as a 95% frequentist interval simply gives the region of parameter values with <img src="https://latex.codecogs.com/png.latex?P">-values above the corresponding <img src="https://latex.codecogs.com/png.latex?%5Calpha"> level, and which are more consistent with the data than the parameter values outside the interval limits. An interval estimate by itself does not explicitly tell one how consistent a parameter value is with the data, which the <img src="https://latex.codecogs.com/png.latex?P">-value does.</p>
<hr>
</section>
<section id="overstating-the-evidence" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="overstating-the-evidence"><span class="header-section-number">3.2</span> Overstating the Evidence</h2>
<hr>
<p><img src="https://latex.codecogs.com/png.latex?P">-values are routinely criticized for overstating the amount of evidence from a study. Such statements are also often given using Bayesian arguments, of which many are skeptical. However, the <img src="https://latex.codecogs.com/png.latex?P">-value cannot overstate evidence as it is simply providing the location at which the test statistic fell in the expected distribution, given that every model assumption were true. It is simply indicative of how surprising/extreme the observed result was, given certain assumptions.</p>
<p>Any overstating of evidence, is not an issue of the statistic itself, but rather users. If we treat the <img src="https://latex.codecogs.com/png.latex?P-"> value as nothing more or less than a continuous measure of compatibility of the observed data with the model used to compute it (observed <img src="https://latex.codecogs.com/png.latex?p">) given certain model assumptions, we won’t run into some of the common misinterpretations such as “the <img src="https://latex.codecogs.com/png.latex?P">-value is the probability of a hypothesis”, or the “probability of chance alone”, or “the probability of being incorrect”.[<span class="citation" data-cites="greenlandStatisticalTestsValues2016"><sup>3</sup></span>]</p>
<p>Indeed, many of the “problems” commonly associated with the <img src="https://latex.codecogs.com/png.latex?P">-value are not due to the actual statistic itself, but rather researchers’ misinterpretations of what it is and what it means for a study.</p>
<p>The answer to these misconceptions may be compatibilism, with less compatibility (smaller <img src="https://latex.codecogs.com/png.latex?P">-values) indicating a poor fit between the data and the test model and hence more evidence against the test hypothesis.</p>
<p>A <img src="https://latex.codecogs.com/png.latex?P">-value of 0.04 means that assuming that <strong>all</strong> the assumptions of the model used to compute the <img src="https://latex.codecogs.com/png.latex?P">-value are correct, we won’t get data (a test statistic) at least as extreme as what was observed by random variation more than 4% of the time.</p>
<p>To many, such low compatibility between the data and the model may lead them to reject the test hypothesis (the null hypothesis).</p>
<hr>
</section>
</section>
<section id="some-valid-issues" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Some Valid Issues</h1>
<hr>
<section id="mismatch-with-direction" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="mismatch-with-direction"><span class="header-section-number">4.1</span> Mismatch With Direction</h2>
<hr>
<p>If you recall from above, I wrote that the <img src="https://latex.codecogs.com/png.latex?P">-value is seen by many as being a continuous measure of evidence against the test hypothesis and model. Technically speaking, it would be incorrect to define it this way because as the <img src="https://latex.codecogs.com/png.latex?P">-value goes up (with the highest value being 1 or 100%), there is <strong>less</strong> evidence against the test hypothesis since the data are <strong>more compatible</strong> with the test model. 1 = perfect compatibility of the data with the test model.</p>
<p>As the <img src="https://latex.codecogs.com/png.latex?P">-value gets lower (with the lowest value being 0), there is <strong>less compatibility</strong> between the data and the model, hence <strong>more</strong> evidence against the test hypothesis used to compute <img src="https://latex.codecogs.com/png.latex?p">.</p>
<p>Thus, saying that <img src="https://latex.codecogs.com/png.latex?P">-values are measures of evidence against the hypothesis used to compute them is a backward definition. This definition would be correct if higher <img src="https://latex.codecogs.com/png.latex?P">-values inferred more evidence against the test hypothesis and vice versa.</p>
<hr>
</section>
<section id="difficulties-due-to-scale" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="difficulties-due-to-scale"><span class="header-section-number">4.2</span> Difficulties Due to Scale</h2>
<hr>
<p>Another problem with <img src="https://latex.codecogs.com/png.latex?P">-values and their interpretation is scaling. Since the statistic is meant to be a continuous measure of compatibility (and relative evidence against the test model + hypothesis), we would hope that differences between <img src="https://latex.codecogs.com/png.latex?P">-values would be equal (on an additive scale), as this makes it easier to interpret.</p>
<p>For example, the difference between 0 and 10 dollars is the same as the difference between 90 and 100 dollars, in that both are a difference of 10 dollars. And this property remains consistent across various intervals, 120 and 130, 1,000,000 and 1,000,010.</p>
<p>Unfortunately, this doesn’t apply to the <img src="https://latex.codecogs.com/png.latex?P">-value because it is on the inverse-exponential scale. The difference between a <img src="https://latex.codecogs.com/png.latex?P">-value of 0.01 and 0.10 is not the same as the difference between 0.90 and 0.99.</p>
<hr>
<figure class="figure">
<p><img src="https://lesslikely.com/images/norm.svg" alt="Gaussian distribution" width="680" style="cursor: zoom-in" class="figure-img"></p>
<figcaption>
A gaussian probability densitiy with the standard deviations annotated. Data points further away from the mean, are more extreme and unlikely events. I also must admit that this is one of my favorite figures of a gaussian distribution.
</figcaption>
</figure>
<hr>
<hr>
<p>For example, with a normal distribution (above), a z-score of 0 results in a <img src="https://latex.codecogs.com/png.latex?P">-value of 1 (perfect compatibility). If we now move to a z-score of 1, the <img src="https://latex.codecogs.com/png.latex?P">-value is 0.31. Thus, we saw a dramatic decrease from a <img src="https://latex.codecogs.com/png.latex?P">-value of 1 to 0.31 with one z-score. A 0.69 decrease in the <img src="https://latex.codecogs.com/png.latex?P">-value.</p>
<p>Now let’s move from a z-score of 1 to a z-score of 2. We saw a decrease of 0.69 with the change in <strong>one</strong> z-score before, so the new <img src="https://latex.codecogs.com/png.latex?P">-value must be 0.31 - 0.69 = -0.38 right? <strong>No</strong>. The <img src="https://latex.codecogs.com/png.latex?P">-value for a z-score of 2 is 0.045. The <img src="https://latex.codecogs.com/png.latex?P">-value for a z-score of 3 is 0.003. Even though we’ve only been moving by <strong>one</strong> z-score at a time, the changes in <img src="https://latex.codecogs.com/png.latex?P">-values don’t remain constant; the decreases become larger and larger.</p>
<p>Thus, the difference between the <img src="https://latex.codecogs.com/png.latex?P">-values of 0.01 and 0.10, in terms of z-score, is substantially larger than the difference between 0.90 and 0.99. Again, this makes it difficult to interpret as a statistic across the board, especially as a continuous measure. This can further be seen in the figure from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland (2020)</a>.</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="resolution-with-surprisals" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Resolution with Surprisals</h1>
<hr>
<p>The issues described above such as the backward definition and the problem of scaling can make it difficult to conceptualize the <img src="https://latex.codecogs.com/png.latex?P">-value as being an evidence measure against the test hypothesis and test model. However, these issues can be addressed by taking the negative log of the <img src="https://latex.codecogs.com/png.latex?P">-value <img src="https://latex.codecogs.com/png.latex?%E2%80%93%5Clog_%7B2%7D(p)"> , which yields something known as the Shannon information value or <em>surprisal (</em><img src="https://latex.codecogs.com/png.latex?s">) value,[<span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>4</sup></span>;<span class="citation" data-cites="coleSurprise2020"><sup>26</sup></span>;<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup>5</sup></span>] named after <a href="https://en.wikipedia.org/wiki/Claude_Shannon">Claude Shannon</a>, the father of information theory.[<span class="citation" data-cites="Shannon1948-uq"><sup>27</sup></span>]</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>Unlike the <img src="https://latex.codecogs.com/png.latex?P">-value, this value is not a probability but a continuous measure of <em>information</em> in <strong>bits</strong> of information against the test hypothesis and is taken from the observed test statistic computed by the test model.</p>
<p>It also provides a more intuitive way to think about <img src="https://latex.codecogs.com/png.latex?P">-values. Imagine that the variable <img src="https://latex.codecogs.com/png.latex?k"> is always the nearest integer to the calculated value of <img src="https://latex.codecogs.com/png.latex?s">. Now, take for example a <img src="https://latex.codecogs.com/png.latex?P">-value of 0.05, the <img src="https://latex.codecogs.com/png.latex?S">-value for this would be <img src="https://latex.codecogs.com/png.latex?s"> = <img src="https://latex.codecogs.com/png.latex?%E2%80%93%5Clog_%7B2%7D(0.05)"> which equals 4.3 bits of information embedded in the test statistic, which can be implied as evidence against the test hypothesis.</p>
<p>How much evidence is this? <img src="https://latex.codecogs.com/png.latex?k"> can help us think about this. The nearest integer to 4.3 is 4. Thus, the data which yield a <img src="https://latex.codecogs.com/png.latex?P">-value of 0.05 which results in an <img src="https://latex.codecogs.com/png.latex?s"> value of 4.3 bits of information is <strong>no more surprising</strong> than getting <strong>all heads</strong> on 4 fair coin tosses.</p>
<p>Another example. Let’s say our study gives us a <img src="https://latex.codecogs.com/png.latex?P">-value of 0.005, which would indicate to many very low compatibility between the test model and the observed data; this would yield an <img src="https://latex.codecogs.com/png.latex?s"> value of <img src="https://latex.codecogs.com/png.latex?%E2%80%93%5Clog_%7B2%7D(0.005)%20=%207.6"> bits of information. <img src="https://latex.codecogs.com/png.latex?k"> which is the closest integer to <img src="https://latex.codecogs.com/png.latex?s"> would be 8. Thus, these data which yield a <img src="https://latex.codecogs.com/png.latex?P">-value of 0.005 are no more surprising than getting all heads on 8 fair coin tosses.</p>
<p>A table of various <img src="https://latex.codecogs.com/png.latex?P">-values and their corresponding <img src="https://latex.codecogs.com/png.latex?S">-values, maximum-likelihood ratios, and likelihood-ratio statistics can be found below from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland (2020)</a>, which includes the general cutoffs used in different scientific fields such as high-energy physics and genome-wide association studies. It also shows how the traditional cutoffs used in these fields can be problematic.</p>
<p>For example, an <img src="https://latex.codecogs.com/png.latex?%5Calpha"> of 0.05, which only corresponds to seeing all heads on 4 fair coin tosses, is practically nothing when compared to the cutoffs used in particle physics and GWAS, which correspond to seeing all heads on 22 and 30 fair coin tosses, respectively.</p>
<hr>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">P-value (compatibility)</th>
<th style="text-align: right;">S-value (bits)</th>
<th style="text-align: right;">Maximum Likelihood Ratio</th>
<th style="text-align: right;">Deviance Statistic 2ln(MLR)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.99</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1.00e+00</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.9</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">1.01e+00</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.5</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.26e+00</td>
<td style="text-align: right;">0.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.25</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">1.94e+00</td>
<td style="text-align: right;">1.32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.1</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">3.87e+00</td>
<td style="text-align: right;">2.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.05</td>
<td style="text-align: right;">4.32</td>
<td style="text-align: right;">6.83e+00</td>
<td style="text-align: right;">3.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.025</td>
<td style="text-align: right;">5.32</td>
<td style="text-align: right;">1.23e+01</td>
<td style="text-align: right;">5.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.01</td>
<td style="text-align: right;">6.64</td>
<td style="text-align: right;">2.76e+01</td>
<td style="text-align: right;">6.63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.005</td>
<td style="text-align: right;">7.64</td>
<td style="text-align: right;">5.14e+01</td>
<td style="text-align: right;">7.88</td>
</tr>
<tr class="even">
<td style="text-align: left;">1e-04</td>
<td style="text-align: right;">13.29</td>
<td style="text-align: right;">1.94e+03</td>
<td style="text-align: right;">15.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5 sigma (~ 2.9 in 10 million)</td>
<td style="text-align: right;">21.70</td>
<td style="text-align: right;">5.20e+05</td>
<td style="text-align: right;">26.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">1 in 100 million (GWAS)</td>
<td style="text-align: right;">26.60</td>
<td style="text-align: right;">1.40e+07</td>
<td style="text-align: right;">32.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6 sigma (~ 1 in a billion)</td>
<td style="text-align: right;">29.90</td>
<td style="text-align: right;">1.30e+08</td>
<td style="text-align: right;">37.40</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style="text-decoration: underline;">Abbreviations: </span></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Table 1: $P$-values and binary $S$-values, with corresponding maximum-likelihood ratios (MLR) and deviance (likelihood-ratio) statistics for a simple test hypothesis H under background assumptions A</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<hr>
<p>Unlike the <img src="https://latex.codecogs.com/png.latex?P">-value, the <img src="https://latex.codecogs.com/png.latex?S">-value is more intuitive as a measure of refutational evidence against the test hypothesis since its value (bits of information against the test hypothesis) increases with less compatibility, whereas the opposite is true for the <img src="https://latex.codecogs.com/png.latex?P">-value.</p>
<hr>
<section id="some-examples" class="level3" data-number="5.0.1">
<h3 data-number="5.0.1" class="anchored" data-anchor-id="some-examples"><span class="header-section-number">5.0.1</span> Some Examples</h3>
<hr>
<p>Let’s try using some data to see this in action. I’ll take a sample experimental dataset from <code>R</code> on the effects of different conditions on dried plant weight. We can plot the data and run a one-way ANOVA.</p>
<hr>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">pg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">force</span>(PlantGrowth)</span>
<span id="cb3-2">(Hmisc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">describe</span>(pg))</span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; pg </span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  2  Variables      30  Observations</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; weight </span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;        n  missing distinct     Info     Mean  pMedian      Gmd      .05 </span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;       30        0       29        1    5.073     5.09   0.8131    3.983 </span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;      .10      .25      .50      .75      .90      .95 </span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;    4.170    4.550    5.155    5.530    6.038    6.132 </span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; lowest : 3.59 3.83 4.17 4.32 4.41, highest: 5.87 6.03 6.11 6.15 6.31</span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; group </span></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;        n  missing distinct </span></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;       30        0        3 </span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;                             </span></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Value       ctrl  trt1  trt2</span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Frequency     10    10    10</span></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Proportion 0.333 0.333 0.333</span></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; --------------------------------------------------------------------------------</span></span></code></pre></div>
<hr>
<p>Looks interesting. We can see some differences from the graph. Here’s what our test output gives us,</p>
<hr>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(weight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> group, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> pg))</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ztable</span>(res)</span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in ztable(res): could not find function "ztable"</span></span></code></pre></div>
<hr>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">(obs_p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> res[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>])</span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 0.01590996</span></span></code></pre></div>
<hr>
<p>If we had set our <img src="https://latex.codecogs.com/png.latex?%5Calpha"> to the traditional 0.05 level before the experiment, we can reject the test hypothesis (the null hypothesis), but that is not as interesting from a continuous evidential perspective. How can I interpret this <img src="https://latex.codecogs.com/png.latex?P">-value of 0.0159 more intuitively?</p>
<p>Let’s convert it into an <img src="https://latex.codecogs.com/png.latex?S">-value.</p>
<hr>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log2</span>(obs_p)</span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 5.97</span></span></code></pre></div>
<hr>
<p><img src="https://latex.codecogs.com/png.latex?%E2%80%93%5Clog_2(0.0159)%20=%205.97"></p>
<hr>
<p><img src="https://latex.codecogs.com/png.latex?s=%205.97"></p>
<hr>
<p>That is 5.97 bits of information against the null hypothesis.</p>
<p>Remember, <img src="https://latex.codecogs.com/png.latex?k"> is the nearest integer to the calculated value of <img src="https://latex.codecogs.com/png.latex?s"> and in this case, would be 6. So these results (the test statistic, <img src="https://latex.codecogs.com/png.latex?F">(4.85)) are as surprising as getting all heads on 6 fair coin tosses. Somewhat surprising, depending on the individual interpreting the results.</p>
<p>How would we interpret it within the context of a given confidence interval? The <img src="https://latex.codecogs.com/png.latex?S">-value tells us that values within the computed 95% CI: have at most 4.3 bits of information against them. That is because all parameter values within a 95% CI have <img src="https://latex.codecogs.com/png.latex?P">-values greater than 0.05.</p>
<p>So those parameter values that are inside the 95% interval estimate have less bits of information against them, than the parameter values that go further and further away from the center of the 95% interval estimate. The point estimate is the most compatible with the data (meaning it has the least refutational information against it), while those values near the limits have more information against them.</p>
<p>In other words, as values head in the directions outside the interval, there is more refutational information against them, as depicted by the following function from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland, 2020</a>, which is known as the surprisal function.</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>The <img src="https://latex.codecogs.com/png.latex?S">-value is not meant to replace the <img src="https://latex.codecogs.com/png.latex?P">-value, and it isn’t superior to the <img src="https://latex.codecogs.com/png.latex?P">-value. It is merely a logarithmic transformation of it that rescales it on an additive scale and tells us how much information is embedded within the test statistic and can be used as evidence against the test hypothesis. It is meant to be a device to help interpret the information one obtains from a calculated <img src="https://latex.codecogs.com/png.latex?P">-value.</p>
<hr>
<p>I’ve <a href="https://data.lesslikely.com/concurve/articles/svalues.html">constructed a calculator</a> that converts observed <img src="https://latex.codecogs.com/png.latex?P">-values into <img src="https://latex.codecogs.com/png.latex?S">-values and provides an intuitive way to think about them. For a more detailed discussion of <img src="https://latex.codecogs.com/png.latex?S">-values, see this <a href="../../../statistics/RG2020BMC">article</a>, in addition to the references below them.</p>
<hr>
</section>
</section>
<section id="s-value-calculator" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> S-value Calculator</h1>
<hr>
<hr>
<blockquote class="blockquote">
<p><strong>Acknowledgments:</strong> I’m very grateful to <a href="https://twitter.com/Lester_Domes">Sander Greenland</a> for his extensive commentary and corrections on several versions of this article. My acknowledgment does not imply endorsement of my views by these colleagues, and I remain solely responsible for the views expressed herein.</p>
</blockquote>
<hr>
<p>The analyses were run on:</p>
<hr>
<pre><code>#&gt; R version 4.5.0 (2025-04-11)
#&gt; Platform: aarch64-apple-darwin20
#&gt; Running under: macOS Sequoia 15.6.1
#&gt; 
#&gt; Matrix products: default
#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib 
#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1
#&gt; 
#&gt; Random number generation:
#&gt;  RNG:     Mersenne-Twister 
#&gt;  Normal:  Inversion 
#&gt;  Sample:  Rejection 
#&gt;  
#&gt; locale:
#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
#&gt; 
#&gt; time zone: America/New_York
#&gt; tzcode source: internal
#&gt; 
#&gt; attached base packages:
#&gt;  [1] splines   grid      stats4    parallel  stats     graphics  grDevices utils     datasets  methods   base     
#&gt; 
#&gt; other attached packages:
#&gt;  [1] pbmcapply_1.5.1       texPreview_2.1.0      tinytex_0.57          rmarkdown_2.29        brms_2.22.0          
#&gt;  [6] bootImpute_1.2.2      knitr_1.50            boot_1.3-31           reshape2_1.4.4        ProfileLikelihood_1.3
#&gt; [11] ImputeRobust_1.3-1    gamlss_5.4-22         gamlss.dist_6.1-1     gamlss.data_6.0-6     mvtnorm_1.3-3        
#&gt; [16] performance_0.14.0    summarytools_1.1.4    tidybayes_3.0.7       htmltools_0.5.8.1     Statamarkdown_0.9.2  
#&gt; [21] car_3.1-3             carData_3.0-5         qqplotr_0.0.6         ggcorrplot_0.1.4.1    Amelia_1.8.3         
#&gt; [26] Rcpp_1.0.14           blogdown_1.21         doParallel_1.0.17     iterators_1.0.14      foreach_1.5.2        
#&gt; [31] lattice_0.22-7        bayesplot_1.12.0      wesanderson_0.3.7     VIM_6.2.2             colorspace_2.1-1     
#&gt; [36] here_1.0.1            progress_1.2.3        loo_2.8.0             mi_1.1                Matrix_1.7-3         
#&gt; [41] broom_1.0.8           yardstick_1.3.2       svglite_2.2.1         Cairo_1.6-2           cowplot_1.1.3        
#&gt; [46] mgcv_1.9-3            nlme_3.1-168          xfun_0.52             broom.mixed_0.2.9.6   reticulate_1.42.0    
#&gt; [51] kableExtra_1.4.0      posterior_1.6.1       checkmate_2.3.2       parallelly_1.45.0     miceFast_0.8.5       
#&gt; [56] randomForest_4.7-1.2  missForest_1.5        miceadds_3.17-44      mice_3.18.0           quantreg_6.1         
#&gt; [61] SparseM_1.84-2        MCMCpack_1.7-1        MASS_7.3-65           coda_0.19-4.1         latex2exp_0.9.6      
#&gt; [66] rstan_2.32.7          StanHeaders_2.32.10   lubridate_1.9.4       forcats_1.0.0         stringr_1.5.1        
#&gt; [71] dplyr_1.1.4           purrr_1.0.4           readr_2.1.5           tibble_3.2.1          ggplot2_3.5.2        
#&gt; [76] tidyverse_2.0.0       ggtext_0.1.2          concurve_2.7.7        showtext_0.9-7        showtextdb_3.0       
#&gt; [81] sysfonts_0.8.9        future.apply_1.11.3   future_1.58.0         tidyr_1.3.1           magrittr_2.0.3       
#&gt; [86] rms_8.0-0             Hmisc_5.2-3          
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;   [1] dichromat_2.0-0.1       nnet_7.3-20             TH.data_1.1-3           vctrs_0.6.5             digest_0.6.37          
#&gt;   [6] png_0.1-8               shape_1.4.6.1           proxy_0.4-27            magick_2.8.6            fontLiberation_0.1.0   
#&gt;  [11] withr_3.0.2             ggpubr_0.6.0            survival_3.8-3          doRNG_1.8.6.2           emmeans_1.11.1         
#&gt;  [16] MatrixModels_0.5-4      systemfonts_1.2.3       ragg_1.4.0              zoo_1.8-14              V8_6.0.4               
#&gt;  [21] ggdist_3.3.3            DEoptimR_1.1-3-1        Formula_1.2-5           prettyunits_1.2.0       rematch2_2.1.2         
#&gt;  [26] httr_1.4.7              rstatix_0.7.2           globals_0.18.0          ps_1.9.1                rstudioapi_0.17.1      
#&gt;  [31] extremevalues_2.4.1     pan_1.9                 generics_0.1.4          processx_3.8.6          base64enc_0.1-3        
#&gt;  [36] curl_6.2.3              mitools_2.4             desc_1.4.3              xtable_1.8-4            svUnit_1.0.6           
#&gt;  [41] pracma_2.4.4            evaluate_1.0.3          hms_1.1.3               glmnet_4.1-9            rcartocolor_2.1.1      
#&gt;  [46] lmtest_0.9-40           robustbase_0.99-4-1     matrixStats_1.5.0       svgPanZoom_0.3.4        class_7.3-23           
#&gt;  [51] pillar_1.10.2           caTools_1.18.3          compiler_4.5.0          stringi_1.8.7           jomo_2.7-6             
#&gt;  [56] minqa_1.2.8             plyr_1.8.9              crayon_1.5.3            abind_1.4-8             metadat_1.4-0          
#&gt;  [61] sp_2.2-0                mathjaxr_1.8-0          rapportools_1.2         twosamples_2.0.1        sandwich_3.1-1         
#&gt;  [66] whisker_0.4.1           codetools_0.2-20        multcomp_1.4-28         textshaping_1.0.1       bcaboot_0.2-3          
#&gt;  [71] openssl_2.3.3           flextable_0.9.9         QuickJSR_1.7.0          e1071_1.7-16            gridtext_0.1.5         
#&gt;  [76] lme4_1.1-37             fs_1.6.6                itertools_0.1-3         listenv_0.9.1           Rdpack_2.6.4           
#&gt;  [81] pkgbuild_1.4.8          estimability_1.5.1      ggsignif_0.6.4          callr_3.7.6             tzdb_0.5.0             
#&gt;  [86] pkgconfig_2.0.3         tools_4.5.0             rbibutils_2.3           viridisLite_0.4.2       DBI_1.2.3              
#&gt;  [91] numDeriv_2016.8-1.1     fastmap_1.2.0           scales_1.4.0            officer_0.6.10          opdisDownsampling_1.0.1
#&gt;  [96] insight_1.3.0           rpart_4.1.24            farver_2.1.2            reformulas_0.4.1        survminer_0.5.0        
#&gt;  [ reached 'max' / getOption("max.print") -- omitted 55 entries ]</code></pre>
<hr>
</section>
<section id="references" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> References</h1>
<hr>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="2" data-line-spacing="2">
<div id="ref-gigerenzerStatisticalRitualsReplication2018" class="csl-entry">
1. Gigerenzer G. (2018). <span>“Statistical <span>Rituals</span>: <span>The Replication Delusion</span> and <span>How We Got There</span>.”</span> <em>Advances in Methods and Practices in Psychological Science</em>. <strong>1</strong>:198–218. doi: <a href="https://doi.org/10.1177/2515245918771329">10.1177/2515245918771329</a>.
</div>
<div id="ref-goodmanDirtyDozenTwelve2008" class="csl-entry">
2. Goodman S. (2008). <span>“A <span>Dirty Dozen</span>: <span>Twelve P</span>-<span>Value Misconceptions</span>.”</span> <em>Seminars in Hematology</em>. <strong>45</strong>:135–140. doi: <a href="https://doi.org/10.1053/j.seminhematol.2008.04.003">10.1053/j.seminhematol.2008.04.003</a>.
</div>
<div id="ref-greenlandStatisticalTestsValues2016" class="csl-entry">
3. Greenland S, Senn SJ, Rothman KJ, Carlin JB, Poole C, Goodman SN, et al. (2016). <span>“Statistical tests, <span>P</span> values, confidence intervals, and power: <span>A</span> guide to misinterpretations.”</span> <em>European Journal of Epidemiology</em>. <strong>31</strong>:337–350. doi: <a href="https://doi.org/10.1007/s10654-016-0149-3">10.1007/s10654-016-0149-3</a>.
</div>
<div id="ref-rafiSemanticCognitiveTools2020" class="csl-entry">
4. Rafi Z, Greenland S. (2020). <span>“Semantic and cognitive tools to aid statistical science: Replace confidence and significance by compatibility and surprise.”</span> <em>BMC Medical Research Methodology</em>. <strong>20</strong>:244. doi: <a href="https://doi.org/10.1186/s12874-020-01105-9">10.1186/s12874-020-01105-9</a>.
</div>
<div id="ref-greenlandValidPvaluesBehave2019" class="csl-entry">
5. Greenland S. (2019). <span>“Valid <span>P</span>-values behave exactly as they should: <span>Some</span> misleading criticisms of <span>P</span>-values and their resolution with <span>S</span>-values.”</span> <em>The American Statistician</em>. <strong>73</strong>:106–114. doi: <a href="https://doi.org/10.1080/00031305.2018.1529625">10.1080/00031305.2018.1529625</a>.
</div>
<div id="ref-greenlandSparseDataBias2016" class="csl-entry">
6. Greenland S, Mansournia MA, Altman DG. (2016). <span>“Sparse data bias: A problem hiding in plain sight.”</span> <em>BMJ</em>. <strong>352</strong>:i1981. doi: <a href="https://doi.org/10.1136/bmj.i1981">10.1136/bmj.i1981</a>.
</div>
<div id="ref-greenlandAidScientificInference2020" class="csl-entry">
7. Greenland S, Rafi Z. (2020). <span>“To <span>Aid Scientific Inference</span>, <span>Emphasize Unconditional Descriptions</span> of <span>Statistics</span>.”</span> <em>arXiv:190908583 [statME]</em>. <a href="https://arxiv.org/abs/1909.08583">https://arxiv.org/abs/1909.08583</a>.
</div>
<div id="ref-moskowitzFasterthanlightNeutrinosAren2012" class="csl-entry">
8. Moskowitz C. (2012). <span>“Faster-than-light neutrinos aren’t.”</span> <em>Scientific American</em>.
</div>
<div id="ref-perezgonzalezPvaluesPercentilesCommentary2015" class="csl-entry">
9. Perezgonzalez JD. (2015). <span>“P-values as percentiles. <span>Commentary</span> on: <span>‘<span>Null</span> hypothesis significance tests. <span>A</span> mixup of two different theories: The basis for widespread confusion and numerous misinterpretations’</span>.”</span> <em>Frontiers in Psychology</em>. <strong>6</strong>. doi: <a href="https://doi.org/10.3389/fpsyg.2015.00341">10.3389/fpsyg.2015.00341</a>.
</div>
<div id="ref-fraserPvalueFunctionStatistical2019" class="csl-entry">
10. Fraser DAS. (2019). <span>“The <span>P</span>-value function and statistical inference.”</span> <em>The American Statistician</em>. <strong>73</strong>:135–147. doi: <a href="https://doi.org/10.1080/00031305.2018.1556735">10.1080/00031305.2018.1556735</a>.
</div>
<div id="ref-sellkeCalibrationValuesTesting2001" class="csl-entry">
11. Sellke T, Bayarri MJ, Berger JO. (2001). <span>“Calibration of <span><img src="https://latex.codecogs.com/png.latex?%5Crho"></span> values for testing precise null hypotheses.”</span> <em>The American Statistician</em>. <strong>55</strong>:62–71. doi: <a href="https://doi.org/10.1198/000313001300339950">10.1198/000313001300339950</a>.
</div>
<div id="ref-greenlandTechnicalIssuesInterpretation2020" class="csl-entry">
12. Greenland S, Rafi Z. (2020). <span>“Technical <span>Issues</span> in the <span>Interpretation</span> of <span>S</span>-values and <span>Their Relation</span> to <span>Other Information Measures</span>.”</span> <em>arXiv:200812991 [statME]</em>. <a href="https://arxiv.org/abs/2008.12991">https://arxiv.org/abs/2008.12991</a>.
</div>
<div id="ref-shaferTestMartingalesBayes2011" class="csl-entry">
13. Shafer G, Shen A, Vereshchagin N, Vovk V. (2011). <span>“Test <span>Martingales</span>, <span>Bayes Factors</span> and p-<span>Values</span>.”</span> <em>Statistical Science</em>. <strong>26</strong>:84–101. doi: <a href="https://doi.org/10/fkcvt5">10/fkcvt5</a>.
</div>
<div id="ref-schuemieRobustEmpiricalCalibration2016" class="csl-entry">
14. Schuemie MJ, Hripcsak G, Ryan PB, Madigan D, Suchard MA. (2016). <span>“Robust empirical calibration of p-values using observational data.”</span> <em>Statistics in Medicine</em>. <strong>35</strong>:3883–3888. doi: <a href="https://doi.org/10/ghqmsb">10/ghqmsb</a>.
</div>
<div id="ref-gruberLimitationsEmpiricalCalibration2016" class="csl-entry">
15. Gruber S, Tchetgen ET. (2016). <span>“Limitations of empirical calibration of p-values using observational data.”</span> <em>Statistics in Medicine</em>. <strong>35</strong>:3869–3882. doi: <a href="https://doi.org/10/ghqmtn">10/ghqmtn</a>.
</div>
<div id="ref-neymanProblemMostEfficient1933" class="csl-entry">
16. Neyman J, Pearson ES. (1933). <span>“On the <span>Problem</span> of the <span>Most Efficient Tests</span> of <span>Statistical Hypotheses</span>.”</span> <em>Philosophical Transactions of the Royal Society of London Series A, Containing Papers of a Mathematical or Physical Character</em>. <strong>231</strong>:289–337. doi: <a href="https://doi.org/10.1098/rsta.1933.0009">10.1098/rsta.1933.0009</a>.
</div>
<div id="ref-whiteheadCaseFrequentismClinical1993" class="csl-entry">
17. Whitehead J. (1993). <span>“The case for frequentism in clinical trials.”</span> <em>Statistics in Medicine</em>. <strong>12</strong>:1405–1413. doi: <a href="https://doi.org/10.1002/sim.4780121506">10.1002/sim.4780121506</a>.
</div>
<div id="ref-rubinWhatTypeType2019" class="csl-entry">
18. Rubin M. (2019). <span>“What type of <span>Type I</span> error? <span>Contrasting</span> the <span>Neyman</span> and <span>Fisherian</span> approaches in the context of exact and direct replications.”</span> <em>Synthese</em>. doi: <a href="https://doi.org/10.1007/s11229-019-02433-0">10.1007/s11229-019-02433-0</a>.
</div>
<div id="ref-Lehmann2011-vs" class="csl-entry">
19. Lehmann EL. (2011). <span>“Fisher, <span>Neyman</span>, and the <span>Creation</span> of <span>Classical Statistics</span>.”</span> <span>Springer New York</span>. doi: <a href="https://doi.org/10.1007/978-1-4419-9500-1">10.1007/978-1-4419-9500-1</a>.
</div>
<div id="ref-fisherDesignExperiments1935" class="csl-entry">
20. Fisher RA. (1935). <span>“The <span>Design</span> of <span>Experiments</span>.”</span> <span>Oxford, England</span>: <span>Oliver &amp; Boyd</span>.
</div>
<div id="ref-fisherStatisticalMethodsScientific1955" class="csl-entry">
21. Fisher R. (1955). <span>“Statistical <span>Methods</span> and <span>Scientific Induction</span>.”</span> <em>Journal of the Royal Statistical Society Series B (Methodological)</em>. <strong>17</strong>:69–78. doi: <a href="https://doi.org/10.1111/j.2517-6161.1955.tb00180.x">10.1111/j.2517-6161.1955.tb00180.x</a>.
</div>
<div id="ref-bickelNullHypothesisSignificance2019" class="csl-entry">
22. Bickel DR. (2019). <span>“Null <span>Hypothesis Significance Testing Defended</span> and <span>Calibrated</span> by <span>Bayesian Model Checking</span>.”</span> <em>The American Statistician</em>. <strong>0</strong>:1–16. doi: <a href="https://doi.org/10.1080/00031305.2019.1699443">10.1080/00031305.2019.1699443</a>.
</div>
<div id="ref-jeffreysTestsSignificanceTreated1935" class="csl-entry">
23. Jeffreys H. (1935). <span>“Some <span>Tests</span> of <span>Significance</span>, <span>Treated</span> by the <span>Theory</span> of <span>Probability</span>.”</span> <em>Mathematical Proceedings of the Cambridge Philosophical Society</em>. <strong>31</strong>:203–222. doi: <a href="https://doi.org/10.1017/S030500410001330X">10.1017/S030500410001330X</a>.
</div>
<div id="ref-jeffreysTheoryProbability1998" class="csl-entry">
24. Jeffreys H. (1998). <span>“The <span>Theory</span> of <span>Probability</span>.”</span> <span>OUP Oxford</span>.
</div>
<div id="ref-royallStatisticalEvidenceLikelihood1997" class="csl-entry">
25. Royall R. (1997). <span>“Statistical <span>Evidence</span>: <span>A Likelihood Paradigm</span>.”</span> <span>CRC Press</span>.
</div>
<div id="ref-coleSurprise2020" class="csl-entry">
26. Cole SR, Edwards JK, Greenland S. (2020). <span>“Surprise!”</span> <em>American Journal of Epidemiology</em>. doi: <a href="https://doi.org/10/gg63md">10/gg63md</a>.
</div>
<div id="ref-Shannon1948-uq" class="csl-entry">
27. Shannon CE. (1948). <span>“A mathematical theory of communication.”</span> <em>The Bell System Technical Journal</em>. <strong>27</strong>:379–423. doi: <a href="https://doi.org/10.1002/j.1538-7305.1948.tb01338.x">10.1002/j.1538-7305.1948.tb01338.x</a>.
</div>
</div></section></div> ]]></description>
  <guid>https://lesslikely.com/posts/statistics/s-values.html</guid>
  <pubDate>Sun, 11 Nov 2018 05:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1605000180/Site/pvalueassumptions.png" medium="image" type="image/png"/>
</item>
<item>
  <title>P-values Are Tough And S-values Can Help</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/s-values.html</link>
  <description><![CDATA[ 





<script src="s-values_files/libs/kePrint-0.0.1/kePrint.js"></script>
<p><link href="s-values_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet"></p>
<hr>
<p>The <img src="https://latex.codecogs.com/png.latex?P">-value doesn’t have many fans. There are those who don’t understand it, often treating it as a measure it’s not, whether that’s a posterior probability, the probability of getting results due to chance alone, or some other bizarre/incorrect interpretation. [<span class="citation" data-cites="gigerenzerStatisticalRitualsReplication2018"><sup>1</sup></span>;<span class="citation" data-cites="goodmanDirtyDozenTwelve2008"><sup>2</sup></span>;<span class="citation" data-cites="greenlandStatisticalTestsValues2016"><sup>3</sup></span>] Then there are those who dislike it because they think the concept is too difficult to understand or because they see it as a noisy statistic we’re not interested in.</p>
<p>However, the groups of people mentioned above aren’t mutually exclusive. Many who dislike and criticize the <img src="https://latex.codecogs.com/png.latex?P">-value also do not understand its properties and behavior. This is unfortunate, given how important and widely used they are. In this article, which could also have been titled, <img src="https://latex.codecogs.com/png.latex?P">-values: More Than You Ever Wanted to Know, I take on the task of explaining:</p>
<hr>
<ul>
<li>what <img src="https://latex.codecogs.com/png.latex?P">-values are</li>
</ul>
<hr>
<ul>
<li>the assumptions behind them</li>
</ul>
<hr>
<ul>
<li>their properties and behavior</li>
</ul>
<hr>
<ul>
<li>different schools of interpretation</li>
</ul>
<hr>
<ul>
<li>misleading criticisms of <img src="https://latex.codecogs.com/png.latex?P">-values</li>
</ul>
<hr>
<ul>
<li>some valid issues in interpretation</li>
</ul>
<hr>
<ul>
<li>how these issues can be resolved</li>
</ul>
<hr>
<section id="what-is-a-p-value-anyway" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> What is a <em>P</em>-value Anyway?</h1>
<hr>
<section id="some-definitions-descriptions" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="some-definitions-descriptions"><span class="header-section-number">1.1</span> Some Definitions &amp; Descriptions</h2>
<hr>
<p>The <img src="https://latex.codecogs.com/png.latex?P">-value is the probability of getting a result (specifically, a test statistic) at least as extreme as what was observed if <strong>every model assumption</strong>, in addition to the targeted test hypothesis (usually a null hypothesis), used to compute it <strong>were correct</strong>. [<span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>4</sup></span>;<span class="citation" data-cites="greenlandStatisticalTestsValues2016"><sup>3</sup></span>;<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup>5</sup></span>]</p>
<p>A simple, mathematically rigorous definition of a <img src="https://latex.codecogs.com/png.latex?P">-value (for those interested) is given by <a href="https://www.stat.berkeley.edu/~stark/Preprints/pValues.pdf">Stark (2015)</a>.</p>
<hr>
<blockquote class="blockquote">
<p>Let <img src="https://latex.codecogs.com/png.latex?P"> be the probability distribution of the data <img src="https://latex.codecogs.com/png.latex?X">, which takes values in the measurable space <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BX%7D">. Let <img src="https://latex.codecogs.com/png.latex?%5Cleft%5C%7BR_%7B%5Calpha%7D%5Cright%5C%7D_%7B%5Calpha%20%5Cin%5B0,1%5D%7D"> be a collection of <img src="https://latex.codecogs.com/png.latex?P"> -measurable subsets of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BX%7D"> such that (1) <img src="https://latex.codecogs.com/png.latex?P%5Cleft(R_%7B%5Calpha%7D%5Cright)=%5Calpha"> and (2) If <img src="https://latex.codecogs.com/png.latex?%5Calpha%5E%7B%5Cprime%7D%3C%5Calpha"> then <img src="https://latex.codecogs.com/png.latex?R_%7B%5Calpha%5E%7B%5Cprime%7D%7D%20%5Csubset%20R_%7B%5Calpha%7D">. Then the <img src="https://latex.codecogs.com/png.latex?P">-value of <img src="https://latex.codecogs.com/png.latex?H_%7B0%7D"> for data <img src="https://latex.codecogs.com/png.latex?X=x"> is inf <img src="https://latex.codecogs.com/png.latex?_%7B%5Calpha%20%5Cin%5B0,1%5D%7D%5Cleft%5C%7B%5Calpha:%20x%20%5Cin%20R_%7B%5Calpha%7D%5Cright%5C%7D">.</p>
</blockquote>
<hr>
<p>A descriptive but technical definition is given by Sander Greenland below. The description can seem dense, so feel free to skip over it for now and revisit it after reading the rest of the post.</p>
<hr>
<blockquote class="blockquote">
<p>A single <img src="https://latex.codecogs.com/png.latex?P">-value <img src="https://latex.codecogs.com/png.latex?p"> is the quantile location of a directional measure of divergence <img src="https://latex.codecogs.com/png.latex?t"> = <img src="https://latex.codecogs.com/png.latex?t(y;M)"> of the data point <img src="https://latex.codecogs.com/png.latex?y"> (usually, the vector in <img src="https://latex.codecogs.com/png.latex?n">-space formed by <img src="https://latex.codecogs.com/png.latex?n"> individual observations) from a test model manifold <img src="https://latex.codecogs.com/png.latex?M"> in the <img src="https://latex.codecogs.com/png.latex?n">-dimensional expectation space defined the logical structure of the data generator (“experiment” or causal structure) that produced the data <img src="https://latex.codecogs.com/png.latex?y">. <img src="https://latex.codecogs.com/png.latex?M"> is the subset of the <img src="https://latex.codecogs.com/png.latex?Y">-space into which the conjunction of the model constraints (assumptions) force the data expectation or predict where y would be were there no ‘random’ variability. I also use <img src="https://latex.codecogs.com/png.latex?M"> to denote the set of all the model constraints, as well as their conjunction.</p>
<p>With this logical set-up, the observed <img src="https://latex.codecogs.com/png.latex?P">-value is the quantile <img src="https://latex.codecogs.com/png.latex?p"> for the observed value <img src="https://latex.codecogs.com/png.latex?t"> of <img src="https://latex.codecogs.com/png.latex?T"> = <img src="https://latex.codecogs.com/png.latex?t(Y;M)">. This <img src="https://latex.codecogs.com/png.latex?p"> is read off a reference distribution <img src="https://latex.codecogs.com/png.latex?F%20=%20F(t;M)"> for <img src="https://latex.codecogs.com/png.latex?T"> derived from <img src="https://latex.codecogs.com/png.latex?M">. This formulation is essentially that of the “value of P” appearing in Pearson’s seminal 1900 paper on goodness-of-fit tests. Notably, his famed chi-squared statistic is the squared Euclidean distance from <img src="https://latex.codecogs.com/png.latex?y"> to <img src="https://latex.codecogs.com/png.latex?M">, with coordinates expressed in standard-deviation units derived from <img src="https://latex.codecogs.com/png.latex?M">.</p>
<p>More broadly, the statistic <img src="https://latex.codecogs.com/png.latex?T"> can be taken as a measure of divergence of a more general embedding or background model manifold <img src="https://latex.codecogs.com/png.latex?A"> (which includes all ‘auxiliary’ assumptions) from a more restrictive model <img src="https://latex.codecogs.com/png.latex?M">, with the goodness-of-fit case taking <img src="https://latex.codecogs.com/png.latex?A"> as a saturated model covering the entire observation space, and the more common “hypothesis testing” case taking M as the conjunction of an unsaturated <img src="https://latex.codecogs.com/png.latex?A"> with a targeted ‘test’ constraint (or set of constraints) <img src="https://latex.codecogs.com/png.latex?H">. This <img src="https://latex.codecogs.com/png.latex?H"> is logically independent of <img src="https://latex.codecogs.com/png.latex?A"> and consistent with <img src="https://latex.codecogs.com/png.latex?A">, with <img src="https://latex.codecogs.com/png.latex?M"> = <img src="https://latex.codecogs.com/png.latex?H"> &amp; <img src="https://latex.codecogs.com/png.latex?A"> in logical terms, or <img src="https://latex.codecogs.com/png.latex?M"> = <img src="https://latex.codecogs.com/png.latex?H"> + <img src="https://latex.codecogs.com/png.latex?A"> in set-theoretic terms with + being union (in particular, we assume no element in <img src="https://latex.codecogs.com/png.latex?H"> is entailed or contradicted by <img src="https://latex.codecogs.com/png.latex?A"> and no element in <img src="https://latex.codecogs.com/png.latex?A"> is entailed or contradicted by <img src="https://latex.codecogs.com/png.latex?H">).</p>
</blockquote>
<hr>
</section>
<section id="misleading-definitions" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="misleading-definitions"><span class="header-section-number">1.2</span> Misleading Definitions</h2>
<hr>
<p>It is very common to see the <img src="https://latex.codecogs.com/png.latex?P">-value defined as</p>
<hr>
<blockquote class="blockquote">
<p><strong>The probability of obtaining test results at least as extreme as the results actually observed, under the assumption that the null hypothesis is correct.</strong></p>
</blockquote>
<hr>
<p>Indeed, this is the actual definition currently given on the <a href="https://en.wikipedia.org/wiki/P-value">Wikipedia page for the topic</a>, however, it is inadequate and misleading because it hides and reifies the other assumptions used to compute the <img src="https://latex.codecogs.com/png.latex?P">-value and exclusively focuses on the null hypothesis.</p>
<p>The test hypothesis (often the null hypothesis) is only one component of the entire model that is being tested. This is reflected in the first definition I gave above, which explicitly emphasizes that every model assumption must be true. Thus, the <img src="https://latex.codecogs.com/png.latex?P">-value is sensitive to all these assumptions and their violation(s).</p>
<hr>
</section>
<section id="auxilliary-assumptions" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="auxilliary-assumptions"><span class="header-section-number">1.3</span> Auxilliary Assumptions</h2>
<hr>
<p>Some of these key <strong>assumptions</strong> behind the computation of a <img src="https://latex.codecogs.com/png.latex?P">-value are that some sort of <strong>random process was employed</strong> (random sampling, random assignment, etc.), that there are <strong>no uncontrolled sources of bias</strong> (confounding, programming errors, equipment defects, sparse-data bias)[<span class="citation" data-cites="greenlandSparseDataBias2016"><sup>6</sup></span>] in the results, and that <strong>the test hypothesis</strong> (often the null hypothesis) <strong>is correct</strong>. Some of these assumptions can be seen in the figure below from [<span class="citation" data-cites="greenlandAidScientificInference2020"><sup>7</sup></span>], which will be discussed later on. This entire set of assumptions is generally referred to as the <em>test model</em>, and that is because the entire assumed model is being tested.</p>
<hr>
<figure class="figure">
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1605000180/Site/pvalueassumptions.svg" alt="P-value assumptions" width="500" style="cursor: zoom-in" class="figure-img"></p>
<figcaption>
Conditional versus unconditional interpretations of P-values, S-values, and compatibility intervals (CIs). (A) Conditional interpretation, in which background model assumptions, such as no systematic error, are assumed to be correct; thus,the information provided by the P-value and S-value is targeted towards the test hypothesis. (B)Unconditional interpretation, in which no aspect of the statistical model is assumed to be correct; thus,the information provided by the P-value and S-value is targeted toward the entire test model.
</figcaption>
</figure>
<hr>
<p>We often start from the position that all those assumptions are correct (hence, we “condition” on them, even though they are often not correct)[<span class="citation" data-cites="greenlandAidScientificInference2020"><sup>7</sup></span>] when calculating the <img src="https://latex.codecogs.com/png.latex?P">-value, so that any deviation of the data from what was expected under those assumptions would be <strong>purely random error</strong>. But in reality such deviations could also be the result of <strong>any</strong> assumptions being false, including <em>but not limited to</em> the test hypothesis.</p>
<hr>
<blockquote class="blockquote">
<p>Note: “Conditioning” here refers to taking the assumptions in the model as given, and should not be confused with conditional probability.</p>
</blockquote>
<hr>
<p>For example, in high-energy physics, neutrinos were found in one study to be faster than light due to the resulting large test statistic and corresponding small <img src="https://latex.codecogs.com/png.latex?P">-value, but this result was later found to be a result of a defect in the fiber-optic timing system for that experiment.[<span class="citation" data-cites="moskowitzFasterthanlightNeutrinosAren2012"><sup>8</sup></span>] Thus, the low <img src="https://latex.codecogs.com/png.latex?P">-value was not because the assumed null hypothesis was false, but instead due to a bias in the procedure.</p>
<p>So the <img src="https://latex.codecogs.com/png.latex?P">-value <strong>cannot</strong> be the probability of one of these assumptions, such as <em>“the probability of getting results due to chance alone.”</em> A statement like this is <strong>backwards</strong> because it’s quantifying one of the assumptions behind the computation of a <img src="https://latex.codecogs.com/png.latex?P">-value.</p>
<p>This assumption of chance causing the results is assumed to be true (aka 100%) along with several other things, when calculating the <img src="https://latex.codecogs.com/png.latex?P">-value, but this does not mean it is actually correct and the calculation of the <img src="https://latex.codecogs.com/png.latex?P">-value <em>cannot</em> be the <em>probability</em> of one of those <strong>assumptions</strong>.</p>
<hr>
</section>
<section id="probability-of-what" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="probability-of-what"><span class="header-section-number">1.4</span> Probability of What?</h2>
<hr>
<p>It is also important to clarify that <img src="https://latex.codecogs.com/png.latex?P">-values are not <em>probabilities of data</em> or parameter values, which many like to say to differentiate from probabilities of hypotheses. Rather, <img src="https://latex.codecogs.com/png.latex?P">-values are probabilities of “data features”, such as test statistics (i.e.&nbsp;a z-score or <img src="https://latex.codecogs.com/png.latex?%5Cchi%5E%7B2%7D"> statistic) or can be interpreted as the percentile at which the observed test statistic falls within the expected distribution for the test statistic, assuming all the model assumptions are true.[<span class="citation" data-cites="perezgonzalezPvaluesPercentilesCommentary2015"><sup>9</sup></span>;<span class="citation" data-cites="fraserPvalueFunctionStatistical2019"><sup>10</sup></span>]</p>
<hr>
</section>
<section id="properties-uniformity" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="properties-uniformity"><span class="header-section-number">1.5</span> Properties (Uniformity)</h2>
<hr>
<p>A <img src="https://latex.codecogs.com/png.latex?P">-value is considered to be valid if over repeated trials it would be uniform when the tested hypothesis and all other assumptions used to compute the <img src="https://latex.codecogs.com/png.latex?P">-value are correct (see the histogram below to see what this looks like). Typically, this test hypothesis is a null hypothesis where the tested parameter value is usually 0 or 1, but this property applies to any test hypothesis for any parameter value. Thus, there is the random variable <img src="https://latex.codecogs.com/png.latex?P">, which (when valid) follows this uniform distribution, and the realization of this random variable, <img src="https://latex.codecogs.com/png.latex?p">, which is the observed <img src="https://latex.codecogs.com/png.latex?P">-value. The latter is what most researchers are interpreting from studies.</p>
<p>Thus, if we were to simulate two variables that are practically the same (meaning there’s no difference between them) and then compare them, say, using a t-test, and we were to iterate this process 10000 times and plot the distribution of the observed P-values, it would be uniform, indicating that any P-value within the interval from 0-1 is just as likely as any other to be observed.</p>
<hr>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @title Simulation of valid P-values where test hypothesis is true</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param X The first variable we are simulating </span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param Y The second variable we are simulating </span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param n.sim # The number of simulations</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param t The object storing the t-test results</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param t.sim # Empty numeric vector to contain values</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param n.samp # Sample size in each group</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @NOTE The null hypothesis does not have to be 0, it can be any value.</span></span>
<span id="cb1-9"></span>
<span id="cb1-10">n.sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span></span>
<span id="cb1-11">t.sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n.sim)</span>
<span id="cb1-12">n.samp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n.sim) {</span>
<span id="cb1-15">  X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-16">  Y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n.samp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-17">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(X, Y)</span>
<span id="cb1-18">  t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t.test</span>(X, Y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mu =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">paired =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb1-19">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var.equal =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df)</span>
<span id="cb1-20">  t.sim[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> t[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]]</span>
<span id="cb1-21">}</span></code></pre></div>
<pre><code>#&gt; Error in theme_less(): could not find function "theme_less"</code></pre>
<hr>
<p>Many frequentist statisticians do not consider <img src="https://latex.codecogs.com/png.latex?P">-values to be valid/useful if they fail to meet this validity criterion of being uniform, hence they do not recognize variants such as the posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-value (which concentrates around values such as 0.5, rather than being uniform) to be valid.</p>
<p>Indeed, there have been great efforts to calibrate the <img src="https://latex.codecogs.com/png.latex?P">-value which ranges from mathematical solutions such as taking the <img src="https://latex.codecogs.com/png.latex?(1%20+%20%5B-e*p*%5Clog(p)%5D%5E%7B-1%7D)%5E%7B-1%7D"> which gives the lower bound on the conditional type I error,[<span class="citation" data-cites="sellkeCalibrationValuesTesting2001"><sup>11</sup></span>;<span class="citation" data-cites="greenlandTechnicalIssuesInterpretation2020"><sup>12</sup></span>] to taking the <img src="https://latex.codecogs.com/png.latex?C_%7B1%7D(K):=%5Csqrt%7BK%7D-1"> of the <img src="https://latex.codecogs.com/png.latex?P">-value (the square-root calibrator), yielding a test martingale,[<span class="citation" data-cites="shaferTestMartingalesBayes2011"><sup>13</sup></span>] or even empirically attempting to recalibrate the <img src="https://latex.codecogs.com/png.latex?P">-value by collecting observed <img src="https://latex.codecogs.com/png.latex?P">-values from observational studies with negative controls (“test-hypotheses where the exposure is not believed to cause the outcome”) and using them to calculate the empirical null distribution.[<span class="citation" data-cites="schuemieRobustEmpiricalCalibration2016"><sup>14</sup></span>]</p>
<p>The latter is done since observational studies are prone to several more biases than controlled, randomized experiments, thus the observed <img src="https://latex.codecogs.com/png.latex?P">-values and estimated effect sizes are used to calculate the systematic errors within the sampling distribution and are used for recalibration of the <img src="https://latex.codecogs.com/png.latex?P">-value. Whether or not this approach is effective, however, is a different matter.[<span class="citation" data-cites="gruberLimitationsEmpiricalCalibration2016"><sup>15</sup></span>] In short, calibration is an often sought-out property of <img src="https://latex.codecogs.com/png.latex?P">-values.</p>
<p>Many frequentist statisticians do not consider <img src="https://latex.codecogs.com/png.latex?P">-values to be valid/useful if they fail to meet this validity criterion of being uniform, hence they do not recognize variants such as the posterior predictive <img src="https://latex.codecogs.com/png.latex?P">-value (which concentrates around values such as 0.5, rather than being uniform) to be valid.</p>
<p>Indeed, there have been great efforts to calibrate the <img src="https://latex.codecogs.com/png.latex?P">-value which ranges from mathematical solutions such as taking the <img src="https://latex.codecogs.com/png.latex?(1%20+%20%5B-e*p*%5Clog(p)%5D%5E%7B-1%7D)%5E%7B-1%7D"> which gives the lower bound on the conditional type I error,[<span class="citation" data-cites="sellkeCalibrationValuesTesting2001"><sup>11</sup></span>;<span class="citation" data-cites="greenlandTechnicalIssuesInterpretation2020"><sup>12</sup></span>] to taking the <img src="https://latex.codecogs.com/png.latex?C_%7B1%7D(K):=%5Csqrt%7BK%7D-1"> of the <img src="https://latex.codecogs.com/png.latex?P">-value (the square-root calibrator), yielding a test martingale,[<span class="citation" data-cites="shaferTestMartingalesBayes2011"><sup>13</sup></span>] or even empirically attempting to recalibrate the <img src="https://latex.codecogs.com/png.latex?P">-value by collecting observed <img src="https://latex.codecogs.com/png.latex?P">-values from observational studies with negative controls (“test-hypotheses where the exposure is not believed to cause the outcome”) and using them to calculate the empirical null distribution.[<span class="citation" data-cites="schuemieRobustEmpiricalCalibration2016"><sup>14</sup></span>]</p>
<p>The latter is done since observational studies are prone to several more biases than controlled, randomized experiments, thus the observed <img src="https://latex.codecogs.com/png.latex?P">-values and estimated effect sizes are used to calculate the systematic errors within the sampling distribution and are used for recalibration of the <img src="https://latex.codecogs.com/png.latex?P">-value. Whether or not this approach is effective, however, is a different matter.[<span class="citation" data-cites="gruberLimitationsEmpiricalCalibration2016"><sup>15</sup></span>] In short, calibration is an often sought-out property of <img src="https://latex.codecogs.com/png.latex?P">-values.</p>
<hr>
</section>
</section>
<section id="the-different-interpretations" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> The Different Interpretations</h1>
<hr>
<section id="the-decision-theoretic-approach" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="the-decision-theoretic-approach"><span class="header-section-number">2.1</span> The Decision-Theoretic Approach</h2>
<hr>
<p>Many researchers interpret the <img src="https://latex.codecogs.com/png.latex?P">-value in a behavioral, decision-guiding way such as being statistically significant or not (defined below) depending on whether observed <em>p</em> from a study (the realization of the random variable <img src="https://latex.codecogs.com/png.latex?P">) falls below a fixed cutoff level (<img src="https://latex.codecogs.com/png.latex?%5Calpha">, which is the maximum tolerable type I error rate).[<span class="citation" data-cites="neymanProblemMostEfficient1933"><sup>16</sup></span>]</p>
<hr>
</section>
<section id="statistical-significance" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="statistical-significance"><span class="header-section-number">2.2</span> Statistical Significance</h2>
<hr>
<p>Thus, in this approach, users do not care how small or large the observed <img src="https://latex.codecogs.com/png.latex?P">-value <img src="https://latex.codecogs.com/png.latex?p"> is, but simply, whether or not it fell beneath the pre-specified <img src="https://latex.codecogs.com/png.latex?%5Calpha"> level (often 0.05). If it falls below <img src="https://latex.codecogs.com/png.latex?%5Calpha"> they behave inline with the rejection of this test hypothesis, and if it fails to fall below <img src="https://latex.codecogs.com/png.latex?%5Calpha">, then they must behave in a manner where they accept this test hypothesis. The phrase <em>statistical significance</em>, simply indicates that the observed <img src="https://latex.codecogs.com/png.latex?P">-value <img src="https://latex.codecogs.com/png.latex?p"> fell below this pre-specified <img src="https://latex.codecogs.com/png.latex?%5Calpha"> level, and nothing else. It does not indicate any meaningful significance on its own.</p>
<p>The pioneers of this approach, Jerzy Neyman and Egon Pearson, define this behavioral guidance in their 1933 paper, “On the Problem of the Most Efficient Tests of Statistical Hypotheses”[<span class="citation" data-cites="neymanProblemMostEfficient1933"><sup>16</sup></span>]</p>
<hr>
<blockquote class="blockquote">
<p>Without hoping to know whether each separate hypothesis is true or false, we may search for rules to govern our behavior with regard to them, in following which we insure that, in the long run of experience, we shall not be too often wrong.</p>
</blockquote>
<hr>
<p>This decision-making framework may be useful in certain scenarios,[<span class="citation" data-cites="whiteheadCaseFrequentismClinical1993"><sup>17</sup></span>] where some sort of randomization is possible, where experiments can be repeated, and where there is large control over the experimental conditions, with one of the most notable historical examples being Egon Pearson (son of Karl Pearson and coauthor of Jerzy Neyman) using it to <a href="https://www.ams.org/journals/bull/1936-42-09/S0002-9904-1936-06365-2/S0002-9904-1936-06365-2.pdf">improve quality control</a> in industrial settings.</p>
<p>Contrary to some claims,[<span class="citation" data-cites="rubinWhatTypeType2019"><sup>18</sup></span>] this approach does <strong>NOT</strong> require exact replications of the experiments, instead, it requires that a valid <img src="https://latex.codecogs.com/png.latex?%5Calpha"> level is used consistently.[<span class="citation" data-cites="neymanProblemMostEfficient1933"><sup>16</sup></span>;<span class="citation" data-cites="Lehmann2011-vs"><sup>19</sup></span>] In this approach, the exact, observed <img src="https://latex.codecogs.com/png.latex?P">-value from a study is not as relevant and cannot validly be interpreted without an entire set of studies that are compared to the fixed error rate (<img src="https://latex.codecogs.com/png.latex?%5Calpha">).</p>
<hr>
<figure class="figure">
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700110/Site/classicalgiants.png" alt="Picture of the giants who founded frequentist statistics such as Egon Pearson, Ronald Fisher, and Jerzy Neyman" width="800" style="cursor: zoom-in" class="figure-img"></p>
<figcaption>
From left to right: Ronald A. Fisher, Jerzy Neyman, and Egon Pearson.
</figcaption>
</figure>
<hr>
</section>
<section id="the-inductive-approach" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="the-inductive-approach"><span class="header-section-number">2.3</span> The Inductive Approach</h2>
<hr>
<p>Others interpret the <img src="https://latex.codecogs.com/png.latex?P">-value <img src="https://latex.codecogs.com/png.latex?p"> in an inductive inferential/evidential (<strong>Fisherian</strong>) way,[<span class="citation" data-cites="fisherDesignExperiments1935"><sup>20</sup></span>;<span class="citation" data-cites="fisherStatisticalMethodsScientific1955"><sup>21</sup></span>] as a <strong>continuous</strong> measure of evidence against the very test hypothesis and entire model (all assumptions) used to compute it (let’s go with this for now, even though there are some problems with this interpretation, more on that below).</p>
<p>This interpretation as a continuous measure of evidence <strong>against</strong> the test hypothesis and the entire model used to compute it can be seen in the figure below from[<span class="citation" data-cites="greenlandAidScientificInference2020"><sup>7</sup></span>]. In one framework (left panel), we may assume certain assumptions to be true (“conditioning” on them, i.e, use of random assignment), and in the other (right panel), we question all assumptions, hence the “unconditional” interpretation. Unlike the <strong>Neyman-Pearson</strong> approach, this inferential approach allows interpretation of <img src="https://latex.codecogs.com/png.latex?P">-values from single studies, and indeed, lower values of it are taken as more evidence against the tested hypothesis.</p>
<hr>
</section>
<section id="null-hypothesis-significance-testing" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="null-hypothesis-significance-testing"><span class="header-section-number">2.4</span> Null-Hypothesis Significance Testing</h2>
<hr>
<p>However, it is also worth pointing out that most individuals do not interpret <img src="https://latex.codecogs.com/png.latex?P">-values from a <strong>Neyman-Pearson</strong> or <strong>Fisherian</strong> standpoint, rather, they fuse both approaches together, which is what we commonly know today as “null-hypothesis significance testing.” This approach is regarded by most as being a incompatible hybrid given that it often confuses error rates (<img src="https://latex.codecogs.com/png.latex?%5Calpha">, <img src="https://latex.codecogs.com/png.latex?%5Cbeta">), which are fixed before a study, with the <img src="https://latex.codecogs.com/png.latex?P">-value, which is not a fixed error-rate, and the fusion of these approaches often has been blamed for the replication crisis in science by many statisticians. Though some believe these approaches can be reconciled and are useful.[<span class="citation" data-cites="bickelNullHypothesisSignificance2019"><sup>22</sup></span>]</p>
<hr>
<figure class="figure">
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1605000180/Site/pvalueassumptions.svg" alt="P-value assumptions" width="500" style="cursor: zoom-in" class="figure-img"></p>
<figcaption>
Conditional versus unconditional interpretations of P-values, S-values, and compatibility intervals (CIs). (A) Conditional interpretation, in which background model assumptions, such as no systematic error, are assumed to be correct; thus,the information provided by the P-value and S-value is targeted towards the test hypothesis. (B)Unconditional interpretation, in which no aspect of the statistical model is assumed to be correct; thus,the information provided by the P-value and S-value is targeted toward the entire test model.
</figcaption>
</figure>
<hr>
<p>Back to the <strong>Fisherian</strong> approach, the interpretation of the <img src="https://latex.codecogs.com/png.latex?P">-value as a continuous measure of evidence against the test model that produced it shouldn’t be confused with other statistics that serve as support measures. Likelihood ratios and Bayes factors are <strong>absolute</strong> measures of evidence <strong>for</strong> a model compared to another model, whereas the <img src="https://latex.codecogs.com/png.latex?P">-value is a <strong>relative</strong> measure of “evidence” (more on that below) that can be tricky to interpret.[<span class="citation" data-cites="jeffreysTestsSignificanceTreated1935"><sup>23</sup></span>;<span class="citation" data-cites="jeffreysTheoryProbability1998"><sup>24</sup></span>;<span class="citation" data-cites="royallStatisticalEvidenceLikelihood1997"><sup>25</sup></span>] Indeed, this is why the <img src="https://latex.codecogs.com/png.latex?P">-value is converted by some Bayesians to a lower bound of the Bayes factor by taking <img src="https://latex.codecogs.com/png.latex?-e*p*%5Clog(p)">.[<span class="citation" data-cites="sellkeCalibrationValuesTesting2001"><sup>11</sup></span>;<span class="citation" data-cites="greenlandTechnicalIssuesInterpretation2020"><sup>12</sup></span>]</p>
<hr>
</section>
<section id="measure-of-compatibility" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="measure-of-compatibility"><span class="header-section-number">2.5</span> Measure of Compatibility</h2>
<hr>
<p>The <img src="https://latex.codecogs.com/png.latex?P">-value is not an absolute measure of evidence for a model (such as the null/alternative model), it is a continuous <strong>measure of the compatibility</strong> of the <strong>observed data</strong> with the <strong>model</strong> used to compute it.[<span class="citation" data-cites="greenlandStatisticalTestsValues2016"><sup>3</sup></span>]</p>
<p>If it’s high, it means the observed data are <strong>very compatible</strong> with the model used to compute it. If it’s very low, then it indicates that the data are <strong>not as compatible</strong> with the model used to calculate it, and this low compatibility may be due to random variation and/or it may be due to a violation of assumptions (such as the null model not being true, not using randomization, a programming error or equipment defect such as that <a href="https://www.washingtonpost.com/blogs/compost/post/faster-than-light-neutrinos-arent/2012/02/23/gIQA5MmjVR_blog.html">seen with neutrinos</a>, etc.).</p>
<p>Low compatibility of the data with the model can be implied as evidence against the test hypothesis, if we accept the rest of the model used to compute the <img src="https://latex.codecogs.com/png.latex?P">-value. Thus, lower <img src="https://latex.codecogs.com/png.latex?P">-values from a <strong>Fisherian</strong> perspective are seen as stronger evidence against the test hypothesis given the rest of the model.</p>
<hr>
</section>
</section>
<section id="common-misleading-criticisms" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Common, Misleading Criticisms</h1>
<hr>
<section id="estimation-and-intervals" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="estimation-and-intervals"><span class="header-section-number">3.1</span> Estimation and Intervals</h2>
<hr>
<p>A common criticism put forth by many is that <img src="https://latex.codecogs.com/png.latex?P">-values are useless, given that they cannot tell you the size of the effect and because they are confounded by sample size and effect size, and that researchers should instead give compatibility (confidence) intervals. However, this criticism is nonsensical as they can both be given and serve different purposes.</p>
<p>A <img src="https://latex.codecogs.com/png.latex?P">-value for a particular parameter value gives the compatibility between the test model in question, which will vary from one parameter value to the next, and the data. An interval estimate such as a 95% frequentist interval simply gives the region of parameter values with <img src="https://latex.codecogs.com/png.latex?P">-values above the corresponding <img src="https://latex.codecogs.com/png.latex?%5Calpha"> level, and which are more consistent with the data than the parameter values outside the interval limits. An interval estimate by itself does not explicitly tell one how consistent a parameter value is with the data, which the <img src="https://latex.codecogs.com/png.latex?P">-value does.</p>
<hr>
</section>
<section id="overstating-the-evidence" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="overstating-the-evidence"><span class="header-section-number">3.2</span> Overstating the Evidence</h2>
<hr>
<p><img src="https://latex.codecogs.com/png.latex?P">-values are routinely criticized for overstating the amount of evidence from a study. Such statements are also often given using Bayesian arguments, of which many are skeptical. However, the <img src="https://latex.codecogs.com/png.latex?P">-value cannot overstate evidence as it is simply providing the location at which the test statistic fell in the expected distribution, given that every model assumption were true. It is simply indicative of how surprising/extreme the observed result was, given certain assumptions.</p>
<p>Any overstating of evidence, is not an issue of the statistic itself, but rather users. If we treat the <img src="https://latex.codecogs.com/png.latex?P-"> value as nothing more or less than a continuous measure of compatibility of the observed data with the model used to compute it (observed <img src="https://latex.codecogs.com/png.latex?p">) given certain model assumptions, we won’t run into some of the common misinterpretations such as “the <img src="https://latex.codecogs.com/png.latex?P">-value is the probability of a hypothesis”, or the “probability of chance alone”, or “the probability of being incorrect”.[<span class="citation" data-cites="greenlandStatisticalTestsValues2016"><sup>3</sup></span>]</p>
<p>Indeed, many of the “problems” commonly associated with the <img src="https://latex.codecogs.com/png.latex?P">-value are not due to the actual statistic itself, but rather researchers’ misinterpretations of what it is and what it means for a study.</p>
<p>The answer to these misconceptions may be compatibilism, with less compatibility (smaller <img src="https://latex.codecogs.com/png.latex?P">-values) indicating a poor fit between the data and the test model and hence more evidence against the test hypothesis.</p>
<p>A <img src="https://latex.codecogs.com/png.latex?P">-value of 0.04 means that assuming that <strong>all</strong> the assumptions of the model used to compute the <img src="https://latex.codecogs.com/png.latex?P">-value are correct, we won’t get data (a test statistic) at least as extreme as what was observed by random variation more than 4% of the time.</p>
<p>To many, such low compatibility between the data and the model may lead them to reject the test hypothesis (the null hypothesis).</p>
<hr>
</section>
</section>
<section id="some-valid-issues" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Some Valid Issues</h1>
<hr>
<section id="mismatch-with-direction" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="mismatch-with-direction"><span class="header-section-number">4.1</span> Mismatch With Direction</h2>
<hr>
<p>If you recall from above, I wrote that the <img src="https://latex.codecogs.com/png.latex?P">-value is seen by many as being a continuous measure of evidence against the test hypothesis and model. Technically speaking, it would be incorrect to define it this way because as the <img src="https://latex.codecogs.com/png.latex?P">-value goes up (with the highest value being 1 or 100%), there is <strong>less</strong> evidence against the test hypothesis since the data are <strong>more compatible</strong> with the test model. 1 = perfect compatibility of the data with the test model.</p>
<p>As the <img src="https://latex.codecogs.com/png.latex?P">-value gets lower (with the lowest value being 0), there is <strong>less compatibility</strong> between the data and the model, hence <strong>more</strong> evidence against the test hypothesis used to compute <img src="https://latex.codecogs.com/png.latex?p">.</p>
<p>Thus, saying that <img src="https://latex.codecogs.com/png.latex?P">-values are measures of evidence against the hypothesis used to compute them is a backward definition. This definition would be correct if higher <img src="https://latex.codecogs.com/png.latex?P">-values inferred more evidence against the test hypothesis and vice versa.</p>
<hr>
</section>
<section id="difficulties-due-to-scale" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="difficulties-due-to-scale"><span class="header-section-number">4.2</span> Difficulties Due to Scale</h2>
<hr>
<p>Another problem with <img src="https://latex.codecogs.com/png.latex?P">-values and their interpretation is scaling. Since the statistic is meant to be a continuous measure of compatibility (and relative evidence against the test model + hypothesis), we would hope that differences between <img src="https://latex.codecogs.com/png.latex?P">-values would be equal (on an additive scale), as this makes it easier to interpret.</p>
<p>For example, the difference between 0 and 10 dollars is the same as the difference between 90 and 100 dollars, in that both are a difference of 10 dollars. And this property remains consistent across various intervals, 120 and 130, 1,000,000 and 1,000,010.</p>
<p>Unfortunately, this doesn’t apply to the <img src="https://latex.codecogs.com/png.latex?P">-value because it is on the inverse-exponential scale. The difference between a <img src="https://latex.codecogs.com/png.latex?P">-value of 0.01 and 0.10 is not the same as the difference between 0.90 and 0.99.</p>
<hr>
<figure class="figure">
<p><img src="https://lesslikely.com/images/norm.svg" alt="Gaussian distribution" width="680" style="cursor: zoom-in" class="figure-img"></p>
<figcaption>
A gaussian probability densitiy with the standard deviations annotated. Data points further away from the mean, are more extreme and unlikely events. I also must admit that this is one of my favorite figures of a gaussian distribution.
</figcaption>
</figure>
<hr>
<hr>
<p>For example, with a normal distribution (above), a z-score of 0 results in a <img src="https://latex.codecogs.com/png.latex?P">-value of 1 (perfect compatibility). If we now move to a z-score of 1, the <img src="https://latex.codecogs.com/png.latex?P">-value is 0.31. Thus, we saw a dramatic decrease from a <img src="https://latex.codecogs.com/png.latex?P">-value of 1 to 0.31 with one z-score. A 0.69 decrease in the <img src="https://latex.codecogs.com/png.latex?P">-value.</p>
<p>Now let’s move from a z-score of 1 to a z-score of 2. We saw a decrease of 0.69 with the change in <strong>one</strong> z-score before, so the new <img src="https://latex.codecogs.com/png.latex?P">-value must be 0.31 - 0.69 = -0.38 right? <strong>No</strong>. The <img src="https://latex.codecogs.com/png.latex?P">-value for a z-score of 2 is 0.045. The <img src="https://latex.codecogs.com/png.latex?P">-value for a z-score of 3 is 0.003. Even though we’ve only been moving by <strong>one</strong> z-score at a time, the changes in <img src="https://latex.codecogs.com/png.latex?P">-values don’t remain constant; the decreases become larger and larger.</p>
<p>Thus, the difference between the <img src="https://latex.codecogs.com/png.latex?P">-values of 0.01 and 0.10, in terms of z-score, is substantially larger than the difference between 0.90 and 0.99. Again, this makes it difficult to interpret as a statistic across the board, especially as a continuous measure. This can further be seen in the figure from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland (2020)</a>.</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="resolution-with-surprisals" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Resolution with Surprisals</h1>
<hr>
<p>The issues described above such as the backward definition and the problem of scaling can make it difficult to conceptualize the <img src="https://latex.codecogs.com/png.latex?P">-value as being an evidence measure against the test hypothesis and test model. However, these issues can be addressed by taking the negative log of the <img src="https://latex.codecogs.com/png.latex?P">-value <img src="https://latex.codecogs.com/png.latex?%E2%80%93%5Clog_%7B2%7D(p)"> , which yields something known as the Shannon information value or <em>surprisal (</em><img src="https://latex.codecogs.com/png.latex?s">) value,[<span class="citation" data-cites="rafiSemanticCognitiveTools2020"><sup>4</sup></span>;<span class="citation" data-cites="coleSurprise2020"><sup>26</sup></span>;<span class="citation" data-cites="greenlandValidPvaluesBehave2019"><sup>5</sup></span>] named after <a href="https://en.wikipedia.org/wiki/Claude_Shannon">Claude Shannon</a>, the father of information theory.[<span class="citation" data-cites="Shannon1948-uq"><sup>27</sup></span>]</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>Unlike the <img src="https://latex.codecogs.com/png.latex?P">-value, this value is not a probability but a continuous measure of <em>information</em> in <strong>bits</strong> of information against the test hypothesis and is taken from the observed test statistic computed by the test model.</p>
<p>It also provides a more intuitive way to think about <img src="https://latex.codecogs.com/png.latex?P">-values. Imagine that the variable <img src="https://latex.codecogs.com/png.latex?k"> is always the nearest integer to the calculated value of <img src="https://latex.codecogs.com/png.latex?s">. Now, take for example a <img src="https://latex.codecogs.com/png.latex?P">-value of 0.05, the <img src="https://latex.codecogs.com/png.latex?S">-value for this would be <img src="https://latex.codecogs.com/png.latex?s"> = <img src="https://latex.codecogs.com/png.latex?%E2%80%93%5Clog_%7B2%7D(0.05)"> which equals 4.3 bits of information embedded in the test statistic, which can be implied as evidence against the test hypothesis.</p>
<p>How much evidence is this? <img src="https://latex.codecogs.com/png.latex?k"> can help us think about this. The nearest integer to 4.3 is 4. Thus, the data which yield a <img src="https://latex.codecogs.com/png.latex?P">-value of 0.05 which results in an <img src="https://latex.codecogs.com/png.latex?s"> value of 4.3 bits of information is <strong>no more surprising</strong> than getting <strong>all heads</strong> on 4 fair coin tosses.</p>
<p>Another example. Let’s say our study gives us a <img src="https://latex.codecogs.com/png.latex?P">-value of 0.005, which would indicate to many very low compatibility between the test model and the observed data; this would yield an <img src="https://latex.codecogs.com/png.latex?s"> value of <img src="https://latex.codecogs.com/png.latex?%E2%80%93%5Clog_%7B2%7D(0.005)%20=%207.6"> bits of information. <img src="https://latex.codecogs.com/png.latex?k"> which is the closest integer to <img src="https://latex.codecogs.com/png.latex?s"> would be 8. Thus, these data which yield a <img src="https://latex.codecogs.com/png.latex?P">-value of 0.005 are no more surprising than getting all heads on 8 fair coin tosses.</p>
<p>A table of various <img src="https://latex.codecogs.com/png.latex?P">-values and their corresponding <img src="https://latex.codecogs.com/png.latex?S">-values, maximum-likelihood ratios, and likelihood-ratio statistics can be found below from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland (2020)</a>, which includes the general cutoffs used in different scientific fields such as high-energy physics and genome-wide association studies. It also shows how the traditional cutoffs used in these fields can be problematic.</p>
<p>For example, an <img src="https://latex.codecogs.com/png.latex?%5Calpha"> of 0.05, which only corresponds to seeing all heads on 4 fair coin tosses, is practically nothing when compared to the cutoffs used in particle physics and GWAS, which correspond to seeing all heads on 22 and 30 fair coin tosses, respectively.</p>
<hr>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">P-value (compatibility)</th>
<th style="text-align: right;">S-value (bits)</th>
<th style="text-align: right;">Maximum Likelihood Ratio</th>
<th style="text-align: right;">Deviance Statistic 2ln(MLR)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.99</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1.00e+00</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.9</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">1.01e+00</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.5</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.26e+00</td>
<td style="text-align: right;">0.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.25</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">1.94e+00</td>
<td style="text-align: right;">1.32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.1</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">3.87e+00</td>
<td style="text-align: right;">2.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.05</td>
<td style="text-align: right;">4.32</td>
<td style="text-align: right;">6.83e+00</td>
<td style="text-align: right;">3.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.025</td>
<td style="text-align: right;">5.32</td>
<td style="text-align: right;">1.23e+01</td>
<td style="text-align: right;">5.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.01</td>
<td style="text-align: right;">6.64</td>
<td style="text-align: right;">2.76e+01</td>
<td style="text-align: right;">6.63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.005</td>
<td style="text-align: right;">7.64</td>
<td style="text-align: right;">5.14e+01</td>
<td style="text-align: right;">7.88</td>
</tr>
<tr class="even">
<td style="text-align: left;">1e-04</td>
<td style="text-align: right;">13.29</td>
<td style="text-align: right;">1.94e+03</td>
<td style="text-align: right;">15.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5 sigma (~ 2.9 in 10 million)</td>
<td style="text-align: right;">21.70</td>
<td style="text-align: right;">5.20e+05</td>
<td style="text-align: right;">26.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">1 in 100 million (GWAS)</td>
<td style="text-align: right;">26.60</td>
<td style="text-align: right;">1.40e+07</td>
<td style="text-align: right;">32.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6 sigma (~ 1 in a billion)</td>
<td style="text-align: right;">29.90</td>
<td style="text-align: right;">1.30e+08</td>
<td style="text-align: right;">37.40</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style="text-decoration: underline;">Abbreviations: </span></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Table 1: $P$-values and binary $S$-values, with corresponding maximum-likelihood ratios (MLR) and deviance (likelihood-ratio) statistics for a simple test hypothesis H under background assumptions A</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<hr>
<p>Unlike the <img src="https://latex.codecogs.com/png.latex?P">-value, the <img src="https://latex.codecogs.com/png.latex?S">-value is more intuitive as a measure of refutational evidence against the test hypothesis since its value (bits of information against the test hypothesis) increases with less compatibility, whereas the opposite is true for the <img src="https://latex.codecogs.com/png.latex?P">-value.</p>
<hr>
<section id="some-examples" class="level3" data-number="5.0.1">
<h3 data-number="5.0.1" class="anchored" data-anchor-id="some-examples"><span class="header-section-number">5.0.1</span> Some Examples</h3>
<hr>
<p>Let’s try using some data to see this in action. I’ll take a sample experimental dataset from <code>R</code> on the effects of different conditions on dried plant weight. We can plot the data and run a one-way ANOVA.</p>
<hr>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">pg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">force</span>(PlantGrowth)</span>
<span id="cb3-2">(Hmisc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">describe</span>(pg))</span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; pg </span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  2  Variables      30  Observations</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; weight </span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;        n  missing distinct     Info     Mean  pMedian      Gmd      .05 </span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;       30        0       29        1    5.073     5.09   0.8131    3.983 </span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;      .10      .25      .50      .75      .90      .95 </span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;    4.170    4.550    5.155    5.530    6.038    6.132 </span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; lowest : 3.59 3.83 4.17 4.32 4.41, highest: 5.87 6.03 6.11 6.15 6.31</span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; group </span></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;        n  missing distinct </span></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;       30        0        3 </span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;                             </span></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Value       ctrl  trt1  trt2</span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Frequency     10    10    10</span></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Proportion 0.333 0.333 0.333</span></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; --------------------------------------------------------------------------------</span></span></code></pre></div>
<hr>
<p>Looks interesting. We can see some differences from the graph. Here’s what our test output gives us,</p>
<hr>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(weight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> group, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> pg))</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ztable</span>(res)</span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in ztable(res): could not find function "ztable"</span></span></code></pre></div>
<hr>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">(obs_p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> res[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>])</span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 0.01590996</span></span></code></pre></div>
<hr>
<p>If we had set our <img src="https://latex.codecogs.com/png.latex?%5Calpha"> to the traditional 0.05 level before the experiment, we can reject the test hypothesis (the null hypothesis), but that is not as interesting from a continuous evidential perspective. How can I interpret this <img src="https://latex.codecogs.com/png.latex?P">-value of 0.0159 more intuitively?</p>
<p>Let’s convert it into an <img src="https://latex.codecogs.com/png.latex?S">-value.</p>
<hr>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log2</span>(obs_p)</span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 5.97</span></span></code></pre></div>
<hr>
<p><img src="https://latex.codecogs.com/png.latex?%E2%80%93%5Clog_2(0.0159)%20=%205.97"></p>
<hr>
<p><img src="https://latex.codecogs.com/png.latex?s=%205.97"></p>
<hr>
<p>That is 5.97 bits of information against the null hypothesis.</p>
<p>Remember, <img src="https://latex.codecogs.com/png.latex?k"> is the nearest integer to the calculated value of <img src="https://latex.codecogs.com/png.latex?s"> and in this case, would be 6. So these results (the test statistic, <img src="https://latex.codecogs.com/png.latex?F">(4.85)) are as surprising as getting all heads on 6 fair coin tosses. Somewhat surprising, depending on the individual interpreting the results.</p>
<p>How would we interpret it within the context of a given confidence interval? The <img src="https://latex.codecogs.com/png.latex?S">-value tells us that values within the computed 95% CI: have at most 4.3 bits of information against them. That is because all parameter values within a 95% CI have <img src="https://latex.codecogs.com/png.latex?P">-values greater than 0.05.</p>
<p>So those parameter values that are inside the 95% interval estimate have less bits of information against them, than the parameter values that go further and further away from the center of the 95% interval estimate. The point estimate is the most compatible with the data (meaning it has the least refutational information against it), while those values near the limits have more information against them.</p>
<p>In other words, as values head in the directions outside the interval, there is more refutational information against them, as depicted by the following function from <a href="https://doi.org/10.1186/s12874-020-01105-9">Rafi &amp; Greenland, 2020</a>, which is known as the surprisal function.</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>The <img src="https://latex.codecogs.com/png.latex?S">-value is not meant to replace the <img src="https://latex.codecogs.com/png.latex?P">-value, and it isn’t superior to the <img src="https://latex.codecogs.com/png.latex?P">-value. It is merely a logarithmic transformation of it that rescales it on an additive scale and tells us how much information is embedded within the test statistic and can be used as evidence against the test hypothesis. It is meant to be a device to help interpret the information one obtains from a calculated <img src="https://latex.codecogs.com/png.latex?P">-value.</p>
<hr>
<p>I’ve <a href="https://data.lesslikely.com/concurve/articles/svalues.html">constructed a calculator</a> that converts observed <img src="https://latex.codecogs.com/png.latex?P">-values into <img src="https://latex.codecogs.com/png.latex?S">-values and provides an intuitive way to think about them. For a more detailed discussion of <img src="https://latex.codecogs.com/png.latex?S">-values, see this <a href="../../../statistics/RG2020BMC">article</a>, in addition to the references below them.</p>
<hr>
</section>
</section>
<section id="s-value-calculator" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> S-value Calculator</h1>
<hr>
<hr>
<blockquote class="blockquote">
<p><strong>Acknowledgments:</strong> I’m very grateful to <a href="https://twitter.com/Lester_Domes">Sander Greenland</a> for his extensive commentary and corrections on several versions of this article. My acknowledgment does not imply endorsement of my views by these colleagues, and I remain solely responsible for the views expressed herein.</p>
</blockquote>
<hr>
<p>The analyses were run on:</p>
<hr>
<pre><code>#&gt; R version 4.5.0 (2025-04-11)
#&gt; Platform: aarch64-apple-darwin20
#&gt; Running under: macOS Sequoia 15.6.1
#&gt; 
#&gt; Matrix products: default
#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib 
#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1
#&gt; 
#&gt; Random number generation:
#&gt;  RNG:     Mersenne-Twister 
#&gt;  Normal:  Inversion 
#&gt;  Sample:  Rejection 
#&gt;  
#&gt; locale:
#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
#&gt; 
#&gt; time zone: America/New_York
#&gt; tzcode source: internal
#&gt; 
#&gt; attached base packages:
#&gt;  [1] splines   grid      stats4    parallel  stats     graphics  grDevices utils     datasets  methods   base     
#&gt; 
#&gt; other attached packages:
#&gt;  [1] pbmcapply_1.5.1       texPreview_2.1.0      tinytex_0.57          rmarkdown_2.29        brms_2.22.0          
#&gt;  [6] bootImpute_1.2.2      knitr_1.50            boot_1.3-31           reshape2_1.4.4        ProfileLikelihood_1.3
#&gt; [11] ImputeRobust_1.3-1    gamlss_5.4-22         gamlss.dist_6.1-1     gamlss.data_6.0-6     mvtnorm_1.3-3        
#&gt; [16] performance_0.14.0    summarytools_1.1.4    tidybayes_3.0.7       htmltools_0.5.8.1     Statamarkdown_0.9.2  
#&gt; [21] car_3.1-3             carData_3.0-5         qqplotr_0.0.6         ggcorrplot_0.1.4.1    Amelia_1.8.3         
#&gt; [26] Rcpp_1.0.14           blogdown_1.21         doParallel_1.0.17     iterators_1.0.14      foreach_1.5.2        
#&gt; [31] lattice_0.22-7        bayesplot_1.12.0      wesanderson_0.3.7     VIM_6.2.2             colorspace_2.1-1     
#&gt; [36] here_1.0.1            progress_1.2.3        loo_2.8.0             mi_1.1                Matrix_1.7-3         
#&gt; [41] broom_1.0.8           yardstick_1.3.2       svglite_2.2.1         Cairo_1.6-2           cowplot_1.1.3        
#&gt; [46] mgcv_1.9-3            nlme_3.1-168          xfun_0.52             broom.mixed_0.2.9.6   reticulate_1.42.0    
#&gt; [51] kableExtra_1.4.0      posterior_1.6.1       checkmate_2.3.2       parallelly_1.45.0     miceFast_0.8.5       
#&gt; [56] randomForest_4.7-1.2  missForest_1.5        miceadds_3.17-44      mice_3.18.0           quantreg_6.1         
#&gt; [61] SparseM_1.84-2        MCMCpack_1.7-1        MASS_7.3-65           coda_0.19-4.1         latex2exp_0.9.6      
#&gt; [66] rstan_2.32.7          StanHeaders_2.32.10   lubridate_1.9.4       forcats_1.0.0         stringr_1.5.1        
#&gt; [71] dplyr_1.1.4           purrr_1.0.4           readr_2.1.5           tibble_3.2.1          ggplot2_3.5.2        
#&gt; [76] tidyverse_2.0.0       ggtext_0.1.2          concurve_2.7.7        showtext_0.9-7        showtextdb_3.0       
#&gt; [81] sysfonts_0.8.9        future.apply_1.11.3   future_1.58.0         tidyr_1.3.1           magrittr_2.0.3       
#&gt; [86] rms_8.0-0             Hmisc_5.2-3          
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;   [1] dichromat_2.0-0.1       nnet_7.3-20             TH.data_1.1-3           vctrs_0.6.5             digest_0.6.37          
#&gt;   [6] png_0.1-8               shape_1.4.6.1           proxy_0.4-27            magick_2.8.6            fontLiberation_0.1.0   
#&gt;  [11] withr_3.0.2             ggpubr_0.6.0            survival_3.8-3          doRNG_1.8.6.2           emmeans_1.11.1         
#&gt;  [16] MatrixModels_0.5-4      systemfonts_1.2.3       ragg_1.4.0              zoo_1.8-14              V8_6.0.4               
#&gt;  [21] ggdist_3.3.3            DEoptimR_1.1-3-1        Formula_1.2-5           prettyunits_1.2.0       rematch2_2.1.2         
#&gt;  [26] httr_1.4.7              rstatix_0.7.2           globals_0.18.0          ps_1.9.1                rstudioapi_0.17.1      
#&gt;  [31] extremevalues_2.4.1     pan_1.9                 generics_0.1.4          processx_3.8.6          base64enc_0.1-3        
#&gt;  [36] curl_6.2.3              mitools_2.4             desc_1.4.3              xtable_1.8-4            svUnit_1.0.6           
#&gt;  [41] pracma_2.4.4            evaluate_1.0.3          hms_1.1.3               glmnet_4.1-9            rcartocolor_2.1.1      
#&gt;  [46] lmtest_0.9-40           robustbase_0.99-4-1     matrixStats_1.5.0       svgPanZoom_0.3.4        class_7.3-23           
#&gt;  [51] pillar_1.10.2           caTools_1.18.3          compiler_4.5.0          stringi_1.8.7           jomo_2.7-6             
#&gt;  [56] minqa_1.2.8             plyr_1.8.9              crayon_1.5.3            abind_1.4-8             metadat_1.4-0          
#&gt;  [61] sp_2.2-0                mathjaxr_1.8-0          rapportools_1.2         twosamples_2.0.1        sandwich_3.1-1         
#&gt;  [66] whisker_0.4.1           codetools_0.2-20        multcomp_1.4-28         textshaping_1.0.1       bcaboot_0.2-3          
#&gt;  [71] openssl_2.3.3           flextable_0.9.9         QuickJSR_1.7.0          e1071_1.7-16            gridtext_0.1.5         
#&gt;  [76] lme4_1.1-37             fs_1.6.6                itertools_0.1-3         listenv_0.9.1           Rdpack_2.6.4           
#&gt;  [81] pkgbuild_1.4.8          estimability_1.5.1      ggsignif_0.6.4          callr_3.7.6             tzdb_0.5.0             
#&gt;  [86] pkgconfig_2.0.3         tools_4.5.0             rbibutils_2.3           viridisLite_0.4.2       DBI_1.2.3              
#&gt;  [91] numDeriv_2016.8-1.1     fastmap_1.2.0           scales_1.4.0            officer_0.6.10          opdisDownsampling_1.0.1
#&gt;  [96] insight_1.3.0           rpart_4.1.24            farver_2.1.2            reformulas_0.4.1        survminer_0.5.0        
#&gt;  [ reached 'max' / getOption("max.print") -- omitted 55 entries ]</code></pre>
<hr>
</section>
<section id="references" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> References</h1>
<hr>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="2" data-line-spacing="2">
<div id="ref-gigerenzerStatisticalRitualsReplication2018" class="csl-entry">
1. Gigerenzer G. (2018). <span>“Statistical <span>Rituals</span>: <span>The Replication Delusion</span> and <span>How We Got There</span>.”</span> <em>Advances in Methods and Practices in Psychological Science</em>. <strong>1</strong>:198–218. doi: <a href="https://doi.org/10.1177/2515245918771329">10.1177/2515245918771329</a>.
</div>
<div id="ref-goodmanDirtyDozenTwelve2008" class="csl-entry">
2. Goodman S. (2008). <span>“A <span>Dirty Dozen</span>: <span>Twelve P</span>-<span>Value Misconceptions</span>.”</span> <em>Seminars in Hematology</em>. <strong>45</strong>:135–140. doi: <a href="https://doi.org/10.1053/j.seminhematol.2008.04.003">10.1053/j.seminhematol.2008.04.003</a>.
</div>
<div id="ref-greenlandStatisticalTestsValues2016" class="csl-entry">
3. Greenland S, Senn SJ, Rothman KJ, Carlin JB, Poole C, Goodman SN, et al. (2016). <span>“Statistical tests, <span>P</span> values, confidence intervals, and power: <span>A</span> guide to misinterpretations.”</span> <em>European Journal of Epidemiology</em>. <strong>31</strong>:337–350. doi: <a href="https://doi.org/10.1007/s10654-016-0149-3">10.1007/s10654-016-0149-3</a>.
</div>
<div id="ref-rafiSemanticCognitiveTools2020" class="csl-entry">
4. Rafi Z, Greenland S. (2020). <span>“Semantic and cognitive tools to aid statistical science: Replace confidence and significance by compatibility and surprise.”</span> <em>BMC Medical Research Methodology</em>. <strong>20</strong>:244. doi: <a href="https://doi.org/10.1186/s12874-020-01105-9">10.1186/s12874-020-01105-9</a>.
</div>
<div id="ref-greenlandValidPvaluesBehave2019" class="csl-entry">
5. Greenland S. (2019). <span>“Valid <span>P</span>-values behave exactly as they should: <span>Some</span> misleading criticisms of <span>P</span>-values and their resolution with <span>S</span>-values.”</span> <em>The American Statistician</em>. <strong>73</strong>:106–114. doi: <a href="https://doi.org/10.1080/00031305.2018.1529625">10.1080/00031305.2018.1529625</a>.
</div>
<div id="ref-greenlandSparseDataBias2016" class="csl-entry">
6. Greenland S, Mansournia MA, Altman DG. (2016). <span>“Sparse data bias: A problem hiding in plain sight.”</span> <em>BMJ</em>. <strong>352</strong>:i1981. doi: <a href="https://doi.org/10.1136/bmj.i1981">10.1136/bmj.i1981</a>.
</div>
<div id="ref-greenlandAidScientificInference2020" class="csl-entry">
7. Greenland S, Rafi Z. (2020). <span>“To <span>Aid Scientific Inference</span>, <span>Emphasize Unconditional Descriptions</span> of <span>Statistics</span>.”</span> <em>arXiv:190908583 [statME]</em>. <a href="https://arxiv.org/abs/1909.08583">https://arxiv.org/abs/1909.08583</a>.
</div>
<div id="ref-moskowitzFasterthanlightNeutrinosAren2012" class="csl-entry">
8. Moskowitz C. (2012). <span>“Faster-than-light neutrinos aren’t.”</span> <em>Scientific American</em>.
</div>
<div id="ref-perezgonzalezPvaluesPercentilesCommentary2015" class="csl-entry">
9. Perezgonzalez JD. (2015). <span>“P-values as percentiles. <span>Commentary</span> on: <span>‘<span>Null</span> hypothesis significance tests. <span>A</span> mixup of two different theories: The basis for widespread confusion and numerous misinterpretations’</span>.”</span> <em>Frontiers in Psychology</em>. <strong>6</strong>. doi: <a href="https://doi.org/10.3389/fpsyg.2015.00341">10.3389/fpsyg.2015.00341</a>.
</div>
<div id="ref-fraserPvalueFunctionStatistical2019" class="csl-entry">
10. Fraser DAS. (2019). <span>“The <span>P</span>-value function and statistical inference.”</span> <em>The American Statistician</em>. <strong>73</strong>:135–147. doi: <a href="https://doi.org/10.1080/00031305.2018.1556735">10.1080/00031305.2018.1556735</a>.
</div>
<div id="ref-sellkeCalibrationValuesTesting2001" class="csl-entry">
11. Sellke T, Bayarri MJ, Berger JO. (2001). <span>“Calibration of <span><img src="https://latex.codecogs.com/png.latex?%5Crho"></span> values for testing precise null hypotheses.”</span> <em>The American Statistician</em>. <strong>55</strong>:62–71. doi: <a href="https://doi.org/10.1198/000313001300339950">10.1198/000313001300339950</a>.
</div>
<div id="ref-greenlandTechnicalIssuesInterpretation2020" class="csl-entry">
12. Greenland S, Rafi Z. (2020). <span>“Technical <span>Issues</span> in the <span>Interpretation</span> of <span>S</span>-values and <span>Their Relation</span> to <span>Other Information Measures</span>.”</span> <em>arXiv:200812991 [statME]</em>. <a href="https://arxiv.org/abs/2008.12991">https://arxiv.org/abs/2008.12991</a>.
</div>
<div id="ref-shaferTestMartingalesBayes2011" class="csl-entry">
13. Shafer G, Shen A, Vereshchagin N, Vovk V. (2011). <span>“Test <span>Martingales</span>, <span>Bayes Factors</span> and p-<span>Values</span>.”</span> <em>Statistical Science</em>. <strong>26</strong>:84–101. doi: <a href="https://doi.org/10/fkcvt5">10/fkcvt5</a>.
</div>
<div id="ref-schuemieRobustEmpiricalCalibration2016" class="csl-entry">
14. Schuemie MJ, Hripcsak G, Ryan PB, Madigan D, Suchard MA. (2016). <span>“Robust empirical calibration of p-values using observational data.”</span> <em>Statistics in Medicine</em>. <strong>35</strong>:3883–3888. doi: <a href="https://doi.org/10/ghqmsb">10/ghqmsb</a>.
</div>
<div id="ref-gruberLimitationsEmpiricalCalibration2016" class="csl-entry">
15. Gruber S, Tchetgen ET. (2016). <span>“Limitations of empirical calibration of p-values using observational data.”</span> <em>Statistics in Medicine</em>. <strong>35</strong>:3869–3882. doi: <a href="https://doi.org/10/ghqmtn">10/ghqmtn</a>.
</div>
<div id="ref-neymanProblemMostEfficient1933" class="csl-entry">
16. Neyman J, Pearson ES. (1933). <span>“On the <span>Problem</span> of the <span>Most Efficient Tests</span> of <span>Statistical Hypotheses</span>.”</span> <em>Philosophical Transactions of the Royal Society of London Series A, Containing Papers of a Mathematical or Physical Character</em>. <strong>231</strong>:289–337. doi: <a href="https://doi.org/10.1098/rsta.1933.0009">10.1098/rsta.1933.0009</a>.
</div>
<div id="ref-whiteheadCaseFrequentismClinical1993" class="csl-entry">
17. Whitehead J. (1993). <span>“The case for frequentism in clinical trials.”</span> <em>Statistics in Medicine</em>. <strong>12</strong>:1405–1413. doi: <a href="https://doi.org/10.1002/sim.4780121506">10.1002/sim.4780121506</a>.
</div>
<div id="ref-rubinWhatTypeType2019" class="csl-entry">
18. Rubin M. (2019). <span>“What type of <span>Type I</span> error? <span>Contrasting</span> the <span>Neyman</span> and <span>Fisherian</span> approaches in the context of exact and direct replications.”</span> <em>Synthese</em>. doi: <a href="https://doi.org/10.1007/s11229-019-02433-0">10.1007/s11229-019-02433-0</a>.
</div>
<div id="ref-Lehmann2011-vs" class="csl-entry">
19. Lehmann EL. (2011). <span>“Fisher, <span>Neyman</span>, and the <span>Creation</span> of <span>Classical Statistics</span>.”</span> <span>Springer New York</span>. doi: <a href="https://doi.org/10.1007/978-1-4419-9500-1">10.1007/978-1-4419-9500-1</a>.
</div>
<div id="ref-fisherDesignExperiments1935" class="csl-entry">
20. Fisher RA. (1935). <span>“The <span>Design</span> of <span>Experiments</span>.”</span> <span>Oxford, England</span>: <span>Oliver &amp; Boyd</span>.
</div>
<div id="ref-fisherStatisticalMethodsScientific1955" class="csl-entry">
21. Fisher R. (1955). <span>“Statistical <span>Methods</span> and <span>Scientific Induction</span>.”</span> <em>Journal of the Royal Statistical Society Series B (Methodological)</em>. <strong>17</strong>:69–78. doi: <a href="https://doi.org/10.1111/j.2517-6161.1955.tb00180.x">10.1111/j.2517-6161.1955.tb00180.x</a>.
</div>
<div id="ref-bickelNullHypothesisSignificance2019" class="csl-entry">
22. Bickel DR. (2019). <span>“Null <span>Hypothesis Significance Testing Defended</span> and <span>Calibrated</span> by <span>Bayesian Model Checking</span>.”</span> <em>The American Statistician</em>. <strong>0</strong>:1–16. doi: <a href="https://doi.org/10.1080/00031305.2019.1699443">10.1080/00031305.2019.1699443</a>.
</div>
<div id="ref-jeffreysTestsSignificanceTreated1935" class="csl-entry">
23. Jeffreys H. (1935). <span>“Some <span>Tests</span> of <span>Significance</span>, <span>Treated</span> by the <span>Theory</span> of <span>Probability</span>.”</span> <em>Mathematical Proceedings of the Cambridge Philosophical Society</em>. <strong>31</strong>:203–222. doi: <a href="https://doi.org/10.1017/S030500410001330X">10.1017/S030500410001330X</a>.
</div>
<div id="ref-jeffreysTheoryProbability1998" class="csl-entry">
24. Jeffreys H. (1998). <span>“The <span>Theory</span> of <span>Probability</span>.”</span> <span>OUP Oxford</span>.
</div>
<div id="ref-royallStatisticalEvidenceLikelihood1997" class="csl-entry">
25. Royall R. (1997). <span>“Statistical <span>Evidence</span>: <span>A Likelihood Paradigm</span>.”</span> <span>CRC Press</span>.
</div>
<div id="ref-coleSurprise2020" class="csl-entry">
26. Cole SR, Edwards JK, Greenland S. (2020). <span>“Surprise!”</span> <em>American Journal of Epidemiology</em>. doi: <a href="https://doi.org/10/gg63md">10/gg63md</a>.
</div>
<div id="ref-Shannon1948-uq" class="csl-entry">
27. Shannon CE. (1948). <span>“A mathematical theory of communication.”</span> <em>The Bell System Technical Journal</em>. <strong>27</strong>:379–423. doi: <a href="https://doi.org/10.1002/j.1538-7305.1948.tb01338.x">10.1002/j.1538-7305.1948.tb01338.x</a>.
</div>
</div></section></div> ]]></description>
  <guid>https://lesslikely.com/posts/statistics/s-values.html</guid>
  <pubDate>Sun, 11 Nov 2018 00:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1605000180/Site/pvalueassumptions.png" medium="image" type="image/png"/>
</item>
<item>
  <title>We May Not Understand Control Groups</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/control-group-effects.html</link>
  <description><![CDATA[ 





<hr>
<p>It’s well known that randomized trials are some of the most efficient ways to make causal inferences and to determine how much something (an intervention) differs from the comparator (some sort of control). Random assignment helps make these goals easier by minimizing selection bias and making the distribution of prognostic factors between groups random (not balanced).[@Zhao2018-yf]</p>
<p>Discussions (similar to the one above) praising the efficiency of randomized trials are widespread, however, few of these discussions take a close look at some of the common assumptions that individuals hold regarding randomized trials. And unfortunately, these common assumptions may be based on outdated evidence and simplistic ideas.</p>
<section id="the-placebo-effect-isnt-what-we-often-think" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> The Placebo Effect Isn’t What We Often Think</h1>
<p>For example, in placebo-controlled trials, many individuals make the assumption that much of the improvement seen in the control group over time is due to the placebo effect, as modeled by the graph below.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1554700142/Site/PlaceboDominance.svg" alt="Bar graph depicting the placebo-dominant model"></p>
<hr>
<p>However, inquiries into this topic have yielded contradictory results, in that the placebo effect may not be as <a href="https://www.newyorker.com/magazine/2011/12/12/the-power-of-nothing">powerful as we assume</a>.</p>
<p>One systematic review[@Hrobjartsson2001-if] that looked at 130 clinical trials concluded the following,</p>
<hr>
<blockquote class="blockquote">
<p>“We found little evidence in general that placebos had powerful clinical effects. Although placebos had no significant effects on objective or binary outcomes, they had possible small benefits in studies with continuous subjective outcomes and for the treatment of pain. Outside the setting of clinical trials, there is no justification for the use of placebos.”</p>
</blockquote>
<hr>
<p>Thus, the placebo effect had some small effects in areas where it is difficult to objectively measure a phenomenon and where there is a higher likelihood for encountering measurement error. However, measurement error is not the only thing that could explain some of the improvements seen in control groups, which we often attribute to the placebo effect.</p>
<p>We simply need to reread two sections of a paper by the very anesthesiologist who popularized the placebo effect[@Beecher1955-yc] and who claimed that it had the ability to put patients’ conditions into remission.</p>
<p>Here, Henry Beecher (the anesthesiologist) claims that placebo effects are powerful:</p>
<hr>
<blockquote class="blockquote">
<p>“It is evident that placebos have a high degree of therapeutic effectiveness in treating subjective responses, decided improvement, interpreted under the unknowns technique as a real therapeutic effect, being produced in 35.2 ± 2.2% of cases….</p>
<p>Placebos have not only remarkable therapeutic power but also toxic effects. These are both subjective and objective. The reaction (psychological) component of suffering has power to produce gross physical change.”</p>
</blockquote>
<hr>
<p>Then he reports another observation from his patients.</p>
<blockquote class="blockquote">
<p>“The evidence is that placebos are most effective when the stress is greatest.”</p>
</blockquote>
<p>If you measured someone’s stress (let’s say objectively, via cortisol measurements) and they were extremely stressed and if you followed up after a certain period of time, it would be very likely that the next measurement of their stress (cortisol levels) would be less than the first measurement.</p>
<p>A slightly reverse situation would likely apply too: if you measured someone’s happiness (in some theoretical objective way) and they were extremely happy, it’s very likely that their next measurement of happiness would not be so high. This phenomenon is known as regression to the mean,[@Senn2011-fj] and it can explain why many individuals who are in an abnormal state, feel slightly more normal over time.</p>
<p>We can see this displayed below in the graph of simulated blood pressure data[@Atkinson2015-dd] where the change in blood pressure is predicted by baseline blood pressure. The individuals with higher blood pressure at baseline experienced a larger decrease in blood pressure over time.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1554700144/Site/RTM.svg" alt="Graph depicting regression to the mean with simulated blood pressure data"></p>
<hr>
<p>This could possibly explain why Beecher observed that placebo was most effective for situations in which stress was the greatest.</p>
<p>It may not have been <em>just</em> the patients’ minds that led to remission of symptoms, rather the combination of regressing towards an average from a more extreme value, the placebo effect, along with the subjectivity and measurement error of the instruments may have led to this phenomenon of experiencing relief as a function of time.[@mcdonaldHowMuchPlacebo1983]</p>
<p>This isn’t to say that placebo effects are nonexistent or that they’re not relevant, they still are because they serve as controls for various other phenomena that come along with them. For example, it seems very unlikely that in a clinical trial that recruits healthy participants and aims to improve their intelligence with an experimental drug, that regression to the mean could explain the improvements seen in the control group.</p>
<p>In a trial aiming to improve biomarkers in healthy participants, could regression towards the mean or noise explain all the variance we see in the control group? Probably not. It seems very feasible that the placebo effect can result in changes to both subjective <em>and</em> objective outcomes, irrespective of the effects of regression to the mean and measurement error, however, I’m inclined to believe that many of the claims regarding the placebo effect may be <a href="https://www.newyorker.com/magazine/2011/12/12/the-power-of-nothing">exaggerated</a>.</p>
<p>Thus, a more accurate way to think of control group effects would be to incorporate phenomena such as regression to the mean, the placebo effect, and other factors, as shown below.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1554700146/Site/Unspecific.svg" alt="Bar graph depicting the unspecific model"></p>
<hr>
<p>Of course, the proportion of these individual effects would likely vary depending on the scenario(s). Here, the proportions of effects in the control group reflect <em>my</em> beliefs about what contributes to improvements seen in sick individuals who are followed over time.</p>
<p>While the model above is certainly an improvement over the first bar graph in the article all the way above, it too may also be simplistic… and may even be wrong.[@Kube2017-jt] I’ll first discuss some theoretical examples and then present some evidence.</p>
<hr>
</section>
<section id="the-additive-model-is-too-simple" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> The Additive Model Is Too Simple</h1>
<hr>
<p>If we add up all the possible effects that lead to improvements in the control group, such as regression to the mean, the placebo effect, measurement error, unspecific effects etc, we can call this giant block (the blue block) the “total control group effect”, at least for the sake of this discussion. This is shown in the bar graph below. Notice that it has a total effect of 6.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1554700108/Site/Additivity.svg" alt="Bar graph depicting the additive model, where treatment effects add on to control group effects"></p>
<hr>
<p>Again, here we are assuming that all the possible things that lead to improvements in the control group are represented by the blue bar. Thus, we design a clinical trial with the assumption that the total control group effect, AKA that represented by the blue bar, will also be the same in the treatment group. This is the “Additive Model” because it simply adds the treatment effect (red bar) on top of the control effect (blue bar), giving a total effect of 10. We subtract the total effect of the treatment group (10) from the total control group effect (6) to get:</p>
<p>Treatment-specific effect (4) = Total treatment group effect (10) - Total control group effect (6)</p>
<p>Therefore, we estimate that the drug has an effect of 4 whereas all the effects that contribute to the control result in an effect of 6. In the form of a linear model, we would model this as y = constant + b(group), where b is the difference between the treatment group and the control group, and group would be coded as 0 or 1, etc.</p>
<p>This idea may be too <em>simplistic</em> as it assumes that the control effect (the blue bar) will be <em>constant</em> between groups.</p>
<p>However, several studies have shown disparities in placebo/control effects between groups, with placebo/control effects sometimes being <em>larger</em> in control groups than in treatment groups.[@Finnerup2010-kw; @Finnerup2015-ga; @Rutherford2014-ye]</p>
<p>Experimental studies have also found that the sum of the drug effect and the placebo effect is often larger than the total treatment effect.[@Hammami2010-ud; @Lund2014-if] This doesn’t seem to support the additive model, where we assume the total control effect is constant in both groups.</p>
<p>It doesn’t take into account that there may be an interaction[@Corraini2017-xi; @Rothman1974-ky] that occurs between the control group effects and the treatment effects, especially if there are possible factors that could lead the participants in the clinical trial to discover that they’ve been allocated to the treatment group.</p>
<p>Thus, a more inclusive model of these possible factors, in the form of a linear model, would be:</p>
<p><em>y</em> = *c<strong>o</strong>n<strong>s</strong>t<strong>a</strong>n<strong>t <em>+</em> β</strong><sup>gr<strong>o</strong>u<strong>p</strong></sup> + β<sup>in<strong>t</strong>e<strong>r</strong>a<strong>c</strong>t<strong>i</strong>o**n<em>(</em>s<em>)</em></sup> + ϵ*</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1554700127/Site/Interactivity.svg" alt="Bar graph depicting the interactive model"></p>
<hr>
<p>These interactions could result in many scenarios, but let’s look at two simple ones.</p>
<p>If a participant in a drug trial is aware of the side effects of the drug beforehand, and receives the drug and experiences side effects, he/she may now have some confirmation that they’ve received the actual intervention, and may overestimate their improvement in a subjective outcome and/or may experience placebo/physiological mechanisms that overlap and interact, thus amplifying the control effects. The overall treatment group effect would increase. This would be a synergistic interaction[@Rothman1974-ky], as shown below. Notice the control group has a total effect of 6, while the drug group has a total effect of 13.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1554700145/Site/Synergism.svg" alt="Bar graph depicting the synergistic interactive model"></p>
<hr>
<p>Now let’s say in another scenario, a patient in a drug trial was unaware of the possible side effects of the drug and experienced some side effects, which has somehow convinced the participant that they may not improve, or the physiological interaction in the mechanisms between the drug and placebo result in negative outcomes. This may lead to a reduction in the placebo effect and a reduction in other unspecific control effects. This would be an antagonistic interaction[@Rothman1974-ky], as shown below. It’s reduced the overall treatment group effect from 13 to 8.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/v1554700108/Site/Antagonism.svg" alt="Bar graph depicting the antagonistic interactive model"></p>
<hr>
<p>Thus, when we design clinical trials with comparators, we’re often assuming that the treatment-specific effect can be estimated by taking the difference between the total treatment group effect and the total control group effect, because we assume the control effect is constant between groups. But again, as shown above, this may be far too simplistic.</p>
<hr>
</section>
<section id="possible-directions" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Possible Directions</h1>
<hr>
<p>So what’s the solution? How can we design clinical trials to better account for these possible interactions between the intervention and the control group effects? A potential solution that’s been put forth by several researchers over the years is the balanced-placebo design.[@Atlas2012-lr; @Hammami2010-ud; @Kube2017-jt; @Lund2014-if; @Schenk2014-pa] The balanced-placebo design is essentially a 2 x 2 factorial design where two groups will receive the drug and two groups will receive placebo.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700109/Site/Balanced.png" alt="Depiction of a balanced placebo design" style="width:80%"></p>
<hr>
<p>Out of the two groups receiving the drug, one will be told that they’re receiving placebo, while the other is told they’re receiving the drug. The same would apply to the two groups receiving the placebo. One will be told that they’re receiving the placebo, while the other is told they’re receiving the drug. While this design may account for interactions between control group effects and the intervention, I can’t say I’m much of a fan of it as it requires more groups (therefore more participants) and doesn’t use blinding. It may also be unethical.</p>
<p>A very simple solution to me (out of <a href="https://www.sciencedirect.com/science/article/pii/S1359644616304500?via%3Dihub">several proposed designs</a>) is the use of an “active placebo.”[@Kube2017-jt] Active placebos are substances that don’t yield any beneficial effects, but are designed to mimic some of the side effects of the intervention (pretty sure a more appropriate term for them would be <a href="https://en.wikipedia.org/wiki/Nocebo">nocebo</a>). Thus, controlling for the possible interaction(s) that could occur if the participant is affected by the side effects of the intervention. This will make it harder for the participant to know whether they got the intervention or the placebo.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700108/Site/ActivePlacebo.png" alt="Depiction of using a design that includes an active placebo and an inert placebo" style="width:80%"></p>
<hr>
<p>Psychiatrist Scott Alexander of <a href="http://slatestarcodex.com/2014/07/07/ssris-much-more-than-you-wanted-to-know/">Slate Star Codex</a> and <a href="https://www.lesswrong.com/">LessWrong</a> is skeptical of active placebos and believes that <a href="https://ajp.psychiatryonline.org/doi/full/10.1176/appi.ajp.157.3.327">the research</a> doesn’t support their usage.[@Quitkin2000-st] In his article about selective serotonin reuptake inhibitors he writes,</p>
<hr>
<blockquote class="blockquote">
<p>“In other words, active placebo research has fallen out of favor in the modern world. Most studies that used active placebo are very old studies that were not very well conducted. Those studies failed to find an active-placebo-vs.-drug difference because they weren’t good enough to do this. But they also failed to find an active-placebo-vs.-inactive-placebo difference. So they provide no support for the idea that active placebos are stronger than inactive placebos in depression and in fact somewhat weigh against it.”</p>
</blockquote>
<hr>
<p>Scott uses a narrative review from 2000[@Quitkin2000-st] that looked at previous active-placebo trials to support this perspective, but several other studies that have used active placebos have been carried out since</p>
<ol type="1">
<li>Several of these are of much higher quality than the studies discussed in the review he cites. A more recent methodological review,[@Jensen2017-jp] published by one of the authors who systematically searched the literature to find that placebo effects were underwhelming in trials with objective outcomes,[@Hrobjartsson2001-if] concludes the following,</li>
</ol>
<hr>
<blockquote class="blockquote">
<p>Pharmacological active placebo control interventions are rarely used in randomized clinical trials, but they constitute a methodological tool which merits serious consideration. We suggest that active placebos are used more often in trials of drugs with noticeable side effects, especially in situations where the expected therapeutic effects are modest and the risk of bias due to unblinding is high.</p>
</blockquote>
<hr>
<p>Luckily, active placebo research doesn’t seem to have <a href="https://clinicaltrials.gov/ct2/show/NCT03666390">fallen out of favor</a>. Is active placebo research the solution to the problems mentioned above? I’m not sure. There are several other proposed designs that attempt to account for possible interactions that can occur and they may be more practical or less biased. It seems like recognizing that such interactions could occur in the first place would be the first step towards finding a solution.</p>
<p><strong>Acknowledgements</strong>: I’d like to thank <a href="https://twitter.com/avigotsky">Andrew Vigotsky</a> for bringing my attention to several of the pieces cited in this article and for offering comments on an early version of this piece.</p>
<hr>
</section>
<section id="references" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> References</h1>
<hr>


<!-- -->

</section>

 ]]></description>
  <guid>https://lesslikely.com/posts/statistics/control-group-effects.html</guid>
  <pubDate>Sun, 28 Oct 2018 04:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700144/Site/RTM.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Misplaced Confidence in Observed Power</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/misplacedpower.html</link>
  <description><![CDATA[ 





<hr>
<p>Two months ago, <a href="https://jamanetwork.com/journals/jama/article-abstract/2688569">a study came out in <em>JAMA</em></a> which compared the effectiveness of the antidepressant escitalopram to placebo for long-term major adverse cardiac events (MACE).</p>
<p>The authors explained in the methods section of their paper how they calculated their sample size and what differences they were looking for between groups.</p>
<p>First, they used some <a href="https://www.ncbi.nlm.nih.gov/pubmed/21982310">previously published data</a> to get an idea for incidence rates,</p>
<blockquote class="blockquote">
<p>“Because previous studies in this field have shown conflicting results, there was no appropriate reference for power calculation within the designated sample size. The KAMIR study reported a 10.9% incidence of major adverse cardiac events (MACE) over 1 year… Therefore, approximately 50% MACE incidence was expected during a 5-year follow-up.”</p>
</blockquote>
<p>Then, they calculated their sample size based on some differences they were interested in finding,</p>
<blockquote class="blockquote">
<p>“Assuming 2-sided tests, α = .05, and a follow-up sample size of 300, the expected power was 70% and 96% for detecting 10% and 15% group differences, respectively.”</p>
</blockquote>
<p>So far so good.</p>
<p>Then, we get to the results,</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700127/Site/JAMAObservedPower.png" alt="Survival curve showing data from associations between antidepressants and major adverse cardiac events"></p>
<hr>
<blockquote class="blockquote">
<p>“A significant difference was found: composite MACE incidence was 40.9% (61/149) in the escitalopram group and 53.6% (81/151) in the placebo group (hazard ratio [HR], 0.69; 95% CI, 0.49-0.96; P = .03). The model assumption was met (Schoenfeld P = .48). The estimated statistical power to detect the observed difference in MACE incidence rates between the 2 groups was 89.7%.”</p>
</blockquote>
<p>Ouch. This issue ended up bothering me so much that I wrote a letter to the editor (LTE) to point out the issue. Unfortunately, the LTE got rejected, but <a href="https://twitter.com/ADAlthousePhD">Andrew Althouse</a> suggested that I discuss this over at DataMethods, <a href="https://discourse.datamethods.org/t/observed-power-and-other-power-issues/731">so I did</a>, and I also <a href="https://twitter.com/dailyzad/status/1045467112293183498">discussed it on Twitter</a> but also wanted to publish the LTE on my blog. <a href="../../uploads/rafi2020_obspower.pdf">Here it is.</a></p>
<p>This letter has now been <a href="https://arxiv.org/abs/1907.08242">preprinted on <em>arXiv</em></a>.</p>
<p>In a similar tale, a group of surgeons published a methodological article advocating this practice of calculating observed power, which I further <a href="../../statistics/observed-power-magic">discuss here</a>.</p>


<!-- -->


 ]]></description>
  <guid>https://lesslikely.com/posts/statistics/misplacedpower.html</guid>
  <pubDate>Sun, 30 Sep 2018 04:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700127/Site/JAMAObservedPower.png" medium="image" type="image/png"/>
</item>
<item>
  <title>The Bradford Hill Criteria Don’t Hold Up</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/bradford-hill-criteria.html</link>
  <description><![CDATA[ 





<hr>
<p>In 1965, the epidemiologist, Austin Bradford Hill, who helped <a href="../../../medicine/smoking-and-lung-cancer">link smoking to lung cancer</a>, <a href="https://www.edwardtufte.com/tufte/hill">gave a speech</a> where he presented his <a href="https://en.wikipedia.org/wiki/Bradford_Hill_criteria">viewpoints</a> on how we can arrive at causation from correlation.</p>
<p>This lecture was a bit of a game changer at the time given that the tobacco industry was employing statisticians, medical doctors, and <a href="https://andrewgelman.com/2012/04/27/how-to-mislead-with-how-to-lie-with-statistics/">even popular science writers</a> to push the idea that the relationship between smoking and lung cancer was merely a correlation, not a causal one.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700112/Site/doctorsmarketingtobacco.jpg" alt="Marketing ad of tobacco from the late 1900s" style="width:50%"></p>
<hr>
<p>Both the tobacco industry and <a href="../../../uploads/FisherLTE.pdf">empiricists</a> argued that the existing data was not very convincing because there were no human experiments showing that smoking causes lung cancer. Of course, this was a sticky situation because it was neither ethical nor practical to randomize people and force them to smoke cigarettes and compare rates of lung cancer to a control group.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700119/Site/Fisher1946.jpg" alt="Picture of Ronald Fisher sitting and smoking" style="width:50%"></p>
<hr>
<p>Austin Bradford Hill and his co-investigator, <a href="https://en.wikipedia.org/wiki/Richard_Doll">Richard Doll</a>, were able to argue with compelling data from the <a href="https://en.wikipedia.org/wiki/British_Doctors_Study">British Doctors’ Study</a> that smoking cigarettes does indeed cause lung cancer, when combining these data with several other data (<a href="https://tobaccocontrol.bmj.com/content/21/2/87">molecular, cellular)</a> and referring to a set of viewpoints.</p>
<p>Since then, these viewpoints have been used as a sort of checklist/criteria in several papers and by several authors to assess causality when randomized trials weren’t possible. For example, <a href="https://sciencebasedmedicine.org">Science-Based Medicine</a> <a href="https://sciencebasedmedicine.org/causation-and-hills-criteria/">often refers to these viewpoints as criteria</a> and <a href="https://sciencebasedmedicine.org/estrogen-matters/">recently discussed</a> their usage in a blog post reviewing a <a href="https://www.amazon.com/Estrogen-Matters-Hormones-Menopause-Well-Being/dp/0316481203">book about hormonal therapy</a>.</p>
<p>In this post, drawing heavily from <a href="http://www.ovid.com/site/catalog/books/4634.jsp">Rothman, Greenland &amp; Lash, 2008</a> (from here on, RGL), I want to discuss these viewpoints, and why many of them don’t often hold up when critically examined.</p>
<p>Hill’s nine viewpoints were the following:</p>
<hr>
<section id="strength" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Strength</h1>
<hr>
<p>Stronger associations, according to Hill, were more compelling for causal relationships than weaker associations because of the possibility of unmeasured confounding leading to weak associations between two phenomena. He uses the example of smoking and cancer and compares it to thrombosis in smokers,</p>
<hr>
<blockquote class="blockquote">
<p>“…prospective inquiries into smoking have shown that the death rate from cancer of the lung in cigarette smokers is nine to ten times the rate in non-smokers and the rate in heavy cigarette smokers is twenty to thirty times as great. On the other hand the death rate from coronary thrombosis in smokers is no more than twice, possibly less, the death rate in non-smokers.”</p>
</blockquote>
<hr>
<p>It does indeed sound compelling. Science-Based Medicine uses the <a href="https://sciencebasedmedicine.org/causation-and-hills-criteria/">same argument</a> for alternative medicine,</p>
<hr>
<blockquote class="blockquote">
<p>“If acupuncture or homeopathy were 400 times superior to placebo, there would no discussion of its validity. Many medical therapies are not 400 times as effective as placebo, but the strength of the association between cause and effect is well above background noise.”</p>
</blockquote>
<hr>
<p>Why It Doesn’t Hold Up</p>
<hr>
<p>Several causal relationships that we know of today, such as the relationship between smoking and cardiovascular disease, and environmental tobacco smoke and lung cancer, had weak associations. However, Hill didn’t discount weak associations as seen here,</p>
<hr>
<blockquote class="blockquote">
<p>“In thus putting emphasis upon the strength of an association we must, nevertheless, look at the obverse of the coin. We must not be too ready to dismiss a cause and effect hypothesis merely on the grounds that the observed association appears to be slight. There are many occasions in medicine when this is in truth so.”</p>
</blockquote>
<hr>
<p>Okay, but really strong associations are more likely to be causal, right? Not necessarily. This criterion easily falls apart when considering relationships that are strongly associated, but noncausal. For example, there is a very strong relationship between Down syndrome and birth rank. However, this association is confounded by the relationship between Down syndrome and maternal age. Once, adjusting for this particular confounder, the association between Down syndrome and birth rank wanes.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700110/Site/confounding.png" alt="Drawing depicting what confounding looks like" style="width:80%"></p>
<hr>
<p>There is no reason to believe that this wouldn’t apply to many associations that happen to be very strong. It’s possible that many associations that are strong and not spurious are likely a result of several unmeasured confounders and strong bias.</p>
<p>It’s likely that most effects studied in the real world are small and few relationships of interest are similar to the one between smoking and lung cancer. As we can see, the strength of association doesn’t necessarily contribute to the determination of causality.</p>
<hr>
</section>
<section id="consistency" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Consistency</h1>
<hr>
<p>Hill defines something as being consistent if it has been observed in different people, in different places, and under different circumstances. Hill writes,</p>
<hr>
<blockquote class="blockquote">
<p>“Some of them on the customary tests of statistical significance will appear to be unlikely to be due to chance. Nevertheless whether chance is the explanation or whether a true hazard has been revealed may sometimes be answered only by a repetition of the circumstances and the observations.”</p>
</blockquote>
<hr>
<p>Science-Based Medicine writes,</p>
<hr>
<blockquote class="blockquote">
<p>“Almost every study should support the association for there to be causation.”</p>
</blockquote>
<hr>
<p>Why It Doesn’t Hold Up</p>
<hr>
<p>Several causal relationships may be circumstantial or unique to a particular population and may not occur in other scenarios; however, this does not rule out causality. RGL provide a great example of this: blood transfusions can lead to the receiver being infected with HIV, however, this <em>only</em> occurs if the virus is present in the donor’s blood.</p>
<p>If there is no virus, then the transfusion cannot cause HIV. However, just because blood transfusions don’t always cause HIV in several different scenarios doesn’t mean they don’t cause HIV in particular scenarios (with the virus present).</p>
<hr>
</section>
<section id="specificity" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Specificity</h1>
<hr>
<p>Hill described specificity in two components: that a specific cause leads to a single effect, and that an effect has one cause. He writes,</p>
<hr>
<blockquote class="blockquote">
<p>“One reason, needless to say, is the specificity of the association, the third characteristic which invariably we must consider. If as here, the association is limited to specific workers and to particular sites and types of disease and there is no association between the work and other modes of dying, then clearly that is a strong argument in favor of causation.”</p>
</blockquote>
<hr>
<p>Why It Doesn’t Hold Up</p>
<hr>
<p>This one makes little sense given that many exposures (such as smoking) are known to contribute to several disease and outcomes. However, Hill also acknowledged this in the same lecture,</p>
<hr>
<blockquote class="blockquote">
<p>“We must also keep in mind that diseases may have more than one cause. It has always been possible to acquire a cancer of the scrotum without sweeping chimneys of taking to mulespinning in Lancashire. One-to-one relationships are not frequent. Indeed I believe that multi-causation is generally more likely than single causation though possibly if we knew all the answer we might get back to a single factor.”</p>
</blockquote>
<hr>
</section>
<section id="temporality" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Temporality</h1>
<hr>
<p>Hill argued that for relationships to be causal, the cause needed to precede the effect,</p>
<hr>
<blockquote class="blockquote">
<p>“My fourth characteristic is the temporal relationship of the association – which is the cart and which is the horse? This is a question which might be particularly relevant with diseases of slow development. Does a particular diet lead to disease or do the early stages of the disease lead to those particular dietetic habits?</p>
<p>Does a particular occupation or occupational environment promote infection by the tubercle bacillus or are the men and women who select that kind of work more liable to contract tuberculosis whatever the environment – or, indeed, have they already contracted it? This temporal problem may not arise often, but it certainly needs to be remembered, particularly with selective factors at work in the industry.”</p>
</blockquote>
<hr>
<p>Why this holds up</p>
<hr>
<p>As RGL points out, this is inarguable,</p>
<hr>
<blockquote class="blockquote">
<p>“This criterion is inarguable, insofar as any claimed overvation of causation must involve the putative cause C preceding the putative effect D. It does not, however, follow that a reverse time order is evidence against the hypothesis that C can cause D. Rather, observations in which C followed D merely show that C could not have caused D in these instances, they provide no evidence for or against the hypothesis that C can cause D in those instances in which it precedes D. Only if it is found that C cannot precede D can we dispense with the causal hypothesis that C could cause D.”</p>
</blockquote>
<hr>
<p>Thus, this “criterion” does hold up and is a necessity.</p>
<hr>
</section>
<section id="biological-gradient" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Biological gradient</h1>
<hr>
<p>Hill’s fifth viewpoint is a referral to a dose-response relationship. For example, the more cigarettes one smokes, the higher the likelihood of developing lung cancer.</p>
<hr>
<blockquote class="blockquote">
<p>“Fifthly, if the association is one which can reveal a biological gradient, or dose-response curve, then we should look most carefully for such evidence. For instance, the fact that the death rate from cancer of the lung rises linearly with the number of cigarettes smoked daily, adds a very great deal to the simpler evidence that cigarette smokers have a higher death rate than non-smokers.</p>
<p>The comparison would be weakened, though not necessarily destroyed, if it depended upon, say, a much heavier death rate in light smokers and a lower rate in heavier smokers. We should then need to envisage some much more complex relationship to satisfy the cause and effect hypothesis. The clear dose-response curve admits of a simple explanation and obviously puts the case in a clearer light.”</p>
</blockquote>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700112/Site/dose_response_curves.jpg" alt="Graph showing a dose-response relationship from a microbiology experiment" style="width:80%"></p>
<hr>
<hr>
<p>Why It Doesn’t Hold Up</p>
<hr>
<p>RGL mentions several problems with this criterion.</p>
<p>First, although Hill mentions a “linear” relationship explicitly, he does not specify on which scale a relationship should be linear. Linear gradients on scales such as risk can easily become nonlinear on other scales such as log risk, odds, or log odds.</p>
<p>Although it is plausible that more carcinogenic exposure would lead to more tissue damage and a higher risk of developing lung cancer, there are causal relationships that are not dose-response relationships/monotonic. For example, the relationship between DES and adenocarcinoma of the vagina is causal. However, it has been observed to be a threshold effect rather than a monotonic one.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700136/Site/monotonic.png" alt="Generic graphs showing what monotonic and nonmonotonic relationships look like" style="width:100%"></p>
<hr>
<p>Many monotonic, dose-response relationships are not causal and are sometimes a result of confounding, in that the confounder itself is the cause of monotonicity (maybe because the confounder is a biological gradient).</p>
<p>As RGL summarizes,</p>
<hr>
<blockquote class="blockquote">
<p>“These issues imply that the existence of a monotonic association is neither necessary nor sufficient for a causal relation.”</p>
</blockquote>
<hr>
</section>
<section id="plausibility" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Plausibility</h1>
<hr>
<p>Hill argued that if a relationship seems biologically plausible, then that is more evidence in favor of a causal relationship. However, he also acknowledged that a relationship and its plausibility would depend on the knowledge at the time.</p>
<hr>
<blockquote class="blockquote">
<p>“It will be helpful if the causation we suspect is biologically plausible. But this is a feature I am convinced we cannot demand. What is biologically plausible depends upon the biological knowledge of the day.”</p>
</blockquote>
<hr>
<p>Why It Doesn’t Hold Up</p>
<hr>
<p>As Hill pointed out, this viewpoint depends heavily on the knowledge of the observer and their prior beliefs. What may seem biologically plausible to one researcher may seem entirely impossible for another researcher, even when the same research is available to the both of them. And many times, beliefs about plausibility can be flat out wrong,</p>
<hr>
<blockquote class="blockquote">
<p>RGL: “… Cheever in 1861, who had been commenting on the etiology of typhus before its mode of transmission (via body lice) was known:</p>
<p>It could be no more ridiculous for the stranger who passed the night in the steerage of an emigrant ship to ascribe the typhus, which he there contracted, to the vermin with which bodies of the sick might be infested. An adequate cause, one reasonable in itself, must correct the coincidences of simply experience.</p>
<p>What was to Cheever an implausible explanation turned out to the be the correct explanation, because it was indeed the vermin that caused the typhus infection. Such is the problem with plausibility: It is too often based not on logic or data, but only on prior beliefs. This is not too say that biologic knowledge should be discounted when a new hypothesis is being evaluated, but only to point the difficulty in applying that knowledge.”</p>
</blockquote>
<hr>
</section>
<section id="coherence" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Coherence</h1>
<hr>
<p>Hill describes coherence as,</p>
<hr>
<blockquote class="blockquote">
<p>“On the other hand the cause-and-effect interpretation of our data should not seriously conflict with the generally known facts of the natural history and biology of the disease – in the expression of the Advisory Committee to the Surgeon-General it should have coherence.”</p>
</blockquote>
<hr>
<p>This viewpoint is a bit difficult to discuss without repeating some of the arguments made against the plausibility viewpoint and the consistency viewpoint. However, Hill does elaborate a bit more on this view,</p>
<hr>
<blockquote class="blockquote">
<p>“Nevertheless, while such laboratory evidence can enormously strengthen the hypothesis and, indeed, may determine the actual causative agents, the lack of such evidence cannot nullify the epidemiological associations in man. Arsenic can undoubtedly cause cancer of the skin in man but it has never been possible to demonstrate such an effect on any other animal.”</p>
</blockquote>
<hr>
<p>Thus, according to Hill, the absence of coherent information cannot be taken as evidence against a causal relationship, but the presence of conflicting information can be considered as such evidence.</p>
<hr>
</section>
<section id="experimental-evidence" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Experimental Evidence</h1>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700128/Site/lab_mice.jpg" alt="Picture of mice in a lab" style="width:60%"></p>
<hr>
<p>As RGL point out, many assume the experiment viewpoint to be a referral to animal/human studies,</p>
<hr>
<blockquote class="blockquote">
<p>“To different observers, experimental evidence can refer to clinical trials, to laboratory experiments with rodents or other nonhuman organisms, or to both.”</p>
</blockquote>
<hr>
<p>Science-Based Medicine’s take on this viewpoint confirms what RGL claims,</p>
<hr>
<blockquote class="blockquote">
<p>“Always nice. Written in 1965, before the massive increase in biomedical research funding, experiments were not as vital in understanding diseases and treatments as they are today… There were no consistent studies discussing subluxation in the animal model.”</p>
</blockquote>
<hr>
<p>However, this doesn’t seem to be what Hill was referring to,</p>
<hr>
<blockquote class="blockquote">
<p>“Occasionally it is possible to appeal to experimental, or semi-experimental, evidence. For example, because of an observed association some preventive action is taken. Does it in fact prevent? The dust in the workshop is reduced, lubricating oils are changed, persons stop smoking cigarettes. Is the frequency of the associated events affected? Here the strongest support for the causation hypothesis may be revealed.”</p>
</blockquote>
<hr>
<p>To Hill, the most persuasive evidence for causation is removing a potentially harmful exposure and observing whether the frequency of the disease declines. This seems to be what he meant by experiment.</p>
<hr>
<p>Why It Doesn’t Hold Up</p>
<hr>
<blockquote class="blockquote">
<p>RGL: “It can be faulty, however, as the”semi-experimental” approach is nothing more than a “before-and-after” time trend analysis, which can be confounded or otherwise biased by a host of concomitant secular changes. Moreover, even if the removal of exposure does causally reduce the frequency of disease, it might not be for the etiologic reason hypothesized.</p>
<p>The draining of a swamp near a city, for instance, would predictable and causally reduce the rate of yellow fever or malaria in that city the following summer. But it would a mistake to call this observation the strongest possible evidence of a causal role of miasmas.”</p>
</blockquote>
<hr>
</section>
<section id="analogy" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Analogy</h1>
<hr>
<p>Here, Hill presents a viewpoint where if one can find a similar, but a plausible relationship to the one being studied, then this may provide evidence for a causal relationship.</p>
<hr>
<blockquote class="blockquote">
<p>“In some circumstances it would be fair to judge by analogy. With the effects of thalidomide and rubella before us we would surely be ready to accept slighter but similar evidence with another drug or another viral disease in pregnancy.”</p>
</blockquote>
<hr>
<p>Why It Doesn’t Hold Up</p>
<hr>
<p>The problem with the analogy viewpoint is that it is easy for any researcher to find an analogy to build a stronger case for a causal relationship. The presence of such analogies may be evidence of an actual signal or imagination, while the absence of such analogies may be a result of a lack of vision or experience.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700109/Site/Bohr.png" alt="Transparent image of the bohr model" style="width:40%"></p>
<hr>
<hr>
</section>
<section id="concluding-thoughts" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Concluding Thoughts</h1>
<hr>
<p>As we can see both from the original lecture by Hill himself and RGL, these “criteria” (viewpoints) have several limitations and exceptions. Many continue to use them as some gold-standard checklist to see whether they can argue causality even when Hill himself argued against this form of usage,</p>
<hr>
<blockquote class="blockquote">
<p>“Here then are nine different viewpoints from all of which we should study association before we cry causation. What I do not believe – and this has been suggested – that we can usefully lay down some hard-and-fast rules of evidence that must be obeyed before we can accept cause and effect.</p>
<p>None of my nine viewpoints can bring indisputable evidence for or against the cause-and-effect hypothesis and none can be required as a sine qua non. What they can do, with greater or less strength, is to help us to make up our minds on the fundamental question – is there any other way of explaining the set of facts before us, is there any other answer equally, or more, likely than cause and effect?”</p>
</blockquote>
<hr>
<p>Because I am a pessimist, I believe that these viewpoints will continue to be used in this way despite several writings discouraging such use.</p>
<p><a href="https://sciencebasedmedicine.org/estrogen-matters/">Science-Based Medicine</a>,</p>
<hr>
<blockquote class="blockquote">
<p>“They stress that correlation is not causation. So how can we approach the mosaic of findings with breast cancer? They show how each of the Bradford Hill criteria for causation supports the finding that smoking causes lung cancer. Then they show that the hypothesis that estrogen causes breast cancer fails to meet any of the Bradford Hill criteria.”</p>
</blockquote>
<hr>
<p><a href="https://www.skepticalraptor.com/skepticalraptorblog.php/biological-plausibility-keystone-vaccine-research/">Skeptical Raptor</a>,</p>
<hr>
<blockquote class="blockquote">
<p>English statistician Sir Austin Bradford Hill was interested in developing a set of objective criteria that could be used to provide epidemiological evidence of causality between a cause and effect. It serves as a sort of checklist for scientists who can take data that establishes correlation and then logically determine if that supports causality.</p>
<p>He used his criteria to establish that smoking was linked to lung cancer (and other diseases). He essentially went through each point of his criteria to show how smoking and cancer were linked.</p>
</blockquote>
<hr>
<p>No, no, no!</p>


<!-- -->

</section>

 ]]></description>
  <guid>https://lesslikely.com/posts/statistics/bradford-hill-criteria.html</guid>
  <pubDate>Thu, 06 Sep 2018 04:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700109/Site/BradfordHillCriteria.png" medium="image" type="image/png"/>
</item>
<item>
  <title>The Bradford Hill Criteria Don’t Hold Up</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/bradford-hill-criteria.html</link>
  <description><![CDATA[ 





<hr>
<p>In 1965, the epidemiologist, Austin Bradford Hill, who helped <a href="../../../medicine/smoking-and-lung-cancer">link smoking to lung cancer</a>, <a href="https://www.edwardtufte.com/tufte/hill">gave a speech</a> where he presented his <a href="https://en.wikipedia.org/wiki/Bradford_Hill_criteria">viewpoints</a> on how we can arrive at causation from correlation.</p>
<p>This lecture was a bit of a game changer at the time given that the tobacco industry was employing statisticians, medical doctors, and <a href="https://andrewgelman.com/2012/04/27/how-to-mislead-with-how-to-lie-with-statistics/">even popular science writers</a> to push the idea that the relationship between smoking and lung cancer was merely a correlation, not a causal one.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700112/Site/doctorsmarketingtobacco.jpg" alt="Marketing ad of tobacco from the late 1900s" style="width:50%"></p>
<hr>
<p>Both the tobacco industry and <a href="../../../uploads/FisherLTE.pdf">empiricists</a> argued that the existing data was not very convincing because there were no human experiments showing that smoking causes lung cancer. Of course, this was a sticky situation because it was neither ethical nor practical to randomize people and force them to smoke cigarettes and compare rates of lung cancer to a control group.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700119/Site/Fisher1946.jpg" alt="Picture of Ronald Fisher sitting and smoking" style="width:50%"></p>
<hr>
<p>Austin Bradford Hill and his co-investigator, <a href="https://en.wikipedia.org/wiki/Richard_Doll">Richard Doll</a>, were able to argue with compelling data from the <a href="https://en.wikipedia.org/wiki/British_Doctors_Study">British Doctors’ Study</a> that smoking cigarettes does indeed cause lung cancer, when combining these data with several other data (<a href="https://tobaccocontrol.bmj.com/content/21/2/87">molecular, cellular)</a> and referring to a set of viewpoints.</p>
<p>Since then, these viewpoints have been used as a sort of checklist/criteria in several papers and by several authors to assess causality when randomized trials weren’t possible. For example, <a href="https://sciencebasedmedicine.org">Science-Based Medicine</a> <a href="https://sciencebasedmedicine.org/causation-and-hills-criteria/">often refers to these viewpoints as criteria</a> and <a href="https://sciencebasedmedicine.org/estrogen-matters/">recently discussed</a> their usage in a blog post reviewing a <a href="https://www.amazon.com/Estrogen-Matters-Hormones-Menopause-Well-Being/dp/0316481203">book about hormonal therapy</a>.</p>
<p>In this post, drawing heavily from <a href="http://www.ovid.com/site/catalog/books/4634.jsp">Rothman, Greenland &amp; Lash, 2008</a> (from here on, RGL), I want to discuss these viewpoints, and why many of them don’t often hold up when critically examined.</p>
<p>Hill’s nine viewpoints were the following:</p>
<hr>
<section id="strength" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Strength</h1>
<hr>
<p>Stronger associations, according to Hill, were more compelling for causal relationships than weaker associations because of the possibility of unmeasured confounding leading to weak associations between two phenomena. He uses the example of smoking and cancer and compares it to thrombosis in smokers,</p>
<hr>
<blockquote class="blockquote">
<p>“…prospective inquiries into smoking have shown that the death rate from cancer of the lung in cigarette smokers is nine to ten times the rate in non-smokers and the rate in heavy cigarette smokers is twenty to thirty times as great. On the other hand the death rate from coronary thrombosis in smokers is no more than twice, possibly less, the death rate in non-smokers.”</p>
</blockquote>
<hr>
<p>It does indeed sound compelling. Science-Based Medicine uses the <a href="https://sciencebasedmedicine.org/causation-and-hills-criteria/">same argument</a> for alternative medicine,</p>
<hr>
<blockquote class="blockquote">
<p>“If acupuncture or homeopathy were 400 times superior to placebo, there would no discussion of its validity. Many medical therapies are not 400 times as effective as placebo, but the strength of the association between cause and effect is well above background noise.”</p>
</blockquote>
<hr>
<p>Why It Doesn’t Hold Up</p>
<hr>
<p>Several causal relationships that we know of today, such as the relationship between smoking and cardiovascular disease, and environmental tobacco smoke and lung cancer, had weak associations. However, Hill didn’t discount weak associations as seen here,</p>
<hr>
<blockquote class="blockquote">
<p>“In thus putting emphasis upon the strength of an association we must, nevertheless, look at the obverse of the coin. We must not be too ready to dismiss a cause and effect hypothesis merely on the grounds that the observed association appears to be slight. There are many occasions in medicine when this is in truth so.”</p>
</blockquote>
<hr>
<p>Okay, but really strong associations are more likely to be causal, right? Not necessarily. This criterion easily falls apart when considering relationships that are strongly associated, but noncausal. For example, there is a very strong relationship between Down syndrome and birth rank. However, this association is confounded by the relationship between Down syndrome and maternal age. Once, adjusting for this particular confounder, the association between Down syndrome and birth rank wanes.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700110/Site/confounding.png" alt="Drawing depicting what confounding looks like" style="width:80%"></p>
<hr>
<p>There is no reason to believe that this wouldn’t apply to many associations that happen to be very strong. It’s possible that many associations that are strong and not spurious are likely a result of several unmeasured confounders and strong bias.</p>
<p>It’s likely that most effects studied in the real world are small and few relationships of interest are similar to the one between smoking and lung cancer. As we can see, the strength of association doesn’t necessarily contribute to the determination of causality.</p>
<hr>
</section>
<section id="consistency" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Consistency</h1>
<hr>
<p>Hill defines something as being consistent if it has been observed in different people, in different places, and under different circumstances. Hill writes,</p>
<hr>
<blockquote class="blockquote">
<p>“Some of them on the customary tests of statistical significance will appear to be unlikely to be due to chance. Nevertheless whether chance is the explanation or whether a true hazard has been revealed may sometimes be answered only by a repetition of the circumstances and the observations.”</p>
</blockquote>
<hr>
<p>Science-Based Medicine writes,</p>
<hr>
<blockquote class="blockquote">
<p>“Almost every study should support the association for there to be causation.”</p>
</blockquote>
<hr>
<p>Why It Doesn’t Hold Up</p>
<hr>
<p>Several causal relationships may be circumstantial or unique to a particular population and may not occur in other scenarios; however, this does not rule out causality. RGL provide a great example of this: blood transfusions can lead to the receiver being infected with HIV, however, this <em>only</em> occurs if the virus is present in the donor’s blood.</p>
<p>If there is no virus, then the transfusion cannot cause HIV. However, just because blood transfusions don’t always cause HIV in several different scenarios doesn’t mean they don’t cause HIV in particular scenarios (with the virus present).</p>
<hr>
</section>
<section id="specificity" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Specificity</h1>
<hr>
<p>Hill described specificity in two components: that a specific cause leads to a single effect, and that an effect has one cause. He writes,</p>
<hr>
<blockquote class="blockquote">
<p>“One reason, needless to say, is the specificity of the association, the third characteristic which invariably we must consider. If as here, the association is limited to specific workers and to particular sites and types of disease and there is no association between the work and other modes of dying, then clearly that is a strong argument in favor of causation.”</p>
</blockquote>
<hr>
<p>Why It Doesn’t Hold Up</p>
<hr>
<p>This one makes little sense given that many exposures (such as smoking) are known to contribute to several disease and outcomes. However, Hill also acknowledged this in the same lecture,</p>
<hr>
<blockquote class="blockquote">
<p>“We must also keep in mind that diseases may have more than one cause. It has always been possible to acquire a cancer of the scrotum without sweeping chimneys of taking to mulespinning in Lancashire. One-to-one relationships are not frequent. Indeed I believe that multi-causation is generally more likely than single causation though possibly if we knew all the answer we might get back to a single factor.”</p>
</blockquote>
<hr>
</section>
<section id="temporality" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Temporality</h1>
<hr>
<p>Hill argued that for relationships to be causal, the cause needed to precede the effect,</p>
<hr>
<blockquote class="blockquote">
<p>“My fourth characteristic is the temporal relationship of the association – which is the cart and which is the horse? This is a question which might be particularly relevant with diseases of slow development. Does a particular diet lead to disease or do the early stages of the disease lead to those particular dietetic habits?</p>
<p>Does a particular occupation or occupational environment promote infection by the tubercle bacillus or are the men and women who select that kind of work more liable to contract tuberculosis whatever the environment – or, indeed, have they already contracted it? This temporal problem may not arise often, but it certainly needs to be remembered, particularly with selective factors at work in the industry.”</p>
</blockquote>
<hr>
<p>Why this holds up</p>
<hr>
<p>As RGL points out, this is inarguable,</p>
<hr>
<blockquote class="blockquote">
<p>“This criterion is inarguable, insofar as any claimed overvation of causation must involve the putative cause C preceding the putative effect D. It does not, however, follow that a reverse time order is evidence against the hypothesis that C can cause D. Rather, observations in which C followed D merely show that C could not have caused D in these instances, they provide no evidence for or against the hypothesis that C can cause D in those instances in which it precedes D. Only if it is found that C cannot precede D can we dispense with the causal hypothesis that C could cause D.”</p>
</blockquote>
<hr>
<p>Thus, this “criterion” does hold up and is a necessity.</p>
<hr>
</section>
<section id="biological-gradient" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Biological gradient</h1>
<hr>
<p>Hill’s fifth viewpoint is a referral to a dose-response relationship. For example, the more cigarettes one smokes, the higher the likelihood of developing lung cancer.</p>
<hr>
<blockquote class="blockquote">
<p>“Fifthly, if the association is one which can reveal a biological gradient, or dose-response curve, then we should look most carefully for such evidence. For instance, the fact that the death rate from cancer of the lung rises linearly with the number of cigarettes smoked daily, adds a very great deal to the simpler evidence that cigarette smokers have a higher death rate than non-smokers.</p>
<p>The comparison would be weakened, though not necessarily destroyed, if it depended upon, say, a much heavier death rate in light smokers and a lower rate in heavier smokers. We should then need to envisage some much more complex relationship to satisfy the cause and effect hypothesis. The clear dose-response curve admits of a simple explanation and obviously puts the case in a clearer light.”</p>
</blockquote>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700112/Site/dose_response_curves.jpg" alt="Graph showing a dose-response relationship from a microbiology experiment" style="width:80%"></p>
<hr>
<hr>
<p>Why It Doesn’t Hold Up</p>
<hr>
<p>RGL mentions several problems with this criterion.</p>
<p>First, although Hill mentions a “linear” relationship explicitly, he does not specify on which scale a relationship should be linear. Linear gradients on scales such as risk can easily become nonlinear on other scales such as log risk, odds, or log odds.</p>
<p>Although it is plausible that more carcinogenic exposure would lead to more tissue damage and a higher risk of developing lung cancer, there are causal relationships that are not dose-response relationships/monotonic. For example, the relationship between DES and adenocarcinoma of the vagina is causal. However, it has been observed to be a threshold effect rather than a monotonic one.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700136/Site/monotonic.png" alt="Generic graphs showing what monotonic and nonmonotonic relationships look like" style="width:100%"></p>
<hr>
<p>Many monotonic, dose-response relationships are not causal and are sometimes a result of confounding, in that the confounder itself is the cause of monotonicity (maybe because the confounder is a biological gradient).</p>
<p>As RGL summarizes,</p>
<hr>
<blockquote class="blockquote">
<p>“These issues imply that the existence of a monotonic association is neither necessary nor sufficient for a causal relation.”</p>
</blockquote>
<hr>
</section>
<section id="plausibility" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Plausibility</h1>
<hr>
<p>Hill argued that if a relationship seems biologically plausible, then that is more evidence in favor of a causal relationship. However, he also acknowledged that a relationship and its plausibility would depend on the knowledge at the time.</p>
<hr>
<blockquote class="blockquote">
<p>“It will be helpful if the causation we suspect is biologically plausible. But this is a feature I am convinced we cannot demand. What is biologically plausible depends upon the biological knowledge of the day.”</p>
</blockquote>
<hr>
<p>Why It Doesn’t Hold Up</p>
<hr>
<p>As Hill pointed out, this viewpoint depends heavily on the knowledge of the observer and their prior beliefs. What may seem biologically plausible to one researcher may seem entirely impossible for another researcher, even when the same research is available to the both of them. And many times, beliefs about plausibility can be flat out wrong,</p>
<hr>
<blockquote class="blockquote">
<p>RGL: “… Cheever in 1861, who had been commenting on the etiology of typhus before its mode of transmission (via body lice) was known:</p>
<p>It could be no more ridiculous for the stranger who passed the night in the steerage of an emigrant ship to ascribe the typhus, which he there contracted, to the vermin with which bodies of the sick might be infested. An adequate cause, one reasonable in itself, must correct the coincidences of simply experience.</p>
<p>What was to Cheever an implausible explanation turned out to the be the correct explanation, because it was indeed the vermin that caused the typhus infection. Such is the problem with plausibility: It is too often based not on logic or data, but only on prior beliefs. This is not too say that biologic knowledge should be discounted when a new hypothesis is being evaluated, but only to point the difficulty in applying that knowledge.”</p>
</blockquote>
<hr>
</section>
<section id="coherence" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Coherence</h1>
<hr>
<p>Hill describes coherence as,</p>
<hr>
<blockquote class="blockquote">
<p>“On the other hand the cause-and-effect interpretation of our data should not seriously conflict with the generally known facts of the natural history and biology of the disease – in the expression of the Advisory Committee to the Surgeon-General it should have coherence.”</p>
</blockquote>
<hr>
<p>This viewpoint is a bit difficult to discuss without repeating some of the arguments made against the plausibility viewpoint and the consistency viewpoint. However, Hill does elaborate a bit more on this view,</p>
<hr>
<blockquote class="blockquote">
<p>“Nevertheless, while such laboratory evidence can enormously strengthen the hypothesis and, indeed, may determine the actual causative agents, the lack of such evidence cannot nullify the epidemiological associations in man. Arsenic can undoubtedly cause cancer of the skin in man but it has never been possible to demonstrate such an effect on any other animal.”</p>
</blockquote>
<hr>
<p>Thus, according to Hill, the absence of coherent information cannot be taken as evidence against a causal relationship, but the presence of conflicting information can be considered as such evidence.</p>
<hr>
</section>
<section id="experimental-evidence" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Experimental Evidence</h1>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700128/Site/lab_mice.jpg" alt="Picture of mice in a lab" style="width:60%"></p>
<hr>
<p>As RGL point out, many assume the experiment viewpoint to be a referral to animal/human studies,</p>
<hr>
<blockquote class="blockquote">
<p>“To different observers, experimental evidence can refer to clinical trials, to laboratory experiments with rodents or other nonhuman organisms, or to both.”</p>
</blockquote>
<hr>
<p>Science-Based Medicine’s take on this viewpoint confirms what RGL claims,</p>
<hr>
<blockquote class="blockquote">
<p>“Always nice. Written in 1965, before the massive increase in biomedical research funding, experiments were not as vital in understanding diseases and treatments as they are today… There were no consistent studies discussing subluxation in the animal model.”</p>
</blockquote>
<hr>
<p>However, this doesn’t seem to be what Hill was referring to,</p>
<hr>
<blockquote class="blockquote">
<p>“Occasionally it is possible to appeal to experimental, or semi-experimental, evidence. For example, because of an observed association some preventive action is taken. Does it in fact prevent? The dust in the workshop is reduced, lubricating oils are changed, persons stop smoking cigarettes. Is the frequency of the associated events affected? Here the strongest support for the causation hypothesis may be revealed.”</p>
</blockquote>
<hr>
<p>To Hill, the most persuasive evidence for causation is removing a potentially harmful exposure and observing whether the frequency of the disease declines. This seems to be what he meant by experiment.</p>
<hr>
<p>Why It Doesn’t Hold Up</p>
<hr>
<blockquote class="blockquote">
<p>RGL: “It can be faulty, however, as the”semi-experimental” approach is nothing more than a “before-and-after” time trend analysis, which can be confounded or otherwise biased by a host of concomitant secular changes. Moreover, even if the removal of exposure does causally reduce the frequency of disease, it might not be for the etiologic reason hypothesized.</p>
<p>The draining of a swamp near a city, for instance, would predictable and causally reduce the rate of yellow fever or malaria in that city the following summer. But it would a mistake to call this observation the strongest possible evidence of a causal role of miasmas.”</p>
</blockquote>
<hr>
</section>
<section id="analogy" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Analogy</h1>
<hr>
<p>Here, Hill presents a viewpoint where if one can find a similar, but a plausible relationship to the one being studied, then this may provide evidence for a causal relationship.</p>
<hr>
<blockquote class="blockquote">
<p>“In some circumstances it would be fair to judge by analogy. With the effects of thalidomide and rubella before us we would surely be ready to accept slighter but similar evidence with another drug or another viral disease in pregnancy.”</p>
</blockquote>
<hr>
<p>Why It Doesn’t Hold Up</p>
<hr>
<p>The problem with the analogy viewpoint is that it is easy for any researcher to find an analogy to build a stronger case for a causal relationship. The presence of such analogies may be evidence of an actual signal or imagination, while the absence of such analogies may be a result of a lack of vision or experience.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700109/Site/Bohr.png" alt="Transparent image of the bohr model" style="width:40%"></p>
<hr>
<hr>
</section>
<section id="concluding-thoughts" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Concluding Thoughts</h1>
<hr>
<p>As we can see both from the original lecture by Hill himself and RGL, these “criteria” (viewpoints) have several limitations and exceptions. Many continue to use them as some gold-standard checklist to see whether they can argue causality even when Hill himself argued against this form of usage,</p>
<hr>
<blockquote class="blockquote">
<p>“Here then are nine different viewpoints from all of which we should study association before we cry causation. What I do not believe – and this has been suggested – that we can usefully lay down some hard-and-fast rules of evidence that must be obeyed before we can accept cause and effect.</p>
<p>None of my nine viewpoints can bring indisputable evidence for or against the cause-and-effect hypothesis and none can be required as a sine qua non. What they can do, with greater or less strength, is to help us to make up our minds on the fundamental question – is there any other way of explaining the set of facts before us, is there any other answer equally, or more, likely than cause and effect?”</p>
</blockquote>
<hr>
<p>Because I am a pessimist, I believe that these viewpoints will continue to be used in this way despite several writings discouraging such use.</p>
<p><a href="https://sciencebasedmedicine.org/estrogen-matters/">Science-Based Medicine</a>,</p>
<hr>
<blockquote class="blockquote">
<p>“They stress that correlation is not causation. So how can we approach the mosaic of findings with breast cancer? They show how each of the Bradford Hill criteria for causation supports the finding that smoking causes lung cancer. Then they show that the hypothesis that estrogen causes breast cancer fails to meet any of the Bradford Hill criteria.”</p>
</blockquote>
<hr>
<p><a href="https://www.skepticalraptor.com/skepticalraptorblog.php/biological-plausibility-keystone-vaccine-research/">Skeptical Raptor</a>,</p>
<hr>
<blockquote class="blockquote">
<p>English statistician Sir Austin Bradford Hill was interested in developing a set of objective criteria that could be used to provide epidemiological evidence of causality between a cause and effect. It serves as a sort of checklist for scientists who can take data that establishes correlation and then logically determine if that supports causality.</p>
<p>He used his criteria to establish that smoking was linked to lung cancer (and other diseases). He essentially went through each point of his criteria to show how smoking and cancer were linked.</p>
</blockquote>
<hr>
<p>No, no, no!</p>


<!-- -->

</section>

 ]]></description>
  <guid>https://lesslikely.com/posts/statistics/bradford-hill-criteria.html</guid>
  <pubDate>Thu, 06 Sep 2018 00:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700109/Site/BradfordHillCriteria.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Misuse of Standard Error in Clinical Trials</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/standard-error.html</link>
  <description><![CDATA[ 





<hr>
<p>Reporting effect sizes with their accompanying standard errors is necessary because it lets the reader interpret the magnitude of the treatment effect and the amount of uncertainty in that estimate. It is <em>magnitudes</em> better than not providing any effect size at all and only focusing on statements of statistical significance.</p>
<p>Although many authors provide standard errors with the intention of relaying the amount of uncertainty in the estimate, there are several misconceptions about when the standard error should be reported, and so it is often misused.</p>
<p>I believe it is worth explaining what exactly standard error is and how it differentiates from something like standard deviation. Standard deviation is a <em>descriptive statistic</em> that tells us about the variability of the data. Let’s quickly take a look at <em>how</em> it’s calculated using random data.</p>
<hr>
<section id="calculating-standard-deviation" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Calculating Standard Deviation</h1>
<hr>
<center>
<p><img src="https://latex.codecogs.com/png.latex?4,%205,%2010,%206,%207,%2010,%2010"></p>
<p><img src="https://latex.codecogs.com/png.latex?4%20+%205%20+%2010%20+%206%20+%207%20+%2010%20+%2010%20=%2052"></p>
<p>The mean is: <img src="https://latex.codecogs.com/png.latex?52%20/%207%20=%207.43"></p>
</center>
<p>Next, we calculate the sum of squared errors, which can be thought of as the total deviance from the mean. We calculate this by taking each value in the data (<img src="https://latex.codecogs.com/png.latex?4,%205,%2010,%206,%207,%2010,%2010">) and subtracting the mean from each value, which gives us the deviance.</p>
<center>
<p><img src="https://latex.codecogs.com/png.latex?(4%20-%207.43)%20=%20-3.43"></p>
<p><img src="https://latex.codecogs.com/png.latex?(5%20-%207.43)%20=%20-2.43"></p>
<p><img src="https://latex.codecogs.com/png.latex?(10%20-%207.43)%20=%202.57"></p>
<p><img src="https://latex.codecogs.com/png.latex?(6%20-%207.43)%20=%20-1.43"></p>
<p><img src="https://latex.codecogs.com/png.latex?(%207%20-%207.43)%20=%20-0.43"></p>
<p><img src="https://latex.codecogs.com/png.latex?(10%20-%207.43)%20=%202.57"></p>
<p><img src="https://latex.codecogs.com/png.latex?(10%20-%207.43)%20=%202.57"></p>
</center>
<p>All of the above values are deviances. We square each of them and add them together to get the <em>sum</em> of squared errors.</p>
<center>
<p><img src="https://latex.codecogs.com/png.latex?(-3.43)%5E2%20+%20(-2.43)%5E2%20+%20(2.57)%5E2%20+%20(-1.43)%5E2%20+%20(-0.43)%5E2%20+%20(2.57)%5E2%20+%20(2.57)%5E2%20="></p>
<p>Sum of Squared Errors = <img src="https://latex.codecogs.com/png.latex?39.68"></p>
</center>
<p>We get the variance by taking the sum of squared errors and dividing by the number of data points <img src="https://latex.codecogs.com/png.latex?-1">.</p>
<center>
<p><img src="https://latex.codecogs.com/png.latex?39.68%20/%207-1%20=%206.61"></p>
<p>Variance = <img src="https://latex.codecogs.com/png.latex?6.61"></p>
<p>Finally, we get the standard deviation by taking the square root of the variance, <img src="https://latex.codecogs.com/png.latex?(%5Csqrt%7B6.61%7D)"></p>
<p>Standard deviation = <img src="https://latex.codecogs.com/png.latex?2.57"></p>
</center>
<p>There we have it. Again, the standard deviation is a <em>descriptive statistic</em> which tells us about the <em>variability</em> of the data.</p>
<hr>
</section>
<section id="calculating-standard-error" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Calculating Standard Error</h1>
<hr>
<p>The standard error, on the other hand, is the standard deviation of the sampling distribution. It can be thought of as the standard deviation of several means. It is an <em>analytic statistic</em> that tells us about the uncertainty in our point estimate. It is calculated by taking the standard deviation and dividing it by the square root of the total number of data points.</p>
<center>
<p><img src="https://latex.codecogs.com/png.latex?2.57%20/%20(%5Csqrt7)%20=%200.97"></p>
<p>Standard error of the mean = <img src="https://latex.codecogs.com/png.latex?0.97"></p>
<p>This and the mean would typically be reported as such <img src="https://latex.codecogs.com/png.latex?7.43%20%C2%B1%200.97"></p>
</center>
<hr>
</section>
<section id="misuse-of-standard-error" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Misuse of Standard Error</h1>
<hr>
<p>In clinical trials, participants are often recruited nonrandomly but are assigned to groups via random assignment. This random allocation allows us to make inferences about those treatment differences (Kempthorne, 1977; Senn &amp; Auclair, 1990). So if the difference between the intervention group and the control group is 7.43 generic units, then we are justified in reporting the standard error (an analytic statistic) as 7.43 ± 0.97.</p>
<p>However, let’s say in a similar scenario (randomized controlled trial) that the intervention group after 12 weeks has an <em>average</em> of 7.43 generic units. Not a <em>difference</em> between the intervention group and the control group, but rather, an <em>average</em> of 7.43 generic units for the intervention group itself. The control group has an average of yy generic units. If we reported the average of the intervention group as 7.43 ± 0.97 (same numbers we calculated above), this would be incorrect.</p>
<p>It is appropriate to report an <em>analytic statistic</em> when there is some form of randomization involved to justify it. In clinical trials, where the focus is on the treatment differences, it would be appropriate to report the standard error for the differences but not the group averages themselves because there is no random sampling involved. Thus, we cannot make inferences from those group averages.</p>
<hr>
<blockquote class="blockquote">
<p>“For inferences to be drawn about averages (rather than differences) it is necessary to make the strong assumption of random sampling; this requires survey validity. In short, the analysis of clinical trials should estimate treatment differences.” (Senn &amp; Auclair, 1990)</p>
</blockquote>
<hr>
<p>In this scenario, it would make sense to report the group average with a descriptive statistic such as the standard deviation: 7.43 (2.57).</p>
<p>We are allowed to make inferences about the group averages, and thus report it as 7.43 ± 0.97 if there was random sampling involved, which is often done in surveys etc., but not very often in clinical trials.</p>
<p>Is this an actual problem? Yes. Although several papers have misreported these statistics, I’ll focus on a recent study (Cohen et al., 2018) that compared the ketogenic diet to the American Cancer Society diet in women with ovarian or endometrial cancer. Some of the outcomes were changes in total fat, android fat, visceral mass, and lean mass.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700147/Site/visceral_lean.png" alt="Example of standard error being misused in a study of weight loss in women" style="width:40%"></p>
<hr>
<p>Here, they graph the average change in lean mass and visceral mass in each of the groups and add the standard error of the mean as error bars, “Values are means ± SEMs.” Again, it would’ve been appropriate here to report the standard deviation rather than the standard error of the mean. That would’ve shown the variability of the group data.</p>
<hr>
</section>
<section id="references" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> References</h1>
<hr>
<p>Cohen, C. W., Fontaine, K. R., Arend, R. C., Alvarez, R. D., Leath, C. A., III, Huh, W. K., … Gower, B. A. (2018). A Ketogenic Diet Reduces Central Obesity and Serum Insulin in Women with Ovarian or Endometrial Cancer. <em>The Journal of Nutrition</em>, <em>148</em>(8), 1253–1260.</p>
<p>Kempthorne, O. (1977). Why randomize? <em>Journal of Statistical Planning and Inference</em>, <em>1</em>(1), 1–25.</p>
<p>Senn, S. J., &amp; Auclair, P. (1990). The graphical representation of clinical trials with particular reference to measurements over time. <em>Statistics in Medicine</em>, <em>9</em>(11), 1287–1302.</p>


<!-- -->

</section>

 ]]></description>
  <guid>https://lesslikely.com/posts/statistics/standard-error.html</guid>
  <pubDate>Tue, 07 Aug 2018 04:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700133/Site/Metabolic-Rates.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Misuse of Standard Error in Clinical Trials</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/standard-error.html</link>
  <description><![CDATA[ 





<hr>
<p>Reporting effect sizes with their accompanying standard errors is necessary because it lets the reader interpret the magnitude of the treatment effect and the amount of uncertainty in that estimate. It is <em>magnitudes</em> better than not providing any effect size at all and only focusing on statements of statistical significance.</p>
<p>Although many authors provide standard errors with the intention of relaying the amount of uncertainty in the estimate, there are several misconceptions about when the standard error should be reported, and so it is often misused.</p>
<p>I believe it is worth explaining what exactly standard error is and how it differentiates from something like standard deviation. Standard deviation is a <em>descriptive statistic</em> that tells us about the variability of the data. Let’s quickly take a look at <em>how</em> it’s calculated using random data.</p>
<hr>
<section id="calculating-standard-deviation" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Calculating Standard Deviation</h1>
<hr>
<center>
<p><img src="https://latex.codecogs.com/png.latex?4,%205,%2010,%206,%207,%2010,%2010"></p>
<p><img src="https://latex.codecogs.com/png.latex?4%20+%205%20+%2010%20+%206%20+%207%20+%2010%20+%2010%20=%2052"></p>
<p>The mean is: <img src="https://latex.codecogs.com/png.latex?52%20/%207%20=%207.43"></p>
</center>
<p>Next, we calculate the sum of squared errors, which can be thought of as the total deviance from the mean. We calculate this by taking each value in the data (<img src="https://latex.codecogs.com/png.latex?4,%205,%2010,%206,%207,%2010,%2010">) and subtracting the mean from each value, which gives us the deviance.</p>
<center>
<p><img src="https://latex.codecogs.com/png.latex?(4%20-%207.43)%20=%20-3.43"></p>
<p><img src="https://latex.codecogs.com/png.latex?(5%20-%207.43)%20=%20-2.43"></p>
<p><img src="https://latex.codecogs.com/png.latex?(10%20-%207.43)%20=%202.57"></p>
<p><img src="https://latex.codecogs.com/png.latex?(6%20-%207.43)%20=%20-1.43"></p>
<p><img src="https://latex.codecogs.com/png.latex?(%207%20-%207.43)%20=%20-0.43"></p>
<p><img src="https://latex.codecogs.com/png.latex?(10%20-%207.43)%20=%202.57"></p>
<p><img src="https://latex.codecogs.com/png.latex?(10%20-%207.43)%20=%202.57"></p>
</center>
<p>All of the above values are deviances. We square each of them and add them together to get the <em>sum</em> of squared errors.</p>
<center>
<p><img src="https://latex.codecogs.com/png.latex?(-3.43)%5E2%20+%20(-2.43)%5E2%20+%20(2.57)%5E2%20+%20(-1.43)%5E2%20+%20(-0.43)%5E2%20+%20(2.57)%5E2%20+%20(2.57)%5E2%20="></p>
<p>Sum of Squared Errors = <img src="https://latex.codecogs.com/png.latex?39.68"></p>
</center>
<p>We get the variance by taking the sum of squared errors and dividing by the number of data points <img src="https://latex.codecogs.com/png.latex?-1">.</p>
<center>
<p><img src="https://latex.codecogs.com/png.latex?39.68%20/%207-1%20=%206.61"></p>
<p>Variance = <img src="https://latex.codecogs.com/png.latex?6.61"></p>
<p>Finally, we get the standard deviation by taking the square root of the variance, <img src="https://latex.codecogs.com/png.latex?(%5Csqrt%7B6.61%7D)"></p>
<p>Standard deviation = <img src="https://latex.codecogs.com/png.latex?2.57"></p>
</center>
<p>There we have it. Again, the standard deviation is a <em>descriptive statistic</em> which tells us about the <em>variability</em> of the data.</p>
<hr>
</section>
<section id="calculating-standard-error" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Calculating Standard Error</h1>
<hr>
<p>The standard error, on the other hand, is the standard deviation of the sampling distribution. It can be thought of as the standard deviation of several means. It is an <em>analytic statistic</em> that tells us about the uncertainty in our point estimate. It is calculated by taking the standard deviation and dividing it by the square root of the total number of data points.</p>
<center>
<p><img src="https://latex.codecogs.com/png.latex?2.57%20/%20(%5Csqrt7)%20=%200.97"></p>
<p>Standard error of the mean = <img src="https://latex.codecogs.com/png.latex?0.97"></p>
<p>This and the mean would typically be reported as such <img src="https://latex.codecogs.com/png.latex?7.43%20%C2%B1%200.97"></p>
</center>
<hr>
</section>
<section id="misuse-of-standard-error" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Misuse of Standard Error</h1>
<hr>
<p>In clinical trials, participants are often recruited nonrandomly but are assigned to groups via random assignment. This random allocation allows us to make inferences about those treatment differences (Kempthorne, 1977; Senn &amp; Auclair, 1990). So if the difference between the intervention group and the control group is 7.43 generic units, then we are justified in reporting the standard error (an analytic statistic) as 7.43 ± 0.97.</p>
<p>However, let’s say in a similar scenario (randomized controlled trial) that the intervention group after 12 weeks has an <em>average</em> of 7.43 generic units. Not a <em>difference</em> between the intervention group and the control group, but rather, an <em>average</em> of 7.43 generic units for the intervention group itself. The control group has an average of yy generic units. If we reported the average of the intervention group as 7.43 ± 0.97 (same numbers we calculated above), this would be incorrect.</p>
<p>It is appropriate to report an <em>analytic statistic</em> when there is some form of randomization involved to justify it. In clinical trials, where the focus is on the treatment differences, it would be appropriate to report the standard error for the differences but not the group averages themselves because there is no random sampling involved. Thus, we cannot make inferences from those group averages.</p>
<hr>
<blockquote class="blockquote">
<p>“For inferences to be drawn about averages (rather than differences) it is necessary to make the strong assumption of random sampling; this requires survey validity. In short, the analysis of clinical trials should estimate treatment differences.” (Senn &amp; Auclair, 1990)</p>
</blockquote>
<hr>
<p>In this scenario, it would make sense to report the group average with a descriptive statistic such as the standard deviation: 7.43 (2.57).</p>
<p>We are allowed to make inferences about the group averages, and thus report it as 7.43 ± 0.97 if there was random sampling involved, which is often done in surveys etc., but not very often in clinical trials.</p>
<p>Is this an actual problem? Yes. Although several papers have misreported these statistics, I’ll focus on a recent study (Cohen et al., 2018) that compared the ketogenic diet to the American Cancer Society diet in women with ovarian or endometrial cancer. Some of the outcomes were changes in total fat, android fat, visceral mass, and lean mass.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700147/Site/visceral_lean.png" alt="Example of standard error being misused in a study of weight loss in women" style="width:40%"></p>
<hr>
<p>Here, they graph the average change in lean mass and visceral mass in each of the groups and add the standard error of the mean as error bars, “Values are means ± SEMs.” Again, it would’ve been appropriate here to report the standard deviation rather than the standard error of the mean. That would’ve shown the variability of the group data.</p>
<hr>
</section>
<section id="references" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> References</h1>
<hr>
<p>Cohen, C. W., Fontaine, K. R., Arend, R. C., Alvarez, R. D., Leath, C. A., III, Huh, W. K., … Gower, B. A. (2018). A Ketogenic Diet Reduces Central Obesity and Serum Insulin in Women with Ovarian or Endometrial Cancer. <em>The Journal of Nutrition</em>, <em>148</em>(8), 1253–1260.</p>
<p>Kempthorne, O. (1977). Why randomize? <em>Journal of Statistical Planning and Inference</em>, <em>1</em>(1), 1–25.</p>
<p>Senn, S. J., &amp; Auclair, P. (1990). The graphical representation of clinical trials with particular reference to measurements over time. <em>Statistics in Medicine</em>, <em>9</em>(11), 1287–1302.</p>


<!-- -->

</section>

 ]]></description>
  <guid>https://lesslikely.com/posts/statistics/standard-error.html</guid>
  <pubDate>Tue, 07 Aug 2018 00:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700133/Site/Metabolic-Rates.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Vitamin E, Mortality, and the Bayesian Gloss</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/bayesian-vitamin-e.html</link>
  <description><![CDATA[ 





<hr>
<p>Bayesian data analysis is beginning to gain traction in several fields. Some of those reasons include that it allows individuals to represent uncertainty using probability distributions and it helps them avoid losing information that’s typically lost with point estimates and dichotomization.</p>
<p>Bayesian inference also allows for relevant background information to be incorporated into a model using a more continuous approach rather than making binary decisions about what to include.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700109/Site/bayes.png" alt="How Bayes incorporates prior beliefs and data into the posterior" style="width:60%"></p>
<hr>
<p>This approach generally plays out well when the background information being incorporated is based on empirical evidence. However, when a prior is poorly chosen and is given a lot of weight, it transfers into the posterior distribution and can yield results that are no more helpful than using a frequentist approach.</p>
<p>Sander Greenland discusses this particular issue <a href="http://journals.sagepub.com/doi/abs/10.1177/1740774509103251?journalCode=ctja">in depth</a> in his response to a <a href="http://journals.sagepub.com/doi/abs/10.1177/1740774508101279">Bayesian meta-analysis</a> that was done on Vitamin E and mortality.</p>
<p>To give some context, it was well known in the biochemical literature at the time that antioxidants reduced oxidative stress, so naturally, everyone was interested to see whether antioxidant supplements, such as Vitamin E could be used for any health outcomes.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700108/Site/antioxidants-molecules.png" alt="Cartoon image showing how antioxidant molecules and free radicals interact via electrons" style="width:80%"></p>
<hr>
<p>Several randomized controlled trials had investigated the effects of vitamin E supplementation on mortality, and a few conventional meta-analyses that pooled these studies found that:</p>
<ul>
<li><p>high doses of vitamin E supplementation <a href="https://www.ncbi.nlm.nih.gov/pubmed/15537682">increased</a> the risk of mortality</p></li>
<li><p>low doses of vitamin E <a href="https://www.ncbi.nlm.nih.gov/pubmed/15537682">reduced</a> the risk of mortality</p></li>
<li><p>studies that were at <strong>low risk</strong> of bias showed that vitamin E <a href="https://www.ncbi.nlm.nih.gov/pubmed/17327526">increased</a> the risk of mortality</p></li>
<li><p>studies that were at <strong>high risk</strong> of bias showed that vitamin E <a href="https://www.ncbi.nlm.nih.gov/pubmed/17327526">decreased</a> the risk of mortality.</p></li>
</ul>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700123/Site/ForestPlot.png" alt="Forest plot depicting the results of a meta-analysis of vitamin E studies"></p>
<hr>
<p>The data weren’t all in agreement. But based on what we knew of mechanisms, combined with the human data, it made sense to believe that vitamin E, at specific dosages, may have helped certain people (people with deficiencies), been useless for a lot of people, and harmed others (induced toxicity). It doesn’t make much sense to conclude that vitamin E has no effect and to extrapolate this to the whole population.</p>
<p>Furthermore, many of the meta-analyses were pooling together trials that used the synthetic form of Vitamin E, dl-tocopheryl acetate, a racemic mixture comprising 50% of but one of 8 known active naturally occurring molecules with vitamin E activity and extrapolating these results to the entire class of molecules.</p>
<p>It would be the equivalent to studying only Vitamin K1 in trials, which is found in plants, finding little to no activity on various biomarkers, and extrapolating those results to the entire Vitamin K class with meta-analyses. So from the beginning, many of these meta-analyses and their conclusions were already displaying ignorance of biochemistry.</p>
<p>In 2009, <a href="http://journals.sagepub.com/doi/abs/10.1177/1740774508101279">a group of researchers</a> wanted to end the confusion regarding vitamin E and mortality and decided to go with a Bayesian hierarchical meta-analysis and incorporate prior information into the model, thinking that it would be the solution the mixed results found in the past. They explain their reasoning for using a Bayesian meta-analysis,</p>
<hr>
<blockquote class="blockquote">
<p>“This relationship should be modeled in a robust fashion and presented in a way that clarifies the strength of the relationship and, to the extent possible, resolves residual uncertainties about the relationship and its strength. We take an approach that is ideally suited for both purposes: Bayesian hierarchical modeling [4,17]. This approach makes assumptions that are less restrictive than those of a conventional meta-analysis”…</p>
<p>“We regard the collection of available studies as a sample from the larger population of studies that address the effects of vitamin E on mortality. Conclusions are possible for the population of studies. And because each study is a member of this population, posterior distributions are available for the effects within individual studies, ‘borrowing strength’ from the other studies in the sample.”</p>
</blockquote>
<hr>
<p>They explored four possible relationships that could explain the association between vitamin E and mortality,</p>
<hr>
<blockquote class="blockquote">
<p>“We examine four mean functions: (1) no vitamin E effect; (2) a quadratic-linear spline; (3) a linear dose effect; and (4) a quadratic dose effect. A Bayesian approach enables such statements as, ‘the probability that vitamin E increases all-cause mortality…’. In addition, the Bayesian modeling averaging aspect of the analysis allows us to draw conclusions such as the probability that a model for a dose–response relationship is correct (within a specified collection of models).</p>
<p>Rather than base our conclusions on a single model as done in other meta-analyses [14–16], we allow a variety of dose–response relationships to contribute to our final conclusion by averaging the results based on the probability that each model is correct.”</p>
</blockquote>
<hr>
<p>They gave each of these models equal weights,</p>
<hr>
<blockquote class="blockquote">
<p>“Specifically, considering the four mean structures for the dose– response relationship: (1) no E effect, (2) spline, (3) linear, and (4) quadratic, we give those four structures the same probability a priori and find the posterior probabilities that each is the correct model among those considered. Consistent with the standard rules of probability, we average the results of the four models to find a final posterior probability, accounting for uncertainty in the choice of models.”</p>
</blockquote>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700143/Site/Prior-Posterior.png" alt="Posterior probabilities from the Bayesian meta-analysis of vitamin E studies"></p>
<hr>
<p>They report,</p>
<hr>
<blockquote class="blockquote">
<p>“As shown in Table 4, the most likely models are the no E effect, with posterior probability 0.94, and the spline, with posterior probability 0.04.”</p>
</blockquote>
<hr>
<p>Greenland responds with,</p>
<hr>
<blockquote class="blockquote">
<p>“My chief objection to BWN’s analysis is the priors it places on vitamin-E effects and effect variation (heterogeneity, interaction). BWN’s model averaging places a special lump (mass) or ‘spike’ of prior probability on each candidate model, including models with no vitamin-E effect, a linear effect, or no variation in effect across covariates (see their Table 4 and supplementaryTable 1).</p>
<p>The inclusion of spikes on these models is not justified by any external information given in BWN. On the contrary, human trials were conducted precisely because other research suggested benefits of vitamin E for health-related endpoints.</p>
<p>If we also recognize that there must be some dose of vitamin E that is toxic, we have no basis for giving extra weight to null models. I thus infer (and my own analysis confirms) that BWN’s use of prior probability spikes on these models pushes them to a stronger null conclusion than would be supported by analyses using priors based on actual external data. In other words, their priors inflate the posterior probability on the null, producing an overconfident inference of ‘no effect.’</p>
</blockquote>
<hr>
<p>Back to the Bayesian meta-analysts who conclude from their results,</p>
<hr>
<blockquote class="blockquote">
<p>“In summary, our Bayesian meta-analysis of data from 22 clinical trials concludes that vitamin E is unlikely to affect all-cause mortality, and that this is true regardless of dose.”</p>
</blockquote>
<hr>
<p>Sander Greenland returns with,</p>
<hr>
<blockquote class="blockquote">
<p>“This cannot be literally true. Background information says that vitamin supplements will affect mortality in a fashion dependent on dietary and metabolic covariates: * First, by the definition of ‘vitamin,’ deficiency states are possible and can be ameliorated by supplements. * Second, as with every essential substance (including oxygen and water) there will be a point of toxicity. Furthermore, the doses yielding benefit and harm will vary across individuals, e.g., individuals with adequate diets will get no benefit in the form of deficiency protection.</p>
<p>If anyone is affected, however, supplement use must affect mortality, although this effect may be beyond detection in feasible trials. I also dislike the wording of BWN’s conclusion. Language is important: To the detriment of science, much statistics has been the art of appearing objective and mathematically precise even when dozens of subjective judgments go into producing the final results [12,13].</p>
<p>BWN refer to their prior driven subjective probabilities as if those were singular objective quantities, as when they claim that ’Vitamin E intake is unlikely to affect mortality regardless of dose.”</p>
</blockquote>
<hr>
<p>He continues later on,</p>
<hr>
<blockquote class="blockquote">
<p>“As a corollary, Bayesian analysis may mislead readers if it objectifies probability statements. Objectification invites deceptively unconditional claims about probabilities of hypotheses, such as BWN’s claim that ‘Vitamin E intake is unlikely to affect mortality regardless of dose.’</p>
<p>This statement sounds as if the subjective conclusion is a discovered biological fact, when it is only a psychological fact, a posterior belief about the null hypothesis based on priors that others (such as myself) find objectionable. For each hypothesis there will be many probabilities, including BWN’s probability, my probability, and your probability, derived from the different models and priors acceptable to BWN, me, and you.”</p>
</blockquote>
<hr>
<p>This might sound crazy but I think Sander Greenland is on to something here…</p>


<!-- -->


 ]]></description>
  <guid>https://lesslikely.com/posts/statistics/bayesian-vitamin-e.html</guid>
  <pubDate>Wed, 20 Jun 2018 04:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700109/Site/bayes.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Vitamin E, Mortality, and the Bayesian Gloss</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/bayesian-vitamin-e.html</link>
  <description><![CDATA[ 





<hr>
<p>Bayesian data analysis is beginning to gain traction in several fields. Some of those reasons include that it allows individuals to represent uncertainty using probability distributions and it helps them avoid losing information that’s typically lost with point estimates and dichotomization.</p>
<p>Bayesian inference also allows for relevant background information to be incorporated into a model using a more continuous approach rather than making binary decisions about what to include.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700109/Site/bayes.png" alt="How Bayes incorporates prior beliefs and data into the posterior" style="width:60%"></p>
<hr>
<p>This approach generally plays out well when the background information being incorporated is based on empirical evidence. However, when a prior is poorly chosen and is given a lot of weight, it transfers into the posterior distribution and can yield results that are no more helpful than using a frequentist approach.</p>
<p>Sander Greenland discusses this particular issue <a href="http://journals.sagepub.com/doi/abs/10.1177/1740774509103251?journalCode=ctja">in depth</a> in his response to a <a href="http://journals.sagepub.com/doi/abs/10.1177/1740774508101279">Bayesian meta-analysis</a> that was done on Vitamin E and mortality.</p>
<p>To give some context, it was well known in the biochemical literature at the time that antioxidants reduced oxidative stress, so naturally, everyone was interested to see whether antioxidant supplements, such as Vitamin E could be used for any health outcomes.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700108/Site/antioxidants-molecules.png" alt="Cartoon image showing how antioxidant molecules and free radicals interact via electrons" style="width:80%"></p>
<hr>
<p>Several randomized controlled trials had investigated the effects of vitamin E supplementation on mortality, and a few conventional meta-analyses that pooled these studies found that:</p>
<ul>
<li><p>high doses of vitamin E supplementation <a href="https://www.ncbi.nlm.nih.gov/pubmed/15537682">increased</a> the risk of mortality</p></li>
<li><p>low doses of vitamin E <a href="https://www.ncbi.nlm.nih.gov/pubmed/15537682">reduced</a> the risk of mortality</p></li>
<li><p>studies that were at <strong>low risk</strong> of bias showed that vitamin E <a href="https://www.ncbi.nlm.nih.gov/pubmed/17327526">increased</a> the risk of mortality</p></li>
<li><p>studies that were at <strong>high risk</strong> of bias showed that vitamin E <a href="https://www.ncbi.nlm.nih.gov/pubmed/17327526">decreased</a> the risk of mortality.</p></li>
</ul>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700123/Site/ForestPlot.png" alt="Forest plot depicting the results of a meta-analysis of vitamin E studies"></p>
<hr>
<p>The data weren’t all in agreement. But based on what we knew of mechanisms, combined with the human data, it made sense to believe that vitamin E, at specific dosages, may have helped certain people (people with deficiencies), been useless for a lot of people, and harmed others (induced toxicity). It doesn’t make much sense to conclude that vitamin E has no effect and to extrapolate this to the whole population.</p>
<p>Furthermore, many of the meta-analyses were pooling together trials that used the synthetic form of Vitamin E, dl-tocopheryl acetate, a racemic mixture comprising 50% of but one of 8 known active naturally occurring molecules with vitamin E activity and extrapolating these results to the entire class of molecules.</p>
<p>It would be the equivalent to studying only Vitamin K1 in trials, which is found in plants, finding little to no activity on various biomarkers, and extrapolating those results to the entire Vitamin K class with meta-analyses. So from the beginning, many of these meta-analyses and their conclusions were already displaying ignorance of biochemistry.</p>
<p>In 2009, <a href="http://journals.sagepub.com/doi/abs/10.1177/1740774508101279">a group of researchers</a> wanted to end the confusion regarding vitamin E and mortality and decided to go with a Bayesian hierarchical meta-analysis and incorporate prior information into the model, thinking that it would be the solution the mixed results found in the past. They explain their reasoning for using a Bayesian meta-analysis,</p>
<hr>
<blockquote class="blockquote">
<p>“This relationship should be modeled in a robust fashion and presented in a way that clarifies the strength of the relationship and, to the extent possible, resolves residual uncertainties about the relationship and its strength. We take an approach that is ideally suited for both purposes: Bayesian hierarchical modeling [4,17]. This approach makes assumptions that are less restrictive than those of a conventional meta-analysis”…</p>
<p>“We regard the collection of available studies as a sample from the larger population of studies that address the effects of vitamin E on mortality. Conclusions are possible for the population of studies. And because each study is a member of this population, posterior distributions are available for the effects within individual studies, ‘borrowing strength’ from the other studies in the sample.”</p>
</blockquote>
<hr>
<p>They explored four possible relationships that could explain the association between vitamin E and mortality,</p>
<hr>
<blockquote class="blockquote">
<p>“We examine four mean functions: (1) no vitamin E effect; (2) a quadratic-linear spline; (3) a linear dose effect; and (4) a quadratic dose effect. A Bayesian approach enables such statements as, ‘the probability that vitamin E increases all-cause mortality…’. In addition, the Bayesian modeling averaging aspect of the analysis allows us to draw conclusions such as the probability that a model for a dose–response relationship is correct (within a specified collection of models).</p>
<p>Rather than base our conclusions on a single model as done in other meta-analyses [14–16], we allow a variety of dose–response relationships to contribute to our final conclusion by averaging the results based on the probability that each model is correct.”</p>
</blockquote>
<hr>
<p>They gave each of these models equal weights,</p>
<hr>
<blockquote class="blockquote">
<p>“Specifically, considering the four mean structures for the dose– response relationship: (1) no E effect, (2) spline, (3) linear, and (4) quadratic, we give those four structures the same probability a priori and find the posterior probabilities that each is the correct model among those considered. Consistent with the standard rules of probability, we average the results of the four models to find a final posterior probability, accounting for uncertainty in the choice of models.”</p>
</blockquote>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700143/Site/Prior-Posterior.png" alt="Posterior probabilities from the Bayesian meta-analysis of vitamin E studies"></p>
<hr>
<p>They report,</p>
<hr>
<blockquote class="blockquote">
<p>“As shown in Table 4, the most likely models are the no E effect, with posterior probability 0.94, and the spline, with posterior probability 0.04.”</p>
</blockquote>
<hr>
<p>Greenland responds with,</p>
<hr>
<blockquote class="blockquote">
<p>“My chief objection to BWN’s analysis is the priors it places on vitamin-E effects and effect variation (heterogeneity, interaction). BWN’s model averaging places a special lump (mass) or ‘spike’ of prior probability on each candidate model, including models with no vitamin-E effect, a linear effect, or no variation in effect across covariates (see their Table 4 and supplementaryTable 1).</p>
<p>The inclusion of spikes on these models is not justified by any external information given in BWN. On the contrary, human trials were conducted precisely because other research suggested benefits of vitamin E for health-related endpoints.</p>
<p>If we also recognize that there must be some dose of vitamin E that is toxic, we have no basis for giving extra weight to null models. I thus infer (and my own analysis confirms) that BWN’s use of prior probability spikes on these models pushes them to a stronger null conclusion than would be supported by analyses using priors based on actual external data. In other words, their priors inflate the posterior probability on the null, producing an overconfident inference of ‘no effect.’</p>
</blockquote>
<hr>
<p>Back to the Bayesian meta-analysts who conclude from their results,</p>
<hr>
<blockquote class="blockquote">
<p>“In summary, our Bayesian meta-analysis of data from 22 clinical trials concludes that vitamin E is unlikely to affect all-cause mortality, and that this is true regardless of dose.”</p>
</blockquote>
<hr>
<p>Sander Greenland returns with,</p>
<hr>
<blockquote class="blockquote">
<p>“This cannot be literally true. Background information says that vitamin supplements will affect mortality in a fashion dependent on dietary and metabolic covariates: * First, by the definition of ‘vitamin,’ deficiency states are possible and can be ameliorated by supplements. * Second, as with every essential substance (including oxygen and water) there will be a point of toxicity. Furthermore, the doses yielding benefit and harm will vary across individuals, e.g., individuals with adequate diets will get no benefit in the form of deficiency protection.</p>
<p>If anyone is affected, however, supplement use must affect mortality, although this effect may be beyond detection in feasible trials. I also dislike the wording of BWN’s conclusion. Language is important: To the detriment of science, much statistics has been the art of appearing objective and mathematically precise even when dozens of subjective judgments go into producing the final results [12,13].</p>
<p>BWN refer to their prior driven subjective probabilities as if those were singular objective quantities, as when they claim that ’Vitamin E intake is unlikely to affect mortality regardless of dose.”</p>
</blockquote>
<hr>
<p>He continues later on,</p>
<hr>
<blockquote class="blockquote">
<p>“As a corollary, Bayesian analysis may mislead readers if it objectifies probability statements. Objectification invites deceptively unconditional claims about probabilities of hypotheses, such as BWN’s claim that ‘Vitamin E intake is unlikely to affect mortality regardless of dose.’</p>
<p>This statement sounds as if the subjective conclusion is a discovered biological fact, when it is only a psychological fact, a posterior belief about the null hypothesis based on priors that others (such as myself) find objectionable. For each hypothesis there will be many probabilities, including BWN’s probability, my probability, and your probability, derived from the different models and priors acceptable to BWN, me, and you.”</p>
</blockquote>
<hr>
<p>This might sound crazy but I think Sander Greenland is on to something here…</p>


<!-- -->


 ]]></description>
  <guid>https://lesslikely.com/posts/statistics/bayesian-vitamin-e.html</guid>
  <pubDate>Wed, 20 Jun 2018 00:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700109/Site/bayes.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Problems with the Number Needed to Treat</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/problems-with-nnt.html</link>
  <description><![CDATA[ 





<div class="cell">
<style type="text/css">
table {
  margin: auto;
  border-top: 3px solid #666;
  border-bottom: 3px solid #666;
}
.table > thead > tr > th {
    border-bottom: 3px solid #666;
}
</style>
</div>
<hr>
<p>The number needed to treat (NNT) is a popular statistic used in medicine and its use is encouraged by groups like <a href="http://handbook-5-1.cochrane.org/chapter_12/12_5_2_more_about_the_number_needed_to_treat_nnt.htm">Cochrane</a> and <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1124816/#B1">CONSORT</a>. Even the famous statistician, Doug Altman was a big proponent of it. Why is it so popular? Most believe that the NNT is more understandable than measures like odds ratios or risk ratios or statistics like the absolute risk reduction. The NNT is also believed to convey more meaningful information.</p>
<hr>
<p>In this blog post, I am going to discuss:</p>
<hr>
<ul>
<li><p>what the NNT is</p></li>
<li><p>how to calculate an NNT</p></li>
<li><p>some of the problems associated with the use of the NNT</p></li>
<li><p>solutions to the problems associated with the use of the NNT</p></li>
</ul>
<hr>
<p>The NNT is defined as the number of patients that need to be treated for one patient to experience a positive outcome or for one patient not to experience an adverse outcome. So, an NNT of 100 means that 100 patients need to be treated for one patient actually to benefit. The NNT is the inverse of the absolute risk reduction (ARR) (1/ARR). I will show how they are calculated with a sample contingency table from a controlled study comparing the drug Apixaban to placebo for recurrent thromboembolism (RT). Apixaban is the treatment for the first row and placebo is the treatment for the second row. Bolded numbers are the totals.</p>
<hr>
<div class="cell">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-hover caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; color: rgba(119, 119, 119, 255) !important; font-size: 18px; position: sticky; top: 0; background-color: #dedede00;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: rgba(119, 119, 119, 255) !important; font-size: 18px; position: sticky; top: 0; background-color: #dedede00;">Recurring Events</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: rgba(119, 119, 119, 255) !important; font-size: 18px; position: sticky; top: 0; background-color: #dedede00;">Non Recurring Events</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: rgba(119, 119, 119, 255) !important; font-size: 18px; position: sticky; top: 0; background-color: #dedede00;">Total Events</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Apixaban</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">826</td>
<td style="text-align: center; font-weight: bold; color: rgba(119, 119, 119, 255) !important;">840</td>
</tr>
<tr class="even">
<td style="text-align: left;">Control</td>
<td style="text-align: center;">73</td>
<td style="text-align: center;">756</td>
<td style="text-align: center; font-weight: bold; color: rgba(119, 119, 119, 255) !important;">829</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total Events</td>
<td style="text-align: center;">87</td>
<td style="text-align: center;">1582</td>
<td style="text-align: center; font-weight: bold; color: rgba(119, 119, 119, 255) !important;">1669</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<hr>
<section id="calculations" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Calculations</h1>
<hr>
<p>We will calculate four different measures: incidence proportions, absolute risk reduction, relative risk, and then the NNT.</p>
<hr>
<section id="incidence-proportions" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="incidence-proportions"><span class="header-section-number">1.1</span> Incidence Proportions</h2>
<hr>
<p>In the group that received the drug, 14 people experienced RT out of 840 people (14/840). So, about <strong>1.7%</strong>. In the control group, 73 people experienced disease progression out of 829 people (73/829), which is <strong>8.8%</strong>. These are incidence proportions.</p>
<hr>
</section>
<section id="absolute-risk-reduction" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="absolute-risk-reduction"><span class="header-section-number">1.2</span> Absolute Risk Reduction</h2>
<hr>
<p>We calculate the absolute risk reduction by finding the difference between the incidence proportions: <strong>8.8%</strong> (control group) - <strong>1.7%</strong> (treatment group) = <strong>7.1%</strong> So, the use of the drug Apixaban lowered the absolute risk of RT by <strong>7.1%.</strong></p>
<hr>
</section>
<section id="relative-risk" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="relative-risk"><span class="header-section-number">1.3</span> Relative Risk</h2>
<hr>
<p>Most people do not enjoy thinking in terms of absolute risk reduction, and they prefer to think in terms of relative risk. We calculate the relative risk by taking the incidence rates and dividing them by one another. So, 8.8% / 1.7% = <strong>5.2</strong></p>
<p>In words, patients who took placebo were <strong>5.2 times more likely</strong> to develop RT than patients who took Apixaban.</p>
<p>We can also do 1.7% / 8.8% = <strong>0.19</strong>, which means that people who were treated with Apixaban had <strong>19%</strong> of the risk that the control group had in developing RT.</p>
<hr>
</section>
<section id="numbers-needed-to-treat" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="numbers-needed-to-treat"><span class="header-section-number">1.4</span> Numbers Needed to Treat</h2>
<hr>
<p>Relative risk is more easily understood than absolute risk reduction, but relative risk can also be deceiving, and most in medicine prefer to work with absolute risk reduction, so they prefer to use the numbers needed to treat which can be calculated by taking the inverse of the absolute risk reduction which is 1 / 7.1 = <strong>14</strong>. This means that <strong>14</strong> people need to be treated with Apixaban to prevent one case of recurrent thromboembolism.</p>
<p>Now that we know how to calculate the NNT, we can discuss the problems with it.</p>
<hr>
<blockquote class="blockquote">
<p>A minor note before I get into this, some statisticians are entirely against the use of the NNT because they believe that it has poor statistical properties mainly due to its non-monotonicity and fusion with infinity as a possible value (Duncan &amp; Olkin, 2005; Hutton, 2000; Kristiansen, Gyrd-Hansen, Nexøe, &amp; Nielsen, 2004; Stang, Poole, &amp; Bender, 2010; Wu &amp; Kottke, 2001).</p>
<p>There are also several other problems such as bias that cannot be corrected for and difficulty calculating confidence intervals with standard errors. Most of these statisticians recommend using the absolute risk reduction instead because it has good statistical properties.</p>
<p>I have listed the papers in the reference section of this article.</p>
</blockquote>
<hr>
</section>
</section>
<section id="major-problem-missing-information" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Major Problem: Missing Information</h1>
<p>A significant problem with the use of the NNT is that it does not provide much information. For example, if we look at the <a href="http://www.thennt.com/">NNT group website</a>, a popular website that classifies interventions by the NNT of an intervention, this is what they have listed at the top of the page for blood pressure medication and mortality/CVD outcomes</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700141/Site/NNT_hypertension_benefits.png" alt="Image taken from the NNT website displaying the benefits of antihypertensive drugs" style="width:60%"></p>
<hr>
<p>And another page about hypertension but mainly focused on primary prevention.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700140/Site/NNT_hypertension_harms.png" alt="Image taken from the NNT website displaying the harms of antihypertensive drugs" style="width:60%"></p>
<hr>
<p>Then one on statins.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700140/Site/NNT_statins.png" alt="Image taken from the NNT website displaying the NNT for statins" style="width:60%"></p>
<hr>
<section id="comparator" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="comparator"><span class="header-section-number">2.1</span> Comparator</h2>
<hr>
<p>Now, most people might take these NNTs and compare them across the board, but unfortunately, you cannot do this if you do not know what the comparators being used here are. The NNT group does have the comparators listed in the middle of the page, but they should be at the top right next to the NNT.</p>
<p>Is it likely that statins are superior to antihypertension medication for primary prevention of CVD events? Probably, I’m not entirely sure. Can we compare them this easily by using only NNTs? No.</p>
<p>As (Stang et al., 2010) points out,</p>
<hr>
<blockquote class="blockquote">
<p>“A statement such as ‘‘This antihypertensive drug has an NNT of 50’’ is not informative unless the comparator is given.”</p>
</blockquote>
<hr>
<p>The NNT seem very easy to understand but are not interpretable without explicit mention of their comparator.</p>
<hr>
<blockquote class="blockquote">
<p>Solution: Explicitly state the comparator next to each NNT.</p>
</blockquote>
<hr>
</section>
<section id="uncertainty" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="uncertainty"><span class="header-section-number">2.2</span> Uncertainty</h2>
<hr>
<p>Another problem is the lack of confidence intervals for the NNTs. Again, NNTs are point estimates, and the uncertainty of the estimate should be displayed right next to the estimate; otherwise, readers will be fooled into thinking that the number is a definitive estimate.</p>
<hr>
<blockquote class="blockquote">
<p>Solution: Calculate and display the confidence intervals of the NNT right next to it.</p>
</blockquote>
<hr>
</section>
<section id="time-period" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="time-period"><span class="header-section-number">2.3</span> Time Period</h2>
<hr>
<p>An NNT without the accompanying time period of the trial or cohort is genuinely meaningless and deceptive when compared across the board. For example, if fish oil for preventing heart attacks had a hypothetical NNT of 10,000 in an RCT that was one year long, and another NNT that was 500 in an RCT that was ten years long, you cannot just blindly compare an NNT of 10,000 to an NNT of 500. Perhaps the intervention takes a long time to work. You are, again, missing vital information if you state the NNT without any accompanying information.</p>
<hr>
<blockquote class="blockquote">
<p>Solution: State the time period of the study that the NNT is calculated from.</p>
</blockquote>
<hr>
</section>
<section id="rounding-nnts" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="rounding-nnts"><span class="header-section-number">2.4</span> Rounding NNTs</h2>
<hr>
<p>Another typical behavior is to round NNTs up because most people do not think it makes much sense to think of part of a patient. For example, people would rather not think that it takes 14.3 patients for one patient to benefit, so they round up. This is a mistake because numbers needed to treat were never meant to be discrete integers, they are estimates and the inverse of risk reductions.</p>
<p>Here’s an example by Stang et al.:</p>
<hr>
<p>If we had an absolute risk reduction that could be between 0.349 and 0.49 and we took the numbers needed to treat from the absolute risk reduction in this interval, they would all round up to 3!</p>
<p>1 / 0.349 = <strong>2.865</strong> is the NNT when the absolute risk reduction is 0.349</p>
<p>1 / 0.40 = <strong>2.5</strong> is the NNT when absolute risk reduction is 0.4</p>
<p>1 / 0.49 = <strong>2.04</strong> is the NNT when absolute risk reduction is 0.49</p>
<p>In practice, all of these NNTs would be rounded up to 3, when there are apparent differences between the absolute risk reduction. NNTs should not be rounded up to the nearest whole integer out of a fear of working with decimals because this will lead to omission of valuable information.</p>
<hr>
<blockquote class="blockquote">
<p>Solution: Don’t round the NNT to the nearest whole integer.</p>
</blockquote>
<hr>
<p>As we can see, numbers needed to treat are not free of problems. While they may convey information that is a lot more intuitive, the statistic itself does not seem to be without issues, and the way they are used in medicine is also a problem. However, a lot of these issues may be circumvented with proper reporting, which may be an improvement over current practice, however, the issues still remain with their statistical properties.</p>
<hr>
</section>
</section>
<section id="references" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> References</h1>
<hr>
<p>Duncan, B. W., &amp; Olkin, I. (2005). Bias of estimates of the number needed to treat. <em>Statistics in Medicine</em>, <em>24</em>(12), 1837–1848. <a href="https://doi.org/10.1002/sim.2076" class="uri">https://doi.org/10.1002/sim.2076</a></p>
<p>Hutton, J. L. (2000). Number needed to treat: properties and problems. <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em>, <em>163</em>(3), 381–402. <a href="https://doi.org/10.1111/1467-985X.00175" class="uri">https://doi.org/10.1111/1467-985X.00175</a></p>
<p>Kristiansen, I. S., Gyrd-Hansen, D., Nexøe, J., &amp; Nielsen, J. B. (2004). Goodbye NNT. <em>Journal of Clinical Epidemiology</em>, <em>57</em>(2), 221. <a href="https://doi.org/10.1016/j.jclinepi.2003.09.001" class="uri">https://doi.org/10.1016/j.jclinepi.2003.09.001</a></p>
<p>Motulsky, H. (2014). <em>Intuitive Biostatistics: A Nonmathematical Guide to Statistical Thinking</em>. Oxford University Press.</p>
<p>Stang, A., Poole, C., &amp; Bender, R. (2010). Common problems related to the use of number needed to treat. <em>Journal of Clinical Epidemiology</em>, <em>63</em>(8), 820–825. <a href="https://doi.org/10.1016/j.jclinepi.2009.08.006" class="uri">https://doi.org/10.1016/j.jclinepi.2009.08.006</a></p>
<p>Wu, L. A., &amp; Kottke, T. E. (2001). Number needed to treat: caveat emptor. <em>Journal of Clinical Epidemiology</em>, <em>54</em>(2), 111–116. Retrieved from <a href="https://www.ncbi.nlm.nih.gov/pubmed/11166524" class="uri">https://www.ncbi.nlm.nih.gov/pubmed/11166524</a></p>


<!-- -->

</section>

 ]]></description>
  <guid>https://lesslikely.com/posts/statistics/problems-with-nnt.html</guid>
  <pubDate>Sun, 27 May 2018 04:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700140/Site/nnt.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Problems with the Number Needed to Treat</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/problems-with-nnt.html</link>
  <description><![CDATA[ 





<div class="cell">
<style type="text/css">
table {
  margin: auto;
  border-top: 3px solid #666;
  border-bottom: 3px solid #666;
}
.table > thead > tr > th {
    border-bottom: 3px solid #666;
}
</style>
</div>
<hr>
<p>The number needed to treat (NNT) is a popular statistic used in medicine and its use is encouraged by groups like <a href="http://handbook-5-1.cochrane.org/chapter_12/12_5_2_more_about_the_number_needed_to_treat_nnt.htm">Cochrane</a> and <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1124816/#B1">CONSORT</a>. Even the famous statistician, Doug Altman was a big proponent of it. Why is it so popular? Most believe that the NNT is more understandable than measures like odds ratios or risk ratios or statistics like the absolute risk reduction. The NNT is also believed to convey more meaningful information.</p>
<hr>
<p>In this blog post, I am going to discuss:</p>
<hr>
<ul>
<li><p>what the NNT is</p></li>
<li><p>how to calculate an NNT</p></li>
<li><p>some of the problems associated with the use of the NNT</p></li>
<li><p>solutions to the problems associated with the use of the NNT</p></li>
</ul>
<hr>
<p>The NNT is defined as the number of patients that need to be treated for one patient to experience a positive outcome or for one patient not to experience an adverse outcome. So, an NNT of 100 means that 100 patients need to be treated for one patient actually to benefit. The NNT is the inverse of the absolute risk reduction (ARR) (1/ARR). I will show how they are calculated with a sample contingency table from a controlled study comparing the drug Apixaban to placebo for recurrent thromboembolism (RT). Apixaban is the treatment for the first row and placebo is the treatment for the second row. Bolded numbers are the totals.</p>
<hr>
<div class="cell">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-hover caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; color: rgba(119, 119, 119, 255) !important; font-size: 18px; position: sticky; top: 0; background-color: #dedede00;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: rgba(119, 119, 119, 255) !important; font-size: 18px; position: sticky; top: 0; background-color: #dedede00;">Recurring Events</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: rgba(119, 119, 119, 255) !important; font-size: 18px; position: sticky; top: 0; background-color: #dedede00;">Non Recurring Events</th>
<th data-quarto-table-cell-role="th" style="text-align: center; color: rgba(119, 119, 119, 255) !important; font-size: 18px; position: sticky; top: 0; background-color: #dedede00;">Total Events</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Apixaban</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">826</td>
<td style="text-align: center; font-weight: bold; color: rgba(119, 119, 119, 255) !important;">840</td>
</tr>
<tr class="even">
<td style="text-align: left;">Control</td>
<td style="text-align: center;">73</td>
<td style="text-align: center;">756</td>
<td style="text-align: center; font-weight: bold; color: rgba(119, 119, 119, 255) !important;">829</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total Events</td>
<td style="text-align: center;">87</td>
<td style="text-align: center;">1582</td>
<td style="text-align: center; font-weight: bold; color: rgba(119, 119, 119, 255) !important;">1669</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<hr>
<section id="calculations" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Calculations</h1>
<hr>
<p>We will calculate four different measures: incidence proportions, absolute risk reduction, relative risk, and then the NNT.</p>
<hr>
<section id="incidence-proportions" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="incidence-proportions"><span class="header-section-number">1.1</span> Incidence Proportions</h2>
<hr>
<p>In the group that received the drug, 14 people experienced RT out of 840 people (14/840). So, about <strong>1.7%</strong>. In the control group, 73 people experienced disease progression out of 829 people (73/829), which is <strong>8.8%</strong>. These are incidence proportions.</p>
<hr>
</section>
<section id="absolute-risk-reduction" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="absolute-risk-reduction"><span class="header-section-number">1.2</span> Absolute Risk Reduction</h2>
<hr>
<p>We calculate the absolute risk reduction by finding the difference between the incidence proportions: <strong>8.8%</strong> (control group) - <strong>1.7%</strong> (treatment group) = <strong>7.1%</strong> So, the use of the drug Apixaban lowered the absolute risk of RT by <strong>7.1%.</strong></p>
<hr>
</section>
<section id="relative-risk" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="relative-risk"><span class="header-section-number">1.3</span> Relative Risk</h2>
<hr>
<p>Most people do not enjoy thinking in terms of absolute risk reduction, and they prefer to think in terms of relative risk. We calculate the relative risk by taking the incidence rates and dividing them by one another. So, 8.8% / 1.7% = <strong>5.2</strong></p>
<p>In words, patients who took placebo were <strong>5.2 times more likely</strong> to develop RT than patients who took Apixaban.</p>
<p>We can also do 1.7% / 8.8% = <strong>0.19</strong>, which means that people who were treated with Apixaban had <strong>19%</strong> of the risk that the control group had in developing RT.</p>
<hr>
</section>
<section id="numbers-needed-to-treat" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="numbers-needed-to-treat"><span class="header-section-number">1.4</span> Numbers Needed to Treat</h2>
<hr>
<p>Relative risk is more easily understood than absolute risk reduction, but relative risk can also be deceiving, and most in medicine prefer to work with absolute risk reduction, so they prefer to use the numbers needed to treat which can be calculated by taking the inverse of the absolute risk reduction which is 1 / 7.1 = <strong>14</strong>. This means that <strong>14</strong> people need to be treated with Apixaban to prevent one case of recurrent thromboembolism.</p>
<p>Now that we know how to calculate the NNT, we can discuss the problems with it.</p>
<hr>
<blockquote class="blockquote">
<p>A minor note before I get into this, some statisticians are entirely against the use of the NNT because they believe that it has poor statistical properties mainly due to its non-monotonicity and fusion with infinity as a possible value (Duncan &amp; Olkin, 2005; Hutton, 2000; Kristiansen, Gyrd-Hansen, Nexøe, &amp; Nielsen, 2004; Stang, Poole, &amp; Bender, 2010; Wu &amp; Kottke, 2001).</p>
<p>There are also several other problems such as bias that cannot be corrected for and difficulty calculating confidence intervals with standard errors. Most of these statisticians recommend using the absolute risk reduction instead because it has good statistical properties.</p>
<p>I have listed the papers in the reference section of this article.</p>
</blockquote>
<hr>
</section>
</section>
<section id="major-problem-missing-information" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Major Problem: Missing Information</h1>
<p>A significant problem with the use of the NNT is that it does not provide much information. For example, if we look at the <a href="http://www.thennt.com/">NNT group website</a>, a popular website that classifies interventions by the NNT of an intervention, this is what they have listed at the top of the page for blood pressure medication and mortality/CVD outcomes</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700141/Site/NNT_hypertension_benefits.png" alt="Image taken from the NNT website displaying the benefits of antihypertensive drugs" style="width:60%"></p>
<hr>
<p>And another page about hypertension but mainly focused on primary prevention.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700140/Site/NNT_hypertension_harms.png" alt="Image taken from the NNT website displaying the harms of antihypertensive drugs" style="width:60%"></p>
<hr>
<p>Then one on statins.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700140/Site/NNT_statins.png" alt="Image taken from the NNT website displaying the NNT for statins" style="width:60%"></p>
<hr>
<section id="comparator" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="comparator"><span class="header-section-number">2.1</span> Comparator</h2>
<hr>
<p>Now, most people might take these NNTs and compare them across the board, but unfortunately, you cannot do this if you do not know what the comparators being used here are. The NNT group does have the comparators listed in the middle of the page, but they should be at the top right next to the NNT.</p>
<p>Is it likely that statins are superior to antihypertension medication for primary prevention of CVD events? Probably, I’m not entirely sure. Can we compare them this easily by using only NNTs? No.</p>
<p>As (Stang et al., 2010) points out,</p>
<hr>
<blockquote class="blockquote">
<p>“A statement such as ‘‘This antihypertensive drug has an NNT of 50’’ is not informative unless the comparator is given.”</p>
</blockquote>
<hr>
<p>The NNT seem very easy to understand but are not interpretable without explicit mention of their comparator.</p>
<hr>
<blockquote class="blockquote">
<p>Solution: Explicitly state the comparator next to each NNT.</p>
</blockquote>
<hr>
</section>
<section id="uncertainty" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="uncertainty"><span class="header-section-number">2.2</span> Uncertainty</h2>
<hr>
<p>Another problem is the lack of confidence intervals for the NNTs. Again, NNTs are point estimates, and the uncertainty of the estimate should be displayed right next to the estimate; otherwise, readers will be fooled into thinking that the number is a definitive estimate.</p>
<hr>
<blockquote class="blockquote">
<p>Solution: Calculate and display the confidence intervals of the NNT right next to it.</p>
</blockquote>
<hr>
</section>
<section id="time-period" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="time-period"><span class="header-section-number">2.3</span> Time Period</h2>
<hr>
<p>An NNT without the accompanying time period of the trial or cohort is genuinely meaningless and deceptive when compared across the board. For example, if fish oil for preventing heart attacks had a hypothetical NNT of 10,000 in an RCT that was one year long, and another NNT that was 500 in an RCT that was ten years long, you cannot just blindly compare an NNT of 10,000 to an NNT of 500. Perhaps the intervention takes a long time to work. You are, again, missing vital information if you state the NNT without any accompanying information.</p>
<hr>
<blockquote class="blockquote">
<p>Solution: State the time period of the study that the NNT is calculated from.</p>
</blockquote>
<hr>
</section>
<section id="rounding-nnts" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="rounding-nnts"><span class="header-section-number">2.4</span> Rounding NNTs</h2>
<hr>
<p>Another typical behavior is to round NNTs up because most people do not think it makes much sense to think of part of a patient. For example, people would rather not think that it takes 14.3 patients for one patient to benefit, so they round up. This is a mistake because numbers needed to treat were never meant to be discrete integers, they are estimates and the inverse of risk reductions.</p>
<p>Here’s an example by Stang et al.:</p>
<hr>
<p>If we had an absolute risk reduction that could be between 0.349 and 0.49 and we took the numbers needed to treat from the absolute risk reduction in this interval, they would all round up to 3!</p>
<p>1 / 0.349 = <strong>2.865</strong> is the NNT when the absolute risk reduction is 0.349</p>
<p>1 / 0.40 = <strong>2.5</strong> is the NNT when absolute risk reduction is 0.4</p>
<p>1 / 0.49 = <strong>2.04</strong> is the NNT when absolute risk reduction is 0.49</p>
<p>In practice, all of these NNTs would be rounded up to 3, when there are apparent differences between the absolute risk reduction. NNTs should not be rounded up to the nearest whole integer out of a fear of working with decimals because this will lead to omission of valuable information.</p>
<hr>
<blockquote class="blockquote">
<p>Solution: Don’t round the NNT to the nearest whole integer.</p>
</blockquote>
<hr>
<p>As we can see, numbers needed to treat are not free of problems. While they may convey information that is a lot more intuitive, the statistic itself does not seem to be without issues, and the way they are used in medicine is also a problem. However, a lot of these issues may be circumvented with proper reporting, which may be an improvement over current practice, however, the issues still remain with their statistical properties.</p>
<hr>
</section>
</section>
<section id="references" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> References</h1>
<hr>
<p>Duncan, B. W., &amp; Olkin, I. (2005). Bias of estimates of the number needed to treat. <em>Statistics in Medicine</em>, <em>24</em>(12), 1837–1848. <a href="https://doi.org/10.1002/sim.2076" class="uri">https://doi.org/10.1002/sim.2076</a></p>
<p>Hutton, J. L. (2000). Number needed to treat: properties and problems. <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em>, <em>163</em>(3), 381–402. <a href="https://doi.org/10.1111/1467-985X.00175" class="uri">https://doi.org/10.1111/1467-985X.00175</a></p>
<p>Kristiansen, I. S., Gyrd-Hansen, D., Nexøe, J., &amp; Nielsen, J. B. (2004). Goodbye NNT. <em>Journal of Clinical Epidemiology</em>, <em>57</em>(2), 221. <a href="https://doi.org/10.1016/j.jclinepi.2003.09.001" class="uri">https://doi.org/10.1016/j.jclinepi.2003.09.001</a></p>
<p>Motulsky, H. (2014). <em>Intuitive Biostatistics: A Nonmathematical Guide to Statistical Thinking</em>. Oxford University Press.</p>
<p>Stang, A., Poole, C., &amp; Bender, R. (2010). Common problems related to the use of number needed to treat. <em>Journal of Clinical Epidemiology</em>, <em>63</em>(8), 820–825. <a href="https://doi.org/10.1016/j.jclinepi.2009.08.006" class="uri">https://doi.org/10.1016/j.jclinepi.2009.08.006</a></p>
<p>Wu, L. A., &amp; Kottke, T. E. (2001). Number needed to treat: caveat emptor. <em>Journal of Clinical Epidemiology</em>, <em>54</em>(2), 111–116. Retrieved from <a href="https://www.ncbi.nlm.nih.gov/pubmed/11166524" class="uri">https://www.ncbi.nlm.nih.gov/pubmed/11166524</a></p>


<!-- -->

</section>

 ]]></description>
  <guid>https://lesslikely.com/posts/statistics/problems-with-nnt.html</guid>
  <pubDate>Sun, 27 May 2018 00:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700140/Site/nnt.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title></title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/observed-power.html</link>
  <description><![CDATA[ undefined ]]></description>
  <guid>https://lesslikely.com/posts/statistics/observed-power.html</guid>
  <pubDate>Fri, 04 May 2018 04:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/v1556974078/Site/obspower.gif" medium="image" type="image/gif"/>
</item>
<item>
  <title></title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/observed-power.html</link>
  <description><![CDATA[ undefined ]]></description>
  <guid>https://lesslikely.com/posts/statistics/observed-power.html</guid>
  <pubDate>Fri, 04 May 2018 00:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/v1556974078/Site/obspower.gif" medium="image" type="image/gif"/>
</item>
<item>
  <title>Myth: Covariates Need to Be Balanced in RCTs</title>
  <dc:creator>Zad Rafi</dc:creator>
  <link>https://lesslikely.com/posts/statistics/equal-covariates.html</link>
  <description><![CDATA[ 





<hr>
<p>Before I get into the discussion, I want to remind everyone why <a href="https://en.wikipedia.org/wiki/Random_assignment">we randomize</a> in the first place. It’s to reduce selection bias and to get rid of systematic variation among groups, which allows us to come to more precise and efficient causal inferences. <a href="https://www.journals.uchicago.edu/doi/abs/10.1086/341855">Many critics claim</a> that we can’t make valid causal inferences if there’s an imbalance in covariates between the groups.</p>
<p>Here’s an example. Say, hypothetically, we had two groups, and we wanted to see the effect of a statin on all-cause mortality and compare it to placebo. We randomized our participants to both groups. Now, imagine our placebo group had more smokers in it than the statin group. We may think that this imbalance in smoking distribution puts us in trouble because there were already substantial between-group differences before the trial even started.</p>
<p>So, we haven’t even started the study, and we got a significant result from our test of homogeneity. Now we’re thinking, <em>“oh no, I need to randomize again or abandon ship, or I’ll attempt to <a href="https://www.ncbi.nlm.nih.gov/pubmed/2727470">fit this covariate</a> in a generalized linear model like an ANCOVA.”</em></p>
<p><a href="https://academic.oup.com/bjps/article-abstract/58/3/451/1611094?redirectedFrom=fulltext">Critics of RCTs</a> will argue that because there’s also always the possibility of there being an imbalance of known or unknown covariates between groups, RCTs cannot make proper causal inferences, especially small RCTs that are <em>“unable to distribute confounders effectively.”</em></p>
<p>Unfortunately, there are several problems with these beliefs and approaches.</p>
<ul>
<li><p>Tests of homogeneity cannot tell you whether you’ve <em>“completely randomized,”</em> and they are also inappropriate, see the <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4310023/">CONSORT statement</a>).</p></li>
<li><p>It’s not always possible to <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5042467/">rerandomize</a> to achieve better balance in trials (even though the pioneer of randomization is believed to have one said to rerandomize when an undesirable configuration was obtained.)</p></li>
<li><p>Larger trials <a href="https://www.jstor.org/stable/2345814?seq=1#page_scan_tab_contents">do not necessarily</a> produce a better balance than smaller trials</p></li>
<li><p>The balance of covariates has never been the <a href="https://onlinelibrary.wiley.com/doi/pdf/10.1002/sim.5713">goal of randomization</a></p></li>
<li><p>Fitting covariates to a GLM <strong>after</strong> a test of significance is inappropriate</p></li>
</ul>
<p>RCTs were never designed to perfectly balance covariates or even have very similar distributions of them. The purpose of randomization is to distribute hidden covariates, not perfectly, but efficiently and <em>randomly</em>.</p>
<p><a href="http://psychclassics.yorku.ca/Fisher/Methods/chap8.htm">Ronald Fisher’s recommendation</a>, when he originally wrote <em>Statistical Methods for Research Workers</em> in the 1900s, was to block known covariates while randomizing all the hidden ones while looking at the effects of known covariates on both between-group variance and within-group variance (where everyone is getting the same treatment). The effects on the within-group variance would give you some idea as to the impact of the covariate.</p>
<hr>
<p><img src="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1559517576/Site/fisher_old.jpg" alt="Picture of Ronald Fisher sitting and smoking" style="width:50%"></p>
<hr>
<p>Now, will imbalances of hidden covariates affect the point estimates? Of course, but they will also yield large standard errors and <em>wide</em> compatibility intervals, which should make you less sure about the results of your study. But it does not mean your study is unable to make causal inferences.</p>
<p>It’s also worth remembering that analyses of clinical trials are robust in that they account for these possible imbalances in both known and unknown covariates. When you have an imbalance in covariates, what do you get? Wide compatibility intervals, which is okay, that’s what statistics is meant to do, allow you to gauge ‘uncertainty.’ Furthermore, if covariates were balanced perfectly between groups, the standard analyses used for RCTs would become inappropriate, which is why the analyses for matched RCTs and normal RCTs are different.</p>
<p>But again, this doesn’t mean that we shouldn’t think about covariates. There are several valid methods to account for known covariates such as minimization (although I am NOT a fan of it), fitting covariates into a GLM (decisions like this are made prior to the analysis, not based on tests of significance) or stratifying by that covariate, in fact, this technique of stratifying after is known as post-stratification and often used by trial statisticians.</p>
<p>So, in conclusion, you don’t achieve causality from a perfect balance of RCTs and clinical trial statistical methods are a lot more complicated than most people think.</p>
<blockquote class="blockquote">
<p>This piece is primarily inspired by <a href="https://scholar.google.com/citations?user=giqwCAEAAAAJ&amp;hl=en">Stephen Senn’s paper on randomization</a>.</p>
</blockquote>


<!-- -->


 ]]></description>
  <guid>https://lesslikely.com/posts/statistics/equal-covariates.html</guid>
  <pubDate>Tue, 10 Apr 2018 04:00:00 GMT</pubDate>
  <media:content url="https://res.cloudinary.com/less-likely/image/upload/f_auto,q_auto/v1554700131/Site/Lurking-Variables.png" medium="image" type="image/png"/>
</item>
</channel>
</rss>
